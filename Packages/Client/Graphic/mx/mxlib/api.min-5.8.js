(function(){(mxLib.Lang={}).inherits=function(c,b){var a,k,e=c.prototype;k=new Function;k.prototype=b.prototype;k=c.prototype=new k;for(a in e)k[a]=e[a];c.prototype.constructor=c;c.superClass=b.prototype}})();(function(){$.Toast=function(c,b,a){function k(){$.Toast.remove(h)}a=$.extend(!0,{},$.Toast.defaultOptions,a);b='\x3cdiv class\x3d"simply-toast alert alert-'+(b?b:a.type)+" "+(a.customClass?a.customClass:"")+'"\x3e';a.allowDismiss&&(b+='\x3cspan class\x3d"close" data-dismiss\x3d"alert"\x3e\x26times;\x3c/span\x3e');b=b+c+"\x3c/div\x3e";var e=a.offset.amount;a.stack||$(".simply-toast").each(function(){return e=Math.max(e,parseInt($(this).css(a.offset.from))+this.offsetHeight+a.spacing)});c={position:"body"===a.appendTo?"fixed":"absolute",margin:0,"z-index":"9999",display:"none","min-width":a.minWidth,"max-width":a.maxWidth};c[a.offset.from]=e+"px";var h=$(b).css(c).appendTo(a.appendTo);switch(a.align){case "center":h.css({left:"50%","margin-left":"-"+h.outerWidth()/2+"px"});break;case "left":h.css("left","20px");break;default:h.css("right","20px")}h.fadeIn?h.fadeIn():h.css({display:"block",opacity:1});0<a.delay&&setTimeout(k,a.delay);h.find('[data-dismiss\x3d"alert"]').removeAttr("data-dismiss").click(k);return h};$.Toast.remove=function(c){return c.fadeOut?c.fadeOut(function(){return c.remove()}):c.remove()};$.Toast.defaultOptions={appendTo:"body",stack:!0,customClass:!1,type:"info",offset:{from:"top",amount:5},align:"center",minWidth:50,maxWidth:500,delay:3E3,allowDismiss:!1,spacing:10}})();(function(){mxLib.guid="$MetaMap$";(function(){window[mxLib.guid]={};mxLib.dom=mxLib.dom||{};mxLib.dom.g=function(a){return"string"==typeof a||a instanceof String?document.getElementById(a):a&&a.nodeName&&(1==a.nodeType||9==a.nodeType)?a:null};mxLib.g=mxLib.G=mxLib.dom.g;mxLib.lang=mxLib.lang||{};mxLib.lang.isString=function(a){return"[object String]"==Object.prototype.toString.call(a)};mxLib.isString=mxLib.lang.isString;mxLib.dom._g=function(a){return mxLib.lang.isString(a)?document.getElementById(a):a};mxLib._g=mxLib.dom._g;mxLib.dom.getDocument=function(a){a=mxLib.dom.g(a);return 9==a.nodeType?a:a.ownerDocument||a.document};mxLib.browser=mxLib.browser||{};mxLib.browser.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0;mxLib.dom.getComputedStyle=function(a,b){a=mxLib.dom._g(a);var e=mxLib.dom.getDocument(a);return e.defaultView&&e.defaultView.getComputedStyle&&(e=e.defaultView.getComputedStyle(a,null))?e[b]||e.getPropertyValue(b):""};mxLib.dom._styleFixer=mxLib.dom._styleFixer||{};mxLib.dom._styleFilter=mxLib.dom._styleFilter||[];mxLib.dom._styleFilter.filter=function(a,b,e){for(var h=0,c=mxLib.dom._styleFilter,f;f=c[h];h++)if(f=f[e])b=f(a,b);return b};mxLib.string=mxLib.string||{};mxLib.string.toCamelCase=function(a){return 0>a.indexOf("-")&&0>a.indexOf("_")?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})};mxLib.dom.getStyle=function(a,b){var e=mxLib.dom;a=e.g(a);b=mxLib.string.toCamelCase(b);var h=a.style[b]||(a.currentStyle?a.currentStyle[b]:"")||e.getComputedStyle(a,b);if(!h){var c=e._styleFixer[b];c&&(h=c.get?c.get(a):mxLib.dom.getStyle(a,c))}if(c=e._styleFilter)h=c.filter(b,h,"get");return h};mxLib.getStyle=mxLib.dom.getStyle;mxLib.dom.setStyle=function(a,b,e){var h=mxLib.dom,c;a=h.g(a);b=mxLib.string.toCamelCase(b);if(c=h._styleFilter)e=c.filter(b,e,"set");(c=h._styleFixer[b])&&c.set?c.set(a,e):a.style[c||b]=e;return a};mxLib.setStyle=mxLib.dom.setStyle;mxLib.dom.setStyles=function(a,b){a=mxLib.dom.g(a);for(var e in b)mxLib.dom.setStyle(a,e,b[e]);return a};mxLib.setStyles=mxLib.dom.setStyles;mxLib.dom._NAME_ATTRS=function(){var a={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};8>mxLib.browser.ie?(a["for"]="htmlFor",a["class"]="className"):(a.htmlFor="for",a.className="class");return a}();mxLib.dom.setAttr=function(a,b,e){a=mxLib.dom.g(a);"style"==b?a.style.cssText=e:(b=mxLib.dom._NAME_ATTRS[b]||b,a.setAttribute(b,e));return a};mxLib.setAttr=mxLib.dom.setAttr;mxLib.dom.setAttrs=function(a,b){a=mxLib.dom.g(a);for(var e in b)mxLib.dom.setAttr(a,e,b[e]);return a};mxLib.setAttrs=mxLib.dom.setAttrs;mxLib.getAttr=mxLib.dom.getAttr=function(a,b){a=mxLib.dom.g(a);if("style"==b)return a.style.cssText;b=mxLib.dom._NAME_ATTRS[b]||b;return a.getAttribute(b)};mxLib.dom.create=function(a,b){var e=document.createElement(a);return mxLib.dom.setAttrs(e,b||{})};/opera\/(\d+\.\d)/i.test(navigator.userAgent)&&(mxLib.browser.opera=+RegExp.$1);mxLib.browser.isWebkit=/webkit/i.test(navigator.userAgent);mxLib.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);mxLib.browser.isStrict="CSS1Compat"==document.compatMode;mxLib.dom.getPosition=function(a){a=mxLib.dom.g(a);var b=mxLib.dom.getDocument(a),e=mxLib.browser,h=mxLib.dom.getStyle;0<e.isGecko&&b.getBoxObjectFor&&h(a,"position");var c={left:0,top:0},f;if(a==(e.ie&&!e.isStrict?b.body:b.documentElement))return c;if(a.getBoundingClientRect)a=a.getBoundingClientRect(),c.left=Math.floor(a.left)+Math.max(b.documentElement.scrollLeft,b.body.scrollLeft),c.top=Math.floor(a.top)+Math.max(b.documentElement.scrollTop,b.body.scrollTop),c.left-=b.documentElement.clientLeft,c.top-=b.documentElement.clientTop,a=b.body,b=parseInt(h(a,"borderLeftWidth")),h=parseInt(h(a,"borderTopWidth")),e.ie&&!e.isStrict&&(c.left-=isNaN(b)?2:b,c.top-=isNaN(h)?2:h);else{f=a;do{c.left+=f.offsetLeft;c.top+=f.offsetTop;if(0<e.isWebkit&&"fixed"==h(f,"position")){c.left+=b.body.scrollLeft;c.top+=b.body.scrollTop;break}f=f.offsetParent}while(f&&f!=a);if(0<e.opera||0<e.isWebkit&&"absolute"==h(a,"position"))c.top-=b.body.offsetTop;for(f=a.offsetParent;f&&f!=b.body;)c.left-=f.scrollLeft,e.opera&&"TR"==f.tagName||(c.top-=f.scrollTop),f=f.offsetParent}return c};mxLib.object=mxLib.object||{};mxLib.extend=mxLib.object.extend=function(a,b){for(var e in b)a[e]=b[e];return a};mxLib.lang=mxLib.lang||{};mxLib.lang.guid=function(){return"MX__"+(window[mxLib.guid]._counter++).toString(36)};window[mxLib.guid]._counter=window[mxLib.guid]._counter||1;window[mxLib.guid]._instances=window[mxLib.guid]._instances||{};mxLib.lang.Class=function(a){this.guid=a||mxLib.lang.guid();window[mxLib.guid]._instances[this.guid]=this};window[mxLib.guid]._instances=window[mxLib.guid]._instances||{};mxLib.lang.decontrol=function(a){var b=window[mxLib.guid];b._instances&&delete b._instances[a]};mxLib.lang.isString=function(a){return"[object String]"==Object.prototype.toString.call(a)};mxLib.lang.isFunction=function(a){return"[object Function]"==Object.prototype.toString.call(a)};mxLib.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};mxLib.lang.Event=function(a,b){this.type=a;this.returnValue=!0;this.target=b||null;this.currentTarget=null};mxLib.lang.Class.prototype.addEventListener=function(a,b,e){if(mxLib.lang.isFunction(b)){!this.__listeners&&(this.__listeners={});var c=this.__listeners,g;if("string"==typeof e&&e){if(/[^\w\-]/.test(e))throw"nonstandard key:"+e;g=b.hashCode=e}0!=a.indexOf("on")&&(a="on"+a);"object"!=typeof c[a]&&(c[a]={});g=g||mxLib.lang.guid();b.hashCode=g;c[a][g]=b;return g}};mxLib.lang.Class.prototype.removeEventListener=function(a,b){if(mxLib.lang.isFunction(b))b=b.hashCode;else if(!mxLib.lang.isString(b))return;!this.__listeners&&(this.__listeners={});0!=a.indexOf("on")&&(a="on"+a);var e=this.__listeners;e[a]&&e[a][b]&&delete e[a][b]};mxLib.lang.Class.prototype.dispatchEvent=function(a,b){mxLib.lang.isString(a)&&(a=new mxLib.lang.Event(a));!this.__listeners&&(this.__listeners={});b=b||{};for(var e in b)a[e]=b[e];var c=this.__listeners,g=a.type;a.target=a.target||this;a.currentTarget=this;0!=g.indexOf("on")&&(g="on"+g);mxLib.lang.isFunction(this[g])&&this[g].apply(this,arguments);if("object"==typeof c[g])for(e in c[g])c[g][e].apply(this,arguments);return a.returnValue};mxLib.lang.inherits=function(a,b,e){var c,g,f=a.prototype;g=new Function;g.prototype=b.prototype;g=a.prototype=new g;for(c in f)g[c]=f[c];a.prototype.constructor=a;a.superClass=b.prototype;"string"==typeof e&&(g._className=e)};mxLib.event=mxLib.event||{};mxLib.event._listeners=mxLib.event._listeners||[];mxLib.on=mxLib.event.on=function(a,b,e){b=b.replace(/^on/i,"");a=mxLib.g(a);var c=function(b){e.call(a,b)},g=mxLib.event._listeners,f=mxLib.event._eventFilter,l=b;b=b.toLowerCase();f&&f[b]&&(c=f[b](a,b,c),l=c.type,c=c.listener);a.addEventListener?a.addEventListener(l,c,!1):a.attachEvent&&a.attachEvent("on"+l,c);g[g.length]=[a,b,e,c,l];return a};mxLib.un=mxLib.event.un=function(a,b,e){a=mxLib._g(a);b=b.replace(/^on/i,"").toLowerCase();for(var c=mxLib.event._listeners,g=c.length,f=!e,l,m;g--;)l=c[g],l[1]!==b||l[0]!==a||!f&&l[2]!==e||(m=l[4],l=l[3],a.removeEventListener?a.removeEventListener(m,l,!1):a.detachEvent&&a.detachEvent("on"+m,l),c.splice(g,1));return a};mxLib.getEvent=mxLib.event.getEvent=function(a){return window.event||a};mxLib.getTarget=mxLib.event.getTarget=function(a){a=mxLib.getEvent(a);return a.target||a.srcElement};mxLib.preventDefault=mxLib.event.preventDefault=function(a){a=mxLib.getEvent(a);a.preventDefault?a.preventDefault():a.returnValue=!1};mxLib.stopBubble=mxLib.event.stopBubble=function(a){a=mxLib.getEvent(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}})();var c=mxLib.Util={};c.createUniqueID=function(a){null==a&&(a="id_");return a+Math.round(1E7*Math.random())};c.removeItem=function(a,b){if(!1==a instanceof Array)return!1;var e=a.indexOf(b);return-1<e?(a.splice(e,1),!0):!1};c.getValueOfNoPX=function(a){if(a){if(-1!=a.indexOf("px")){var b=a.indexOf("px");return Number(a.substring(0,b))}return Number(a)}};c.isPageMxMode=function(){return $.isEmptyObject(MxHost)?!1:!0};c.toast=function(a,b,e){var c="";a==MX_MSGTYPE_SUCCESS?c="success":a==MX_MSGTYPE_WARN?(e=e||{},e.delay=e.delay||1E4,e.allowDismiss=!1===e.allowDismiss?!1:!0,c="warning"):a==MX_MSGTYPE_ERROR?(e=e||{},e.delay=e.delay||12E4,e.allowDismiss=!1===e.allowDismiss?!1:!0,c="danger"):c="info";$.Toast(b,c,e)};c.toastInfo=function(a,b){this.toast(MX_MSGTYPE_INFO,a,b)};c.toastSuccess=function(a,b){this.toast(MX_MSGTYPE_SUCCESS,a,b)};c.toastWarn=function(a,b){this.toast(MX_MSGTYPE_WARN,a,b)};c.toastError=function(a,b){this.toast(MX_MSGTYPE_ERROR,a,b)};c.color=function(){function a(a){a=a.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,b,e,k){return b+b+e+e+k+k});return(a=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(a))?"rgb("+parseInt(a[1],16)+","+parseInt(a[2],16)+","+parseInt(a[3],16)+")":p}var b={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},e=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,c=/rgb\(\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*\)/,g=/rgba\(\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(0|1|0\.[1-9])\s*\)/;return{oI:function(a){if(e.test(a))return a;if(c.test(a))return a=a.match(c),"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2);if(b[a])return b[a]},b0:a,$Z:function(a){return e.test(a)?a:b[a]?b[a]:"#000"},mB:function(f,l){if(g.test(f))return f;"undefined"!=typeof b[f.toLowerCase()]&&(f=b[f.toLowerCase()]);e.test(f)&&(f=a(f));c.test(f)?(f=f.replace(/rgb/g,"rgba"),f=f.replace(/\)/,","+l+")")):f="rgba(0,0,0,1)";return f}}}();c.dispatchEvent=function(a,b,e){0!=b.indexOf("on")&&(b="on"+b);b=new mxLib.lang.Event(b);if(e)for(var c in e)b[c]=e[c];a.dispatchEvent(b)};c.stopAndPrevent=function(a){a=window.event||a;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;return mxLib.preventDefault(a)};c.purge=function(a){if(a){var b=a.attributes,e="";if(b)for(var c=0,g=b.length;c<g;c++)e=b[c].name,"function"===typeof a[e]&&(a[e]=null);if(b=a.childnodes)for(c=0,g=b.length;c<g;c++)mxLib.Util.purge(a.childnodes[c])}};c._setCursor=function(a){var b="",b={dragstart:"-moz-grab",dragging:"-moz-grabbing",dragend:"pointer"},e={dragstart:"move",dragging:"move",dragend:"pointer"};return b=-1!==navigator.userAgent.indexOf("Gecko/")?b[a]:e[a]};c.setAnimation=function(a,b,e){a&&(b==MX_ANIMATION_BOUNCE?($(a).addClass("markerball"),e&&0<e&&setTimeout(function(){$(a).removeClass("markerball")},e)):b==MX_ANIMATION_SHADOW?$(a).addClass("markerShadow"):b==MX_ANIMATION_DROP?(b=$(a).offset().top,e=$(a).height(),a.style.top="0px",$(a).animate({top:b+"px",bottom:b+e+"px"},500),$(a).animate({top:b-30+"px",bottom:b+e+"px"},200),$(a).animate({top:b+"px",bottom:b+e+"px"},100),$(a).animate({top:b-15+"px",bottom:b+e+"px"},200),$(a).animate({top:b+"px",bottom:b+e+"px"},100),$(a).animate({top:b-5+"px",bottom:b+e+"px"},100),$(a).animate({top:b+"px",bottom:b+e+"px"},50),a.style.top=b+"px",$(a).height(e)):b==MX_ANIMATION_FLASH?($(a).addClass("markerflash"),e&&0<e&&setTimeout(function(){$(a).removeClass("markerflash")},e)):!b&&a&&($(a).removeClass("markerball"),$(a).removeClass("markerShadow")))};c.loadCss=function(a){$("\x3clink\x3e").attr({rel:"stylesheet",type:"text/css",href:a}).appendTo("head")};c.getPointArrayBounds=function(a){if(0==a.length)return null;for(var b=new mxLib.Bounds(a[0],a[0]),e=1;e<a.length;e++)b.extend(a[e]);return b};c.getEventPoint=function(a,b){var e=b.clientX||b.x,c=b.clientY||b.y,e=e||0,c=c||0;return a?a.pixelToPoint(new mxLib.Pixel(e,c)):new mxLib.Point(e,c)};c.stringFormat=function(){if(0==arguments.length)return null;for(var a=arguments[0],b=1;b<arguments.length;b++)a=a.replace(RegExp("\\{"+(b-1)+"\\}","gm"),arguments[b]);return a};c.distance=function(a,b){if(a instanceof mxLib.Point)return a.distanceTo(b);if(4==arguments.length){var e=arguments[0],c=arguments[1],g=arguments[2],f=arguments[3];return Math.sqrt((e-g)*(e-g)+(c-f)*(c-f))}};c.getSvgPathBounds=function(a){return(new CanvablePath(a)).bounds()};c.parseOptions=function(a,b){var e=$(a),c={},g=$.trim(e.attr("data-options"));g&&("{"!=g.substring(0,1)&&(g="{"+g+"}"),c=(new Function("return "+g))());$.map("width height left top minWidth maxWidth minHeight maxHeight".split(" "),function(b){var l=$.trim(a.style[b]||"");l&&(-1==l.indexOf("%")&&(l=parseInt(l)||void 0),c[b]=l)});if(b){for(var g={},f=0;f<b.length;f++){var l=b[f];if("string"==typeof l)g[l]=e.attr(l);else for(var m in l){var q=l[m];"boolean"==q?g[m]=e.attr(m)?"true"==e.attr(m):void 0:"number"==q&&(g[m]="0"==e.attr(m)?0:parseFloat(e.attr(m))||void 0)}}$.extend(c,g)}return c};c.isLowerVersion=function(){return 0<=navigator.userAgent.indexOf("Safari/534.34")?!0:!1};mxLib.Util=c;var b=mxLib.GeoUtils={};b.isPointInRect=function(a,b){if(!(a instanceof mxLib.Point&&b instanceof mxLib.Bounds))return!1;var e=b.getSouthWest(),c=b.getNorthEast();return a.y>=e.y&&a.y<=c.y&&a.x>=e.x&&a.x<=c.x};b.isPointInCircle=function(a,k){if(!(a instanceof mxLib.Point&&k instanceof mxLib.Circle))return!1;var e=k.getCenter(),c=k.getRadius();return b.getDistance(a,e)<=c?!0:!1};b.isPointOnPolyline=function(a,b){if(!(a instanceof mxLib.Point&&b instanceof mxLib.Polyline))return!1;var e=b.getBounds();if(!this.isPointInRect(a,e))return!1;for(var e=b.getPath(),c=0;c<e.length-1;c++){var g=e[c],f=e[c+1];if(a.y>=Math.min(g.y,f.y)&&a.y<=Math.max(g.y,f.y)&&a.x>=Math.min(g.x,f.x)&&a.x<=Math.max(g.x,f.x)&&(g=(g.y-a.y)*(f.x-a.x)-(f.y-a.y)*(g.x-a.x),2E-10>g&&-2E-10<g))return!0}return!1};b.isPointInPolygon=function(a,b){if(!(a instanceof mxLib.Point&&b instanceof mxLib.Polygon))return!1;var e=b.getBounds();if(!this.isPointInRect(a,e))return!1;var e=b.getPath(),c=e.length,g=0,f,l;f=e[0];for(var m=1;m<=c;++m){if(a.equals(f))return!0;l=e[m%c];if(!(a.x<Math.min(f.x,l.x)||a.x>Math.max(f.x,l.x)))if(a.x>Math.min(f.x,l.x)&&a.x<Math.max(f.x,l.x)){if(a.y<=Math.max(f.y,l.y)){if(f.x==l.x&&a.y>=Math.min(f.y,l.y))return!0;if(f.y==l.y){if(f.y==a.y)return!0;++g}else{f=(a.x-f.x)*(l.y-f.y)/(l.x-f.x)+f.y;if(2E-10>Math.abs(a.y-f))return!0;a.y<f&&++g}}}else if(a.x==l.x&&a.y<=l.y){var q=e[(m+1)%c];a.x>=Math.min(f.x,q.x)&&a.x<=Math.max(f.x,q.x)?++g:g+=2}f=l}return 0==g%2?!1:!0};b.degreeToRad=function(a){return Math.PI*a/180};b.radToDegree=function(a){return 180*a/Math.PI};b.getDistance=function(a,b){return mxLib.Util.distance(a,b)};b.getPolylineDistance=function(a){if(a instanceof mxLib.Polyline||a instanceof Array){a=a instanceof mxLib.Polyline?a.getPath():a;if(2>a.length)return 0;for(var c=0,e=0;e<a.length-1;e++)var h=b.getDistance(a[e],a[e+1]),c=c+h;return c}return 0};b.getPolygonArea=function(a){if(!(a instanceof mxLib.Polygon||a instanceof Array))return 0;var b;b=a instanceof mxLib.Polygon?a.getPath():a;if(3>b.length)return 0;for(var e=a=0,c=0,g=0,f=0,l=0,m=0,q=0,n=f=g=0,r=e=0,s=m=l=c=0,v=0,t=a=m=q=n=r=v=s=l=c=r=e=n=0,y=0,u=0,w=0,x=b.length,w=0;w<x;w++)0==w?(e=b[x-1].y*Math.PI/180,c=b[x-1].x*Math.PI/180,g=b[0].y*Math.PI/180,f=b[0].x*Math.PI/180,l=b[1].y*Math.PI/180,m=b[1].x*Math.PI/180):w==x-1?(e=b[x-2].y*Math.PI/180,c=b[x-2].x*Math.PI/180,g=b[x-1].y*Math.PI/180,f=b[x-1].x*Math.PI/180,l=b[0].y*Math.PI/180,m=b[0].x*Math.PI/180):(e=b[w-1].y*Math.PI/180,c=b[w-1].x*Math.PI/180,g=b[w].y*Math.PI/180,f=b[w].x*Math.PI/180,l=b[w+1].y*Math.PI/180,m=b[w+1].x*Math.PI/180),q=Math.cos(f)*Math.cos(g),g=Math.cos(f)*Math.sin(g),f=Math.sin(f),n=Math.cos(c)*Math.cos(e),e=Math.cos(c)*Math.sin(e),r=Math.sin(c),c=Math.cos(m)*Math.cos(l),l=Math.cos(m)*Math.sin(l),m=Math.sin(m),s=(q*q+g*g+f*f)/(q*n+g*e+f*r),v=(q*q+g*g+f*f)/(q*c+g*l+f*m),n=s*n-q,e=s*e-g,r=s*r-f,c=v*c-q,l=v*l-g,s=v*m-f,m=(c*n+l*e+s*r)/(Math.sqrt(c*c+l*l+s*s)*Math.sqrt(n*n+e*e+r*r)),m=Math.acos(m),v=l*r-s*e,r=0-(c*r-s*n),n=c*e-l*n,q=0!=q?v/q:0!=g?r/g:n/f,0<q?(a+=m,u++):(t+=m,y++);b=a+(2*Math.PI*y-t);u=2*Math.PI*u-a+t;w=a>t?1>b-(x-2)*Math.PI?b:u:1>u-(x-2)*Math.PI?u:b;return a=4.058960035303017E13*(w-(x-2)*Math.PI)};mxLib.GeoUtils=b})();(function(){var c=mxLib.Point=function(b,a){this.x="string"==typeof b?parseFloat(b):b;this.y="string"==typeof a?parseFloat(a):a;this.IsRealEqual=mxLib.MxHost.IsRealEqual||function(a,b){return a==b}};c.prototype.x=0;c.prototype.y=0;c.prototype.equals=function(b){var a=null;1<arguments.length&&$.isNumeric(arguments[1])&&(a=arguments[1]);return a?Math.abs(b.x-this.x)<=a&&Math.abs(b.y-this.y)<=a?!0:!1:this.IsRealEqual(b.x,this.x)&&this.IsRealEqual(b.y,this.y)};c.prototype.toPixel=function(b){return b?b.pointToPixel(this.x,this.y):null};c.prototype.distanceTo=function(b){var a=this.x,c=this.y;1==arguments.length&&arguments[0]instanceof mxLib.Point?(a=arguments[0].x,c=arguments[0].y):2==arguments.length&&$.isNumeric(arguments[0])&&$.isNumeric(arguments[1])&&(a=arguments[0],c=arguments[1]);return Math.sqrt((a-this.x)*(a-this.x)+(c-this.y)*(c-this.y))};c.prototype.lng=function(){return this.x};c.prototype.lat=function(){return this.y}})();(function(){var c=mxLib.Pixel=function(b,a){this.x=b;this.y=a};c.prototype.x=0;c.prototype.y=0;c.prototype.equals=function(b){return this.x==b.x&&this.y==b.y?!0:!1};c.prototype.toPoint=function(b){return b?b.pointToPixel(this.x,this.y):null}})();(function(){var c=mxLib.Bounds=function(){if(4==arguments.length){var b=arguments[0]||0,a=arguments[1]||0,c=arguments[2]||0,e=arguments[3]||0;this.leftBtmPoint=new mxLib.Point(Math.min(b,c),Math.min(a,e));this.rightTopPoint=new mxLib.Point(Math.max(b,c),Math.max(a,e))}else 2==arguments.length?(b=arguments[0],a=arguments[1],b=b||new mxLib.Point(0,0),a=a||new mxLib.Point(0,0),b.x=b.x||0,a.x=a.x||0,b.y=b.y||0,a.y=a.y||0,this.leftBtmPoint=new mxLib.Point(Math.min(b.x,a.x),Math.min(b.y,a.y)),this.rightTopPoint=new mxLib.Point(Math.max(b.x,a.x),Math.max(b.y,a.y))):(this.leftBtmPoint=new mxLib.Point,this.rightTopPoint=new mxLib.Point);this.width=this.rightTopPoint.x-this.leftBtmPoint.x;this.height=this.rightTopPoint.y-this.leftBtmPoint.y};c.prototype.width=0;c.prototype.height=0;c.prototype.equals=function(b){return b?this.leftBtmPoint.equals(b.leftBtmPoint)&&this.rightTopPoint.equals(b.rightTopPoint)?!0:!1:!1};c.prototype.containsPoint=function(b,a){return a&&(this.leftBtmPoint.equals(b)||this.rightTopPoint.equals(b))?!0:b.x>=this.leftBtmPoint.x&&b.x<=this.rightTopPoint.x&&b.y>=this.leftBtmPoint.y&&b.y<=this.rightTopPoint.y?!0:!1};c.prototype.containsBounds=function(b,a){return!1!==a?this.containsPoint(b.leftBtmPoint)&&this.containsPoint(b.rightTopPoint)?!0:!1:this.containsPoint(b.leftBtmPoint)||this.containsPoint(b.rightTopPoint)?!0:!1};c.prototype.getCenter=function(){return new mxLib.Point((this.leftBtmPoint.x+this.rightTopPoint.x)/2,(this.leftBtmPoint.y+this.rightTopPoint.y)/2)};c.prototype.getLeftTop=function(){return new mxLib.Point(this.leftBtmPoint.x,this.rightTopPoint.y)};c.prototype.getLeftBottom=function(){return this.leftBtmPoint};c.prototype.getRightBottom=function(){return new mxLib.Point(this.rightTopPoint.x,this.leftBtmPoint.y)};c.prototype.getRightTop=function(){return this.rightTopPoint};c.prototype.getSouthWest=function(){return this.leftBtmPoint};c.prototype.getNorthEast=function(){return this.rightTopPoint};c.prototype.extend=function(b){if(void 0==this.leftBtmPoint.x||null==this.leftBtmPoint.x)this.leftBtmPoint.x=b.x;if(void 0==this.leftBtmPoint.y||null==this.leftBtmPoint.y)this.leftBtmPoint.y=b.y;if(void 0==this.rightTopPoint.x||null==this.rightTopPoint.x)this.rightTopPoint.x=b.x;if(void 0==this.rightTopPoint.y||null==this.rightTopPoint.y)this.rightTopPoint.y=b.y;this.containsPoint(b)||(this.leftBtmPoint.x>b.x&&(this.leftBtmPoint.x=b.x),this.rightTopPoint.x<b.x&&(this.rightTopPoint.x=b.x),this.leftBtmPoint.y>b.y&&(this.leftBtmPoint.y=b.y),this.rightTopPoint.y<b.y&&(this.rightTopPoint.y=b.y),this.width=this.rightTopPoint.x-this.leftBtmPoint.x,this.height=this.rightTopPoint.y-this.leftBtmPoint.y)}})();(function(){var c=mxLib.Size=function(){if(4==arguments.length){var b=arguments[0],a=arguments[1],c=arguments[2],e=arguments[3];this.leftTopPixel=new mxLib.Pixel(Math.min(b,c),Math.min(a,e));this.rightBtmPixel=new mxLib.Pixel(Math.max(b,c),Math.max(a,e))}else 2==arguments.length?arguments[0]instanceof mxLib.Pixel?(b=arguments[0],a=arguments[1],this.leftTopPixel=new mxLib.Pixel(Math.min(b.x,a.x),Math.min(b.y,a.y)),this.rightBtmPixel=new mxLib.Pixel(Math.max(b.x,a.x),Math.max(b.y,a.y))):(b=arguments[0],a=arguments[1],this.leftTopPixel=new mxLib.Pixel(0,0),this.rightBtmPixel=new mxLib.Pixel(b,a)):(this.leftTopPixel=new mxLib.Pixel,this.rightBtmPixel=new mxLib.Pixel);this.width=this.rightBtmPixel.x-this.leftTopPixel.y;this.height=this.rightBtmPixel.y-this.leftTopPixel.y};c.prototype.width=0;c.prototype.height=0;c.prototype.equals=function(b){return b?this.leftTopPixel.equals(b.leftTopPixel)&&this.rightBtmPixel.equals(b.rightBtmPixel)?!0:!1:!1};c.prototype.containsPixel=function(b){return this.leftTopPixel.equals(b)||this.rightBtmPixel.equals(b)?!0:b.x>this.leftTopPixel.x&&b.x<this.rightBtmPixel.x&&b.y>this.leftTopPixel.y&&b.y<this.rightBtmPixel.y?!0:!1};c.prototype.containsSize=function(b,a){return!1!==a?this.containsPixel(b.leftTopPixel)&&this.containsPixel(b.rightBtmPixel)?!0:!1:this.containsPixel(b.leftTopPixel)||this.containsPixel(b.rightBtmPixel)?!0:!1};c.prototype.getCenter=function(){return new mxLib.Pixel((this.leftTopPixel.x+this.rightBtmPixel.x)/2,(this.leftTopPixel.y+this.rightBtmPixel.y)/2)};c.prototype.getLeftTop=function(){return this.leftTopPixel};c.prototype.getRightBottom=function(){return this.rightBtmPixel}})();(function(){function c(a){function e(){if(a.panesParentDiv){var b=a.getCenter(),c=b.x-a._centerOld.x,b=b.y-a._centerOld.y,c=a.pointDistToPixelDist(Math.abs(c))*(0<c?-1:1),b=a.pointDistToPixelDist(Math.abs(b))*(0<b?1:-1);a.panesParentDiv.style.left=c+"px";a.panesParentDiv.style.top=b+"px";a._isMiddleMode&&(a._MiddleMaskImg.style.left=c+a._SaveContainerPos.left+"px",a._MiddleMaskImg.style.top=b+a._SaveContainerPos.top+"px")}}var c=a;$(c.container).dblclick(function(a){if(0!=a.button||!c.eventInMapTarget(a))return!0;var b=a.clientX||a.x;a=a.clientY||a.y;b-=$(this).offset().left;a-=$(this).offset().top;if("true"!=mxLib.View.getExtData(MV_ATTR_DBCLICKNOPANMAP))return"true"!=mxLib.View.getExtData(MV_ATTR_DBCCLKPANMAPNOFIT)?c.element.PanToPixel(b,a,!1):c.element.PanToPixel(b,a,!0),!1});$(c.container).mousedown(function(a){});$(c.container).mouseup(function(b){if(1!=b.button&&2==b.button&&a._ContextMenu)return a.showContextMenu(b),!1});a.addEventListener("message",function(a,b){mxLib.Util.toast(a,b)});a.addEventListener("zoomend",function(b){a.panesParentDiv&&(a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px");for(b=0;b<a.overlays.length;b++)a.overlays[b].draw(!0);for(b=0;b<a.controls.length;b++)a.controls[b].curZoomInRange()});a.addEventListener("dragstart",function(b){a.panesParentDiv&&(a._centerOld=a.getCenter());a._bDragstart=!0;a._isMiddleMode&&(a._saveStyleLeft&&(a._MiddleMaskImg.style.left=a._saveStyleLeft,a._MiddleMaskImg.style.top=a._saveStyleTop,a.setRealRefresh(!0)),a._SaveContainerPos=$(a.container).position(),a._saveStyleLeft=a._MiddleMaskImg.style.left,a._saveStyleTop=a._MiddleMaskImg.style.top);!0===a.isDragging&&a.panesParentDiv&&(a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px");a.isDragging=!0});a.addEventListener("dragging",function(b){a._bDragstart&&(a._isMiddleMode&&a.setRealRefresh(!1),a._bDragstart=!1);e()});a.addEventListener("dragend",function(b){a.panesParentDiv&&(a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px");a._isMiddleMode&&(!1===a._bDragstart&&a.setRealRefresh(!0),a._MiddleMaskImg.style.left=a._saveStyleLeft,a._MiddleMaskImg.style.top=a._saveStyleTop,a._saveStyleLeft=null,a._saveStyleTop=null);for(b=0;b<a.overlays.length;b++)a.overlays[b].draw();a.isDragging=!1});a.addEventListener("movestart",function(b){if(a.panesParentDiv||a._isMiddleMode)a._centerOld=a.getCenter(),a._bMovestart=!0,a._isMiddleMode&&(a._saveStyleLeft=a.container.style.left,a._saveStyleTop=a.container.style.top)});a.addEventListener("moving",function(b){a._bMovestart&&(a._isMiddleMode&&a.setRealRefresh(!1),a._bMovestart=!1);e()});a.addEventListener("moveend",function(b){if(a.panesParentDiv||a._isMiddleMode)a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px",a._isMiddleMode&&(!1===a._bMovestart&&a.setRealRefresh(!0),a.container.style.left=a._saveStyleLeft,a.container.style.top=a._saveStyleTop,a._saveStyleLeft=null,a._saveStyleTop=null);for(b=0;b<a.overlays.length;b++)a.overlays[b].draw()});b(a)}function b(b){function e(a){a=window.event||a;a=new mxLib.Pixel(a.pageX||a.clientX||0,a.pageY||a.clientY||0);var c=b.pixelToPoint(a);return{pixel:a,point:c}}if(0==b.hotspots.length)b.hotspotpixels_visble.length=0,b._hotspot_clickFunc&&b.removeEventListener("click",b._hotspot_clickFunc),b._hotspot_mousemoveFunc&&b.removeEventListener("mousemove",b._hotspot_mousemoveFunc);else if(!b._hotspot_clickFunc){setTimeout(function(){a(b)},100);b.addEventListener("zoomend",function(e){a(b)});b.addEventListener("dragend",function(e){a(b)});b.addEventListener("moveend",function(e){a(b)});b.addEventListener("mouseup",b._hotspot_clickFunc=function(a){if(1!=a.button)for(var c=a.clientX||a.x,k=a.clientY||a.y,h=e(a),g=0;g<b.hotspotpixels_visble.length;g++)if(c>=b.hotspotpixels_visble[g].x-b.hotspots_visble[g].offsets[3]&&c<=b.hotspotpixels_visble[g].x+b.hotspots_visble[g].offsets[1]&&k>=b.hotspotpixels_visble[g].y-b.hotspots_visble[g].offsets[0]&&k<=b.hotspotpixels_visble[g].y+b.hotspots_visble[g].offsets[2]){0==a.button?$(b.container).trigger("hotspotclick",{point:h.point,pixel:h.pixel,spots:b.hotspots_visble[g]}):2==a.button&&$(b.container).trigger("hotspotrightclick",{point:h.point,pixel:h.pixel,spots:b.hotspots_visble[g]});break}});var c=b.container.style.cursor;b.addEventListener("mousemove",b._hotspot_mousemoveFunc=function(a){var k=a.clientX||a.x,h=a.clientY||a.y;if(!b.isDragging){a=e(a);for(var g=!1,f=0;f<b.hotspotpixels_visble.length;f++)if(k>=b.hotspotpixels_visble[f].x-b.hotspots_visble[f].offsets[3]&&k<=b.hotspotpixels_visble[f].x+b.hotspots_visble[f].offsets[1]&&h>=b.hotspotpixels_visble[f].y-b.hotspots_visble[f].offsets[0]&&h<=b.hotspotpixels_visble[f].y+b.hotspots_visble[f].offsets[2]){b.container.style.cursor="pointer";g=!0;b._curHotspotPointIndex!=f&&($(b.container).trigger("hotspotover",{point:a.point,pixel:a.pixel,spots:b.hotspots_visble[f]}),""!=b.hotspots_visble[f].getText()&&b.hotspot_lable&&(b.hotspot_lable.setContent(b.hotspots_visble[f].getText()),k=b.hotspots_visble[f].getPosition(),k=b.pointToPixel(k),k.y+=b.hotspots_visble[f].offsets[2],k=b.pixelToPoint(k),b.hotspot_lable.setPosition(k),b.hotspot_lable.show(),b.hotspot_lable.draw()),b.hotspot_marker&&b.hotspot_symbol&&(k=Math.abs(b.hotspots_visble[f].offsets[3]+b.hotspots_visble[f].offsets[1]),h=Math.abs(b.hotspots_visble[f].offsets[0]+b.hotspots_visble[f].offsets[2]),b.hotspot_symbol.style.shapeRectWidth=k,b.hotspot_symbol.style.shapeRectHeight=h,b.config.enableCustomHotspotMarker?$(b.container).trigger("hotspotmarker",{point:a.point,pixel:a.pixel,spots:b.hotspots_visble[f],width:k,height:h,icon:b.hotspot_symbol,marker:b.hotspot_marker,hotspotPositon:b.hotspots_visble[f].getPosition()}):(b.hotspot_symbol.init(),b.hotspot_marker.setIcon(b.hotspot_symbol),b.hotspot_marker.setPosition(b.hotspots_visble[f].getPosition()),b.hotspot_marker.show())),b._curHotspotPointIndex&&$(b.container).trigger("hotspotout",{point:a.point,pixel:a.pixel,spots:b.hotspots_visble[b._curHotspotPointIndex]}),b._curHotspotPointIndex=f);break}g||(b.container.style.cursor=c,b._curHotspotPointIndex&&($(b.container).trigger("hotspotout",{point:a.point,pixel:a.pixel,spots:b.hotspots_visble[b._curHotspotPointIndex]}),b._curHotspotPointIndex=null,b.hotspot_lable&&b.hotspot_lable.hide(),b.hotspot_marker&&b.hotspot_marker.hide()))}})}}function a(a){var b=a.getBounds(!1);a.hotspots_visble.length=0;for(var e=a.hotspotpixels_visble.length=0;e<a.hotspots.length;e++)a.curZoomInRange(a.hotspots[e].options.minZoom,a.hotspots[e].options.maxZoom)&&b.containsPoint(a.hotspots[e].getPosition())&&(a.hotspotpixels_visble.push(a.pointToPixel(a.hotspots[e].getPosition())),a.hotspots_visble.push(a.hotspots[e]))}function k(a){a.hotspot_lable=null;a.hotspot_symbol=null;a.hotspot_marker=null;var b=new mxLib.Label("",{enableMassClear:!1,offset:new mxLib.Size(0,16)});b.setStyle({backgroundcolor:"rgb(255, 255, 225)",border:"1px solid rgb(140, 140, 140)",padding:"1px",whitespace:"nowrap",font:"12px arial,simsun,sans-serif",color:"blue"});a.addOverlay(b);b.setZIndex(19E6);b.hide();var e=new mxLib.Symbol(MX_Symbol_SHAPE_RECTANGLE,{scale:1,fillColor:"rgb(220,220,220)",fillOpacity:0.2,shapeRectWidth:0,shapeRectHeight:0,strokeColor:"rgb(220,220,220)",strokeWeight:1}),c=new mxLib.Marker(new mxLib.Point(0,0),{icon:e,enableMassClear:!1});a.addOverlay(c);c.setZIndex(19E6);c.hide();a.hotspot_lable=b;a.hotspot_symbol=e;a.hotspot_marker=c}function e(a){function b(a,e){var c=mxLib.dom.create("div",{style:"overflow: visible; position: absolute; left: 0px; top: 0px;"});c.style.zIndex=e;a.appendChild(c);return c}var e=mxLib.dom.create("div",{style:"overflow: visible; position: absolute; z-index: 0; left: 0px; top: 0px;"});a.panes.floatPane=b(e,800);a.panes.markerMouseTarget=b(e,700);a.panes.floatShadow=b(e,600);a.panes.labelPane=b(e,500);a.panes.markerPane=b(e,400);a.panes.markerShadow=b(e,300);a.panes.mapVertex=b(e,250);a.panes.vectorLayer=b(e,200);a.panes.mapPane=b(e,100);a.panesParentDiv=e;$(a.container).append(e)}function h(a,b){if(b&&b.length){a._saveOverlaysEvents=[];for(var e=0;e<b.length;e++){var c={},k=b[e]instanceof mxLib.lang.Class,h=k?null:$._data(b[e],"events");c._clickEvents=h?h.click:null;c._dblclickEvents=h?h.dblclick:null;c._mousedownEvents=h?h.mousedown:null;c._mousemoveEvents=h?h.mousemove:null;c._mouseupEvents=h?h.mouseup:null;c._mouseoutEvents=h?h.mouseout:null;c._mouseoverEvents=h?h.mouseover:null;h&&(h.click=null,h.dblclick=null,h.mousedown=null,h.mousemove=null,h.mouseup=null,h.mouseout=null,h.mouseover=null);c._ContextMenu=b[e]._ContextMenu;b[e]._ContextMenu=null;k&&(k=b[e].__listeners)&&(c._onlickEvents=k.onclick,c._ondblclickEvents=k.ondblclick,c._onmousedownEvents=k.onmousedown,c._onmousemoveEvents=k.onmousemove,c._onmouseupEvents=k.onmouseup,c._onmouseoutEvents=k.onmouseout,c._onmouseoverEvents=k.onmouseover,c._ondragstart=k.ondragstart,c._ondragging=k.ondragging,c._ondragend=k.ondragend,k.onclick=void 0,k.ondblclick=void 0,k.onmousedown=void 0,k.onmousemove=void 0,k.onmouseup=void 0,k.onmouseout=void 0,k.onmouseover=void 0,k.ondragstart=void 0,k.ondragging=void 0,k.ondragend=void 0);a._saveOverlaysEvents.push(c)}}}function g(a,b,e){a._saveEventOverlays=e;h(a,e);a._clickEvents=$._data(a.getContainer(),"events").click;a._dblclickEvents=$._data(a.getContainer(),"events").dblclick;$._data(document,"events")?(a._keydownEvents=$._data(document,"events").keydown,a._keypressEvents=$._data(document,"events").keypress,a._keyupEvents=$._data(document,"events").keyup):(a._keydownEvents=null,a._keypressEvents=null,a._keyupEvents=null);a._mousedownEvents=$._data(a.getContainer(),"events").mousedown;a._mousemoveEvents=$._data(a.getContainer(),"events").mousemove;a._mouseupEvents=$._data(a.getContainer(),"events").mouseup;$._data(a.getContainer(),"events").click=null;$._data(a.getContainer(),"events").dblclick=null;$._data(document,"events")&&($._data(document,"events").keydown=null,$._data(document,"events").keypress=null,$._data(document,"events").keyup=null);$._data(a.getContainer(),"events").mousedown=null;$._data(a.getContainer(),"events").mousemove=null;$._data(a.getContainer(),"events").mouseup=null;a._saveContextMenu=a._ContextMenu;a._ContextMenu=null;a._saveCursor=a.container.style.cursor;b||(b={markerMouseTarget:!1,floatShadow:!1,labelPane:!1,markerPane:!1,markerShadow:!1,mapVertex:!1,mapPane:!1,vectorLayer:!1});!0!==b.markerMouseTarget&&(b.markerMouseTarget=!1);!0!==b.floatShadow&&(b.floatShadow=!1);!0!==b.labelPane&&(b.labelPane=!1);!0!==b.markerPane&&(b.markerPane=!1);!0!==b.markerShadow&&(b.markerShadow=!1);!0!==b.mapVertex&&(b.mapVertex=!1);!0!==b.mapPane&&(b.mapPane=!1);!0!==b.vectorLayer&&(b.vectorLayer=!1);if(e)for(var c=0;c<e.length;c++)e[c].getEventPane&&(e[c].getEventPane()==a.getPanes().floatPane?b.floatPane=!0:e[c].getEventPane()==a.getPanes().markerMouseTarget?b.markerMouseTarget=!0:e[c].getEventPane()==a.getPanes().labelPane?b.labelPane=!0:e[c].getEventPane()==a.getPanes().markerPane?b.markerPane=!0:e[c].getEventPane()==a.getPanes().markerShadow?b.markerShadow=!0:e[c].getEventPane()==a.getPanes().mapVertex?b.mapVertex=!0:e[c].getEventPane()==a.getPanes().mapPane?b.mapPane=!0:e[c].getEventPane()==a.getPanes().vectorLayer&&(b.vectorLayer=!0));if(a._saveCaptureEvents=b)if(!1===b.floatPane&&$(a.getPanes().floatPane).css("pointer-events","none"),!1===b.markerMouseTarget&&$(a.getPanes().markerMouseTarget).css("pointer-events","none"),!1===b.floatShadow&&$(a.getPanes().floatShadow).css("pointer-events","none"),!1===b.labelPane&&$(a.getPanes().labelPane).css("pointer-events","none"),!1===b.markerPane&&$(a.getPanes().markerPane).css("pointer-events","none"),!1===b.markerShadow&&$(a.getPanes().markerShadow).css("pointer-events","none"),!1===b.mapVertex&&$(a.getPanes().mapVertex).css("pointer-events","none"),!1===b.mapPane&&$(a.getPanes().mapPane).css("pointer-events","none"),!1===b.vectorLayer&&$(a.getPanes().vectorLayer).css("pointer-events","none"),b.noEventDoms&&0<b.noEventDoms.length)for(e=0;e<b.noEventDoms.length;e++)$(b.noEventDoms[e]).css("pointer-events","none");a.addEventListener("keypress",function(b,e){if(27==b.charCode){if(a.hasFocus()){0<a.commandStack.length&&a.commandStack[a.commandStack.length-1].end(!0);return}var c=(new Date).getTime();a._escLastPresTime=a._escLastPresTime||0;a._escPresCount=a._escPresCount||0;a._escPresCount+=1;if(5==a._escPresCount){if(3E3>c-a._escLastPresTime){a.exitAllCommand();return}a._escPresCount=0;a._escLastPresTime=c}}0!=a.commandStack.length&&a.commandStack[a.commandStack.length-1].keypress(b,e)});a.addEventListener("keyup",function(b,e){0!=a.commandStack.length&&a.commandStack[a.commandStack.length-1].keyup(b,e)});a.addEventListener("keydown",function(b,e){0!=a.commandStack.length&&a.commandStack[a.commandStack.length-1].keydown(b,e)});a.addEventListener("dblclick",function(b,e){0==b.button&&0!=a.commandStack.length&&a.eventInMapTarget(b)&&a.commandStack[a.commandStack.length-1].dblclick(b,e)});a.addEventListener("click",function(b,e){0==b.button&&0!=a.commandStack.length&&a.eventInMapTarget(b)&&a.commandStack[a.commandStack.length-1].click(b,e)});a.addEventListener("mousedown",function(b,e){if(0!=a.commandStack.length&&a.eventInMapTarget(b)){var c=a.commandStack[a.commandStack.length-1];0==b.button?c.leftMousedown(b,e):2==b.button&&c.rightMousedown(b,e)}});a.addEventListener("mouseup",function(b,e){if(0!=a.commandStack.length&&a.eventInMapTarget(b)){var c=a.commandStack[a.commandStack.length-1];0==b.button?c.leftMouseup(b,e):2==b.button&&c.rightMouseup(b,e)}});a.addEventListener("mousemove",function(b,e){0!=a.commandStack.length&&a.eventInMapTarget(b)&&a.commandStack[a.commandStack.length-1].mousemove(b,e)})}var f=mxLib.Map=function(a,b){this.elementId=null==a||void 0==a||""==a?"mmap":a;var h="mc_"+this.elementId;if(document.getElementById(h))alert("\u5730\u56fe\u5bf9\u8c61\u91cd\u590d\u521b\u5efa\uff0cid:"+this.elementId);else{this.config=b=b||{};this.controls=[];this.overlays=[];this.hotspots=[];this.hotspots_visble=[];this.hotspotpixels_visble=[];this.panes={};this.temp={};this.commandStack=[];this.element=document.getElementById(this.elementId);this.mapPaneSvgExtendPixel=500;var g=document.createElement("div");g.id=h;var h=this.element,f=h.parentNode;f.lastChild==h?f.appendChild(g,h):f.insertBefore(g,h.nextSibling);_ElementSameStyle(g,this.element);this.container=g;this._isMiddleMode=this.element&&this.element.GetZMode&&1==this.element.GetZMode()?!0:!1;this._isMiddleMode&&(this.element.style.zIndex=-999999,g="mc_maskimg_"+this.elementId,$(this.container).append($('\x3cdiv id\x3d"'+g+'" style\x3d"position:absolute;left:0px;top:0px;width:100%;height:100%"/\x3e')),this._MiddleMaskImg=$("#"+g)[0]);UpdateDwgImg("maskimg_"+this.elementId,"");this.element.SetLoadJsBegin&&this.element.SetLoadJsBegin();e(this);c(this);k(this);!1!==this.config.focus&&this.setFocus()}};_ElementSameStyle=function(a,b){var e=b.style;$(a).css("position","absolute");$(a).css("overflow","hidden");$(a).css("-webkit-user-select","none");a.onselectstart=function(){return!1};for(var c=0;c<e.length;c++){var k=e[c],h=e[k];"position"==k.toLowerCase()&&"relative"==h.toLowerCase()&&(h="absolute");$(a).css(k,h)}};f.prototype.getMapPaneSvg=function(){if(this._MapPaneSvg)return this._MapPaneSvg;if(this.panes&&this.panes.mapPane){var a=document.createElementNS("http://www.w3.org/2000/svg","svg");a.id=mxLib.Util.createUniqueID("svg");a.style.position="absolute";var b=$(this.container).width()+2*this.mapPaneSvgExtendPixel,e=$(this.container).height()+2*this.mapPaneSvgExtendPixel,c=-this.mapPaneSvgExtendPixel,k=-this.mapPaneSvgExtendPixel;a.style.width=b+"px";a.style.height=e+"px";a.style.top=c+"px";a.style.left=k+"px";$(a).attr("viewBox",c+" "+k+" "+b+" "+e);this.panes.mapPane.appendChild(a);this._MapPaneSvgDomElement=a;return this._MapPaneSvg=Snap("#"+a.id)}return null};f.prototype.getElement=function(){return this.element};f.prototype.getContainer=function(){return this.container};f.prototype.getMapImagePlaceholder=function(){return this._MiddleMaskImg};f.prototype.addControl=function(a){!1!=a instanceof mxLib.Control&&-1==this.controls.indexOf(a)&&(a.domElement=a.initialize(this),mxLib.Control.prototype.initialize.call(a,this),this.controls.push(a))};f.prototype.removeControl=function(a){!1!=a instanceof mxLib.Control&&-1!=this.controls.indexOf(a)&&($(a.domElement).remove(),mxLib.Util.removeItem(this.controls,a),a.remove())};f.prototype.addOverlay=function(a){!1!=a instanceof mxLib.Overlay&&a._initAddOverlay&&(a._initAddOverlay(this),this.overlays.push(a))};f.prototype.removeOverlay=function(a){!1!=a instanceof mxLib.Overlay&&-1!=this.overlays.indexOf(a)&&($(a.domElement).remove(),mxLib.Util.removeItem(this.overlays,a),a.remove())};f.prototype.getOverlays=function(a){return this.overlays};f.prototype.clearOverlays=function(a){if(a)for(a=0;a<this.overlays.length;a++)this.overlays[a].enableMassClear&&this.removeOverlay(this.overlays[a]);else{for(var b in this.panes)this.panes[b].innerHTML="";for(a=0;a<this.overlays.length;a++)this.overlays[a].remove();this.overlays.length=0;this._MapPaneSvg=null;k(this)}};f.prototype.addHotspot=function(a){!1!=a instanceof mxLib.Hotspot&&(a.initialize(this),this.hotspots.push(a),b(this))};f.prototype.removeHotspot=function(a){!1!=a instanceof mxLib.Hotspot&&-1!=this.hotspots.indexOf(a)&&(mxLib.Util.removeItem(this.hotspots,a),b(this))};f.prototype.clearHotspots=function(){this.hotspots.length=0;b(this)};f.prototype.openInfoWindow=function(a,b){if(a instanceof mxLib.Overlay&&b instanceof mxLib.Point){var e=this.temp;if(a.marker)e.marker.setPosition(b);else{var c=new mxLib.Icon(scriptBaseDir+"mxImg/blank.gif",{width:1,height:1});e.marker=new mxLib.Marker(b,{icon:c,width:1,height:1,offset:new mxLib.Size(0,0),infoWindowOffset:new mxLib.Size(0,0),clickable:!1});e.marker._fromMap=!0}this.addOverlay(e.marker);e.marker.openInfoWindow(a)}};f.prototype.closeInfoWindow=function(){var a=this.temp.infoWin;a&&a.overlay&&a.overlay.closeInfoWindow()};f.prototype.openDwg=function(a){return this.element.OpenDwg(a)};f.prototype.getElementId=function(){return this.element.GetID()};f.prototype.getContainerId=function(){return"mc_"+this.elementId};f.prototype.setFocus=function(){this.element.SetFocus&&this.element.SetFocus()};f.prototype.hasFocus=function(){if(this.element.HasFocus)return this.element.HasFocus()};f.prototype.setVisble=function(a){this.element.SetVisible(a)};f.prototype.getVisble=function(){return this.element.GetVisible()};f.prototype.setRealRefresh=function(a){this.element.SetRealRefresh(a)};f.prototype.getRealRefresh=function(){return this.element.GetIsRealRefresh()};f.prototype.setFocus=function(){this.element.SetFocus&&this.element.SetFocus()};f.prototype.setZoomRange=function(a,b,e,c){this.element.SetScaleFactor&&this.element.SetScaleFactor(a,b,e,c)};f.prototype.getMinZoom=function(){return this.element.GetMinScale?this.element.GetMinScale():0};f.prototype.getMaxZoom=function(){return this.element.GetMaxScale?this.element.GetMaxScale():0};f.prototype.getFullZoom=function(){return this.element.GetFullScale?this.element.GetFullScale():0};f.prototype.getFitZoom=function(){return this.element.GetFitScale()};f.prototype.curZoomInRange=function(a,b){var e=0;if(this.element.GetZoomScale)e=this.element.GetZoomScale();else return!0;return a&&e<a||b&&e>b?!1:!0};f.prototype.pointToPixel=function(a,b){var e=a,c=b;a instanceof mxLib.Point&&(e=a.x,c=a.y);return this.getElement().GetDevPt?(e=this.getElement().GetDevPt(e||0,c||0),e=$.parseJSON(e),new mxLib.Pixel(e.x,e.y)):new mxLib.Pixel(e,c)};f.prototype.pixelToPoint=function(a,b){var e=a,c=b;a instanceof mxLib.Pixel&&(e=a.x,c=a.y);e=e||0;c=c||0;return this.getElement().GetGeoPt?(e=this.getElement().GetGeoPt(e,c),e=$.parseJSON(e),new mxLib.Point(e.x,e.y)):new mxLib.Point(e,c)};f.prototype.pointToSvgPixel=function(a,b){var e=a,c=b;a instanceof mxLib.Point&&(e=a.x,c=a.y);return this.getElement().GetDevPt?(e=this.getElement().GetDevPt(e||0,c||0),e=$.parseJSON(e),new mxLib.Pixel(e.x+this.mapPaneSvgExtendPixel,e.y+this.mapPaneSvgExtendPixel)):new mxLib.Pixel(e+this.mapPaneSvgExtendPixel,c+this.mapPaneSvgExtendPixel)};f.prototype.pixelDistToPointDist=function(a){return this.getElement().GeoByPixel?this.getElement().GeoByPixel(a):a};f.prototype.pointDistToPixelDist=function(a){return this.getElement().PixelByGeo?this.getElement().PixelByGeo(a):a};f.prototype.centerAndZoom=function(a,b){this.element.CenterZoom(a.x,a.y,b)};f.prototype.getCenter=function(){if(!this.element.GetViewCenter)return new mxLib.Point($(this.element).width()/2,$(this.element).height()/2);var a=this.element.GetViewCenter(),a=$.parseJSON(a);return new mxLib.Point(a.cx,a.cy)};f.prototype.setCenter=function(a){a instanceof mxLib.Point&&a.x&&a.y&&$.isNumeric(a.x)&&$.isNumeric(a.y)&&this.panTo(a.x,a.y,!1)};f.prototype.panTo=function(a,b,e){a instanceof mxLib.Point?this.element.PanTo(a.x,a.y,b):$.isNumeric(a)&&$.isNumeric(b)&&this.element.PanTo(a,b,e)};f.prototype.panToPixel=function(){1==arguments.length&&arguments[0]instanceof mxLib.Pixel?this.element.PanToPixel(arguments[0].x,arguments[0].y,arguments[1]):$.isNumeric(arguments[0])&&$.isNumeric(arguments[1])&&this.element.PanToPixel(arguments[0],arguments[1],arguments[2])};f.prototype.panBy=function(){1==arguments.length&&arguments[0]instanceof mxLib.Pixel?this.element.PanBy&&this.element.PanBy(arguments[0].x,arguments[0].y):2==arguments.length&&this.element.PanBy&&this.element.PanBy(arguments[0],arguments[1])};f.prototype.setZoom=function(a){this.element.SetZoomScale(a)};f.prototype.getZoom=function(){return this.element.GetZoomScale?this.element.GetZoomScale():0};f.prototype.zoomIn=function(){this.element.ZoomIn()};f.prototype.zoomOut=function(){this.element.ZoomOut()};f.prototype.zoomWindowSel=function(){this.element.ZoomWindowSel()};f.prototype.zoomWindow=function(){this.element.ZoomWindow&&(2==arguments.length&&arguments[0]instanceof mxLib.Point&&arguments[1]instanceof mxLib.Point?this.element.ZoomWindow(arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y):4==arguments.length&&this.element.ZoomWindow(arguments[0],arguments[1],arguments[2],arguments[3]))};f.prototype.zoomWindowByPixel=function(){2==arguments.length&&arguments[0]instanceof mxLib.Pixel&&arguments[1]instanceof mxLib.Pixel?this.element.ZoomWindowPixel(arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y):4==arguments.length&&this.element.ZoomWindowPixel(arguments[0],arguments[1],arguments[2],arguments[3])};f.prototype.zoomExtent=function(){this.element.ZoomExtent()};f.prototype.setViewport=function(a,b){if(a instanceof mxLib.Bounds){var e=b||{};if(!e.margins||4>e.margins.length)e.margins=[30,60,30,60];var c=this.pixelDistToPointDist(e.margins[0]),k=this.pixelDistToPointDist(e.margins[1]),h=this.pixelDistToPointDist(e.margins[2]),g=this.pixelDistToPointDist(e.margins[3]);this.zoomWindow(a.getSouthWest().x-g,a.getSouthWest().y-h,a.getNorthEast().x+k,a.getNorthEast().y+c);e.zoomFactor&&this.setZoom(this.getZoom()+e.zoomFactor)}};f.prototype.getBounds=function(a){return this.element.GetBounds?(a=this.element.GetBounds(a?!0:!1),a=JSON.parse(a),new mxLib.Bounds(a.minx,a.miny,a.maxx,a.maxy)):new mxLib.Bounds(0,0,$(this.element).width(),$(this.element).height())};f.prototype.getSize=function(a){return this.element.GetViewSize&&a?(a=this.element.GetViewSize(),a=JSON.parse(a),new mxLib.Size(a.left,a.top,a.right,a.bottom)):new mxLib.Size(0,0,$(this.element).width(),$(this.element).height())};f.prototype.getDistance=function(){var a=0,b=0,e=0,c=0;2==arguments.length?arguments[0]instanceof mxLib.Point&&arguments[1]instanceof mxLib.Point?(a=arguments[0].x,e=arguments[0].y,b=arguments[1].x,c=arguments[1].y):arguments[0]instanceof mxLib.Pixel&&arguments[1]instanceof mxLib.Pixel&&(a=arguments[0].x,e=arguments[0].y,b=arguments[1].x,c=arguments[1].y):4==arguments.length&&$.isNumeric(arguments[0])&&$.isNumeric(arguments[1])&&$.isNumeric(arguments[2])&&$.isNumeric(arguments[3])&&(a=arguments[0],e=arguments[1],b=arguments[2],c=arguments[3]);return Math.sqrt((b-a)*(b-a)+(c-e)*(c-e))};f.prototype.selEntity=function(a,b,e){return this.element.EntSel?this.element.EntSel(b||MX_EntAtt_kAttDefault,a||MX_EntType_kTypeDefault,e||!1):"{}"};f.prototype.getEntityByBounds=function(a,b,e,c,k,h,g){return this.element.EntRegion(a,b,e,c,k||MX_EntType_kTypeDefault,h||MX_EntAtt_kAttDefault,2===g?2:1)};f.prototype.getEntityBySize=function(a,b,e,c,k,h){return this.element.EntRegionPixel(b,a,c,e,k||MX_EntType_kTypeDefault,h||MX_EntAtt_kAttDefault)};f.prototype.getEntityByPoint=function(a,b,e,c){return this.element.EntPoint(a,b,e||MX_EntType_kTypeDefault,c||MX_EntAtt_kAttDefault)};f.prototype.getEntityByPixel=function(a,b,e,c){c=c||MX_EntAtt_kAttDefault;e=e||MX_EntType_kTypeDefault;a=this.pixelToPoint(a,b);return this.element.EntPoint(a.x,a.y,e,c)};f.prototype.getLayer=function(a,b){return this.element.LayerFromDb(a,b||MX_LayerAtr_kLayerDefault)};f.prototype.getLayerByBounds=function(a,b,e,c,k,h){return this.element.LayerFromRegion(a,b,e,c,h||MX_LayerAtr_kLayerDefault)};f.prototype.getEntityByLayer=function(a,b,e){return this.element.EntFromLayer(a,e||MX_EntAtt_kAttDefault,b||MX_EntType_kTypeDefault)};f.prototype.getEntityByHandle=function(a,b){return this.element.EntFromHandle(a,b||MX_EntAtt_kAttDefault)};f.prototype.setEntityAttribute=function(a,b,e,c){if(a)return this.element.SetEntAtt(a,b,e,!1===c?!1:!0)};f.prototype.setLayerAttribute=function(a,b,e){if(a)return this.element.SetLayerAtt(a,b,e)};f.prototype.update=function(){return this.element.OnRender()};f.prototype.getEntityPoints=function(a,b){for(var e=this.element.GetEntPoints(a,b||100),c=[],e=$.parseJSON(e),k=0;k<e.length;k++)c.push(new mxLib.Point(e[k].x,e[k].y));return c};f.prototype.cancelEntitySelect=function(){if(this.element.CancelEntSel)return this.element.CancelEntSel()};f.prototype.positionEntity=function(a){if(this.element.EntPosition)return this.element.EntPosition(a)};f.prototype.PtInRegion=function(a,b){if(!(this.element.PtInRegion&&a instanceof mxLib.Point&&b.length))return!1;for(var e="[",c=0;c<b.length;c++){0!=c&&(e+=",");var k=mxLib.Util.stringFormat('{"x":{0},"y":{1}}',b[c].x,b[c].y),e=e+k}return this.element.PtInRegion(a.x,a.y,e+"]")?!0:!1};f.prototype.ptCloseToLine=function(a,b){if(this.element.PtCloseToLine&&a instanceof mxLib.Point&&b.length){for(var e="[",c=0;c<b.length;c++){0!=c&&(e+=",");var k=mxLib.Util.stringFormat('{"x":{0},"y":{1}}',b[c].x,b[c].y),e=e+k}e=this.element.PtCloseToLine(a.x,a.y,e+"]");e=$.parseJSON(e);return mxLib.Point(e.x,e.y)}};f.prototype.flashEntity=function(a,b,e){if(a){e=e||8;var c=null,k=!0,h=0,c=setInterval(function(){k=!k;h++;h==e&&clearInterval(c);map.setEntityAttribute(a,"DWG_ENT_VISBLE",k?"true":"false")},b||400)}};f.prototype.getDwgFileName=function(){return this.element.GetDwgFileName()};f.prototype.setTransparent=function(a){return this.element.SetTransparent(a)};f.prototype.sendEscKey=function(){return this.element.SendEscKey()};f.prototype.eventInMapTarget=function(a){var b=!1;a.target.id==this.container.id&&(b=!0);!b&&this._MapPaneSvgDomElement&&a.target.id==this._MapPaneSvgDomElement.id&&(b=!0);0==a.target.id.indexOf("vl_new_")&&(b=!0);return b};f.prototype.startCommand=function(a){if(a.parentCmd){for(e=this.commandStack.length-1;0<=e&&this.commandStack[e].parentCmd!=a.parentCmd;e--);if(0<=e&&e<this.commandStack.length)for(var b=this.commandStack.length-1;b>=e;b--)this.commandStack[b].end(!0)}else if(0<this.commandStack.length)for(var e=0;e<this.commandStack.length;e++)this.commandStack[e].end(!0);0==this.commandStack.length&&g(this,a.options?a.options.captureEvents:null,a.options?a.options.saveEventOverlays:null);this.commandStack.push(a);a.start(this)};f.prototype.endCommand=function(a,b){if(0!=this.commandStack.length){var e=this.commandStack.indexOf(a);if(-1!=e&&(this.commandStack.splice(e,this.commandStack.length-e),0==this.commandStack.length)){if((e=this._saveEventOverlays)&&e.length){for(var c=0;c<e.length;c++){var k=this._saveOverlaysEvents[c],h=e[c]instanceof mxLib.lang.Class,g=h?null:$._data(e[c],"events");g&&(g.click=k._clickEvents,g.dblclick=k._dblclickEvents,g.mousedown=k._mousedownEvents,g.mousemove=k._mousemoveEvents,g.mouseup=k._mouseupEvents,g.mouseout=k._mouseoutEvents,g.mouseover=k._mouseoverEvents);e[c]._ContextMenu=k._ContextMenu;h&&(h=e[c].__listeners)&&(h.onclick=k._onlickEvents,h.ondblclick=k._ondblclickEvents,h.onmousedown=k._onmousedownEvents,h.onmousemove=k._onmousemoveEvents,h.onmouseup=k._onmouseupEvents,h.onmouseout=k._onmouseoutEvents,h.onmouseover=k._onmouseoverEvents,h.ondragstart=k._ondragstart,h.ondragging=k._ondragging,h.ondragend=k._ondragend)}this._saveOverlaysEvents=null}this._saveEventOverlays=null;$._data(this.getContainer(),"events").click=this._clickEvents;$._data(this.getContainer(),"events").dblclick=this._dblclickEvents;$._data(document,"events")&&($._data(document,"events").keydown=this._keydownEvents,$._data(document,"events").keypress=this._keypressEvents,$._data(document,"events").keyup=this._keyupEvents);$._data(this.getContainer(),"events").mousedown=this._mousedownEvents;$._data(this.getContainer(),"events").mousemove=this._mousemoveEvents;$._data(this.getContainer(),"events").mouseup=this._mouseupEvents;this._mouseupEvents=this._mousemoveEvents=this._mousedownEvents=this._keyupEvents=this._keypressEvents=this._keydownEvents=this._dblclickEvents=this._clickEvents=null;this._ContextMenu=this._saveContextMenu;this.setCursor(this._saveCursor);if(e=this._saveCaptureEvents)if(!1===e.floatPane&&$(this.getPanes().floatPane).css("pointer-events",""),!1===e.markerMouseTarget&&$(this.getPanes().markerMouseTarget).css("pointer-events",""),!1===e.floatShadow&&$(this.getPanes().floatShadow).css("pointer-events",""),!1===e.labelPane&&$(this.getPanes().labelPane).css("pointer-events",""),!1===e.markerPane&&$(this.getPanes().markerPane).css("pointer-events",""),!1===e.markerShadow&&$(this.getPanes().markerShadow).css("pointer-events",""),!1===e.mapVertex&&$(this.getPanes().mapVertex).css("pointer-events",""),!1===e.mapPane&&$(this.getPanes().mapPane).css("pointer-events",""),!1===e.vectorLayer&&$(this.getPanes().vectorLayer).css("pointer-events",""),e.noEventDoms&&0<e.noEventDoms.length)for(c=0;c<e.noEventDoms.length;c++)$(e.noEventDoms[c]).css("pointer-events","");this._saveCaptureEvents=null}}};f.prototype.exitAllCommand=function(){for(var a=this.commandStack.length-1;0<=a;a--)this.commandStack[a].end(!0)};f.prototype.addEventListener=function(a,b){b&&("dwgloaded"==a?this.element.dwgloaded&&this.element.dwgloaded.connect(b):"zoomend"==a?this.element.zoomend&&this.element.zoomend.connect(b):"message"==a?this.element.message&&this.element.message.connect(b):"zoomined"==a?this.element.zoomined&&this.element.zoomined.connect(b):"zoomouted"==a?this.element.zoomouted&&this.element.zoomouted.connect(b):"movestart"==a?this.element.movestart&&this.element.movestart.connect(b):"moving"==a?this.element.moving&&this.element.moving.connect(b):"moveend"==a?this.element.moveend&&this.element.moveend.connect(b):"dragstart"==a?this.element.dragstart&&this.element.dragstart.connect(b):"dragging"==a?this.element.dragging&&this.element.dragging.connect(b):"dragend"==a?this.element.dragend&&this.element.dragend.connect(b):"rendered"==a?this.element.rendered&&this.element.rendered.connect(b):"resize"==a?this.element.resize&&this.element.resize.connect(b):"keydown"==a||"keypress"==a||"keyup"==a?$(document).bind(a,b):$(this.container).bind(a,b))};f.prototype.removeEventListener=function(a,b){b&&("dwgloaded"==a?this.element.dwgloaded&&this.element.dwgloaded.disconnect(b):"zoomend"==a?this.element.zoomend&&this.element.zoomend.disconnect(b):"message"==a?this.element.message&&this.element.message.disconnect(b):"zoomined"==a?this.element.zoomined&&this.element.zoomined.disconnect(b):"zoomouted"==a?this.element.zoomouted&&this.element.zoomouted.disconnect(b):"movestart"==a?this.element.movestart&&this.element.movestart.disconnect(b):"moving"==a?this.element.moving&&this.element.moving.disconnect(b):"moveend"==a?this.element.moveend&&this.element.moveend.disconnect(b):"dragstart"==a?this.element.dragstart&&this.element.dragstart.disconnect(b):"dragging"==a?this.element.dragging&&this.element.dragging.disconnect(b):"dragend"==a?this.element.dragend&&this.element.dragend.disconnect(b):"rendered"==a?this.element.rendered&&this.element.rendered.disconnect(b):"resize"==a?this.element.resize&&this.element.resize.disconnect(b):"keydown"==a||"keypress"==a||"keyup"==a?$(document).unbind(a,b):$(this.container).unbind(a,b))};f.prototype.createContextMenu=function(){var a=mxLib.dom.create("div",{style:"overflow: visible; position: absolute; z-index: 10000000; left: 0px; top: 0px;"});$(a).addClass("easyui-menu");$(a).mxMenu();$(this.container).append(a);return a};f.prototype.addContextMenu=function(a){a instanceof mxLib.ContextMenu&&(this._ContextMenu&&this.removeContextMenu(this._ContextMenu),a.initialize(this),this._ContextMenu=a)};f.prototype.removeContextMenu=function(a){a instanceof mxLib.ContextMenu&&a&&a.destroy()};f.prototype.showContextMenu=function(a){var b=a.clientX||a.x,e=a.clientY||a.y;if(this._ContextMenu)return this._ContextMenu.show(new mxLib.Pixel(b,e)),a.stopPropagation(),!1};f.prototype.setCursor=function(a){this.container.style.cursor=a};f.prototype.getPanes=function(){return{floatPane:this.panes.floatPane,markerMouseTarget:this.panes.markerMouseTarget,floatShadow:this.panes.floatShadow,labelPane:this.panes.labelPane,markerPane:this.panes.markerPane,markerShadow:this.panes.markerShadow,mapVertex:this.panes.mapVertex,vectorLayer:this.panes.vectorLayer,mapPane:this.panes.mapPane}};f.prototype.setAnimation=function(a){mxLib.View.setExtData(MV_ATTR_DWG_ANIMATION,a)}})();(function(){function c(a,b,e){if(null!=a&&void 0!=a)switch(a.style.position="absolute",b){case MX_ANCHOR_TOP_LEFT:a.style.left=e.width+"px";a.style.top=e.height+"px";break;case MX_ANCHOR_TOP_RIGHT:a.style.right=e.width+"px";a.style.top=e.height+"px";break;case MX_ANCHOR_BOTTOM_LEFT:a.style.left=e.width+"px";a.style.bottom=e.height+"px";break;case MX_ANCHOR_BOTTOM_RIGHT:a.style.right=e.width+"px",a.style.bottom=e.height+"px"}}window.MX_ANCHOR_TOP_LEFT=0;window.MX_ANCHOR_TOP_RIGHT=1;window.MX_ANCHOR_BOTTOM_LEFT=2;window.MX_ANCHOR_BOTTOM_RIGHT=3;var b=mxLib.Control=function(){this.domElement=this.defaultOffset=this.defaultAnchor=null};mxLib.lang.inherits(mxLib.Control,mxLib.lang.Class,"Control");b.prototype.initialize=function(a){this._map=a;c(this.domElement,this.defaultAnchor,this.defaultOffset)};b.prototype.setAnchor=function(a){this.defaultAnchor=a;c(this.domElement,this.defaultAnchor,this.defaultOffset)};b.prototype.getAnchor=function(){return this.defaultAnchor};b.prototype.setOffset=function(a){this.defaultOffset=a;c(this.domElement,this.defaultAnchor,this.defaultOffset)};b.prototype.getOffset=function(){return this.defaultOffset};b.prototype.show=function(){this.domElement&&$(this.domElement).show()};b.prototype.getDomElement=function(){return this.domElement};b.prototype.hide=function(){$(this.domElement).hide()};b.prototype.isVisible=function(){return $(this.domElement).is(":visible")};b.prototype.curZoomInRange=function(){if(!this._map||!this.domElement)return!0;if(this.options){var a=this.options.minZoom,b=this.options.maxZoom;if(!a&&!b)return!0;a=this._map.curZoomInRange(a,b);b=!1;b=this.isVisible();if(a){if(a!=b){if(2!=this._zoomVisibleOpt)return!1;this.show();this._zoomVisibleOpt=1}return!0}a!=b&&(this.hide(),this._zoomVisibleOpt=2);return!1}};b.prototype.remove=function(){}})();(function(){function c(a,b){var e=a.getMinZoom(),c=a.getMaxZoom(),g=b;if(g<e||g>c)g=e;var f=this._navBarLength,l=(g-e)*f/(c-e),e=this._navBarBeginTop+f-(g-e)*f/(c-e);$("#ctrl_navi_bar_"+this._ctrlId).css("top",e+"px");$("#ctrl_navi_bar_fill_"+this._ctrlId).css("top",e+this._navBarHeight+"px");$("#ctrl_navi_bar_fill_"+this._ctrlId).css("height",l+"px")}var b=mxLib.NavigationControl=function(a){a=a||{};this.defaultAnchor=a.anchor||MX_ANCHOR_TOP_LEFT;this.defaultOffset=a.offest||new mxLib.Size(10,10);this.options=a};mxLib.Lang.inherits(b,mxLib.Control);b.prototype.initialize=function(a){function b(e,k){var h=$("#ctrl_navi_bar_full_"+l).offset().top,h=e-h,f=g._navBarLength;0>h?h=0:h>f&&(h=f);var m=a.getMinZoom(),q=a.getMaxZoom();r=m+(f-h)*(q-m)/f;c.call(g,a,r);k&&(a.setZoom(r),g.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+r.toFixed(0),{delay:300}))}function e(a){b(a.clientY||a.y)}function h(){$(a.container).unbind("mousemove",e);$(a.container).unbind("mouseup",h);null!=r&&(a.setZoom(r),g.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+r.toFixed(0),{delay:300}))}this.map=a;var g=this,f=document.createElement("div");this.domElement=f;f.style.width="66px";f.style.height="230px";f.style.zIndex="1100";var l=mxLib.Util.createUniqueID();this._ctrlId=l;var m;m=' \x3cdiv style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: 0px 0px; width: 56px; height: 56px; left: 11px; top: 0px;"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_bar_full_CTRLID"   style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -36px -80px; width: 8px; height: 118px; left: 35px; top: 88px;"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_bar_fill_CTRLID"  style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -10px -80px; width: 8px; height: 58px; left: 35px; top: 149px;"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_zoomin_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -1px -56px; width: 26px; height: 26px; cursor: pointer;                                left: 26px; top: 64px;" title\x3d"\u653e\u5927"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_zoomout_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -1px -196px; width: 26px; height: 26px; cursor: pointer;                                left: 26px; top: 205px;" title\x3d"\u7f29\u5c0f"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_up_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -19px -5px; width: 20px; height: 18px; cursor: pointer;                                left: 30px; top: 5px;" title\x3d"\u5411\u4e0a\u5e73\u79fb"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_down_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -19px -32px; width: 20px; height: 18px; cursor: pointer;                                left: 30px; top: 32px;" title\x3d"\u5411\u4e0b\u5e73\u79fb"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_left_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -5px -19px; width: 17px; height: 18px; cursor: pointer;                                left: 16px; top: 19px;" title\x3d"\u5411\u5de6\u5e73\u79fb"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_right_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -36px -19px; width: 17px; height: 18px; cursor: pointer;                                left: 47px; top: 19px;" title\x3d"\u5411\u53f3\u5e73\u79fb"\x3e                            \x3c/div\x3e                            \x3cdiv id\x3d"ctrl_navi_bar_CTRLID"  style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -53px -56px; width: 24px; height: 14px; cursor: pointer;                                left: 27px; top: 141px;"\x3e                            \x3c/div\x3e                            \x3cdiv style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);                                background-position: -81px -120px; width: 28px; height: 18px; cursor: pointer;                                left: 0px; top: 193px; display: none;"\x3e                            \x3c/div\x3e'.replace(/CTRLID/g,l);m=m.replace(/SCRIPTDIR/g,scriptBaseDir);$(f).append($(m));$(a.getContainer()).append(f);$("#ctrl_navi_up_"+l).hover(function(){$(this).css("background-position","-75px -5px")},function(){$(this).css("background-position","-19px -5px")}).click(function(){a.panBy(0,-80)});$("#ctrl_navi_down_"+l).hover(function(){$(this).css("background-position","-75px -32px")},function(){$(this).css("background-position","-19px -32px")}).click(function(){a.panBy(0,80)});$("#ctrl_navi_left_"+l).hover(function(){$(this).css("background-position","-61px -19px")},function(){$(this).css("background-position","-5px -19px")}).click(function(){a.panBy(-80,-0)});$("#ctrl_navi_right_"+l).hover(function(){$(this).css("background-position","-92px -19px")},function(){$(this).css("background-position","-36px -19px")}).click(function(){a.panBy(80,-0)});$("#ctrl_navi_zoomin_"+l).hover(function(){$(this).css("background-position","-27px -56px")},function(){$(this).css("background-position","-1px -56px")}).click(function(){a.zoomIn();g.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+a.getZoom().toFixed(0),{delay:300})});$("#ctrl_navi_zoomout_"+l).hover(function(){$(this).css("background-position","-27px -196px")},function(){$(this).css("background-position","-1px -196px")}).click(function(){a.zoomOut();g.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+a.getZoom().toFixed(0),{delay:300})});m=$("#ctrl_navi_bar_"+l).css("height");var q=$("#ctrl_navi_bar_full_"+l).css("height"),n=$("#ctrl_navi_bar_full_"+l).css("top");this._navBarHeight=mxLib.Util.getValueOfNoPX(m);this._navBarLength=mxLib.Util.getValueOfNoPX(q)-mxLib.Util.getValueOfNoPX(m);this._navBarBeginTop=mxLib.Util.getValueOfNoPX(n);c(a,a.getZoom());a.addEventListener("zoomend",function(b){c.call(g,a,b)});var r=null;$("#ctrl_navi_bar_"+l).mousedown(function(b){$(a.container).mousemove(e);$(a.container).mouseup(h);return!1});$("#ctrl_navi_bar_full_"+l).mousedown(function(a){b(a.clientY||a.y,!0)});$("#ctrl_navi_bar_fill_"+l).mousedown(function(a){b(a.clientY||a.y,!0)});return f};b.prototype.remove=function(){map.removeEventListener("zoomend",this.zoomChange);mxLib.Control.prototype.remove.call(this)}})();(function(){var c=mxLib.OverviewMapControl=function(b){b=b||{};this.defaultAnchor=b.anchor||MX_ANCHOR_TOP_LEFT;this.defaultOffset=b.offest||new mxLib.Size(10,10);this.options=b};mxLib.Lang.inherits(c,mxLib.Control);c.prototype.initialize=function(b){};c.prototype.remove=function(){map.removeEventListener("zoomend",this.zoomChange);mxLib.Control.prototype.remove.call(this)}})();(function(c){function b(a,b){var e=c.data(a,"linkbutton").options;b&&c.extend(e,b);if(e.width||e.height||e.fit){var k=c(a),m=k.parent(),q=k.is(":visible");if(!q){var n=c('\x3cdiv style\x3d"display:none"\x3e\x3c/div\x3e').insertBefore(a),r={position:k.css("position"),display:k.css("display"),left:k.css("left")};k.appendTo("body");k.css({position:"absolute",display:"inline-block",left:-2E4})}k.size(e,m);e=k.find(".mx-l-btn-left");e.css("margin-top",0);e.css("margin-top",parseInt((k.height()-e.height())/2)+"px");q||(k.insertAfter(n),k.css(r),n.remove())}}function a(a){var b=c.data(a,"linkbutton").options,f=c(a).empty();f.addClass("mx-l-btn").removeClass("mx-l-btn-plain mx-l-btn-selected mx-l-btn-plain-selected");f.removeClass("mx-l-btn-small mx-l-btn-medium mx-l-btn-large").addClass("mx-l-btn-"+b.size);b.plain&&f.addClass("mx-l-btn-plain");b.selected&&f.addClass(b.plain?"mx-l-btn-selected mx-l-btn-plain-selected":"mx-l-btn-selected");f.attr("group",b.group||"");f.attr("id",b.id||"");var l=c('\x3cspan class\x3d"mx-l-btn-left"\x3e\x3c/span\x3e').appendTo(f);b.text?c('\x3cspan class\x3d"mx-l-btn-text"\x3e\x3c/span\x3e').html(b.text).appendTo(l):c('\x3cspan class\x3d"mx-l-btn-text mx-l-btn-empty"\x3e\x26nbsp;\x3c/span\x3e').appendTo(l);b.iconCls&&(c('\x3cspan class\x3d"mx-l-btn-icon"\x3e\x26nbsp;\x3c/span\x3e').addClass(b.iconCls).appendTo(l),l.addClass("mx-l-btn-icon-"+b.iconAlign));f.unbind(".linkbutton").bind("focus.linkbutton",function(){b.disabled||c(this).addClass("mx-l-btn-focus")}).bind("blur.linkbutton",function(){c(this).removeClass("mx-l-btn-focus")}).bind("click.linkbutton",function(){b.disabled||(b.toggle&&(b.selected?c(this).linkbutton("unselect"):c(this).linkbutton("select")),b.onClick.call(this))});k(a,b.selected);e(a,b.disabled)}function k(a,b){var e=c.data(a,"linkbutton").options;b?(e.group&&c('a.mx-l-btn[group\x3d"'+e.group+'"]').each(function(){var a=c(this).linkbutton("options");a.toggle&&(c(this).removeClass("mx-l-btn-selected mx-l-btn-plain-selected"),a.selected=!1)}),c(a).addClass(e.plain?"mx-l-btn-selected mx-l-btn-plain-selected":"mx-l-btn-selected"),e.selected=!0):e.group||(c(a).removeClass("mx-l-btn-selected mx-l-btn-plain-selected"),e.selected=!1)}function e(a,b){var e=c.data(a,"linkbutton"),k=e.options;c(a).removeClass("mx-l-btn-disabled mx-l-btn-plain-disabled");if(b){k.disabled=!0;var m=c(a).attr("href");m&&(e.href=m,c(a).attr("href","javascript:void(0)"));a.onclick&&(e.onclick=a.onclick,a.onclick=null);k.plain?c(a).addClass("mx-l-btn-disabled mx-l-btn-plain-disabled"):c(a).addClass("mx-l-btn-disabled")}else k.disabled=!1,e.href&&c(a).attr("href",e.href),e.onclick&&(a.onclick=e.onclick)}c.fn.linkbutton=function(e,k){if("string"==typeof e)return c.fn.linkbutton.methods[e](this,k);e=e||{};return this.each(function(){var k=c.data(this,"linkbutton");k?c.extend(k.options,e):(c.data(this,"linkbutton",{options:c.extend({},c.fn.linkbutton.defaults,c.fn.linkbutton.parseOptions(this),e)}),c(this).removeAttr("disabled"),c(this).bind("_resize",function(a,e){e&&b(this);return!1}));a(this);b(this)})};c.fn.linkbutton.methods={options:function(a){return c.data(a[0],"linkbutton").options},resize:function(a,e){return a.each(function(){b(this,e)})},enable:function(a){return a.each(function(){e(this,!1)})},disable:function(a){return a.each(function(){e(this,!0)})},select:function(a){return a.each(function(){k(this,!0)})},unselect:function(a){return a.each(function(){k(this,!1)})}};c.fn.linkbutton.parseOptions=function(a){var b=c(a);return c.extend({},mxLib.Util.parseOptions(a,["id","iconCls","iconAlign","group","size",{plain:"boolean",toggle:"boolean",selected:"boolean"}]),{disabled:b.attr("disabled")?!0:void 0,text:c.trim(b.html()),iconCls:b.attr("icon")||b.attr("iconCls")})};c.fn.linkbutton.defaults={id:null,disabled:!1,toggle:!1,selected:!1,group:null,plain:!1,text:"",iconCls:null,iconAlign:"left",size:"small",onClick:function(){}}})(jQuery);(function(){var c=mxLib.LinkButtonControl=function(b,a,c){this.text=b;this.callback=c;b=a||{};this.defaultAnchor=b.anchor||MX_ANCHOR_TOP_LEFT;this.colorIndex=b.colorIndex||0;this.iconCls=b.iconCls;this.defaultOffset=b.offest||new mxLib.Size(10,10);this.options=b};mxLib.Lang.inherits(c,mxLib.Control);c.prototype.initialize=function(b){var a=$('\x3ca href\x3d"#"\x3e'+this.text+"\x3c/a\x3e ");$(b.container).append(a);this.domElement=a[0];this.iconCls?a.linkbutton({iconCls:this.iconCls}):a.linkbutton();this.options.opacity&&a.css("opacity",this.options.opacity);this.callback&&a.bind("click",this.callback);this.colorIndex&&(this.colorIndex%=8,0==this.colorIndex&&(this.colorIndex=8),a.addClass("mx-c"+this.colorIndex));(this.options.width||this.options.height)&&this.resize(this.options.width,this.options.height);return a[0]};c.prototype.resize=function(b,a){b&&a?$(this.domElement).linkbutton("resize",{width:b,height:a}):b?$(this.domElement).linkbutton("resize",{width:b}):a&&$(this.domElement).linkbutton("resize",{height:a})};c.prototype.enable=function(){$(this.domElement).linkbutton("enable");this.callback&&$(this.domElement).unbind("click",this.callback);this.callback&&$(this.domElement).bind("click",this.callback)};c.prototype.disable=function(){$(this.domElement).linkbutton("disable");this.callback&&$(this.domElement).unbind("click",this.callback)};c.prototype.remove=function(){this.callback&&$(this.domElement).unbind("click",this.callback);mxLib.Control.prototype.remove.call(this)}})();(function(){var c=mxLib.LinkButtonGroupControl=function(b,a){this.buttons=b;var c=a||{};this.defaultAnchor=c.anchor||MX_ANCHOR_TOP_LEFT;this.defaultOffset=c.offest||new mxLib.Size(10,10);this.options=c;this.options.margin=this.options.margin||3};mxLib.Lang.inherits(c,mxLib.Control);c.prototype.initialize=function(b){var a=$("\x3cdiv "+(this.options.style?'style\x3d"'+this.options.style+'"':"")+"\x3e ");$(b.container).append(a);this.domElement=a[0];this.options.opacity&&a.css("opacity",this.options.opacity);for(b=0;b<this.buttons.length;b++){var c=$('\x3ca href\x3d"#"\x3e'+this.buttons[b].text+"\x3c/a\x3e ");this.options.margin&&(this.options.vLayout?(c.css("margin-top",this.options.margin+"px"),c.css("margin-bottom",this.options.margin+"px")):(c.css("margin-left",this.options.margin+"px"),c.css("margin-right",this.options.margin+"px")));if(this.options.vLayout){var e=$("\x3cdiv/\x3e");a.append(e);e.append(c)}else a.append(c);this.buttons[b].iconCls?c.linkbutton({iconCls:this.buttons[b].iconCls}):c.linkbutton();this.buttons[b].group&&c.linkbutton({group:this.buttons[b].group,toggle:!0,selected:this.buttons[b].selected||!1});this.buttons[b].callback&&c.bind("click",this.buttons[b].callback);this.buttons[b].colorIndex&&(this.buttons[b].colorIndex%=8,0==this.buttons[b].colorIndex&&(this.buttons[b].colorIndex=8),c.addClass("mx-c"+this.buttons[b].colorIndex));(this.buttons[b].width||this.buttons[b].height)&&c.linkbutton("resize",{width:this.buttons[b].width,height:this.buttons[b].height})}return a[0]};c.prototype.remove=function(){mxLib.Control.prototype.remove.call(this)}})();(function(){window.MX_DRAWING_MARKER="marker";window.MX_DRAWING_POLYLINE="polyline";window.MX_DRAWING_CIRCLE="circle";window.MX_DRAWING_RECTANGLE="rectangle";window.MX_DRAWING_POLYGON="polygon";mxLib.DrawingTool=DrawingTool=function(c,b){this.DrawCommand=c;b=this.drawingToolOptions=b||{};this.defaultAnchor=MX_ANCHOR_TOP_LEFT;this.defaultOffset=new mxLib.Size(10,10);this.options=b;this.defaultDrawingModes=[MX_DRAWING_MARKER,MX_DRAWING_CIRCLE,MX_DRAWING_POLYLINE,MX_DRAWING_POLYGON,MX_DRAWING_RECTANGLE];this.drawingModes=b.drawingModes?b.drawingModes:this.defaultDrawingModes;b.anchor&&this.setAnchor(b.anchor);b.offset&&this.setOffset(b.offset)};DrawingTool.prototype=new mxLib.Control;DrawingTool.prototype.initialize=function(c){var b=this.container=document.createElement("div");b.className="MxLib_Drawing";var a=this.panel=document.createElement("div");a.className="MxLib_Drawing_panel";this.drawingToolOptions&&this.drawingToolOptions.scale&&this._setScale(this.drawingToolOptions.scale);b.appendChild(a);a.innerHTML=this._generalHtml();this._bind(a);c.getContainer().appendChild(b);return b};DrawingTool.prototype._generalHtml=function(c){var b={};b[MX_DRAWING_MARKER]="\u753b\u70b9";b[MX_DRAWING_CIRCLE]="\u753b\u5706";b[MX_DRAWING_POLYLINE]="\u753b\u6298\u7ebf";b[MX_DRAWING_POLYGON]="\u753b\u591a\u8fb9\u5f62";b[MX_DRAWING_RECTANGLE]="\u753b\u77e9\u5f62";b.exithander="\u9000\u51fa";c=function(a,e){return'\x3ca class\x3d"'+a+'" drawingType\x3d"'+e+'" href\x3d"javascript:void(0)" title\x3d"'+b[e]+'" onfocus\x3d"this.blur()"\x3e\x3c/a\x3e'};for(var a=[],k=0,e=this.drawingModes.length;k<e;k++){var h="MxLib_box MxLib_"+this.drawingModes[k];k==e-1&&(h+=" MxLib_last");a.push(c(h,this.drawingModes[k]))}a.push(c("MxLib_box MxLib_exithander","exithander"));return a.join("")};DrawingTool.prototype._setScale=function(c){var b=-parseInt((390-390*c)/2,10),a=-parseInt((50-50*c)/2,10);this.container.style.cssText=["-moz-transform: scale("+c+");","-o-transform: scale("+c+");","-webkit-transform: scale("+c+");","transform: scale("+c+");","margin-left:"+b+"px;","margin-top:"+a+"px;","*margin-left:0px;*margin-top:0px;margin-left:0px\\0;margin-top:0px\\0;filter: progid:DXImageTransform.Microsoft.Matrix(","M11\x3d"+c+",","M12\x3d0,M21\x3d0,","M22\x3d"+c+",","SizingMethod\x3d'auto expand');"].join("")};DrawingTool.prototype._bind=function(c){var b=this;mxLib.on(this.panel,"click",function(a){a=mxLib.getTarget(a).getAttribute("drawingType");b.setStyleByDrawingMode(a);b._bindEventByDraingMode(a)})};DrawingTool.prototype.setStyleByDrawingMode=function(c){if(c)for(var b=this.panel.getElementsByTagName("a"),a=0,k=b.length;a<k;a++){var e=b[a];if(e.getAttribute("drawingType")==c){var h="MxLib_box MxLib_"+c+"_hover";a==k-1&&(h+=" MxLib_last");e.className=h}else e.className=e.className.replace(/_hover/,"")}};DrawingTool.prototype._bindEventByDraingMode=function(c){var b=this.DrawCommand;b&&("exithander"==c?b.end(!0):b.setDrawingMode(c));mxLib.Util.dispatchEvent(this,"click",{drawingType:c,control:this})}})();(function(){CanvablePath=function(c){c=c.replace(/,/gm," ");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");c=c.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");c=c.replace(/([0-9])([+\-])/gm,"$1 $2");c=c.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");c=c.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");c=CanvablePath.compressSpaces(c);c=CanvablePath.trim(c);this.PathParser=new function(b){this.tokens=b.split(" ");this.reset=function(){this.__index_=-1;this.__previousCommand_=this.__command_="";this.__start_=new CanvablePath.Point(0,0);this.__control_=new CanvablePath.Point(0,0);this.__current_=new CanvablePath.Point(0,0);this.__points_=[];this.__angles_=[]};this.isEnd=function(){return this.__index_>=this.tokens.length-1};this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.__index_+1].match(/^[A-Za-z]$/)};this.isRelativeCommand=function(){switch(this.__command_){case "m":case "l":case "h":case "v":case "c":case "s":case "q":case "t":case "a":case "z":return!0}return!1};this.getToken=function(){this.__index_++;return this.tokens[this.__index_]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.__previousCommand_=this.__command_;this.__command_=this.getToken()};this.getPoint=function(){var a=new CanvablePath.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)};this.getAsControlPoint=function(){var a=this.getPoint();return this.__control_=a};this.getAsCurrentPoint=function(){var a=this.getPoint();return this.__current_=a};this.getReflectedControlPoint=function(){return"c"!=this.__previousCommand_.toLowerCase()&&"s"!=this.__previousCommand_.toLowerCase()&&"q"!=this.__previousCommand_.toLowerCase()&&"t"!=this.__previousCommand_.toLowerCase()?this.__current_:new CanvablePath.Point(2*this.__current_.x-this.__control_.x,2*this.__current_.y-this.__control_.y)};this.makeAbsolute=function(a){this.isRelativeCommand()&&(a.x+=this.__current_.x,a.y+=this.__current_.y);return a};this.addMarker=function(a,b,e){null!=e&&0<this.__angles_.length&&null==this.__angles_[this.__angles_.length-1]&&(this.__angles_[this.__angles_.length-1]=this.__points_[this.__points_.length-1].angleTo(e));this.addMarkerAngle(a,null==b?null:b.angleTo(a))};this.addMarkerAngle=function(a,b){this.__points_.push(a);this.__angles_.push(b)};this.getMarkerPoints=function(){return this.__points_};this.getMarkerAngles=function(){for(var a=0;a<this.__angles_.length;a++)if(null==this.__angles_[a])for(var b=a+1;b<this.__angles_.length;b++)if(null!=this.__angles_[b]){this.__angles_[a]=this.__angles_[b];break}return this.__angles_}}(c);this.bounds=function(){return this.draw(null)};this.draw=function(b){var a=this.PathParser;a.reset();var c=new CanvablePath.BoundingBox;for(null!=b&&b.beginPath();!a.isEnd();)switch(a.nextCommand(),a.__command_){case "M":case "m":var e=a.getAsCurrentPoint();a.addMarker(e);c.addPoint(e.x,e.y);null!=b&&b.moveTo(e.x,e.y);for(a.__start_=a.__current_;!a.isCommandOrEnd();)e=a.getAsCurrentPoint(),a.addMarker(e,a.__start_),c.addPoint(e.x,e.y),null!=b&&b.lineTo(e.x,e.y);break;case "L":case "l":for(;!a.isCommandOrEnd();){var h=a.__current_,e=a.getAsCurrentPoint();a.addMarker(e,h);c.addPoint(e.x,e.y);null!=b&&b.lineTo(e.x,e.y)}break;case "H":case "h":for(;!a.isCommandOrEnd();)e=new CanvablePath.Point((a.isRelativeCommand()?a.__current_.x:0)+a.getScalar(),a.__current_.y),a.addMarker(e,a.__current_),a.__current_=e,c.addPoint(a.__current_.x,a.__current_.y),null!=b&&b.lineTo(a.__current_.x,a.__current_.y);break;case "V":case "v":for(;!a.isCommandOrEnd();)e=new CanvablePath.Point(a.__current_.x,(a.isRelativeCommand()?a.__current_.y:0)+a.getScalar()),a.addMarker(e,a.__current_),a.__current_=e,c.addPoint(a.__current_.x,a.__current_.y),null!=b&&b.lineTo(a.__current_.x,a.__current_.y);break;case "C":case "c":for(;!a.isCommandOrEnd();){var g=a.__current_,h=a.getPoint(),f=a.getAsControlPoint(),e=a.getAsCurrentPoint();a.addMarker(e,f,h);c.addBezierCurve(g.x,g.y,h.x,h.y,f.x,f.y,e.x,e.y);null!=b&&b.bezierCurveTo(h.x,h.y,f.x,f.y,e.x,e.y)}break;case "S":case "s":for(;!a.isCommandOrEnd();)g=a.__current_,h=a.getReflectedControlPoint(),f=a.getAsControlPoint(),e=a.getAsCurrentPoint(),a.addMarker(e,f,h),c.addBezierCurve(g.x,g.y,h.x,h.y,f.x,f.y,e.x,e.y),null!=b&&b.bezierCurveTo(h.x,h.y,f.x,f.y,e.x,e.y);break;case "Q":case "q":for(;!a.isCommandOrEnd();)g=a.__current_,f=a.getAsControlPoint(),e=a.getAsCurrentPoint(),a.addMarker(e,f,f),c.addQuadraticCurve(g.x,g.y,f.x,f.y,e.x,e.y),null!=b&&b.quadraticCurveTo(f.x,f.y,e.x,e.y);break;case "T":case "t":for(;!a.isCommandOrEnd();)g=a.__current_,f=a.getReflectedControlPoint(),a.__control_=f,e=a.getAsCurrentPoint(),a.addMarker(e,f,f),c.addQuadraticCurve(g.x,g.y,f.x,f.y,e.x,e.y),null!=b&&b.quadraticCurveTo(f.x,f.y,e.x,e.y);break;case "A":case "a":for(;!a.isCommandOrEnd();){var g=a.__current_,l=a.getScalar(),m=a.getScalar(),h=a.getScalar()*(Math.PI/180),q=a.getScalar(),f=a.getScalar(),e=a.getAsCurrentPoint(),n=new CanvablePath.Point(Math.cos(h)*(g.x-e.x)/2+Math.sin(h)*(g.y-e.y)/2,-Math.sin(h)*(g.x-e.x)/2+Math.cos(h)*(g.y-e.y)/2),r=Math.pow(n.x,2)/Math.pow(l,2)+Math.pow(n.y,2)/Math.pow(m,2);1<r&&(l*=Math.sqrt(r),m*=Math.sqrt(r));q=(q==f?-1:1)*Math.sqrt((Math.pow(l,2)*Math.pow(m,2)-Math.pow(l,2)*Math.pow(n.y,2)-Math.pow(m,2)*Math.pow(n.x,2))/(Math.pow(l,2)*Math.pow(n.y,2)+Math.pow(m,2)*Math.pow(n.x,2)));isNaN(q)&&(q=0);var s=new CanvablePath.Point(q*l*n.y/m,q*-m*n.x/l),g=new CanvablePath.Point((g.x+e.x)/2+Math.cos(h)*s.x-Math.sin(h)*s.y,(g.y+e.y)/2+Math.sin(h)*s.x+Math.cos(h)*s.y),v=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))*Math.sqrt(Math.pow(b[0],2)+Math.pow(b[1],2)))},t=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(v(a,b))},q=t([1,0],[(n.x-s.x)/l,(n.y-s.y)/m]),r=[(n.x-s.x)/l,(n.y-s.y)/m],s=[(-n.x-s.x)/l,(-n.y-s.y)/m],n=t(r,s);-1>=v(r,s)&&(n=Math.PI);1<=v(r,s)&&(n=0);r=1-f?1:-1;s=q+r*(n/2);t=new CanvablePath.Point(g.x+l*Math.cos(s),g.y+m*Math.sin(s));a.addMarkerAngle(t,s-r*Math.PI/2);a.addMarkerAngle(e,s-r*Math.PI);c.addPoint(e.x,e.y);null!=b&&(v=l>m?l:m,e=l>m?1:l/m,l=l>m?m/l:1,b.translate(g.x,g.y),b.rotate(h),b.scale(e,l),b.arc(0,0,v,q,q+n,1-f),b.scale(1/e,1/l),b.rotate(-h),b.translate(-g.x,-g.y))}break;case "Z":case "z":null!=b&&b.closePath(),a.__current_=a.__start_}return c};this.getMarkers=function(){for(var b=this.PathParser.getMarkerPoints(),a=this.PathParser.getMarkerAngles(),c=[],e=0;e<b.length;e++)c.push([b[e],a[e]]);return c}};CanvablePath.trim=function(c){return c.replace(/^\s+|\s+$/g,"")};CanvablePath.compressSpaces=function(c){return c.replace(/[\s\r\t\n]+/gm," ")};CanvablePath.Point=function(c,b){this.x=c;this.y=b};CanvablePath.Point.prototype.angleTo=function(c){return Math.atan2(c.y-this.y,c.x-this.x)};CanvablePath.Point.prototype.applyTransform=function(c){var b=this.x*c[1]+this.y*c[3]+c[5];this.x=this.x*c[0]+this.y*c[2]+c[4];this.y=b};CanvablePath.BoundingBox=function(c,b,a,k){this.y2=this.x2=this.y1=this.x1=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(a,b){if(null!=a){if(isNaN(this.x1)||isNaN(this.x2))this.x2=this.x1=a;a<this.x1&&(this.x1=a);a>this.x2&&(this.x2=a)}if(null!=b){if(isNaN(this.y1)||isNaN(this.y2))this.y2=this.y1=b;b<this.y1&&(this.y1=b);b>this.y2&&(this.y2=b)}};this.addX=function(a){this.addPoint(a,null)};this.addY=function(a){this.addPoint(null,a)};this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1);this.addPoint(a.x2,a.y2)};this.addQuadraticCurve=function(a,b,c,k,l,m){c=a+2/3*(c-a);k=b+2/3*(k-b);this.addBezierCurve(a,b,c,c+1/3*(l-a),k,k+1/3*(m-b),l,m)};this.addBezierCurve=function(a,b,c,k,l,m,q,n){var r=[a,b],s=[c,k],v=[l,m],t=[q,n];this.addPoint(r[0],r[1]);this.addPoint(t[0],t[1]);for(__index_=0;1>=__index_;__index_++)a=function(a){return Math.pow(1-a,3)*r[__index_]+3*Math.pow(1-a,2)*a*s[__index_]+3*(1-a)*Math.pow(a,2)*v[__index_]+Math.pow(a,3)*t[__index_]},b=6*r[__index_]-12*s[__index_]+6*v[__index_],c=-3*r[__index_]+9*s[__index_]-9*v[__index_]+3*t[__index_],k=3*s[__index_]-3*r[__index_],0==c?0!=b&&(b=-k/b,0<b&&1>b&&(0==__index_&&this.addX(a(b)),1==__index_&&this.addY(a(b)))):(k=Math.pow(b,2)-4*k*c,0>k||(l=(-b+Math.sqrt(k))/(2*c),0<l&&1>l&&(0==__index_&&this.addX(a(l)),1==__index_&&this.addY(a(l))),b=(-b-Math.sqrt(k))/(2*c),0<b&&1>b&&(0==__index_&&this.addX(a(b)),1==__index_&&this.addY(a(b)))))};this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2};this.addPoint(c,b);this.addPoint(a,k)}})();(function(){window.MX_ANIMATION_DROP=1;window.MX_ANIMATION_BOUNCE=2;window.MX_ANIMATION_FLASH=3;window.MX_ANIMATION_SHADOW=4;var c=mxLib.Overlay=function(){this.domElement=null};mxLib.lang.inherits(mxLib.Overlay,mxLib.lang.Class,"Overlay");c.prototype._initAddOverlay=function(b){!this.domElement&&this.initialize&&(mxLib.Overlay.prototype.initialize.call(this,b),this.domElement=this.initialize(b))&&(this.domElement.style.WebkitUserSelect="none");this._bOverlayInternal||this.draw()};c.prototype.initialize=function(b){this._map=b};c.prototype.draw=function(){};c.prototype.getDomElement=function(){return this.domElement};c.getZIndex=function(b){return(b*=1)?-1E5*b<<1:0};c.prototype.show=function(){this.domElement&&$(this.domElement).show()};c.prototype.hide=function(){$(this.domElement).hide()};c.prototype.isVisible=function(){return $(this.domElement).is(":visible")};c.prototype.curZoomInRange=function(b,a,c,e){if(!this._map||!this.domElement||!b&&!a)return!0;b=this._map.curZoomInRange(b,a);a=this.domElement&&"http://www.w3.org/2000/svg"==this.domElement.namespaceURI;e=!1;e=a?"none"!=this.domElement.style.display:this.isVisible();if(b){if(b!=e){if(2!=this._zoomVisibleOpt)return!1;a?this.domElement.style.display="":this.show();if(c)for(b=0;b<c.length;b++)c[b]!=this.domElement&&(c[b]&&c[b].domElement&&c[b].show?c[b].show():c[b]&&(c[b].style.display=""));this._zoomVisibleOpt=1}return!0}if(b!=e){a?this.domElement.style.display="none":this.hide();if(c)for(b=0;b<c.length;b++)c[b]&&c[b].domElement&&c[b].hide?c[b].hide():c[b]&&(c[b].style.display="none");this._zoomVisibleOpt=2}return!1};c.prototype.remove=function(){this.removeContextMenu();this.domElement=null};c.prototype.addContextMenu=function(b){if(this.domElement&&b instanceof mxLib.ContextMenu){this._ContextMenu&&this.removeContextMenu(this._ContextMenu);b.initialize(this._map);this._ContextMenu=b;var a=this;this._funcContextMenu||(this._funcContextMenu=function(b){var e=b.clientX||b.x,c=b.clientY||b.y;if(2==b.button&&a._ContextMenu)return a._ContextMenu.targetObject=a,a._ContextMenu.show(new mxLib.Pixel(e,c)),b.stopPropagation(),!1});$(this.domElement).bind("mouseup",this._funcContextMenu)}};c.prototype.removeContextMenu=function(){this.domElement&&this._ContextMenu&&(this._ContextMenu.releaseRef(),this._funcContextMenu&&$(this.domElement).unbind("mouseup",this._funcContextMenu),this._ContextMenu=null)};c.prototype.setEventDispath=function(b,a){function c(a){a=window.event||a;a=new mxLib.Pixel(a.pageX||a.clientX||0,a.pageY||a.clientY||0);var b=f.pixelToPoint(a);return{pixel:a,point:b}}var e=this;b=b||e.domElement;var h=null;a=!1===a?!1:!0;var g=null,f=e.map||e._map;mxLib.on(b,"onclick",function(a){mxLib.Util.dispatchEvent(e,"onclick");mxLib.Util.stopAndPrevent(a)});mxLib.on(b,"ontouchend",function(a){mxLib.Util.dispatchEvent(e,"ontouchend");mxLib.Util.dispatchEvent(e,"onclick");mxLib.Util.stopAndPrevent(a)});mxLib.on(b,"ondblclick",function(a){var b=c(a);mxLib.Util.dispatchEvent(e,"ondblclick",{point:b.point,pixel:b.pixel});mxLib.Util.stopAndPrevent(a)});b.onmouseover=function(a){var b=c(a);mxLib.Util.dispatchEvent(e,"onmouseover",{point:b.point,pixel:b.pixel});mxLib.Util.stopAndPrevent(a)};b.onmouseout=function(a){var b=c(a);mxLib.Util.dispatchEvent(e,"onmouseout",{point:b.point,pixel:b.pixel});mxLib.Util.stopAndPrevent(a)};var l=function(q){var n=c(q);mxLib.Util.dispatchEvent(e,"onmouseup",{point:n.point,pixel:n.pixel});if(a){var r=f;mxLib.un(r.container,"onmousemove",m);mxLib.un(r.container,"onmouseup",l);if(0!=q.button||!e.isDraggable()){mxLib.Util.stopAndPrevent(q);return}b.style.cursor=g;b.releaseCapture&&b.releaseCapture();mxLib.Util.dispatchEvent(e,"ondragend",{point:n.point,pixel:n.pixel});h=null}mxLib.Util.stopAndPrevent(q)};if(a)var m=function(a){var b=c(a),g=f.pointToPixel(e.getDragPoint()),l=b.pixel.x-h.x+g.x,g=b.pixel.y-h.y+g.y;h=b.pixel;e.setDragPoint(f.pixelToPoint(new mxLib.Pixel(l,g)));e.draw();mxLib.Util.dispatchEvent(e,"ondragging",{point:b.point,pixel:b.pixel});mxLib.Util.stopAndPrevent(a)};mxLib.on(b,"onmousedown",function(q){var n=c(q);mxLib.Util.dispatchEvent(e,"onmousedown",{point:n.point,pixel:n.pixel});if(0==q.button&&e.isDraggable()&&a){g=b.style.cursor;var r=mxLib.Util._setCursor("dragstart");b.style.cursor!=r&&(b.style.cursor=r);r=f;mxLib.on(r.container,"onmousemove",m);mxLib.on(r.container,"onmouseup",l);h=n.pixel;mxLib.Util.dispatchEvent(e,"ondragstart",{point:n.point,pixel:n.pixel})}mxLib.Util.stopAndPrevent(q)})};c.prototype.enableDragging=function(){this.options||(this.options={});this.options.enableDragging||(this.options.enableDragging={});this.options.enableDragging=!0};c.prototype.disableDragging=function(){this.options||(this.options={});this.options.enableDragging||(this.options.enableDragging={});this.options.enableDragging=!1};c.prototype.isDraggable=function(){return this.options&&this.options.enableDragging?!0:!1};c.prototype.getDragPoint=function(){return this.point};c.prototype.setDragPoint=function(b){this.point&&(this.point=b)}})();(function(){function c(a,b){var e=new Image;e.src=a;e.complete?b.call(e):e.onload=function(){b.call(e)}}window.MX_Icon_SHAPE_DROP_RED=1;window.MX_Icon_SHAPE_DROP_BLUE=2;window.MX_Icon_SHAPE_STAR_SMALL=3;window.MX_Icon_SHAPE_STAR_BIG=4;var b=mxLib.Icon=function(a,b,e){a&&("number"===typeof a&&(a==MX_Icon_SHAPE_DROP_RED?(a=scriptBaseDir+"mxImg/red-marker.png",b||(b=new mxLib.Size(10,13))):a==MX_Icon_SHAPE_DROP_BLUE?(a=scriptBaseDir+"mxImg/blue-marker.png",b||(b=new mxLib.Size(15,16))):a==MX_Icon_SHAPE_STAR_SMALL?(a=scriptBaseDir+"mxImg/star.png",b||(b=new mxLib.Size(16,16))):a==MX_Icon_SHAPE_STAR_BIG&&(a=scriptBaseDir+"mxImg/star_big.png",b||(b=new mxLib.Size(38,38)))),b&&(this.imageUrl=a,this.size=b,a={anchor:new mxLib.Size(Math.floor(b.width/2),Math.floor(b.height/2)),imageOffset:new mxLib.Size(0,0)},e=e||{},$.extend(a,e),this.anchor=a.anchor,this.imageOffset=a.imageOffset,this.infoWindowAnchor=e.infoWindowAnchor||this.anchor))};b.prototype.anchor=null;b.prototype.size=null;b.prototype.imageOffset=null;b.prototype.imageSize=null;b.prototype.imageUrl=null;b.prototype.infoWindowAnchor=null;b.prototype.setImageUrl=function(a){a&&(this.imageUrl=a,this._image=null)};b.prototype.draw=function(a,b,e){this.imageUrl&&(this._image?(e=a.getContext("2d"),e.save(),b instanceof mxLib.Pixel&&e.translate(b.x,b.y),e.drawImage(this._image,0,0,this.size.width,this.size.height),e.restore()):(this._image=b=new Image,b.src=this.imageUrl,e&&c(this.imageUrl,e)))};b.prototype.setSize=function(a){a&&(this.size=new mxLib.Size(a.width,a.height))};b.prototype.getSize=function(){return this.size};b.prototype.setAnchor=function(a){a&&(this.anchor=new mxLib.Size(a.width,a.height))};b.prototype.getAnchor=function(){return this.anchor};b.prototype.setImageOffset=function(a){a&&(this.imageOffset=new mxLib.Size(a.width,a.height))};b.prototype.setInfoWindowAnchor=function(a){a&&(this.infoWindowAnchor=new mxLib.Size(a.width,a.height))};b.prototype.toString=function(){return"Icon"}})();(function(){var c=mxLib.Label=function(b,a){mxLib.Overlay.prototype.constructor.call(this);this.content=b;this.Size=this.map=null;a=a||{};this.options={width:0,offset:a.offset||new mxLib.Size(0,0),style:{backgroundColor:"#fff",border:"1px solid #f00",padding:"1px",whiteSpace:"nowrap",font:"12px \u5b8b\u4f53,Tahoma,Arial,Helvetica,sans-serif;",zIndex:"80"},position:a.position||null,enableMassClear:!1===a.enableMassClear?!1:!0,enableClicking:!0,minZoom:a.minZoom||0,maxZoom:a.maxZoom||0};0>this.options.width&&(this.options.width=0);"undefined"!=typeof a.enableClicking&&(this.options.enableClicking=a.enableClicking);this.point=this.options.position};mxLib.Lang.inherits(c,mxLib.Overlay);c.prototype.initialize=function(b){this.map=b;var a=mxLib.dom.create("label",{"class":"MxLabel",onselectstart:"return false;"}),c=this.options,e=this.content;c.title&&(a.title=c.title);var h=a.style;h.position="absolute";0==c.width||"auto"==c.width?h.display="inline":(h.width=c.width+"px",h.display="block",h.overflow="hidden");!0==c.enableClicking&&(h.cursor="pointer");a.innerHTML=e;this._bOverlayInternal||b.getPanes().labelPane.appendChild(a);this.domElement=a;this.setStyle(c.style);mxLib.Overlay.prototype.setEventDispath.call(this);return a};c.prototype.getEventPane=function(){return this._map.getPanes().labelPane};c.prototype.draw=function(){mxLib.Overlay.prototype.draw.call(this);if(this.domElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)){var b=this.options.offset,a=this.map.pointToPixel(this.point);this.domElement.style.left=a.x+b.width+"px";this.domElement.style.top=a.y+b.height+"px"}};c.prototype.remove=function(){mxLib.Overlay.prototype.remove.call(this)};c.prototype.setStyle=function(b){$.extend(this.options.style,b);this.domElement&&mxLib.dom.setStyles(this.domElement,this.options.style)};c.prototype.setContent=function(b){this.content=b;this.domElement&&(this.domElement.innerHTML=b)};c.prototype.setPosition=function(b){this.point=b;this.draw()};c.prototype.getPosition=function(){return this.point};c.prototype.setOffset=function(b){this.this.options.offset=offest;this.draw()};c.prototype.getOffset=function(){return this.this.options.offset};c.prototype.setTitle=function(b){this.this.options.title=b};c.prototype.getTitle=function(){return this.this.options.title};c.prototype.setTop=function(b){this._bZIndexTop=b;this._updateZIndex()};c.prototype._updateZIndex=function(){if(this.domElement){var b=this.zIndex=this.domElement.style.zIndex;this._bSetZIndex||(b=mxLib.Overlay.getZIndex(this.point.y),this._bZIndexTop&&(b+=Math.abs(b)+1E5));b!=this.zIndex&&(this.domElement.style.zIndex=b)}};c.prototype.enableMassClear=function(){this.options.enableMassClear=!0};c.prototype.disableMassClear=function(){this.options.enableMassClear=!1};c.prototype.setZIndex=function(b){this.options.style.zIndex=b};c.prototype.getMap=function(){return this.map};c.prototype.addContextMenu=function(b){};c.prototype.removeContextMenu=function(b){};c.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};c.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)}})();(function(){window.MX_Symbol_SHAPE_CIRCLE=1;window.MX_Symbol_SHAPE_RECTANGLE=2;window.MX_Symbol_SHAPE_RHOMBUS=3;window.MX_Symbol_SHAPE_STAR=4;window.MX_Symbol_SHAPE_BACKWARD_CLOSED_ARROW=5;window.MX_Symbol_SHAPE_FORWARD_CLOSED_ARROW=6;window.MX_Symbol_SHAPE_BACKWARD_OPEN_ARROW=7;window.MX_Symbol_SHAPE_FORWARD_OPEN_ARROW=8;window.MX_Symbol_SHAPE_POINT=9;window.MX_Symbol_SHAPE_PLANE=10;window.MX_Symbol_SHAPE_CAMERA=11;window.MX_Symbol_SHAPE_WARNING=12;window.MX_Symbol_SHAPE_SMILE=13;window.MX_Symbol_SHAPE_CLOCK=14;var c={14:"m-0.00573,-10c-5.51975,0 -9.99427,4.47453 -9.99427,9.99428c0,5.51974 4.47452,9.99425 9.99427,9.99425c5.51972,0 9.99426,-4.47452 9.99426,-9.99425c0,-5.51975 -4.47453,-9.99428 -9.99426,-9.99428zm0,17.92491c-4.37412,0 -7.93132,-3.55788 -7.93132,-7.93063c0,-4.37345 3.5572,-7.93134 7.93132,-7.93134c4.37411,0 7.93062,3.55721 7.93062,7.93134c0,4.37412 -3.55789,7.93063 -7.93062,7.93063zm-0.00068,-15.4088c-0.38027,0 -0.68696,0.30807 -0.68696,0.68765l0,6.34078l-4.15752,1.81815c-0.34794,0.15266 -0.50611,0.55837 -0.35344,0.90632c0.11278,0.25787 0.36445,0.4119 0.6292,0.4119c0.09214,0 0.18635,-0.01857 0.27575,-0.05845l4.55635,-1.99279c0.00344,-0.00137 0.00619,-0.00275 0.00894,-0.00412l0.00275,-0.00138c0.01032,-0.00413 0.01581,-0.01376 0.02545,-0.01719c0.07151,-0.03576 0.13821,-0.07771 0.19185,-0.1341c0.02337,-0.02338 0.03644,-0.05364 0.05431,-0.08045c0.03301,-0.04401 0.06946,-0.08733 0.0894,-0.14028c0.0165,-0.04126 0.01787,-0.08596 0.02613,-0.12997c0.00894,-0.04469 0.02614,-0.08389 0.02614,-0.1286l0,-6.7905c0,-0.37889 -0.30807,-0.68697 -0.68833,-0.68697z",13:"m-0.00706,-9.5c-5.24281,0 -9.49294,4.25065 -9.49294,9.49294c0,5.24331 4.25014,9.49294 9.49294,9.49294c5.24281,0 9.49294,-4.24964 9.49294,-9.49294c0,-5.2423 -4.25013,-9.49294 -9.49294,-9.49294zm3.08857,3.85997c0.61044,0 1.10279,0.96873 1.10279,2.16271s-0.49384,2.1647 -1.10279,2.1647c-0.60844,0 -1.10228,-0.96873 -1.10228,-2.16372s0.49434,-2.16369 1.10228,-2.16369zm-6.28628,0c0.60844,0 1.10228,0.96873 1.10228,2.16271s-0.49284,2.1647 -1.10228,2.1647s-1.10277,-0.96873 -1.10277,-2.16372s0.49383,-2.16369 1.10277,-2.16369zm3.21167,12.16493c-1.87667,0 -3.63373,-1.14814 -5.14663,-3.14239c1.56571,1.02156 3.27993,1.59064 5.07786,1.59064c1.90905,0 3.72343,-0.63985 5.36539,-1.78497c-1.54429,2.11685 -3.35767,3.33672 -5.29662,3.33672l-0.00001,0z",12:"m9.27295,5.92958l-2.64443,-4.57961c-0.79727,-1.37992 -2.10131,-3.63983 -2.8986,-5.01973l-2.64441,-4.57858c-0.79782,-1.38093 -2.10186,-1.38093 -2.89913,0l-2.64335,4.57858c-0.79728,1.3799 -2.10188,3.63981 -2.89916,5.01973l-2.64387,4.57961c-0.79728,1.38101 -0.14472,2.50988 1.44983,2.50988l16.37221,0c1.59561,0 2.24711,-1.12887 1.45091,-2.50988l0,0zm-8.88166,0.70811l-1.56837,0l0,-1.50484l1.56837,0l0,1.50484zm-0.07527,-2.61447l-1.41621,0l-0.14044,-6.44231l1.68427,0l-0.12761,6.44231l0,0z",11:"m8.08295,-6.56414l-3.59319,0l0,-1.43586l-8.98155,0l0,1.43586l-3.59321,0c-1.0569,0 -1.915,0.85509 -1.915,1.91159l0,9.92258c0,1.05357 0.8581,1.91158 1.915,1.91158l16.16796,0c1.05692,0 1.91501,-0.85801 1.91501,-1.91158l0,-9.92258c0,-1.0565 -0.85809,-1.91159 -1.91501,-1.91159l0,0zm-8.08397,12.66884c-3.20143,0 -5.80643,-2.60031 -5.80643,-5.79596c0,-3.19569 2.605,-5.79891 5.80643,-5.79891s5.80789,2.60322 5.80789,5.79891c0,3.19565 -2.60794,5.79596 -5.80789,5.79596zm0,-9.6804c-2.15036,0 -3.89142,1.7394 -3.89142,3.88444c0,2.14503 1.74252,3.8844 3.89142,3.8844c2.1489,0 3.89141,-1.73937 3.89141,-3.8844c0,-2.14503 -1.74105,-3.88444 -3.89141,-3.88444z",10:"m0,-10c-0.20885,0 -0.39491,0.08583 -0.55177,0.24149c-0.15674,0.15536 -0.28646,0.37838 -0.39429,0.65665c-0.21586,0.55655 -0.34853,1.33844 -0.42114,2.27477c-0.07231,0.93446 -0.08474,2.02273 -0.05447,3.18765c-2.58175,1.05925 -7.81787,3.24648 -8.23854,3.73474c-0.56001,0.65029 -0.37908,1.3954 -0.15331,1.89002l8.608,-1.75235c0.18202,2.28374 0.4407,4.5455 0.66615,6.31771c-0.8418,0.24646 -2.41323,0.73303 -2.73754,1.03474c-0.4469,0.41562 -0.4469,1.75793 -0.4469,1.75793l3.52318,-0.28665c0.08286,0.57874 0.13486,0.9163 0.13486,0.9163l0.00511,0.03042l0.02778,0l0.06486,0l0.02778,0l0.00511,-0.03042c0,0 0.05185,-0.33756 0.13486,-0.9163l3.52424,0.28665c0,0 0,-1.34231 -0.44688,-1.75793c-0.32446,-0.30172 -1.89697,-0.7895 -2.73847,-1.0358c0.22484,-1.76681 0.4832,-4.02001 0.66507,-6.29634l8.50712,1.73203c0.22561,-0.49462 0.40765,-1.23973 -0.15237,-1.89002c-0.41538,-0.48221 -5.52504,-2.62071 -8.1386,-3.69423c0.03119,-1.17999 0.01971,-2.28285 -0.05353,-3.22816l0,-0.00233c-0.07263,-0.93523 -0.20545,-1.71635 -0.42114,-2.27244c-0.10784,-0.27827 -0.23634,-0.50114 -0.3932,-0.65665c-0.15689,-0.15567 -0.34293,-0.24149 -0.55195,-0.24149l0,0l0,0l0,0l0.00001,0l0,0l-0.00003,0.00001z",3:"m-10,0l10,-10l10,10l-10,10l-10,-10z",5:"M0,0 L-5,-15 0,-10 5,-15 z",6:"M0,0 L5,15 0,10 -5,15z",7:"M-5,-15 L0,0 5,-15",8:"M-5,15 L0,0 5,15",9:"m0,-24c-4.4183,0 -8,3.58167 -8,8c0,1.42102 0.3816,2.75 1.0312,3.90601c0.1079,0.19202 0.221,0.38098 0.3438,0.56299l6.625,11.53101l6.625,-11.53101c0.102,-0.151 0.19,-0.31097 0.281,-0.46899l0.063,-0.09399c0.649,-1.15601 1.031,-2.48499 1.031,-3.90601c0,-4.41833 -3.582,-8 -8,-8zm0,4c2.209,0 4,1.79089 4,4c0,2.20898 -1.791,4 -4,4c-2.2091,0 -4,-1.79102 -4,-4c0,-2.20911 1.7909,-4 4,-4z"},b=mxLib.Symbol=function(a,b){a&&(b=b||{},this.style={},this.style.anchor=b.anchor||new mxLib.Size(0,0),this.style.anchor=b.anchor||new mxLib.Size(0,0),this.style.fillColor=b.fillColor||"#000",this.style.fillOpacity=b.fillOpacity||1,this.style.scale=b.scale||1,this.style.rotation=b.rotation||0,this.style.strokeColor=b.strokeColor||"#000",this.style.strokeOpacity=b.strokeOpacity||1,this.style.strokeWeight=b.strokeWeight,this.style.svgMarkerOrient=b.svgMarkerOrient||"auto",this.style.svgMarkerX=b.svgMarkerX||0,this.style.svgMarkerY=b.svgMarkerY||0,this.style.svgMarkerWidth=b.svgMarkerWidth||0,this.style.svgMarkerHeight=b.svgMarkerHeight||0,this.style.svgMarkerRefX=b.svgMarkerRefX||0,this.style.svgMarkerRefY=b.svgMarkerRefY||0,this.style.shapeRectWidth=b.shapeRectWidth||4,this.style.shapeRectHeight=b.shapeRectHeight||2,this.path="number"===typeof a?a:"UserDefined",this.anchor=this.style.anchor,this._anchor=new mxLib.Size(this.anchor.width,this.anchor.height),this.transSize=new mxLib.Size(0,0),this.path=a,this.init())};b.prototype.init=function(){var a=this.path;c[a]&&(a=c[a]);this.svgPath=a;switch(a){case 1:var b=a=this.Pt(2),e=this.style.scale,h=this._anchor;this.size=new mxLib.Size(a,b);this.anchor=new mxLib.Size(a/2+h.width*e,b/2+h.height*e);this.path=1;this.style.svgMarkerWidth||(this.style.svgMarkerWidth=this.size.width);this.style.svgMarkerHeight||(this.style.svgMarkerHeight=this.size.height);this.style.svgMarkerRefX||(this.style.svgMarkerRefX=this.size.width/2+this.style.svgMarkerX);this.style.svgMarkerRefY||(this.style.svgMarkerRefY=this.size.height/2+this.style.svgMarkerY);break;case 2:var a=this.Pt(this.style.shapeRectWidth),b=this.Pt(this.style.shapeRectHeight),h=this._anchor,g=this.style.strokeWeight?this.style.strokeWeight:this.style.scale,e=this.style.scale;this.size=new mxLib.Size(a,b);this.transSize=new mxLib.Size(Math.floor(-g/2),Math.floor(-g/2));this.anchor=new mxLib.Size(a/2+h.width*e,b/2+h.height*e);this.path=2;this.style.svgMarkerWidth||(this.style.svgMarkerWidth=this.size.width);this.style.svgMarkerHeight||(this.style.svgMarkerHeight=this.size.height);this.style.svgMarkerRefX||(this.style.svgMarkerRefX=this.size.width/2+this.style.svgMarkerX);this.style.svgMarkerRefY||(this.style.svgMarkerRefY=this.size.height/2+this.style.svgMarkerY);break;case 4:b=a=this.Pt(20);h=this._anchor;e=this.style.scale;this.size=new mxLib.Size(a,b);this.anchor=new mxLib.Size(a/2+h.width*e,b/2+h.height*e);this.path=4;break;default:var a=new CanvablePath(a),f=a.bounds(),b=this.style.rotation*Math.PI/180,g=this.style.strokeWeight?this.style.strokeWeight:this.style.scale,e=this.style.scale,h=this._anchor,l=new mxLib.Size(Math.floor(f.x1*e-g/2),Math.floor(f.y1*e-g/2)),e={CM:new mxLib.Pixel(Math.floor(f.x1*e-g/2)-e*h.width,Math.floor(f.y1*e-g/2)-e*h.height),TZ:new mxLib.Pixel(Math.floor(f.x1*e-g/2)-e*h.width,Math.ceil(f.y2*e-g/2)-e*h.height),s1:new mxLib.Pixel(Math.ceil(f.x2*e+g/2)-e*h.width,Math.floor(f.y1*e-g/2)-e*h.height),UZ:new mxLib.Pixel(Math.ceil(f.x2*e+g/2)-e*h.width,Math.ceil(f.y2*e+g/2)-e*h.height)},h={},g=[],m=[],q;for(q in e){var n=Math.cos(b)*e[q].x-Math.sin(b)*e[q].y,r=Math.sin(b)*e[q].x+Math.cos(b)*e[q].y;h[q]=new mxLib.Pixel(n,r);g.push(n);m.push(r)}xmax=Math.max.apply(Math,g);ymax=Math.max.apply(Math,m);xmin=Math.min.apply(Math,g);ymin=Math.min.apply(Math,m);this.size=new mxLib.Size(Math.ceil(xmax-xmin),Math.ceil(ymax-ymin));this.anchor=new mxLib.Size(-xmin,-ymin);this.transSize=new mxLib.Size(xmin-h.CM.x,ymin-h.CM.y);this.translatePos=new mxLib.Pixel(l.width,l.height);this.rotation=b;this.path=a;this.style.svgMarkerX||(this.style.svgMarkerX=Math.min(f.x1,f.x2));this.style.svgMarkerY||(this.style.svgMarkerY=Math.min(f.y1,f.y2));this.style.svgMarkerWidth||(this.style.svgMarkerWidth=Math.abs(f.x1-f.x2));this.style.svgMarkerHeight||(this.style.svgMarkerHeight=Math.abs(f.y1-f.y2));this.style.svgMarkerRefX||(this.style.svgMarkerRefX=f.width/2+this.style.svgMarkerX);this.style.svgMarkerRefY||(this.style.svgMarkerRefY=f.height)}this.infoWindowAnchor=new mxLib.Size(this.size.width/2,0)};b.prototype.getSize=function(a){return this.size};b.prototype.Pt=function(a){return this.style.strokeWeight?a*this.style.scale+this.style.strokeWeight%3+this.style.strokeWeight:a*this.style.scale+this.style.scale+this.style.scale%2};b.prototype.draw=function(a,b){var e=this.style.scale;size=this.size;this.canvas=a;a=this.canvas2d=a.getContext("2d");a.save();a.fillStyle=mxLib.Util.color.mB(this.style.fillColor,this.style.fillOpacity);a.strokeStyle=mxLib.Util.color.mB(this.style.strokeColor,this.style.strokeOpacity);a.lineCap="round";a.lineJoin="round";a.lineWidth=this.style.strokeWeight||e;b instanceof mxLib.Pixel&&a.translate(b.x,b.y);this.size&&a.translate(-this.transSize.width,-this.transSize.height);this.rotation&&a.rotate(this.rotation);this.translatePos&&a.translate(-this.translatePos.x,-this.translatePos.y);switch(this.path){case 1:a.arc(size.width/2,size.height/2,e,0,2*Math.PI);break;case 2:a.rect(0,0,this.style.shapeRectWidth*e,this.style.shapeRectHeight*e);break;case 4:a.beginPath();for(var c=size.width/2,e=10*e,g=2*Math.PI/10,f=11;0!=f;f--){var l=e*(f%2+1)/2,m=g*f;a.lineTo(l*Math.sin(m)+c,l*Math.cos(m)+c)}a.closePath();break;default:a.lineWidth/=e,a.scale(e,e),this.path.draw(a)}a.fill();a.stroke();a.restore()};b.prototype.getSvgMarker=function(a,b){if(!a)return null;if(this.svgMarker)return this.svgMarker;var e=null,c=this.style.scale;size=this.size;switch(this.path){case 1:e=a.paper.circle(size.width/2,size.height/2,c);break;case 2:e=a.paper.rect(0,0,4*c,2*c);break;case 4:break;default:e=a.paper.path(this.svgPath)}e.attr({fill:this.style.fillColor,"fill-opacity":this.style.fillOpacity,stroke:this.style.strokeColor,strokeWidth:this.style.strokeWeight,"stroke-opacity":this.style.strokeOpacity});if(b)for(var g in b)e.attr(g,b[g]);this.style.rotation&&(e.transform((new Snap.Matrix).rotate(this.style.rotation)),c=e.getBBox(),this.style.svgMarkerX=c.x,this.style.svgMarkerY=Math.min(c.y,c.y2),this.style.svgMarkerWidth=c.width,this.style.svgMarkerHeight=c.height);this.svgMarker=e.marker(this.style.svgMarkerX,this.style.svgMarkerY,this.style.svgMarkerWidth,this.style.svgMarkerHeight,this.style.svgMarkerRefX,this.style.svgMarkerRefY);1!=this.style.scale&&this.svgMarker.attr({markerWidth:this.style.svgMarkerWidth*this.style.scale,markerHeight:this.style.svgMarkerHeight*this.style.scale});"auto"!=this.style.svgMarkerOrient&&this.svgMarker.attr({orient:this.style.svgMarkerOrient});return this.svgMarker};b.prototype.setPath=function(a){this.path=a;this.init()};b.prototype.setAnchor=function(a){this.anchor=this.style.anchor=a;this._anchor=new mxLib.Size(this.anchor.width,this.anchor.height);this.init()};b.prototype.getAnchor=function(){return this.style.anchor};b.prototype.setRotation=function(a){this.style.rotation=a;this.init()};b.prototype.setScale=function(a){this.style.scale=a;this.init()};b.prototype.setStrokeWeight=function(a){this.style.strokeWeight=a;this.init()};b.prototype.setStrokeColor=function(a){this.style.strokeColor=a;this.init()};b.prototype.setStrokeOpacity=function(a){this.style.strokeOpacity=a;this.init()};b.prototype.setFillOpacity=function(a){this.style.fillOpacity=a;this.init()};b.prototype.setFillColor=function(a){this.style.fillColor=a;this.init()};b.prototype.toString=function(){return"Symbol"}})();(function(){function c(a){var b="",b=a.imageOffset,c=a.imageSize,b=['\x3cimg src\x3d"',a.imageUrl,'" style\x3d"display: block; border:none;margin-left:'+b.width+"px","; margin-top:"+b.height+"px","; "];c&&b.push("; width:"+c.width+"px; height:"+c.height+"px;");b.push('" /\x3e');return b.join("")}var b=new mxLib.Icon(scriptBaseDir+"mxImg/marker_red_sprite.png",new mxLib.Size(19,25),{anchor:new mxLib.Size(10,25),infoWindowAnchor:new mxLib.Size(10,0)}),a=mxLib.Marker=function(a,e){mxLib.Overlay.prototype.constructor.call(this);e=e||{};this.point=a;this.map=null;this.options={offset:e.offset||new mxLib.Size(0,0),icon:e.icon||b,shadow:e.shadow||null,title:e.title||"",label:null,baseZIndex:e.baseZIndex||0,top:!1,enableMassClear:!1===e.enableMassClear?!1:!0,enableDragging:!0===e.enableDragging?!0:!1,enableClicking:!1===e.enableClicking?!1:!0,draggingCursor:e.draggingCursor||"-moz-grabbing",rotation:e.rotation||0,shadowAniamte:!1===e.shadowAniamte?!1:!0,minZoom:e.minZoom||0,maxZoom:e.maxZoom||0};e.icon&&!e.shadow&&(this.options.shadow=null)};mxLib.Lang.inherits(a,mxLib.Overlay);a.prototype.initialize=function(a){this.map=a;this._appendContent();this.setPosition(this.point);this.setIcon(this.options.icon);this.setShadow(this.options.shadow);this.setRotation(this.options.rotation);this.setLabel(this.options.label);this.setTitle(this.options.title);this._setEventDispath();return this._mouseTargetElement};a.prototype.getEventPane=function(){return this.map.getPanes().markerMouseTarget};a.prototype._appendContent=function(){this._mouseTargetElement=$(this._createMouseTargetElement())[0];this.map.getPanes().markerMouseTarget.appendChild(this._mouseTargetElement);this._markerPaneElement=$(this._createMarkerPaneElement())[0];this.map.getPanes().markerPane.appendChild(this._markerPaneElement)};a.prototype._setEventDispath=function(){function a(c){c=window.event||c;c=new mxLib.Pixel(c.pageX||c.clientX||0,c.pageY||c.clientY||0);var k=b.map.pixelToPoint(c);return{pixel:c,point:k}}var b=this,c=b._mouseTargetElement,g=!1,f=null;mxLib.on(c,"onclick",function(a){mxLib.Util.dispatchEvent(b,"onclick");mxLib.Util.stopAndPrevent(a)});mxLib.on(c,"ontouchend",function(a){mxLib.Util.dispatchEvent(b,"ontouchend");mxLib.Util.dispatchEvent(b,"onclick");mxLib.Util.stopAndPrevent(a)});mxLib.on(c,"ondblclick",function(c){var g=a(c);mxLib.Util.dispatchEvent(b,"ondblclick",{point:g.point,pixel:g.pixel});mxLib.Util.stopAndPrevent(c)});c.onmouseover=function(c){var g=a(c);mxLib.Util.dispatchEvent(b,"onmouseover",{point:g.point,pixel:g.pixel});mxLib.Util.stopAndPrevent(c)};c.onmouseout=function(c){var g=a(c);mxLib.Util.dispatchEvent(b,"onmouseout",{point:g.point,pixel:g.pixel});mxLib.Util.stopAndPrevent(c)};var l=function(q){var n=a(q);mxLib.Util.dispatchEvent(b,"onmouseup",{point:n.point,pixel:n.pixel});b._mouseTargetElement&&b._mouseTargetElement.releaseCapture?(mxLib.un(c,"onmousemove",m),mxLib.un(c,"onmouseup",l)):(mxLib.un(b.map.container,"onmousemove",m),mxLib.un(b.map.container,"onmouseup",l));b.options.enableDragging&&0==q.button&&(b._mouseTargetElement&&b._mouseTargetElement.releaseCapture&&b._mouseTargetElement.releaseCapture(),mxLib.Util.dispatchEvent(b,"ondragend",{point:n.point,pixel:n.pixel}),g=!1,f=null,b._mouseTargetElement&&(n=mxLib.Util._setCursor("dragend"),b._mouseTargetElement.style.cursor!=n&&(b._mouseTargetElement.style.cursor=n),b._mouseTargetElement.style.MozUserSelect="",b._mouseTargetElement.style.KhtmlUserSelect="",b._mouseTargetElement.style.WebkitUserSelect="",b._mouseTargetElement.unselectable="off",b._mouseTargetElement.onselectstart=function(){}));mxLib.Util.stopAndPrevent(q)},m=function(c){if(b.options.enableDragging&&g){var h=a(c),l=b.map.pointToPixel(b.point),m=h.pixel.x-f.x+l.x,l=h.pixel.y-f.y+l.y;f=h.pixel;b.point=b.map.pixelToPoint(new mxLib.Pixel(m,l));b.draw();m=mxLib.Util._setCursor("dragging");b._mouseTargetElement.style.cursor!=m&&(b._mouseTargetElement.style.cursor=m);mxLib.Util.dispatchEvent(b,"ondragging",{point:h.point,pixel:h.pixel});mxLib.Util.stopAndPrevent(c)}};mxLib.on(c,"onmousedown",function(q){var n=a(q);mxLib.Util.dispatchEvent(b,"onmousedown",{point:n.point,pixel:n.pixel});b._mouseTargetElement&&b._mouseTargetElement.setCapture?(mxLib.on(c,"onmousemove",m),mxLib.on(c,"onmouseup",l)):(mxLib.on(b.map.container,"onmousemove",m),mxLib.on(b.map.container,"onmouseup",l));b.options.enableDragging&&0==q.button&&(f=n.pixel,mxLib.Util.dispatchEvent(b,"ondragstart",{point:n.point,pixel:n.pixel}),g=!0,b._mouseTargetElement&&(n=mxLib.Util._setCursor("dragstart"),b._mouseTargetElement.style.cursor!=n&&(b._mouseTargetElement.style.cursor=n),b._mouseTargetElement.setCapture&&b._mouseTargetElement.setCapture(),b._mouseTargetElement.style.MozUserSelect="none",b._mouseTargetElement.style.KhtmlUserSelect="none",b._mouseTargetElement.style.WebkitUserSelect="none",b._mouseTargetElement.unselectable="on",b._mouseTargetElement.onselectstart=function(){return!1}));mxLib.Util.stopAndPrevent(q)})};a.prototype._createMouseTargetElement=function(){var a=['\x3cspan class\x3d"MX_Marker MX_noprint" unselectable\x3d"on" '];this.options.title&&a.push('title\x3d"'+this.options.title+'"');a.push(' style\x3d"position:absolute;padding:0;margin:0;border:0;width:0;height:0;-moz-user-select:none;');a.push(this.options.enableClicking?"cursor:pointer;":"");a.push("background:url("+scriptBaseDir+"mxImg/blank.gif) repeat scroll 0% 0% transparent;");a.push("width:"+this.options.icon.size.width+"px;");a.push("height:"+this.options.icon.size.height+"px;");a.push('"\x3e\x3c/span\x3e');return a.join("")};a.prototype._createMarkerPaneElement=function(){var a=['\x3cspan class\x3d"MX_Marker" unselectable\x3d"on" '];a.push('style\x3d"position:absolute;padding:0;margin:0;border:0;');a.push('width:0;height:0;-moz-user-select:none"\x3e\x3c/span\x3e');return a.join("")};a.prototype._createMarkerShadowElement=function(){var a=['\x3cspan class\x3d"MX_MarkerShadow"  unselectable\x3d"on" '];a.push('style\x3d"position:absolute;padding:0;margin:0;border:0;');a.push('width:0;height:0;-moz-user-select:none"\x3e\x3c/span\x3e');return a.join("")};a.prototype._iconPixelPos=function(){var a=this.options.offset||new Size(0,0),b=this.options.icon.anchor||new Size(0,0),c=this.map.pointToPixel(this.getPosition()),b=[new mxLib.Pixel(c.x+a.width-b.width,c.y+a.height-b.height)];if(this.options.shadow){var g=this.options.shadow.anchor||new Size(0,0);b[1]=new mxLib.Pixel(c.x+a.width-g.width,c.y+a.height-g.height)}else b[1]=new mxLib.Pixel(c.x+a.width-4,c.y+a.height);return b};a.prototype.draw=function(){if(this._mouseTargetElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)){var a=this._iconPixelPos();this._mouseTargetElement.style.left=a[0].x+"px";this._mouseTargetElement.style.top=a[0].y+"px";this._markerPaneElement&&(this._markerPaneElement.style.left=a[0].x+"px",this._markerPaneElement.style.top=a[0].y+"px");this._markerShadowElement&&(this._markerShadowElement.style.left=a[1].x+"px",this._markerShadowElement.style.top=a[1].y+"px");this._updateZIndex()}};a.prototype.remove=function(){this.setAnimation(null);this._markerPaneElement&&this._markerPaneElement.parentNode&&this._markerPaneElement.parentNode.removeChild(this._markerPaneElement);this._markerShadowElement&&this._markerShadowElement.parentNode&&this._markerShadowElement.parentNode.removeChild(this._markerShadowElement);this._mouseTargetElement&&this._mouseTargetElement.parentNode&&this._mouseTargetElement.parentNode.removeChild(this._mouseTargetElement);this._markerPaneElement=this._markerShadowElement=this._mouseTargetElement=null;this.options.label&&(this._labelRemoveListerner&&this.options.label.removeEventListener("remove",this._labelRemoveListerner),this.options.label=null);mxLib.Overlay.prototype.remove.call(this)};a.prototype.openInfoWindow=function(a){this.map&&(this.map.closeInfoWindow(),this.map.temp._infoWin=a,a.overlay=this,mxLib.lang.Class.call(a,a.guid),a.open(this))};a.prototype.closeInfoWindow=function(){this.map&&this.map.temp._infoWin&&(this.map.temp._infoWin._visible=!1,mxLib.lang.decontrol(this.map.temp._infoWin.guid),this.map.temp._infoWin=null)};a.prototype.setIcon=function(a){if((this.options.icon=a)&&this.map&&this._mouseTargetElement&&this._markerPaneElement){try{this._markerDiv&&(this._markerPaneElement.removeChild(this._markerDiv),this._markerDiv=null),this._markerPaneElement.style.width=a.size.width+"px",this._markerPaneElement.style.height=a.size.height+"px"}catch(b){}if(this.options.icon){var h=this._markerDiv=document.createElement(a instanceof mxLib.Icon?"div":"canvas"),g=h.style;g.position="absolute";g.padding=g.margin="0";g.width=a.size.width+"px";g.height=a.size.height+"px";g.overflow="hidden";a instanceof mxLib.Symbol?(h.width=a.size.width,h.height=a.size.height,a.draw(h)):h.innerHTML=c(a);this._markerPaneElement.appendChild(this._markerDiv)}this.draw()}};a.prototype.getIcon=function(){return this.options.icon};a.prototype.setShadow=function(a){if(a instanceof mxLib.Icon&&(this.options.shadow=a,this.map&&this._mouseTargetElement&&this._markerPaneElement)){this._markerShadowElement||(this._markerShadowElement=$(this._createMarkerShadowElement())[0],this.map.getPanes().markerShadow.appendChild(this._markerShadowElement));try{this._shadowDiv&&(this._markerShadowElement.removeChild(this._shadowDiv),this._shadowDiv=null),this._markerShadowElement.style.width=a.size.width+"px",this._markerShadowElement.style.height=a.size.height+"px"}catch(b){}if(this.options.shadow){var h=this._shadowDiv=document.createElement("div"),g=h.style;g.position="absolute";g.padding=g.margin="0";g.width=a.size.width+"px";g.height=a.size.height+"px";g.overflow="hidden";h.innerHTML=c(a);this._markerShadowElement.appendChild(this._shadowDiv)}this.draw()}};a.prototype.getShadow=function(){return this.options.shadow};a.prototype.setPosition=function(a){a instanceof mxLib.Point&&(this.point=this.options.point=new mxLib.Point(a.x,a.y),this.draw())};a.prototype.getPosition=function(){return this.point};a.prototype.setOffset=function(a){a instanceof mxLib.Size&&(this.options.offset=a,this.draw())};a.prototype.getOffset=function(){return this.options.offset};a.prototype.getLabel=function(){return this.options.label};a.prototype.setLabel=function(a){if(a&&a instanceof mxLib.Label){this.options.label=a;var b=this;this.options.label._bRemoveListerner||(this.options.label._bRemoveListerner=!0,this._labelRemoveListerner=function(){b.options.label=null},this.options.label.addEventListener("remove",this._labelRemoveListerner));a.point=this.map.pixelToPoint(new mxLib.Pixel(0,0));if(this.map){a.domElement||(a._bOverlayInternal=!0,a._initAddOverlay(this.map));this._markerPaneElement.appendChild(a.domElement);a._marker=this;var c=a.domElement.style;c.left=a.options.offset.width+"px";c.top=a.options.offset.height+"px";a.draw()}}};a.prototype.setTitle=function(a){this.options.title=a;this.options.label&&(this.options.label.title=a)};a.prototype.getTitle=function(){return this.options.title};a.prototype.setTop=function(a){this._bZIndexTop=a;this._updateZIndex()};a.prototype.enableDragging=function(){this.options.enableDragging=!0};a.prototype.disableDragging=function(){this.options.enableDragging=!1};a.prototype.enableMassClear=function(){this.options.enableMassClear=!0};a.prototype.disableMassClear=function(){this.options.enableMassClear=!1};a.prototype._updateZIndex=function(){if(this._mouseTargetElement){var a=this.zIndex=this._mouseTargetElement.style.zIndex;this._bSetZIndex||(a=mxLib.Overlay.getZIndex(this.point.y),this._bZIndexTop&&(a+=Math.abs(a)+1E5));a!=this.zIndex&&(this._mouseTargetElement.style.zIndex=a,this._markerPaneElement.style.zIndex=a)}};a.prototype.setZIndex=function(a){this._bSetZIndex=!0;this._mouseTargetElement.style.zIndex=a;this._markerPaneElement.style.zIndex=a};a.prototype.getMap=function(){return this.map};a.prototype.setAnimation=function(a,b){if(a==MX_ANIMATION_BOUNCE){if(this._markerPaneElement&&$(this._markerPaneElement).addClass("markerball"),this.options.shadowAniamte&&!this._shadowDiv&&(this._markerShadowElement||(this._markerShadowElement=$(this._createMarkerShadowElement())[0],this.map.getPanes().markerShadow.appendChild(this._markerShadowElement),this.draw()),$(this._markerShadowElement).addClass("markerShadow")),b&&0<b){var c=this;setTimeout(function(){$(c._markerPaneElement).removeClass("markerball");c.options.shadowAniamte&&!c._shadowDiv&&$(c._markerShadowElement).removeClass("markerShadow")},b)}}else if(a==MX_ANIMATION_DROP){if(this._markerPaneElement){var g=$(this._markerPaneElement).offset().top;this._markerPaneElement.style.top="0px";$(this._markerPaneElement).animate({top:g+"px"},500);$(this._markerPaneElement).animate({top:g-30+"px"},200);$(this._markerPaneElement).animate({top:g+"px"},100);$(this._markerPaneElement).animate({top:g-15+"px"},200);$(this._markerPaneElement).animate({top:g+"px"},100);$(this._markerPaneElement).animate({top:g-5+"px"},100);$(this._markerPaneElement).animate({top:g+"px"},50);this._markerPaneElement.style.top=g+"px"}}else a==MX_ANIMATION_FLASH?($(this._markerPaneElement).addClass("markerflash"),b&&0<b&&(c=this,setTimeout(function(){$(c._markerPaneElement).removeClass("markerflash")},b))):a||(this._markerPaneElement&&$(this._markerPaneElement).removeClass("markerball"),this._markerShadowElement&&$(this._markerShadowElement).addClass("markerShadow"))};a.prototype.setRotation=function(a){if(a&&(this.options.rotation=a,this.map&&this._mouseTargetElement&&this._markerPaneElement))try{if(this._markerDiv){var b=this._markerDiv.style;b.webkitTransform="rotate("+this.options.rotation+"deg)";b.transform="rotate("+this.options.rotation+"deg)"}this._shadowDiv&&(b=this._markerPaneElement.style,b.webkitTransform="rotate("+this.options.rotation+"deg)",b.transform="rotate("+this.options.rotation+"deg)")}catch(c){}};a.prototype.getRotation=function(){return this.options.rotation};a.prototype.show=function(){mxLib.Overlay.prototype.show.call(this);this._mouseTargetElement&&$(this._mouseTargetElement).show();this._markerPaneElement&&$(this._markerPaneElement).show();this._markerShadowElement&&$(this._markerShadowElement).show();this.options.label&&this.options.label.domElement&&$(this.options.label.domElement).show()};a.prototype.hide=function(){mxLib.Overlay.prototype.hide.call(this);this._mouseTargetElement&&$(this._mouseTargetElement).hide();this._markerPaneElement&&$(this._markerPaneElement).hide();this._markerShadowElement&&$(this._markerShadowElement).hide();this.options.label&&this.options.label.domElement&&$(this.options.label.domElement).hide()};a.prototype.addEventListener=function(a,b){return mxLib.lang.Class.prototype.addEventListener.call(this,a,b)};a.prototype.removeEventListener=function(a,b){mxLib.lang.Class.prototype.removeEventListener.call(this,a,b)}})();(function(){var c=mxLib.RichMarker=function(b,a,c){b&&a&&a instanceof mxLib.Point&&(this._map=null,this._content=b,this._position=a,this._size=this._container=null,c=c||{},this._opts=mxLib.extend(mxLib.extend(this._opts||{},{enableDragging:!1,anchor:new mxLib.Size(0,0)}),c),this._opts.minZoom=this._opts.minZoom||0,this._opts.maxZoom=this._opts.maxZoom||0)};c.prototype=new mxLib.Overlay;c.prototype.initialize=function(b){var a=this._container=document.createElement("div");this._map=b;mxLib.extend(a.style,{position:"absolute",zIndex:mxLib.Overlay.getZIndex(this._position.y),background:"#FFF",cursor:"pointer"});b.getPanes().labelPane.appendChild(a);this._appendContent();this.domElement=a;mxLib.Overlay.prototype.setEventDispath.call(this);this._getContainerSize();return a};c.prototype.getEventPane=function(){return this._map.getPanes().labelPane};c.prototype.draw=function(){if(this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)){var b=this._opts.anchor,a=this._map.pointToPixel(this._position);this._container.style.left=a.x+b.width+"px";this._container.style.top=a.y+b.height+"px"}};c.prototype.enableDragging=function(){this._opts.enableDragging=!0};c.prototype.disableDragging=function(){this._opts.enableDragging=!1};c.prototype.isDraggable=function(){return this._opts.enableDragging};c.prototype.getPosition=function(){return this._position};c.prototype.setPosition=function(b){!b instanceof mxLib.Point||(this._position=b,this.draw())};c.prototype.getAnchor=function(){return this._opts.anchor};c.prototype.setAnchor=function(b){!b instanceof mxLib.Size||(this._opts.anchor=b,this.draw())};c.prototype._appendContent=function(){var b=this._content;if("string"==typeof b){var a=document.createElement("DIV");a.innerHTML=b;if(1==a.childNodes.length)b=a.removeChild(a.firstChild);else for(b=document.createDocumentFragment();a.firstChild;)b.appendChild(a.firstChild)}this._container.innerHTML="";this._container.appendChild(b)};c.prototype.getContent=function(){return this._content};c.prototype.setContent=function(b){b&&(this._content=b,this._appendContent())};c.prototype._getContainerSize=function(){this._container&&(this._size=new mxLib.Size(this._container.offsetWidth,this._container.offsetHeight))};c.prototype.getWidth=function(){if(this._size)return this._size.width};c.prototype.setWidth=function(b){this._container&&(this._container.style.width=b+"px",this._getContainerSize())};c.prototype.getHeight=function(){if(this._size)return this._size.height};c.prototype.setHeight=function(b){this._container&&(this._container.style.height=b+"px",this._getContainerSize())};c.prototype.getDragPoint=function(){return this._position};c.prototype.setDragPoint=function(b){this._position=b};c.prototype.remove=function(){this._container&&mxLib.Util.purge(this._container);this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);mxLib.Overlay.prototype.remove.call(this)};c.prototype.enableMassClear=function(){this._opts.enableMassClear=!0};c.prototype.disableMassClear=function(){this._opts.enableMassClear=!1}})();(function(){var c=scriptBaseDir+"mxImg/m",b=mxLib.TextIconOverlay=function(a,b,c){this._position=a;this._text=b;this._options=c||{};this._options.minZoom=c.minZoom||0;this._options.maxZoom=c.maxZoom||0;this._styles=this._options.styles||[];!this._styles.length&&this._setupDefaultStyles()};mxLib.lang.inherits(b,mxLib.Overlay,"TextIconOverlay");b.prototype._setupDefaultStyles=function(){for(var a=[53,56,66,78,90],b=0,e;e=a[b];b++)this._styles.push({url:c+b+".png",size:new mxLib.Size(e,e)})};b.prototype.initialize=function(a){this._map=a;this._domElement=document.createElement("div");this._updateCss();this._updateText();this._updatePosition();this._bind();this._map.getPanes().markerMouseTarget.appendChild(this._domElement);return this._domElement};b.prototype.getEventPane=function(){return this._map.getPanes().markerMouseTarget};b.prototype.draw=function(){this.curZoomInRange(this._options.minZoom,this._options.maxZoom)&&this._map&&this._updatePosition()};b.prototype.getText=function(){return this._text};b.prototype.setText=function(a){!a||this._text&&this._text.toString()==a.toString()||(this._text=a,this._updateText(),this._updateCss(),this._updatePosition())};b.prototype.getPosition=function(){return this._position};b.prototype.setPosition=function(a){!a||this._position&&this._position.equals(a)||(this._position=a,this._updatePosition())};b.prototype.getStyleByText=function(a,b){var c=parseInt(a),c=parseInt(c/10),c=Math.max(0,c),c=Math.min(c,b.length-1);return b[c]};b.prototype._updateCss=function(){var a=this.getStyleByText(this._text,this._styles);this._domElement.style.cssText=this._buildCssText(a)};b.prototype._updateText=function(){this._domElement&&(this._domElement.innerHTML=this._text)};b.prototype._updatePosition=function(){if(this._domElement&&this._position){var a=this._domElement.style,b=this._map.pointToPixel(this._position);b.x-=Math.ceil(parseInt(a.width)/2);b.y-=Math.ceil(parseInt(a.height)/2);a.left=b.x+"px";a.top=b.y+"px"}};b.prototype._buildCssText=function(a){var b=a.url,c=a.size,h=a.anchor,g=a.offset,f=a.textColor||"black";a=a.textSize||10;var l=[];7>mxLib.browser.ie?l.push('filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod\x3dscale,src\x3d"'+b+'");'):(l.push("background-image:url("+b+");"),b="0 0",g instanceof mxLib.Size&&(b=g.width+"px "+g.height+"px"),l.push("background-position:"+b+";"));c instanceof mxLib.Size&&(h instanceof mxLib.Size?(0<h.height&&h.height<c.height&&l.push("height:"+(c.height-h.height)+"px; padding-top:"+h.height+"px;"),0<h.width&&h.width<c.width&&l.push("width:"+(c.width-h.width)+"px; padding-left:"+h.width+"px;")):(l.push("height:"+c.height+"px; line-height:"+c.height+"px;"),l.push("width:"+c.width+"px; text-align:center;")));l.push("cursor:pointer; color:"+f+"; position:absolute; font-size:"+a+"px; font-family:Arial,sans-serif; font-weight:bold");return l.join("")};b.prototype.enableMassClear=function(){this._options.enableMassClear=!0};b.prototype.disableMassClear=function(){this._options.enableMassClear=!1};b.prototype._bind=function(){function a(a,b){var h=a.srcElement||a.target,k=a.clientX||a.pageX,q=a.clientY||a.pageY;a&&b&&k&&q&&h&&(h=mxLib.dom.getPosition(c.getContainer()),b.pixel=new mxLib.Pixel(k-h.left,q-h.top),b.point=c.pixelToPoint(b.pixel));return b}if(this._domElement){var b=this,c=this._map,h=mxLib.lang.Event;mxLib.event.on(this._domElement,"mouseover",function(c){b.dispatchEvent(a(c,new h("onmouseover")))});mxLib.event.on(this._domElement,"mouseout",function(c){b.dispatchEvent(a(c,new h("onmouseout")))});mxLib.event.on(this._domElement,"click",function(c){b.dispatchEvent(a(c,new h("onclick")))})}}})();(function(c){var b=function(){var a=function(a){var b={data:[],heatmap:a};this.max=1;this.get=function(a){return b[a]};this.set=function(a,c){b[a]=c}};a.prototype={addDataPoint:function(a,b){if(!(0>a||0>b)){var c=this.get("heatmap"),e=this.get("data");e[a]||(e[a]=[]);e[a][b]||(e[a][b]=0);e[a][b]+=3>arguments.length?1:arguments[2];this.set("data",e);this.max<e[a][b]?(c.get("actx").clearRect(0,0,c.get("width"),c.get("height")),this.setDataSet({max:e[a][b],data:e},!0)):c.drawAlpha(a,b,e[a][b],!0)}},setDataSet:function(a,b){var c=this.get("heatmap"),e=[],k=a.data,q=k.length;c.clear();this.max=a.max;c.get("legend")&&c.get("legend").update(a.max);if(null!=b&&b)for(var n in k){if(void 0!==n)for(var r in k[n])void 0!==r&&c.drawAlpha(n,r,k[n][r],!1)}else for(;q--;)n=k[q],c.drawAlpha(n.x,n.y,n.count,!1),e[n.x]||(e[n.x]=[]),e[n.x][n.y]||(e[n.x][n.y]=0),e[n.x][n.y]=n.count;c.colorize();this.set("data",k)},exportDataSet:function(){var a=this.get("data"),b=[],c;for(c in a)if(void 0!==c)for(var e in a[c])void 0!==e&&b.push({x:parseInt(c,10),y:parseInt(e,10),count:a[c][e]});return{max:this.max,data:b}},generateRandomDataSet:function(a){var b=this.get("heatmap"),c=b.get("width"),b=b.get("height"),e={},k=Math.floor(1E3*Math.random()+1);e.max=k;for(var q=[];a--;)q.push({x:Math.floor(Math.random()*c+1),y:Math.floor(Math.random()*b+1),count:Math.floor(Math.random()*k+1)});e.data=q;this.setDataSet(e)}};var b=function(a){this.config=a;var b={element:null,labelsEl:null,gradientCfg:null,ctx:null};this.get=function(a){return b[a]};this.set=function(a,c){b[a]=c};this.init()};b.prototype={init:function(){var a=this.config,b=a.title||"Legend",c=a.position,e=a.offset||10,a=document.createElement("ul"),k="";this.processGradientObject();k=-1<c.indexOf("t")?k+("top:"+e+"px;"):k+("bottom:"+e+"px;");k=-1<c.indexOf("l")?k+("left:"+e+"px;"):k+("right:"+e+"px;");c=document.createElement("div");c.style.cssText="border-radius:5px;position:absolute;"+k+"font-family:Helvetica; width:256px;z-index:10000000000; background:rgba(255,255,255,1);padding:10px;border:1px solid black;margin:0;";c.innerHTML="\x3ch3 style\x3d'padding:0;margin:0;text-align:center;font-size:16px;'\x3e"+b+"\x3c/h3\x3e";a.style.cssText="position:relative;font-size:12px;display:block;list-style:none;list-style-type:none;margin:0;height:15px;";b=document.createElement("div");b.style.cssText=["position:relative;display:block;width:256px;height:15px;border-bottom:1px solid black; background-image:url(",this.createGradientImage(),");"].join("");c.appendChild(a);c.appendChild(b);this.set("element",c);this.set("labelsEl",a);this.update(1)},processGradientObject:function(){var a=this.config.gradient,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push({stop:c,value:a[c]});b.sort(function(a,b){return a.stop-b.stop});b.unshift({stop:0,value:"rgba(0,0,0,0)"});this.set("gradientArr",b)},createGradientImage:function(){var a=this.get("gradientArr"),b=a.length,c=document.createElement("canvas"),e=c.getContext("2d"),k;c.width="256";c.height="15";k=e.createLinearGradient(0,5,256,10);for(var q=0;q<b;q++)k.addColorStop(1/(b-1)*q,a[q].value);e.fillStyle=k;e.fillRect(0,5,256,10);e.strokeStyle="black";e.beginPath();for(q=0;q<b;q++)e.moveTo((256*(1/(b-1))*q>>0)+0.5,0),e.lineTo((256*(1/(b-1))*q>>0)+0.5,0==q?15:5);e.moveTo(255.5,0);e.lineTo(255.5,15);e.moveTo(255.5,4.5);e.lineTo(0,4.5);e.stroke();this.set("ctx",e);return c.toDataURL()},getElement:function(){return this.get("element")},update:function(a){for(var b=this.get("gradientArr"),c=this.get("ctx"),e=this.get("labelsEl"),k,q="",n,r=0;r<b.length;r++)k=a*b[r].stop>>0,n=c.measureText(k).width/2>>0,0==r&&(n=0),r==b.length-1&&(n*=2),q+='\x3cli style\x3d"position:absolute;left:'+(((256*(1/(b.length-1))*r||0)>>0)-n+0.5)+'px"\x3e'+k+"\x3c/li\x3e";e.innerHTML=q}};var c=function(b){var c={radius:40,element:{},canvas:{},acanvas:{},ctx:{},actx:{},legend:null,visible:!0,width:0,height:0,max:!1,gradient:!1,opacity:180,premultiplyAlpha:!1,bounds:{l:1E3,r:0,t:1E3,b:0},debug:!1};this.store=new a(this);this.get=function(a){return c[a]};this.set=function(a,b){c[a]=b};this.configure(b);this.init()};c.prototype={configure:function(a){this.set("radius",a.radius||40);this.set("element",a.element instanceof Object?a.element:document.getElementById(a.element));this.set("visible",null!=a.visible?a.visible:!0);this.set("max",a.max||!1);this.set("gradient",a.gradient||{"0.45":"rgb(0,0,255)","0.55":"rgb(0,255,255)","0.65":"rgb(0,255,0)","0.95":"yellow",1:"rgb(255,0,0)"});this.set("opacity",parseInt(255/(100/a.opacity),10)||180);this.set("width",a.width||0);this.set("height",a.height||0);this.set("debug",a.debug);a.legend&&(a=a.legend,a.gradient=this.get("gradient"),this.set("legend",new b(a)))},resize:function(){var a=this.get("element"),b=this.get("canvas"),c=this.get("acanvas");b.width=c.width=this.get("width")||a.style.width.replace(/px/,"")||this.getWidth(a);this.set("width",b.width);b.height=c.height=this.get("height")||a.style.height.replace(/px/,"")||this.getHeight(a);this.set("height",b.height)},init:function(){var a=document.createElement("canvas"),b=document.createElement("canvas"),c=a.getContext("2d"),e=b.getContext("2d"),k=this.get("element");this.initColorPalette();this.set("canvas",a);this.set("ctx",c);this.set("acanvas",b);this.set("actx",e);this.resize();a.style.cssText=b.style.cssText="position:absolute;top:0;left:0;z-index:10000000;";this.get("visible")||(a.style.display="none");k.appendChild(a);this.get("legend")&&k.appendChild(this.get("legend").getElement());this.get("debug")&&document.body.appendChild(b);e.shadowOffsetX=15E3;e.shadowOffsetY=15E3;e.shadowBlur=15},initColorPalette:function(){var a=document.createElement("canvas"),b=this.get("gradient"),c,e;a.width="1";a.height="256";a=a.getContext("2d");c=a.createLinearGradient(0,0,1,256);e=a.getImageData(0,0,1,1);e.data[0]=e.data[3]=64;e.data[1]=e.data[2]=0;a.putImageData(e,0,0);e=a.getImageData(0,0,1,1);this.set("premultiplyAlpha",60>e.data[0]||70<e.data[0]);for(var k in b)c.addColorStop(k,b[k]);a.fillStyle=c;a.fillRect(0,0,1,256);this.set("gradient",a.getImageData(0,0,1,256).data)},getWidth:function(a){var b=a.offsetWidth;a.style.paddingLeft&&(b+=a.style.paddingLeft);a.style.paddingRight&&(b+=a.style.paddingRight);return b},getHeight:function(a){var b=a.offsetHeight;a.style.paddingTop&&(b+=a.style.paddingTop);a.style.paddingBottom&&(b+=a.style.paddingBottom);return b},colorize:function(a,b){var c=this.get("width"),e=this.get("radius"),k=this.get("height"),q=this.get("actx"),n=this.get("ctx"),r=3*e,e=this.get("premultiplyAlpha"),s=this.get("gradient"),v=this.get("opacity"),t=this.get("bounds"),y,u,w;null!=a&&null!=b?(a+r>c&&(a=c-r),0>a&&(a=0),0>b&&(b=0),b+r>k&&(b=k-r),y=a,c=b,u=a+r,k=b+r):(y=0>t.l?0:t.l,u=t.r>c?c:t.r,c=0>t.t?0:t.t,k=t.b>k?k:t.b);q=q.getImageData(y,c,u-y,k-c);k=q.data;r=k.length;for(u=3;u<r;u+=4)if(w=k[u],t=4*w)w=w<v?w:v,k[u-3]=s[t],k[u-2]=s[t+1],k[u-1]=s[t+2],e&&(k[u-3]/=255/w,k[u-2]/=255/w,k[u-1]/=255/w),k[u]=w;q.data=k;n.putImageData(q,y,c)},drawAlpha:function(a,b,c,e){var k=this.get("radius"),q=this.get("actx");this.get("max");var n=this.get("bounds"),r=a-1.5*k>>0,s=b-1.5*k>>0,v=a+1.5*k>>0,t=b+1.5*k>>0;q.shadowColor="rgba(0,0,0,"+(c?c/this.store.max:"0.1")+")";q.shadowOffsetX=15E3;q.shadowOffsetY=15E3;q.shadowBlur=15;q.beginPath();q.arc(a-15E3,b-15E3,k,0,2*Math.PI,!0);q.closePath();q.fill();e?this.colorize(r,s):(r<n.l&&(n.l=r),s<n.t&&(n.t=s),v>n.r&&(n.r=v),t>n.b&&(n.b=t))},toggleDisplay:function(){var a=this.get("visible");this.get("canvas").style.display=a?"none":"block";this.set("visible",!a)},isVisible:function(){return this.get("visible")},getImageData:function(){return this.get("canvas").toDataURL()},clear:function(){var a=this.get("width"),b=this.get("height");this.store.set("data",[]);this.get("ctx").clearRect(0,0,a,b);this.get("actx").clearRect(0,0,a,b)},cleanup:function(){this.get("element").removeChild(this.get("canvas"))}};return{create:function(a){return new c(a)},util:{mousePosition:function(a){var b,c;a.layerX?(b=a.layerX,c=a.layerY):a.offsetX&&(b=a.offsetX,c=a.offsetY);if("undefined"!=typeof b)return[b,c]}}}}();c.h337=c.heatmapFactory=b})(window);(function(){var c=mxLib.HeatmapOverlay=function(b){this.conf=b||{};this.heatmap=null;this.latlngs=[];this.bounds=null;this.conf.minZoom=b.minZoom||0;this.conf.maxZoom=b.maxZoom||0};c.prototype=new mxLib.Overlay;c.prototype.initialize=function(b){this._map=b;var a=document.createElement("div");a.style.position="absolute";a.style.top=0;a.style.left=0;a.style.border=0;a.style.width=this._map.getSize().width+"px";a.style.height=this._map.getSize().height+"px";a.style.pointerEvents="none";this.conf.element=a;b.getPanes().mapPane.appendChild(a);this.heatmap=h337.create(this.conf);return this._div=a};c.prototype.getEventPane=function(){return this.map.getPanes().mapPane};c.prototype.draw=function(){if(this.curZoomInRange(this.conf.minZoom,this.conf.maxZoom)&&this.heatmap.isVisible()){var b=this._map.getBounds();this.bounds=b;var a=this._map.pointToPixel(b.getNorthEast()),c=this._map.pointToPixel(b.getSouthWest()),e=a.y<c.y?a.y:c.y,h=c.x,g=Math.abs(c.y-a.y),a=Math.abs(a.x-c.x);this.conf.element.style.left=h+"px";this.conf.element.style.top=e+"px";this.conf.element.style.width=a+"px";this.conf.element.style.height=g+"px";this.heatmap.store.get("heatmap").resize();if(0<this.latlngs.length){this.heatmap.clear();g=this.latlngs.length;for(d={max:this.heatmap.store.max,data:[]};g--;)a=this.latlngs[g].latlng,b.containsPoint(a)&&(a=this._map.pointToPixel(a),a=new mxLib.Pixel(a.x-h,a.y-e),a=this.pixelTransform(a),d.data.push({x:a.x,y:a.y,count:this.latlngs[g].c}));this.heatmap.store.setDataSet(d)}}};c.prototype.pixelTransform=function(b){for(var a=this.heatmap.get("width"),c=this.heatmap.get("height");0>b.x;)b.x+=a;for(;b.x>a;)b.x-=a;for(;0>b.y;)b.y+=c;for(;b.y>c;)b.y-=c;b.x>>=0;b.y>>=0;return b};c.prototype.setDataSet=function(b){var a=this._map.getBounds(),c={max:b.max,data:[]};b=b.data;var e=b.length;for(this.latlngs=[];e--;){var h=new mxLib.Point(b[e].x,b[e].y);if(a.containsPoint(h)){this.latlngs.push({latlng:h,c:b[e].val});var h=this._map.pointToPixel(h),g=this._map.pointToPixel(a.getSouthWest()).x,f=this._map.pointToPixel(a.getNorthEast()).y,h=new mxLib.Pixel(h.x-g,h.y-f),h=this.pixelTransform(h);c.data.push({x:h.x,y:h.y,count:b[e].val})}}this.heatmap.clear();this.heatmap.store.setDataSet(c)};c.prototype.addDataPoint=function(b,a,c){b=new mxLib.Point(b,a);a=this.pixelTransform(this._map.pointToPixel(b));this.heatmap.store.addDataPoint(a.x,a.y,c);this.latlngs.push({latlng:b,c:c})};c.prototype.toggle=function(){this.heatmap.toggleDisplay();this.heatmap.isVisible()&&this.draw()};mxLib.HeatmapOverlay=c})();(function(){var c=mxLib.InfoWindow=function(a,c,e){this.guid=b++;mxLib.InfoWindow.instance[this.guid]=this;this._isOpen=!1;this._map=a;this._opts=e=e||{};this._content=c||"";this._opts.width=e.width;this._opts.height=e.height;this._opts._title=e.title||"";this._opts.offset=e.offset||new mxLib.Size(0,0);this._opts.enableAutoPan=!0===e.enableAutoPan?!0:!1;this._opts.minZoom=e.minZoom||0;this._opts.maxZoom=e.maxZoom||0};c.prototype=new mxLib.Overlay;c.prototype.initialize=function(a){this._closeOtherInfoWindow();var b=this,c=this._createInfoTemplate();a=a.getPanes().floatPane;a.style.width="auto";a.appendChild(c);this._initInfoTemplate();this._getInfoWindowSize();this._boxWidth=parseInt(this.container.offsetWidth,10);this._boxHeight=parseInt(this.container.offsetHeight,10);this.draw();mxLib.event.on(c,"onmousedown",function(a){b._stopBubble(a)});mxLib.event.on(c,"ontouchstart",function(a){b._stopBubble(a)});mxLib.event.on(c,"touchmove",function(a){b._stopBubble(a)});mxLib.event.on(c,"touchend",function(a){b._stopBubble(a)});mxLib.event.on(c,"onmouseover",function(a){b._stopBubble(a)});mxLib.event.on(c,"click",function(a){b._stopBubble(a)});mxLib.event.on(c,"dblclick",function(a){b._stopBubble(a)});return c};c.prototype.getEventPane=function(){return this._map.getPanes().floatPane};c.prototype.draw=function(){this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)&&this._isOpen&&this._adjustPosition(this._point)};c.prototype.open=function(a){this._map.closeInfoWindow();var b=this,c;this._isOpen||(this._map.addOverlay(this),this._isOpen=!0,setTimeout(function(){b._dispatchEvent(b,"open",{point:b._point})},10));a instanceof mxLib.Point?(c=a,this._removeMarkerEvt(),this.marker=null):a instanceof mxLib.Marker&&(this.marker&&this._removeMarkerEvt(),c=a.getPosition(),this.marker=a,this._map.temp.marker=this.marker,!this._markerDragend&&this.marker.addEventListener("dragend",this._markerDragend=function(a){b._point=a.point;b._adjustPosition(b._point);b._panBox();b.show()}),!this._markerDragging&&this.marker.addEventListener("dragging",this._markerDragging=function(){b.hide();b._point=b.marker.getPosition();b._adjustPosition(b._point)}));this.show();this._point=c;this._panBox();this._adjustPosition(this._point);this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)};c.prototype.close=function(){this._isOpen&&(this._map.removeOverlay(this),this._isOpen=!1,this._dispatchEvent(this,"close",{point:this._point}))};c.prototype.enableAutoPan=function(){this._opts.enableAutoPan=!0};c.prototype.disableAutoPan=function(){this._opts.enableAutoPan=!1};c.prototype.setContent=function(a){this._setContent(a);this._getInfoWindowSize();this._adjustPosition(this._point)};c.prototype.setTitle=function(a){this.dom.title.innerHTML=a;this._opts._title=a};c.prototype.getContent=function(){return this.dom.content.innerHTML};c.prototype.getTitle=function(){return this.dom.title.innerHTML};c.prototype.setPosition=function(a){this._point=a;this._adjustPosition(a);this._panBox();this._removeMarkerEvt()};c.prototype.getPosition=function(){return this._point};c.prototype.getOffset=function(){return this._opts.offset};c.prototype._closeOtherInfoWindow=function(){for(var a=mxLib.InfoWindow.instance,b=a.length;b--;)a[b]._isOpen&&a[b].close()};c.prototype._setContent=function(a){this.dom&&this.dom.content&&("undefined"===typeof a.nodeType?this.dom.content.innerHTML=a:this.dom.content.appendChild(a),this._adjustContainerWidth(),this._content=a)};c.prototype._adjustPosition=function(a){a=this._getPointPosition(a);var b=this.marker&&this.marker.getIcon();this.marker?(this.container.style.bottom=-(a.y-this._opts.offset.height-b.anchor.height+b.infoWindowAnchor.height)-this.marker.getOffset().height+32+"px",this.container.style.left=a.x-b.anchor.width+this.marker.getOffset().width+b.infoWindowAnchor.width-this._boxWidth/2+28+"px"):(this.container.style.bottom=-(a.y-this._opts.offset.height)+30+"px",this.container.style.left=a.x-this._boxWidth/2+25+"px")};c.prototype._getPointPosition=function(a){return this._pointPosition=this._map.pointToPixel(a)};c.prototype._getInfoWindowSize=function(){this._boxWidth=parseInt(this.container.offsetWidth,10);this._boxHeight=parseInt(this.container.offsetHeight,10)};c.prototype._stopBubble=function(a){a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0};c.prototype._panBox=function(){if(this._opts.enableAutoPan){var a=parseInt(this._map.getContainer().offsetHeight,10),b=parseInt(this._map.getContainer().offsetWidth,10),c=this._boxHeight,h=this._boxWidth;if(!(c>=a||h>=b)){this._map.getBounds().containsPoint(this._point)||this._map.setCenter(this._point);var g=this._map.pointToPixel(this._point),a=h/2-28-g.x+10,b=h/2+28+g.x-b+10;if(this.marker)var f=this.marker.getIcon();f=this.marker?f.anchor.height+this.marker.getOffset().height-f.infoWindowAnchor.height:0;c=c-g.y+this._opts.offset.height+f+31+10;panX=0<a?a:0<b?-b:0;this._map.panBy(panX,0<c?c:0)}}};c.prototype._removeMarkerEvt=function(){this._markerDragend&&this.marker.removeEventListener("dragend",this._markerDragend);this._markerDragging&&this.marker.removeEventListener("dragging",this._markerDragging);this._markerDragend=this._markerDragging=null};c.prototype._dispatchEvent=function(a,b,c){0!=b.indexOf("on")&&(b="on"+b);b=new mxLib.lang.Event(b);if(c)for(var h in c)b[h]=c[h];a.dispatchEvent(b)};c.prototype._initInfoTemplate=function(){this._initDom();this.setTitle(this._opts._title);this._opts.height&&(this.dom.content.style.height=parseInt(this._opts.height,10)+"px");this._setContent(this._content);this._bind();this._mendIE6()};c.prototype._createInfoTemplate=function(){if(!this._div){var a=mxLib.dom.create("div",{"class":"MxLib_InfoWindow",id:"MxLib_InfoWindow"+this.guid});a.innerHTML=['\x3cdiv class\x3d"MxLib_bubble_top"\x3e','\x3cdiv class\x3d"MxLib_bubble_title" id\x3d"MxLib_bubble_title'+this.guid+'"\x3e\x3c/div\x3e','\x3cdiv class\x3d"MxLib_bubble_tools"\x3e','\x3cdiv class\x3d"MxLib_bubble_close" title\x3d"\u5173\u95ed" id\x3d"MxLib_bubble_close'+this.guid+'"\x3e','\x3c/div\x3e\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"MxLib_bubble_center"\x3e','\x3cdiv class\x3d"MxLib_bubble_content" id\x3d"MxLib_bubble_content'+this.guid+'" style\x3d"overflow:auto"\x3e','\x3c/div\x3e\x3c/div\x3e\x3cdiv class\x3d"MxLib_bubble_bottom"\x3e\x3c/div\x3e','\x3cimg src\x3d"'+scriptBaseDir+'mxImg/iw_tail.png" width\x3d"58" height\x3d"31" alt\x3d"" class\x3d"MxLib_trans" id\x3d"MxLib_trans'+this.guid+'" style\x3d"left:144px;"/\x3e'].join("");this._div=a}return this._div};c.prototype._initDom=function(){this.dom||(this.dom={container:mxLib.g("MxLib_InfoWindow"+this.guid),content:mxLib.g("MxLib_bubble_content"+this.guid),title:mxLib.g("MxLib_bubble_title"+this.guid),closeBtn:mxLib.g("MxLib_bubble_close"+this.guid),transIco:mxLib.g("MxLib_trans"+this.guid)},this.container=this.dom.container)};c.prototype._adjustContainerWidth=function(){var a=250;this._opts.width?(a=parseInt(this._opts.width,10),a+=10):a=parseInt(this.dom.content.offsetWidth,10);250>a&&(a=250);this._width=a;this.container.style.width=this._width+"px";this._adjustTransPosition()};c.prototype._adjustTransPosition=function(){this.dom.transIco.style.left=this.container.offsetWidth/2-2-29+"px";this.dom.transIco.style.top=this.container.offsetHeight-2+"px"};c.prototype._bind=function(){var a=this;mxLib.on(this.dom.closeBtn,"click",function(b){a.close()});mxLib.on(this.dom.closeBtn,"touchstart",function(b){a.close()})};c.prototype._mendIE6=function(a){if(mxLib.browser.ie&&!(6<mxLib.browser.ie)){a=this.container.getElementsByTagName("IMG");for(var b=0;b<a.length;b++)0>a[b].src.indexOf(".png")||(a[b].style.cssText+=";FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d"+a[b].src+",sizingMethod\x3dcrop)",a[b].src=scriptBaseDir+"mxImg/blank.gif")}};var b=0;mxLib.InfoWindow.instance=[]})();var mxLib=window.mxLib=mxLib||{};(function(){window.INFOBOX_AT_TOP=1;window.INFOBOX_AT_RIGHT=2;window.INFOBOX_AT_BOTTOM=3;window.INFOBOX_AT_LEFT=4;var c=mxLib.InfoBox=function(b,a,c){this._content=a||"";this._isOpen=!1;this._map=b;this._opts=c=c||{};this._opts.offset=c.offset||new mxLib.Size(0,0);this._opts.boxClass=c.boxClass||"infoBox";this._opts.boxStyle=c.boxStyle||{};this._opts.closeIconMargin=c.closeIconMargin||"2px";this._opts.closeIconUrl=c.closeIconUrl||scriptBaseDir+"mxImg/close.png";this._opts.enableAutoPan=c.enableAutoPan?!0:!1;this._opts.align=c.align||INFOBOX_AT_TOP;this._opts.minZoom=c.minZoom||0;this._opts.maxZoom=c.maxZoom||0};mxLib.Lang.inherits(c,mxLib.Overlay);c.prototype.initialize=function(b){var a=this,c=this._div=mxLib.dom.create("div",{"class":this._opts.boxClass});mxLib.dom.setStyles(c,this._opts.boxStyle);c.style.position="absolute";this._setContent(this._content);b=b.getPanes().floatPane;b.style.width="auto";b.appendChild(c);this._getInfoBoxSize();this.draw();mxLib.event.on(c,"onmousedown",function(b){a._stopBubble(b)});mxLib.event.on(c,"onmouseover",function(b){a._stopBubble(b)});mxLib.event.on(c,"click",function(b){a._stopBubble(b)});mxLib.event.on(c,"dblclick",function(b){a._stopBubble(b)});return c};c.prototype.getEventPane=function(){return this._map.getPanes().floatPane};c.prototype.draw=function(){this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)&&this._isOpen&&this._adjustPosition(this._point)};c.prototype.open=function(b){var a=this,c;this._isOpen||(this._map.addOverlay(this),this._isOpen=!0,setTimeout(function(){a._dispatchEvent(a,"open",{point:a._point})},10));b instanceof mxLib.Point?(c=b,this._removeMarkerEvt()):b instanceof mxLib.Marker&&(this.marker&&this._removeMarkerEvt(),c=b.getPosition(),this.marker=b,this._map.temp.marker=this.marker,!this._markerDragend&&this.marker.addEventListener("dragend",this._markerDragend=function(b){a._point=a.marker.getPosition();a._adjustPosition(a._point);a._panBox();a.show()}),!this._markerDragging&&this.marker.addEventListener("dragging",this._markerDragging=function(){a.hide();a._point=a.marker.getPosition();a._adjustPosition(a._point)}));this.show();this._point=c;this._panBox();this._adjustPosition(this._point);this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)};c.prototype.close=function(){this._isOpen&&(this._map.removeOverlay(this),this._remove(),this._isOpen=!1,this._dispatchEvent(this,"close",{point:this._point}))};c.prototype.enableAutoPan=function(){this._opts.enableAutoPan=!0};c.prototype.disableAutoPan=function(){this._opts.enableAutoPan=!1};c.prototype.setContent=function(b){this._setContent(b);this._getInfoBoxSize();this._adjustPosition(this._point)};c.prototype.setPosition=function(b){this._point=b;this._adjustPosition(b);this._removeMarkerEvt()};c.prototype.getPosition=function(){return this._point};c.prototype.getOffset=function(){return this._opts.offset};c.prototype._remove=function(){this.domElement&&this.domElement.parentNode&&(mxLib.event.un(this._div.firstChild,"click",this._closeHandler()),this.domElement.parentNode.removeChild(this.domElement));this.domElement=null;this._isOpen=!1;this.dispatchEvent("onremove")};mxLib.object.extend(c.prototype,{_getCloseIcon:function(){return"\x3cimg src\x3d'"+this._opts.closeIconUrl+"' align\x3d'right' style\x3d'position:absolute;right:0px;cursor:pointer;margin:"+this._opts.closeIconMargin+"'/\x3e"},_setContent:function(b){if(this._div){var a=this._getCloseIcon();"undefined"===typeof b.nodeType?this._div.innerHTML=a+b:(this._div.innerHTML=a,this._div.appendChild(b));this._content=b;this._addEventToClose()}},_adjustPosition:function(b){b=this._getPointPosition(b);var a=this.marker&&this.marker.getIcon();switch(this._opts.align){case INFOBOX_AT_TOP:this._div.style.bottom=this.marker?-(b.y-this._opts.offset.height-a.anchor.height+a.infoWindowAnchor.height)-this.marker.getOffset().height+2+"px":-(b.y-this._opts.offset.height)+"px";break;case INFOBOX_AT_BOTTOM:this._div.style.top=this.marker?b.y+this._opts.offset.height-a.anchor.height+a.infoWindowAnchor.height+this.marker.getOffset().height+"px":b.y+this._opts.offset.height+"px"}this._div.style.left=this.marker?b.x-a.anchor.width+this.marker.getOffset().width+a.infoWindowAnchor.width-this._boxWidth/2+"px":b.x-this._boxWidth/2+"px"},_getPointPosition:function(b){return this._pointPosition=this._map.pointToPixel(b)},_getInfoBoxSize:function(){this._boxWidth=parseInt(this._div.offsetWidth,10);this._boxHeight=parseInt(this._div.offsetHeight,10)},_addEventToClose:function(){mxLib.event.on(this._div.firstChild,"click",this._closeHandler());this._hasBindEventClose=!0},_closeHandler:function(){var b=this;return function(a){b.close()}},_stopBubble:function(b){b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0},_panBox:function(){if(this._opts.enableAutoPan){var b=parseInt(this._map.getContainer().offsetHeight,10),a=parseInt(this._map.getContainer().offsetWidth,10),c=this._boxHeight,e=this._boxWidth;if(!(c>=b||e>=a)){this._map.getBounds().containsPoint(this._point)||this._map.setCenter(this._point);var h=this._map.pointToPixel(this._point),g,f,l=e/2-h.x,a=e/2+h.x-a;if(this.marker)var m=this.marker.getIcon();switch(this._opts.align){case INFOBOX_AT_TOP:m=this.marker?m.anchor.height+this.marker.getOffset().height-m.infoWindowAnchor.height:0;g=c-h.y+this._opts.offset.height+m+2;break;case INFOBOX_AT_BOTTOM:m=this.marker?-m.anchor.height+m.infoWindowAnchor.height+this.marker.getOffset().height+this._opts.offset.height:0,f=c+h.y-b+m+4}panX=0<l?l:0<a?-a:0;b=0<g?g:0<f?-f:0;0==panX&&0==b||this._map.panBy(panX,b)}}},_removeMarkerEvt:function(){this._markerDragend&&this.marker.removeEventListener("dragend",this._markerDragend);this._markerDragging&&this.marker.removeEventListener("dragging",this._markerDragging);this._markerDragend=this._markerDragging=null},_dispatchEvent:function(b,a,c){0!=a.indexOf("on")&&(a="on"+a);a=new mxLib.lang.Event(a);if(c)for(var e in c)a[e]=c[e];b.dispatchEvent(a)}})})();mxLib=window.mxLib=mxLib||{};(function(){function c(a){this._markerClusterer=a;this._map=a.getMap();this._minClusterSize=a.getMinClusterSize();this._isAverageCenter=a.isAverageCenter();this._center=null;this._markers=[];this._gridBounds=null;this._isReal=!1;this._clusterMarker=new mxLib.TextIconOverlay(this._center,this._markers.length,{styles:this._markerClusterer.getStyles()})}var b=function(a,b,c){var k=a.pointToPixel(b.getNorthEast());b=a.pointToPixel(b.getSouthWest());k.x+=c;k.y-=c;b.x-=c;b.y+=c;c=a.pixelToPoint(k);a=a.pixelToPoint(b);return new mxLib.Bounds(a,c)},a=function(a,b){var c=-1;if("[object Array]"===Object.prototype.toString.call(b))if(b.indexOf)c=b.indexOf(a);else for(var k=0,l;l=b[k];k++)if(l===a){c=k;break}return c},k=mxLib.MarkerClusterer=function(a,b){if(a){this._map=a;this._markers=[];this._clusters=[];var c=b||{};this._gridSize=c.gridSize||60;this._maxZoom=c.maxZoom||18;this._minClusterSize=c.minClusterSize||2;this._isDrawViewportMarker=c.isDrawViewportMarker||!1;this._isAverageCenter=!0;void 0!=c.isAverageCenter&&(this._isAverageCenter=c.isAverageCenter);this._styles=c.styles||[];var k=this;this._map.addEventListener("zoomend",function(){k._redraw()});this._isDrawViewportMarker&&(this._map.addEventListener("dragend",function(){k._redraw()}),this._map.addEventListener("moveend",function(){k._redraw()}));c=c.markers;"[object Array]"===Object.prototype.toString.call(c)&&this.addMarkers(c)}};k.prototype.addMarkers=function(a){for(var b=0,c=a.length;b<c;b++)this._pushMarkerTo(a[b]);this._createClusters()};k.prototype._pushMarkerTo=function(b){-1===a(b,this._markers)&&(b.isInCluster=!1,this._markers.push(b))};k.prototype.addMarker=function(a){this._pushMarkerTo(a);this._createClusters()};k.prototype._createClusters=function(){for(var a=this._map.getBounds(this._isDrawViewportMarker?!1:!0),a=b(this._map,a,this._gridSize),c=0,k;k=this._markers[c];c++)!k.isInCluster&&a.containsPoint(k.getPosition())&&this._addToClosestCluster(k)};k.prototype._addToClosestCluster=function(a){var b=4E6,k=null;a.getPosition();for(var f=0,l;l=this._clusters[f];f++){var m=l.getCenter();m&&(m=this._map.getDistance(m,a.getPosition()),m<b&&(b=m,k=l))}k&&k.isMarkerInClusterBounds(a)?k.addMarker(a):(l=new c(this),l.addMarker(a),this._clusters.push(l))};k.prototype._clearLastClusters=function(){for(var a=0,b;b=this._clusters[a];a++)b.remove();this._clusters=[];this._removeMarkersFromCluster()};k.prototype._removeMarkersFromCluster=function(){for(var a=0,b;b=this._markers[a];a++)b.isInCluster=!1};k.prototype._removeMarkersFromMap=function(){for(var a=0,b;b=this._markers[a];a++)b.isInCluster=!1,this._map.removeOverlay(b)};k.prototype._removeMarker=function(b){var c=a(b,this._markers);if(-1===c)return!1;this._map.removeOverlay(b);this._markers.splice(c,1);return!0};k.prototype.removeMarker=function(a){if(a=this._removeMarker(a))this._clearLastClusters(),this._createClusters();return a};k.prototype.removeMarkers=function(a){for(var b=!1,c=0;c<a.length;c++)var k=this._removeMarker(a[c]),b=b||k;b&&(this._clearLastClusters(),this._createClusters());return b};k.prototype.clearMarkers=function(){this._clearLastClusters();this._removeMarkersFromMap();this._markers=[]};k.prototype._redraw=function(){this._clearLastClusters();this._createClusters()};k.prototype.getGridSize=function(){return this._gridSize};k.prototype.setGridSize=function(a){this._gridSize=a;this._redraw()};k.prototype.getMaxZoom=function(){return this._maxZoom};k.prototype.setMaxZoom=function(a){this._maxZoom=a;this._redraw()};k.prototype.getStyles=function(){return this._styles};k.prototype.setStyles=function(a){this._styles=a;this._redraw()};k.prototype.getMinClusterSize=function(){return this._minClusterSize};k.prototype.setMinClusterSize=function(a){this._minClusterSize=a;this._redraw()};k.prototype.isAverageCenter=function(){return this._isAverageCenter};k.prototype.getMap=function(){return this._map};k.prototype.getMarkers=function(){return this._markers};k.prototype.getClustersCount=function(){for(var a=0,b=0,c;c=this._clusters[b];b++)c.isReal()&&a++;return a};c.prototype.addMarker=function(a){if(this.isMarkerInCluster(a))return!1;if(!this._center)this._center=a.getPosition(),this.updateGridBounds();else if(this._isAverageCenter){var b=this._markers.length+1,c=(this._center.x*(b-1)+a.getPosition().x)/b,b=(this._center.y*(b-1)+a.getPosition().y)/b;this._center=new mxLib.Point(c,b);this.updateGridBounds()}a.isInCluster=!0;this._markers.push(a);c=this._markers.length;if(c<this._minClusterSize)return this._map.addOverlay(a),!0;if(c===this._minClusterSize)for(a=0;a<c;a++)this._markers[a].getMap()&&this._map.removeOverlay(this._markers[a]);this._map.addOverlay(this._clusterMarker);this._isReal=!0;this.updateClusterMarker();return!0};c.prototype.isMarkerInCluster=function(a){if(this._markers.indexOf)return-1!=this._markers.indexOf(a);for(var b=0,c;c=this._markers[b];b++)if(c===a)return!0;return!1};c.prototype.isMarkerInClusterBounds=function(a){return this._gridBounds.containsPoint(a.getPosition())};c.prototype.isReal=function(a){return this._isReal};c.prototype.updateGridBounds=function(){var a=new mxLib.Bounds(this._center,this._center);this._gridBounds=b(this._map,a,this._markerClusterer.getGridSize())};c.prototype.updateClusterMarker=function(){if(this._map.getZoom()>this._markerClusterer.getMaxZoom()){this._clusterMarker&&this._map.removeOverlay(this._clusterMarker);for(var a=0,b;b=this._markers[a];a++)this._map.addOverlay(b)}else if(this._markers.length<this._minClusterSize)this._clusterMarker.hide();else{this._clusterMarker.setPosition(this._center);this._clusterMarker.setText(this._markers.length);var c=this._map,k=this.getBounds();this._clusterMarker.addEventListener("click",function(a){c.setViewport(k)})}};c.prototype.remove=function(){for(var a=0;this._markers[a];a++)this._markers[a].getMap()&&this._map.removeOverlay(this._markers[a]);this._map.removeOverlay(this._clusterMarker);this._markers.length=0;delete this._markers};c.prototype.getBounds=function(){for(var a=new mxLib.Bounds(this._center,this._center),b=0,c;c=this._markers[b];b++)a.extend(c.getPosition());return a};c.prototype.getCenter=function(){return this._center}})();(function(){var c=mxLib.Vertex=function(b,a){this.point=b;this.isMiddle=a||!1};mxLib.Lang.inherits(c,mxLib.Overlay);c.prototype.initialize=function(b){this.map=b;var a="",a=this.isMiddle?"MxLib_vectex MxLib_vectex_nodeT":"MxLib_vectex MxLib_vectex_node",c=this.domElement=document.createElement("div");c.className=a;a=b.pointToPixel(this.point);c.style.left=a.x-5+"px";c.style.top=a.y-5+"px";b.getPanes().mapVertex.appendChild(c);mxLib.Overlay.prototype.setEventDispath.call(this);return c};c.prototype.getEventPane=function(){return this.map.getPanes().mapVertex};c.prototype.draw=function(){if(this.domElement){var b=this.map.pointToPixel(this.point);this.domElement.style.left=b.x-5+"px";this.domElement.style.top=b.y-5+"px"}};c.prototype.getMap=function(){return this.map};c.prototype.isDraggable=function(){return!0};c.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};c.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)}})();(function(){var c=mxLib.Polyline=function(b,a){a=a||{};this.points=b;this.options={};this.options.strokeColor=a.strokeColor||"blue";this.options.strokeWidth=a.strokeWidth||a.strokeWeight||1;this.options.strokeOpacity=a.strokeOpacity||1;this.options.strokeStyle=a.strokeStyle||"solid";this.options.enableMassClear=!1===a.enableMassClear?!1:!0;this.options.enableEditing=a.enableEditing||!1;this.options.enableClicking=!1===a.enableClicking?!1:!0;this.options.minZoom=a.minZoom||0;this.options.maxZoom=a.maxZoom||0};mxLib.Lang.inherits(c,mxLib.Overlay);c.prototype.initialize=function(b){this.map=b;b=b.getMapPaneSvg();var a="none";$.isNumeric(this.options.strokeStyle)?a=this.options.strokeStyle:"dashed"==this.options.strokeStyle&&(a=4);this.options.strokeStyle=a;this.svgElement=b.polyline().attr({fill:"none",points:this._toPixelPointsString(),stroke:this.options.strokeColor,strokeWidth:this.options.strokeWidth,strokeOpacity:this.options.strokeOpacity,"stroke-dasharray":this.options.strokeStyle});!0==this.options.enableClicking&&this.svgElement.attr({cursor:"pointer"});this.domElement=this.svgElement.node;mxLib.Overlay.prototype.setEventDispath.call(this);this.options.enableEditing?this.enableEditing():this.disableEditing();return this.domElement};c.prototype.getEventPane=function(){return this.map.getPanes().mapPane};c.prototype._toPixelPointsString=function(){for(var b="",a=0;a<this.points.length;a++)var c=this.map.pointToSvgPixel(this.points[a]),b=b+(c.x+","+c.y+" ");return b};c.prototype.snap=function(){return this.svgElement};c.prototype.draw=function(){this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)&&this.svgElement.attr({points:this._toPixelPointsString()})};c.prototype.setSymbol=function(b,a){this.svgElement&&b instanceof mxLib.Symbol&&(0==a?this.svgElement.attr("marker-start",b.getSvgMarker(this.map.getMapPaneSvg())):1==a?this.svgElement.attr("marker-mid",b.getSvgMarker(this.map.getMapPaneSvg())):2==a&&this.svgElement.attr("marker-end",b.getSvgMarker(this.map.getMapPaneSvg())))};c.prototype.setPath=function(b){this.points=b;this.draw()};c.prototype.getPath=function(){return this.points};c.prototype.setStrokeColor=function(b){b!=this.options.strokeColor&&(this.options.strokeColor=b,this.svgElement&&this.svgElement.attr({stroke:this.options.strokeColor}))};c.prototype.getStrokeColor=function(){return this.options.strokeColor};c.prototype.setStrokeOpacity=function(b){b!=this.options.strokeOpacity&&(this.options.strokeOpacity=b,this.svgElement&&this.svgElement.attr({strokeOpacity:this.options.strokeOpacity}))};c.prototype.getStrokeOpacity=function(){return this.options.strokeOpacity};c.prototype.setStrokeWidth=function(b){b!=this.options.strokeWidth&&(this.options.strokeWidth=b,this.svgElement&&this.svgElement.attr({strokeWidth:b}))};c.prototype.getStrokeWidth=function(){return this.options.strokeWidth};c.prototype.setStrokeStyle=function(b){var a="none";$.isNumeric(b)?a=b:"dashed"==b&&(a=4);a!=this.options.strokeStyle&&(this.options.strokeStyle=a,this.svgElement.attr({"stroke-dasharray":this.options.strokeStyle}))};c.prototype.getStrokeStyle=function(){return this.options.strokeStyle};c.prototype.getBounds=function(){return mxLib.Util.getPointArrayBounds(this.points)};c.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];for(var b=this,a=0;a<this.points.length;a++){var c=new mxLib.Vertex(this.points[a],!1);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];0==a?c.push(b.points[a]):c.push(b.points[a-1]);c.push(b.points[a]);a==b.points.length-1?c.push(b.points[a]):c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.getStrokeColor(),strokeOpacity:0.65,strokeWidth:5,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.setPositionAt(a,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}for(a=0;a<this.points.length-1;a++){var e=new mxLib.Point((this.points[a].x+this.points[a+1].x)/2,(this.points[a].y+this.points[a+1].y)/2),c=new mxLib.Vertex(e,!0);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];c.push(b.points[a]);c.push(e);c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.getStrokeColor(),strokeOpacity:0.65,strokeWidth:5,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.points.splice(a+1,0,this.point),b.setPositionAt(a+1,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}}};c.prototype.disableEditing=function(){if(this.options.enableEditing){this.options.enableEditing=this._bEnableEditing=!1;for(var b=0;b<this.vertexs.length;b++)this.map.removeOverlay(this.vertexs[b]);this.vertexs.length=0}};c.prototype.enableMassClear=function(){this.options.enableMassClear=!0};c.prototype.disableMassClear=function(){this.options.enableMassClear=!1};c.prototype.setPositionAt=function(b,a){0>b||b>=this.points.length||(this.points[b]=a,this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing()),this.draw())};c.prototype.getMap=function(){return this.map};c.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};c.prototype.removeEventListener=function(b,a){this.disableEditing();mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};c.prototype.remove=function(){this.disableEditing();mxLib.Overlay.prototype.remove.call(this)}})();(function(){var c=mxLib.Polygon=function(b,a){a=a||{};this.points=b;this.options={};this.options.strokeColor=a.strokeColor||"blue";this.options.strokeWidth=a.strokeWidth||a.strokeWeight||1;this.options.strokeOpacity=a.strokeOpacity||1;this.options.strokeStyle=a.strokeStyle||"solid";this.options.enableMassClear=!1===a.enableMassClear?!1:!0;this.options.enableEditing=!0===a.enableEditing?!0:!1;this.options.enableClicking=!1===a.enableClicking?!1:!0;this.options.fillColor=a.fillColor||"#fff";this.options.fillOpacity=a.fillOpacity||0.65;this.options.minZoom=a.minZoom||0;this.options.maxZoom=a.maxZoom||0};mxLib.Lang.inherits(c,mxLib.Overlay);c.prototype.initialize=function(b){this.map=b;b=b.getMapPaneSvg();var a="none";$.isNumeric(this.options.strokeStyle)?a=this.options.strokeStyle:"dashed"==this.options.strokeStyle&&(a=4);this.options.strokeStyle=a;this.svgElement=b.polygon().attr({points:this._toPixelPointsString(),stroke:this.options.strokeColor,strokeWidth:this.options.strokeWidth,strokeOpacity:this.options.strokeOpacity,fill:this.options.fillColor,fillOpacity:this.options.fillOpacity,"stroke-dasharray":this.options.strokeStyle});!0==this.options.enableClicking&&this.svgElement.attr({cursor:"pointer"});this.domElement=this.svgElement.node;mxLib.Overlay.prototype.setEventDispath.call(this);this.options.enableEditing?this.enableEditing():this.disableEditing();return this.domElement};c.prototype.getEventPane=function(){return this.map.getPanes().mapPane};c.prototype._toPixelPointsString=function(){for(var b="",a=0;a<this.points.length;a++)var c=this.map.pointToSvgPixel(this.points[a]),b=b+(c.x+","+c.y+" ");return b};c.prototype.snap=function(){return this.svgElement};c.prototype.draw=function(){this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)&&this.svgElement.attr({points:this._toPixelPointsString()})};c.prototype.setSymbol=function(b,a){this.svgElement&&b instanceof mxLib.Symbol&&(0==a?this.svgElement.attr("marker-start",b.getSvgMarker(this.map.getMapPaneSvg())):1==a?this.svgElement.attr("marker-mid",b.getSvgMarker(this.map.getMapPaneSvg())):2==a&&this.svgElement.attr("marker-end",b.getSvgMarker(this.map.getMapPaneSvg())))};c.prototype.setPath=function(b){this.points=b;this.draw()};c.prototype.getPath=function(){return this.points};c.prototype.setStrokeColor=function(b){b!=this.options.strokeColor&&(this.options.strokeColor=b,this.svgElement&&this.svgElement.attr({stroke:this.options.strokeColor}))};c.prototype.getStrokeColor=function(){return this.options.strokeColor};c.prototype.setStrokeOpacity=function(b){b!=this.options.strokeOpacity&&(this.options.strokeOpacity=b,this.svgElement&&this.svgElement.attr({strokeOpacity:this.options.strokeOpacity}))};c.prototype.getStrokeOpacity=function(){return this.options.strokeOpacity};c.prototype.setFillOpacity=function(b){b!=this.options.fillOpacity&&(this.options.fillOpacity=b,this.svgElement&&this.svgElement.attr({fillOpacity:this.options.fillOpacity}))};c.prototype.getFillOpacity=function(){return this.options.fillOpacity};c.prototype.setFillColor=function(b){b!=this.options.fillColor&&(this.options.fillColor=b,this.svgElement&&this.svgElement.attr({fill:this.options.fillColor}))};c.prototype.getFillColor=function(){return this.options.fillColor};c.prototype.setStrokeWidth=function(b){b!=this.options.strokeWidth&&(this.options.strokeWidth=b,this.svgElement&&this.svgElement.attr({strokeWidth:b}))};c.prototype.getStrokeWidth=function(){return this.options.strokeWidth};c.prototype.setStrokeStyle=function(b){var a="none";$.isNumeric(b)?a=b:"dashed"==b&&(a=4);a!=this.options.strokeStyle&&(this.options.strokeStyle=a,this.svgElement.attr({"stroke-dasharray":this.options.strokeStyle}))};c.prototype.getStrokeStyle=function(){return this.options.strokeStyle};c.prototype.getBounds=function(){return mxLib.Util.getPointArrayBounds(this.points)};c.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];for(var b=this,a=0;a<this.points.length;a++){var c=new mxLib.Vertex(this.points[a],!1);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];0==a?c.push(b.points[a]):c.push(b.points[a-1]);c.push(b.points[a]);a==b.points.length-1?c.push(b.points[a]):c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,strokeWidth:b.options.strokeWidth,strokeOpacity:b.options.strokeOpacity,fill:b.options.fillColor,fillOpacity:b.options.fillOpacity,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.setPositionAt(a,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}for(a=0;a<this.points.length-1;a++){var e=new mxLib.Point((this.points[a].x+this.points[a+1].x)/2,(this.points[a].y+this.points[a+1].y)/2),c=new mxLib.Vertex(e,!0);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];c.push(b.points[a]);c.push(e);c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,strokeWidth:b.options.strokeWidth,strokeOpacity:b.options.strokeOpacity,fill:b.options.fillColor,fillOpacity:b.options.fillOpacity,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.points.splice(a+1,0,this.point),b.setPositionAt(a+1,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}}};c.prototype.disableEditing=function(){if(this.options.enableEditing){this.options.enableEditing=this._bEnableEditing=!1;for(var b=0;b<this.vertexs.length;b++)this.map.removeOverlay(this.vertexs[b]);this.vertexs.length=0}};c.prototype.enableMassClear=function(){this.options.enableMassClear=!0};c.prototype.disableMassClear=function(){this.options.enableMassClear=!1};c.prototype.setPositionAt=function(b,a){0>b||b>=this.points.length||(this.points[b]=a,this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing()),this.draw())};c.prototype.getMap=function(){return this.map};c.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};c.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};c.prototype.remove=function(){this.disableEditing();mxLib.Overlay.prototype.remove.call(this)}})();(function(){var c=mxLib.Circle=function(b,a,c){c=c||{};this.center=b;this.radius=a;this.options={};this.options.strokeColor=c.strokeColor||"blue";this.options.strokeWidth=c.strokeWidth||c.strokeWeight||1;this.options.strokeOpacity=c.strokeOpacity||1;this.options.strokeStyle=c.strokeStyle||"solid";this.options.enableMassClear=!1===c.enableMassClear?!1:!0;this.options.enableEditing=!0===c.enableEditing?!0:!1;this.options.enableClicking=!1===c.enableClicking?!1:!0;this.options.fillColor=c.fillColor||"#fff";this.options.fillOpacity=c.fillOpacity||0.65;this.options.minZoom=c.minZoom||0;this.options.maxZoom=c.maxZoom||0};mxLib.Lang.inherits(c,mxLib.Overlay);c.prototype.initialize=function(b){this.map=b;b=b.getMapPaneSvg();var a="none";$.isNumeric(this.options.strokeStyle)?a=this.options.strokeStyle:"dashed"==this.options.strokeStyle&&(a=4);this.options.strokeStyle=a;var a=this.map.pointToSvgPixel(this.center),c=this.map.pointDistToPixelDist(this.radius);this.svgElement=b.circle(a.x,a.y,c).attr({stroke:this.options.strokeColor,strokeWidth:this.options.strokeWidth,strokeOpacity:this.options.strokeOpacity,fill:this.options.fillColor,fillOpacity:this.options.fillOpacity,"stroke-dasharray":this.options.strokeStyle});!0==this.options.enableClicking&&this.svgElement.attr({cursor:"pointer"});this.domElement=this.svgElement.node;mxLib.Overlay.prototype.setEventDispath.call(this);this.options.enableEditing?this.enableEditing():this.disableEditing();return this.domElement};c.prototype.getEventPane=function(){return this.map.getPanes().mapPane};c.prototype.snap=function(){return this.svgElement};c.prototype.draw=function(){if(this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom,this.vertexs)){var b=this.map.pointToSvgPixel(this.center),a=this.map.pointDistToPixelDist(this.radius);this.svgElement.attr({cx:b.x,cy:b.y,r:a})}};c.prototype.setCenter=function(b){this.center=b;this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing());this.draw()};c.prototype.getCenter=function(){return this.center};c.prototype.setRadius=function(b){this.radius=b;this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing());this.draw()};c.prototype.getRadius=function(){return this.radius};c.prototype.setStrokeColor=function(b){b!=this.options.strokeColor&&(this.options.strokeColor=b,this.svgElement&&this.svgElement.attr({stroke:this.options.strokeColor}))};c.prototype.getStrokeColor=function(){return this.options.strokeColor};c.prototype.setFillOpacity=function(b){b!=this.options.fillOpacity&&(this.options.fillOpacity=b,this.svgElement&&this.svgElement.attr({fillOpacity:this.options.fillOpacity}))};c.prototype.getFillOpacity=function(){return this.options.fillOpacity};c.prototype.setFillColor=function(b){b!=this.options.fillColor&&(this.options.fillColor=b,this.svgElement&&this.svgElement.attr({fill:this.options.fillColor}))};c.prototype.getFillColor=function(){return this.options.fillColor};c.prototype.setStrokeOpacity=function(b){b!=this.options.strokeOpacity&&(this.options.strokeOpacity=b,this.svgElement&&this.svgElement.attr({strokeOpacity:this.options.strokeOpacity}))};c.prototype.getStrokeOpacity=function(){return this.options.strokeOpacity};c.prototype.setStrokeWidth=function(b){b!=this.options.strokeWidth&&(this.options.strokeWidth=b,this.svgElement&&this.svgElement.attr({strokeWidth:b}))};c.prototype.getStrokeWidth=function(){return this.options.strokeWidth};c.prototype.setStrokeStyle=function(b){var a="none";$.isNumeric(b)?a=b:"dashed"==b&&(a=4);a!=this.options.strokeStyle&&(this.options.strokeStyle=a,this.svgElement.attr({"stroke-dasharray":this.options.strokeStyle}))};c.prototype.getStrokeStyle=function(){return this.options.strokeStyle};c.prototype.getBounds=function(){return mxLib.Util.getPointArrayBounds(this.points)};c.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];var b=this,a=new mxLib.Vertex(this.center,!1);this.map.addOverlay(a);this.vertexs.push(a);a.addEventListener("ondragging",function(){this._tempCircle?this._tempCircle.setCenter(this.point):(this._tempCircle=new mxLib.Circle(b.center,b.radius,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,strokeWidth:b.options.strokeWidth,strokeOpacity:b.options.strokeOpacity,fill:b.options.fillColor,fillOpacity:b.options.fillOpacity,strokeStyle:10}),b.map.addOverlay(this._tempCircle))});a.addEventListener("ondragend",function(){this._tempCircle&&(b.setCenter(this.point),b.map.removeOverlay(this._tempCircle),this._tempCircle=null)});vertexRadius=new mxLib.Vertex(new mxLib.Point(this.center.x+this.radius,this.center.y),!1);this.map.addOverlay(vertexRadius);this.vertexs.push(vertexRadius);vertexRadius.addEventListener("ondragging",function(){this._tempCircle?this._tempCircle.setRadius(this.point.distanceTo(b.center)):(this._tempCircle=new mxLib.Circle(b.center,b.radius,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,strokeWidth:b.options.strokeWidth,strokeOpacity:b.options.strokeOpacity,fill:b.options.fillColor,fillOpacity:b.options.fillOpacity,strokeStyle:10}),b.map.addOverlay(this._tempCircle))});vertexRadius.addEventListener("ondragend",function(){this._tempCircle&&(b.setRadius(this.point.distanceTo(b.center)),b.map.removeOverlay(this._tempCircle),this._tempCircle=null)})}};c.prototype.disableEditing=function(){if(this.options.enableEditing){this.options.enableEditing=this._bEnableEditing=!1;for(var b=0;b<this.vertexs.length;b++)this.map.removeOverlay(this.vertexs[b]);this.vertexs.length=0}};c.prototype.enableMassClear=function(){this.options.enableMassClear=!0};c.prototype.disableMassClear=function(){this.options.enableMassClear=!1};c.prototype.getMap=function(){return this.map};c.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};c.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};c.prototype.remove=function(){this.disableEditing();mxLib.Overlay.prototype.remove.call(this)}})();(function(){var c=mxLib.PointCollection=function(b,a,c){this.points=b;this.symbol=a;this.options=c=c||{};this.options.listenMoveEvent=!1===c.listenMoveEvent?!1:!0;this.options.listenClickEvent=!1===c.listenClickEvent?!1:!0;this.options.minZoom=c.minZoom||0;this.options.maxZoom=c.maxZoom||0};mxLib.Lang.inherits(c,mxLib.Overlay);c.prototype.initialize=function(b){this.map=b;var a=document.createElement("canvas");a.style.cssText="position: absolute; left: 0; top: 0;pointer-events:none";var c=b.getSize();a.width=c.width;a.height=c.height;b.getPanes().mapPane.appendChild(a);this.createCache();this.domElement=a;this.drawPointIndexs=[];this.drawPixels=[];this.curPointIndex=null;this._setEventDispath();return a};c.prototype.getEventPane=function(){return this.map.getPanes().mapPane};c.prototype._setEventDispath=function(){function b(b){b=window.event||b;b=new mxLib.Pixel(b.pageX||b.clientX||0,b.pageY||b.clientY||0);var c=a.map.pixelToPoint(b);return{pixel:b,point:c}}var a=this,c=a.map.container.style.cursor;this.options.listenClickEvent&&this.map.addEventListener("mouseup",this._clickFunc=function(c){if(1!=c.button)for(var k=c.clientX||c.x,g=c.clientY||c.y,f=a.symbol.getSize(),l=b(c),m=0;m<a.drawPixels.length;m++)if(k>=a.drawPixels[m].x-f.width/2&&k<=a.drawPixels[m].x+f.width/2&&g>=a.drawPixels[m].y-f.height/2&&g<=a.drawPixels[m].y+f.height/2){0==c.button?mxLib.Util.dispatchEvent(a,"click",{point:l.point,pixel:l.pixel,index:m}):2==c.button&&mxLib.Util.dispatchEvent(a,"rightclick",{point:l.point,pixel:l.pixel,index:m});break}});this.options.listenMoveEvent&&this.map.addEventListener("mousemove",this._mousemoveFunc=function(e){var h=e.clientX||e.x,g=e.clientY||e.y;if(!a.map.isDragging){var f=a.symbol.getSize();e=b(e);for(var l=!1,m=0;m<a.drawPixels.length;m++)if(h>=a.drawPixels[m].x-f.width/2&&h<=a.drawPixels[m].x+f.width/2&&g>=a.drawPixels[m].y-f.height/2&&g<=a.drawPixels[m].y+f.height/2){a.map.container.style.cursor="pointer";l=!0;a.curPointIndex!=m&&(mxLib.Util.dispatchEvent(a,"mouseover",{point:e.point,pixel:e.pixel,index:m}),a.curPointIndex&&mxLib.Util.dispatchEvent(a,"mouseout",{point:e.point,pixel:e.pixel,index:a.curPointIndex}),a.curPointIndex=m);break}l||(a.map.container.style.cursor=c,a.curPointIndex&&(mxLib.Util.dispatchEvent(a,"mouseout",{point:e.point,pixel:e.pixel,index:a.curPointIndex}),a.curPointIndex=null))}})};c.prototype.remove=function(){mxLib.Overlay.prototype.remove.call(this);this.map.removeEventListener("mousemove",this._mousemoveFunc);this.map.removeEventListener("click",this._clickFunc)};c.prototype.createCache=function(){this.cacheCanvas=document.createElement("canvas");this._drawBegin=!1;if(this.symbol instanceof mxLib.Icon){var b=this;this.symbol.draw(this.cacheCanvas,null,function(){b.symbol.draw(b.cacheCanvas);b._drawBegin=!0;b.draw()})}else this.symbol.draw(this.cacheCanvas),this._drawBegin=!0};c.prototype.draw=function(){mxLib.Overlay.prototype.draw.call(this);if(this.domElement&&this.domElement.getContext("2d")&&this.cacheCanvas&&this._drawBegin&&(this.domElement.getContext("2d").clearRect(0,0,this.domElement.width,this.domElement.height),this.map.curZoomInRange(this.options.minZoom,this.options.maxZoom))){var b=this.map.getBounds(!1),a=this.symbol.getAnchor(),c=this.domElement.getContext("2d");this.drawPointIndexs.length=0;for(var e=this.drawPixels.length=0;e<this.points.length;e++)if(b.containsPoint(this.points[e])){var h=this.map.pointToPixel(this.points[e]);c.drawImage(this.cacheCanvas,h.x-a.width,h.y-a.height);this.drawPointIndexs.push(e);this.drawPixels.push(h)}}};c.prototype.setPoints=function(b){this.points=b;this.draw()};c.prototype.setSymbol=function(b){this.symbol=b;this.createCache();this.draw()};c.prototype.clear=function(){this.points.length=0;this.draw()};c.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};c.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)}})();(function(){var c=mxLib.Hotspot=function(b,a){this.position=b;a=a||{};a.text=a.text||"";this.offsets=a.offsets=a.offsets||[5,5,5,5];a.minZoom=a.minZoom||0;a.maxZoom=a.maxZoom||0;this.options=a};c.prototype.initialize=function(b){this.map=b};c.prototype.setPosition=function(b){this.position=b};c.prototype.getPosition=function(){return this.position};c.prototype.setText=function(b){this.options.text=b};c.prototype.getText=function(){return this.options.text};c.prototype.setUserData=function(b){this.options.userData=b};c.prototype.getUserData=function(){return this.options.userData}})();(function(){function c(a){$("#"+a.id+" .zoomNoScale").each(function(b){(b=$(this).attr("transformOrigin"))?$(this).css("-webkit-transform-origin",b):$(this).css("-webkit-transform-origin","50% 50%");$(this).css("-webkit-transform","scale("+a.scaleRatio+")")})}var b=mxLib.VectorLayer=function(a,b,c){this.src=a;this.bounds=b;c=c||{};this.src&&""!=this.src||(this.bNewVectorLayer=!0,this.mapSvgRatio=1);1==arguments.length&&"object"==$.type(a)&&(c=a,this.bNewVectorLayer=!0,this.mapSvgRatio=1);this.options=c;this.options.minZoom=c.minZoom||0;this.options.maxZoom=c.maxZoom||0};mxLib.Lang.inherits(b,mxLib.Overlay);b.prototype.initialize=function(a){this.map=a;if(this.bNewVectorLayer){this.mapSvgRatio=a.getBounds(!0).width/1024;var b=document.createElementNS("http://www.w3.org/2000/svg","svg");this.id=mxLib.Util.createUniqueID("vl_new_");b.id=this.id;b.style.position="absolute";var e=$(a.container).width()+2*a.mapPaneSvgExtendPixel,h=$(a.container).height()+2*a.mapPaneSvgExtendPixel,g=-a.mapPaneSvgExtendPixel,f=-a.mapPaneSvgExtendPixel;b.style.width=e+"px";b.style.height=h+"px";b.style.top=g+"px";b.style.left=f+"px";$(a.getPanes().vectorLayer).append($(b));this.embedElement=this.domElement=b;this.setOpacity(this.options.Opacity);this.updateWidthHeight();this.updateViewBox();c(this);var l=this;a.addEventListener("resize",this.updateWidthHeightFun=function(){l.updateWidthHeight();l.updateViewBox()});!1===this.options.embedEvents&&this.setEmbedEvent(!1);return b}this.id=mxLib.Util.createUniqueID("vl_");var b=a.pointToPixel(this.bounds.getLeftTop()),e=a.pointDistToPixelDist(this.bounds.width),h=a.pointDistToPixelDist(this.bounds.height),e=mxLib.Util.stringFormat("\x3cdiv  id \x3d '{0}' style\x3d'position:absolute;left:{1}px;top:{2}px;width:{3}px;height:{4}px'\x3e\x3cembed src\x3d'{5}'  wmode\x3d'transparent' style\x3d'position:absolute;left:0px;top:0px;width:100%;height:100%'/\x3e\x3c/div\x3e",this.id,b.x,b.y,e,h,this.src),e=$(e);$(a.getPanes().vectorLayer).append(e);this.domElement=e[0];this.embedElement=e.children("embed")[0];this.setOpacity(this.options.Opacity);!1===this.options.embedEvents&&this.setEmbedEvent(!1);mxLib.Overlay.prototype.setEventDispath.call(this);var m=this;this.embedElement.addEventListener&&this.embedElement.addEventListener("load",function(){m._snap=null;mxLib.Util.dispatchEvent(m,"load",{overlay:m});if(mxLib.Util.isLowerVersion()){var a=m.map.pointDistToPixelDist(m.bounds.width),b=m.map.pointDistToPixelDist(m.bounds.height),c=m.snap();c&&c.attr({width:a+"px",height:b+"px"})}(m.options.autoWidth||m.options.autoHeight)&&m.fitBounds(m.options.autoWidth)},!1);return e[0]};b.prototype.remove=function(){this.bNewVectorLayer&&this.updateWidthHeightFun&&map.removeEventListener("resize",this.updateWidthHeightFun);mxLib.Overlay.prototype.remove.call(this)};b.prototype.updateWidthHeight=function(){if(this.domElement){var a=$(this.map.container).width()+2*this.map.mapPaneSvgExtendPixel,b=$(this.map.container).height()+2*this.map.mapPaneSvgExtendPixel;this.snap().attr({width:a,height:b});this.domElement.style.width=a+"px";this.domElement.style.height=b+"px"}};b.prototype.updateViewBox=function(){if(this.bNewVectorLayer){var a=$(this.map.container).width()+2*this.map.mapPaneSvgExtendPixel,b=$(this.map.container).height()+2*this.map.mapPaneSvgExtendPixel,c=-this.map.mapPaneSvgExtendPixel,h=-this.map.mapPaneSvgExtendPixel,g=this.map.pixelToPoint(new mxLib.Pixel(c,h)),h=this.map.pixelToPoint(new mxLib.Pixel(c+a,h+b)),f=this.map.getBounds(!0).getLeftTop();this.ptMapLeftTop=f;var l,b=g.x-f.x,g=f.y-g.y,c=h.x-f.x;l=f.y-h.y;b/=this.mapSvgRatio;g/=this.mapSvgRatio;c/=this.mapSvgRatio;l/=this.mapSvgRatio;h=0+b;f=0+g;b=c-b;g=l-g;this.scaleRatio=b/a;this.snap().attr("viewBox",h+" "+f+" "+b+" "+g)}};b.prototype.svgMapPoint=function(a){var b=[],c=!1;a instanceof mxLib.Point?b.push(a):$.isArray(a)?(b=a,2<=arguments.length&&!0===arguments[1]&&(c=!0)):$.isNumeric(a)&&(px=arguments[0],py=arguments[1],b.push(new mxLib.Point(px,py)));this.ptMapLeftTop||(this.ptMapLeftTop=this.map.getBounds(!0).getLeftTop());var h="";1<b.length&&c&&(h="M");for(var g=0;g<b.length;g++)0!=g&&(h+=",",c&&(h+="L")),h=h+(b[g].x-this.ptMapLeftTop.x)/this.mapSvgRatio+","+(this.ptMapLeftTop.y-b[g].y)/this.mapSvgRatio;return h};b.prototype.fromMapPoint=function(a){if(!this.bNewVectorLayer)return null;var b,c;1==arguments.length&&a instanceof mxLib.Point?(b=a.x,c=a.y):2==arguments.length&&(b=arguments[0],c=arguments[1]);this.ptMapLeftTop||(this.ptMapLeftTop=this.map.getBounds(!0).getLeftTop());return new mxLib.Point((b-this.ptMapLeftTop.x)/this.mapSvgRatio,(this.ptMapLeftTop.y-c)/this.mapSvgRatio)};b.prototype.fromMapDist=function(a){return a/this.mapSvgRatio};b.prototype.toMapPoint=function(a){if(!this.bNewVectorLayer)return null;this.ptMapLeftTop||(this.ptMapLeftTop=this.map.getBounds(!0).getLeftTop());var b,c;1==arguments.length&&a instanceof mxLib.Point?(b=a.x,c=a.y):2==arguments.length&&(b=arguments[0],c=arguments[1]);return new mxLib.Point(b*this.mapSvgRatio+this.ptMapLeftTop.x,this.ptMapLeftTop.y-c*this.mapSvgRatio)};b.prototype.toMapDist=function(a){return a*this.mapSvgRatio};b.prototype.draw=function(){if(this.curZoomInRange(this.options.minZoom,this.options.maxZoom)&&this.isVisible())if(this.bNewVectorLayer)this.updateViewBox(),0<arguments.length&&!0===arguments[0]&&this.scaleRatio&&c(this);else{var a=this.map.pointToPixel(this.bounds.getLeftTop()),b=this.map.pointDistToPixelDist(this.bounds.width),e=this.map.pointDistToPixelDist(this.bounds.height);$(this.domElement).offset({left:a.x,top:a.y});$(this.domElement).width(b);$(this.domElement).height(e);mxLib.Util.isLowerVersion()&&(a=this.snap())&&a.attr({width:b+"px",height:e+"px"})}};b.prototype.setOpacity=function(a){a&&this.domElement&&$(this.domElement).css("opacity",a)};b.prototype.getSVGDocument=function(){return this.embedElement?this.bNewVectorLayer?this.embedElement:this.embedElement.getSVGDocument():null};b.prototype.getEmbedElement=function(){return this.embedElement};b.prototype.setEmbedEvent=function(a){this.embedElement&&$(this.embedElement).css("pointer-events",a?"":"none")};b.prototype.getBounds=function(){return this.bounds};b.prototype.setBounds=function(a){this.bounds=a};b.prototype.getLeftTopPoint=function(){return this.bounds.getLeftTop()};b.prototype.setLeftTopPoint=function(a){this.bounds=new mxLib.Bounds(a.x,a.y,a.x+this.bounds.width,a.y-this.bounds.height)};b.prototype.snap=function(){if(!this.domElement)return null;if(this._snap)return this._snap;if(this.bNewVectorLayer)this._snap=Snap("#"+this.id);else{var a=null;this.getSVGDocument()&&(a=this.getSVGDocument().getElementsByTagName("svg"));a&&0<a.length&&(this._snap=Snap(a[0]))}return this._snap};b.prototype.getEventPane=function(){return this.map.getPanes().vectorLayer};b.prototype.getDragPoint=function(){return this.getLeftTopPoint()};b.prototype.setDragPoint=function(a){return this.setLeftTopPoint(a)};b.prototype.fitBounds=function(a){a?(this.options.autoHeight=!1,this.options.autoWidth=!0):(this.options.autoHeight=!0,this.options.autoWidth=!1);if(this.snap()){a=this.snap().attr("width");var b=this.snap().attr("height");a=mxLib.Util.getValueOfNoPX(a);b=mxLib.Util.getValueOfNoPX(b);if(this.options.autoWidth)var c=this.getLeftTopPoint(),h=this.bounds.height,g=a*h/b;else c=this.getLeftTopPoint(),g=this.bounds.width,h=b*g/a;this.bounds=new mxLib.Bounds(c.x,c.y,c.x+g,c.y-h);this.draw()}}})();(function(c){function b(b){function f(a){var e=[];a.addClass("mx-menu");e.push(a);a.hasClass("mx-menu-content")||a.children("div").each(function(){var a=c(this).children("div");a.length&&(a.insertAfter(b),this.submenu=a,a=f(a),e=e.concat(a))});return e}function g(f){var h=mxLib.Util.parseOptions(f[0],["width","height"]);f[0].originalHeight=h.height||0;f.hasClass("mx-menu-content")?f[0].originalWidth=h.width||f.outerWidth():(f[0].originalWidth=h.width||0,f.children("div").each(function(){var a=c(this),f=c.extend({},mxLib.Util.parseOptions(this,["name","iconCls","href",{separator:"boolean"}]),{disabled:a.attr("disabled")?!0:void 0});f.separator&&a.addClass("mx-menu-sep");if(!a.hasClass("mx-menu-sep")){a[0].itemName=f.name||"";a[0].itemHref=f.href||"";var k=a.addClass("mx-menu-item").html();a.empty().append(c('\x3cdiv class\x3d"mx-menu-text"\x3e\x3c/div\x3e').html(k));f.iconCls&&c('\x3cdiv class\x3d"mx-menu-icon"\x3e\x3c/div\x3e').addClass(f.iconCls).appendTo(a);f.disabled&&m(b,a[0],!0);a[0].submenu&&c('\x3cdiv class\x3d"mx-menu-rightarrow"\x3e\x3c/div\x3e').appendTo(a);e(b,a)}}),c('\x3cdiv class\x3d"mx-menu-line"\x3e\x3c/div\x3e').prependTo(f));a(b,f);f.hide();k(b,f)}c(b).appendTo("body");c(b).addClass("mx-menu-top");c(document).unbind(".mx-menu").bind("mousedown.menu",function(a){c(a.target).closest("div.mx-menu,div.combo-p").length||c("body\x3ediv.mx-menu-top:visible").mxMenu("hide")});for(var h=f(c(b)),l=0;l<h.length;l++)g(h[l])}function a(a,b){var e=c.data(a,"menu").options,f=b.attr("style")||"";b.css({display:"block",left:-1E4,height:"auto",overflow:"hidden"});var k=b[0],g=k.originalWidth||0;g||(g=0,b.find("div.mx-menu-text").each(function(){g<c(this).outerWidth()&&(g=c(this).outerWidth());c(this).closest("div.mx-menu-item").outerHeight(c(this).outerHeight()+2)}),g+=40);var g=Math.max(g,e.minWidth),h=k.originalHeight||0;if(!h)if(h=b.outerHeight(),b.hasClass("mx-menu-top")&&e.alignTo)var l=c(e.alignTo),e=l.offset().top-c(document).scrollTop(),l=c(window).outerHeight()+c(document).scrollTop()-l.offset().top-l.outerHeight(),h=Math.min(h,Math.max(e,l));else h>c(window).outerHeight()?(h=c(window).height(),f+=";overflow:auto"):f+=";overflow:hidden";e=Math.max(k.originalHeight,b.outerHeight())-2;b.outerWidth(g).outerHeight(h);b.children("div.mx-menu-line").outerHeight(e);f+=";width:"+k.style.width+";height:"+k.style.height;b.attr("style",f)}function k(a,b){var e=c.data(a,"menu");b.unbind(".mx-menu").bind("mouseenter.mx-menu",function(){e.timer&&(clearTimeout(e.timer),e.timer=null)}).bind("mouseleave.mx-menu",function(){e.options.hideOnUnhover&&(e.timer=setTimeout(function(){h(a)},e.options.duration))})}function e(a,b){b.hasClass("mx-menu-item")&&(b.unbind(".mx-menu"),b.bind("click.mx-menu",function(){if(!c(this).hasClass("mx-menu-item-disabled")){if(!this.submenu){h(a);var b=this.itemHref;b&&(location.href=b)}b=c(a).mxMenu("getItem",this);c.data(a,"menu").options.onClick.call(a,b)}}).bind("mouseenter.menu",function(e){b.siblings().each(function(){this.submenu&&f(this.submenu);c(this).removeClass("mx-menu-active")});b.addClass("mx-menu-active");c(this).hasClass("mx-menu-item-disabled")?b.addClass("mx-menu-active-disabled"):(e=b[0].submenu)&&c(a).mxMenu("show",{menu:e,parent:b})}).bind("mouseleave.menu",function(a){b.removeClass("mx-menu-active mx-menu-active-disabled");var c=b[0].submenu;c?a.pageX>=parseInt(c.css("left"))?b.addClass("mx-menu-active"):f(c):b.removeClass("mx-menu-active")}))}function h(a){var b=c.data(a,"menu");b&&c(a).is(":visible")&&(f(c(a)),b.options.onHide.call(a));return!1}function g(a,b){function e(a,b){a+g.outerHeight()>c(window).outerHeight()+c(document).scrollTop()&&(a=b?c(b).offset().top-g.outerHeight():c(window).outerHeight()+c(document).scrollTop()-g.outerHeight());0>a&&(a=0);return a}var f,k;b=b||{};var g=c(b.menu||a);c(a).mxMenu("resize",g[0]);if(g.hasClass("mx-menu-top")){var h=c.data(a,"menu").options;c.extend(h,b);f=h.left;k=h.top;if(h.alignTo){var l=c(h.alignTo);f=l.offset().left;k=l.offset().top+l.outerHeight();"right"==h.align&&(f+=l.outerWidth()-g.outerWidth())}f+g.outerWidth()>c(window).outerWidth()+c(document).scrollLeft()&&(f=c(window).outerWidth()+c(document).scrollLeft()-g.outerWidth()-5);0>f&&(f=0);k=e(k,h.alignTo)}else k=b.parent,f=k.offset().left+k.outerWidth()-2,f+g.outerWidth()+5>c(window).outerWidth()+c(document).scrollLeft()&&(f=k.offset().left-g.outerWidth()+2),k=e(k.offset().top-3);g.css({left:f,top:k});g.show(0,function(){g[0].shadow||(g[0].shadow=c('\x3cdiv class\x3d"mx-menu-shadow"\x3e\x3c/div\x3e').insertAfter(g));g[0].shadow.css({display:"block",zIndex:c.fn.mxMenu.defaults.zIndex++,left:g.css("left"),top:g.css("top"),width:g.outerWidth(),height:g.outerHeight()});g.css("z-index",c.fn.mxMenu.defaults.zIndex++);g.hasClass("mx-menu-top")&&c.data(g[0],"menu").options.onShow.call(g[0])})}function f(a){function b(a){a.stop(!0,!0);a[0].shadow&&a[0].shadow.hide();a.hide()}a&&(b(a),a.find("div.mx-menu-item").each(function(){this.submenu&&f(this.submenu);c(this).removeClass("mx-menu-active")}))}function l(a,b){function e(k){k.children("div.mx-menu-item").each(function(){var k=c(a).mxMenu("getItem",this),h=g.empty().html(k.text).text();b==c.trim(h)?f=k:this.submenu&&!f&&e(this.submenu)})}var f=null,g=c("\x3cdiv\x3e\x3c/div\x3e");e(c(a));g.remove();return f}function m(a,b,e){a=c(b);a.hasClass("mx-menu-item")&&(e?(a.addClass("mx-menu-item-disabled"),b.onclick&&(b.onclick1=b.onclick,b.onclick=null)):(a.removeClass("mx-menu-item-disabled"),b.onclick1&&(b.onclick=b.onclick1,b.onclick1=null)))}function q(b,f){var g=c(b);f.parent&&(f.parent.submenu||(g=c('\x3cdiv class\x3d"mx-menu"\x3e\x3cdiv class\x3d"mx-menu-line"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo("body"),g.hide(),f.parent.submenu=g,c('\x3cdiv class\x3d"mx-menu-rightarrow"\x3e\x3c/div\x3e').appendTo(f.parent)),g=f.parent.submenu);if(f.separator)var h=c('\x3cdiv class\x3d"mx-menu-sep"\x3e\x3c/div\x3e').appendTo(g);else h=c('\x3cdiv class\x3d"mx-menu-item"\x3e\x3c/div\x3e').appendTo(g),c('\x3cdiv class\x3d"mx-menu-text"\x3e\x3c/div\x3e').html(f.text).appendTo(h);f.iconCls&&c('\x3cdiv class\x3d"mx-menu-icon"\x3e\x3c/div\x3e').addClass(f.iconCls).appendTo(h);f.id&&h.attr("id",f.id);f.name&&(h[0].itemName=f.name);f.href&&(h[0].itemHref=f.href);f.onclick&&("string"==typeof f.onclick?h.attr("onclick",f.onclick):h[0].onclick=eval(f.onclick));f.handler&&(h[0].onclick=eval(f.handler));f.disabled&&m(b,h[0],!0);e(b,h);k(b,g);a(b,g)}function n(b,e){function f(a){if(a.submenu){a.submenu.children("div.mx-menu-item").each(function(){f(this)});var b=a.submenu[0].shadow;b&&b.remove();a.submenu.remove()}c(a).remove()}var g=c(e).parent();f(e);a(b,g)}function r(b,e,f){var g=c(e).parent();f?c(e).show():c(e).hide();a(b,g)}function s(a){c(a).children("div.mx-menu-item").each(function(){n(a,this)});a.shadow&&a.shadow.remove();c(a).remove()}c.fn.mxMenu=function(a,e){if("string"==typeof a)return c.fn.mxMenu.methods[a](this,e);a=a||{};return this.each(function(){var e=c.data(this,"menu");e?c.extend(e.options,a):(e=c.data(this,"menu",{options:c.extend({},c.fn.mxMenu.defaults,c.fn.mxMenu.parseOptions(this),a)}),b(this));c(this).css({left:e.options.left,top:e.options.top})})};c.fn.mxMenu.methods={options:function(a){return c.data(a[0],"menu").options},show:function(a,b){return a.each(function(){g(this,b)})},hide:function(a){return a.each(function(){h(this)})},destroy:function(a){return a.each(function(){s(this)})},setText:function(a,b){return a.each(function(){c(b.target).children("div.mx-menu-text").html(b.text)})},setIcon:function(a,b){return a.each(function(){c(b.target).children("div.mx-menu-icon").remove();b.iconCls&&c('\x3cdiv class\x3d"mx-menu-icon"\x3e\x3c/div\x3e').addClass(b.iconCls).appendTo(b.target)})},getItem:function(a,b){var e=c(b),f={target:b,id:e.attr("id"),text:c.trim(e.children("div.mx-menu-text").html()),disabled:e.hasClass("mx-menu-item-disabled"),name:b.itemName,href:b.itemHref,onclick:b.onclick},g=e.children("div.mx-menu-icon");if(g.length){for(var e=[],g=g.attr("class").split(" "),k=0;k<g.length;k++)"mx-menu-icon"!=g[k]&&e.push(g[k]);f.iconCls=e.join(" ")}return f},findItem:function(a,b){return l(a[0],b)},appendItem:function(a,b){return a.each(function(){q(this,b)})},removeItem:function(a,b){return a.each(function(){n(this,b)})},enableItem:function(a,b){return a.each(function(){m(this,b,!1)})},disableItem:function(a,b){return a.each(function(){m(this,b,!0)})},showItem:function(a,b){return a.each(function(){r(this,b,!0)})},hideItem:function(a,b){return a.each(function(){r(this,b,!1)})},resize:function(b,e){return b.each(function(){a(this,c(e))})}};c.fn.mxMenu.parseOptions=function(a){return c.extend({},mxLib.Util.parseOptions(a,[{minWidth:"number",duration:"number",hideOnUnhover:"boolean"}]))};c.fn.mxMenu.defaults={zIndex:11E4,left:0,top:0,alignTo:null,align:"left",minWidth:120,duration:100,hideOnUnhover:!0,onShow:function(){},onHide:function(){},onClick:function(a){}}})(jQuery);(function(){mxLib.MenuItem=function(b,a,c,e){this.text=b;this.icon=a;this.parent=c;this.callback=e};var c=mxLib.ContextMenu=function(b){this.menuItems=[];this.refCnt=0};c.prototype.addRef=function(){this.refCnt+=1};c.prototype.releaseRef=function(){this.refCnt-=1;0==this.refCnt&&this.destroy()};c.prototype.initialize=function(b){this.map=b;this.addRef();if(!this.menuDiv){this.menuDiv=b.createContextMenu();for(b=0;b<this.menuItems.length;b++)this.menuItems[b].parent||(this.appendItem(this.menuItems[b],!0),!1===this.menuItems[b].enable&&this.disableItem(this.menuItems[b].text),!1===this.menuItems[b].show&&this.hideItem(this.menuItems[b].text),!0===this.menuItems[b].check&&this.checkItem(this.menuItems[b].text));for(b=0;b<this.menuItems.length;b++)this.menuItems[b].parent&&(this.appendItem(this.menuItems[b],!0),!1===this.menuItems[b].enable&&this.disableItem(this.menuItems[b].text),!1===this.menuItems[b].show&&this.hideItem(this.menuItems[b].text),!0===this.menuItems[b].check&&this.checkItem(this.menuItems[b].text))}};c.prototype.show=function(b){this.menuDiv&&$(this.menuDiv).mxMenu("show",{left:b.x,top:b.y})};c.prototype.hide=function(){this.menuDiv&&$(this.menuDiv).mxMenu("hide")};c.prototype.destroy=function(){this.menuDiv&&($(this.menuDiv).mxMenu("destroy"),this.menuDiv=0)};c.prototype.findItem=function(b){return $(this.menuDiv).mxMenu("findItem",b)};c.prototype.setText=function(b,a){var c=this.findItem(b);$(this.menuDiv).mxMenu("setText",{target:c.target,text:a})};c.prototype.setIcon=function(b,a){if(a){var c=this.findItem(b),e=this.getItem(b);-1<e&&(this.menuItems[e].icon=a);e=mxLib.Util.createUniqueID("menuIcon");$(this.menuDiv).mxMenu("setIcon",{target:c.target,iconCls:e});$("."+e).css("background","transparent url('"+a+"') no-repeat scroll center center");$("."+e).removeClass(e)}};c.prototype.appendItem=function(b,a){a||this.menuItems.push(b);if(this.menuDiv){var c=b.parent;c?(c=this.findItem(c),$(this.menuDiv).mxMenu("appendItem",{parent:c.target,text:b.text,onclick:b.callback})):$(this.menuDiv).mxMenu("appendItem",{text:b.text,onclick:b.callback});b.icon&&this.setIcon(b.text,b.icon)}};c.prototype.getItem=function(b){for(var a=0;a<this.menuItems.length;a++)if(this.menuItems[a].text==b)return a;return-1};c.prototype.removeItem=function(b){var a=this.getItem(b);-1<a&&this.menuItems.splice(a,1);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("removeItem",b.target))};c.prototype.checkItem=function(b){var a=this.getItem(b);if(!(0>a)){this.menuItems[a].check=!0;var c=this.menuItems[a].icon;this.setIcon(b,scriptBaseDir+"mxImg/icon_check.png");this.menuItems[a].icon=c}};c.prototype.unCheckItem=function(b){var a=this.getItem(b);if(!(0>a)){this.menuItems[a].check=!1;var c=this.menuItems[a].icon;c?this.setIcon(b,c):this.setIcon(b,scriptBaseDir+"mxImg/blank.gif");this.menuItems[a].icon=c}};c.prototype.enableItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].enable=!0);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("enableItem",b.target))};c.prototype.disableItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].enable=!1);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("disableItem",b.target))};c.prototype.showItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].show=!0);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("showItem",b.target))};c.prototype.hideItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].show=!1);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("hideItem",b.target))}})();(function(){var c=mxLib.Command=function(b,a,c){this.cmdName=b;this.parentCmd=a;this.options=c||{}};mxLib.lang.inherits(mxLib.Command,mxLib.lang.Class,"Command");c.prototype.start=function(b){this.map=b;this.result={};mxLib.Util.dispatchEvent(this,"start",{command:this})};c.prototype.end=function(b){this.map&&this.map.endCommand(this,b);this.parentCmd&&this.parentCmd.retCmd(this,this.cmdName,this.result,b);mxLib.Util.dispatchEvent(this,"end",{command:this,cancel:b})};c.prototype.retCmd=function(b,a,c,e){mxLib.Util.dispatchEvent(this,"retCmd",{command:this,name:a,retCommand:b,result:c,cancel:e})};c.prototype.leftMousedown=function(b,a){};c.prototype.leftMouseup=function(b,a){};c.prototype.mousemove=function(b,a){};c.prototype.rightMousedown=function(b,a){};c.prototype.rightMouseup=function(b,a){};c.prototype.click=function(b,a){};c.prototype.dblclick=function(b,a){};c.prototype.keydown=function(b,a){};c.prototype.keyup=function(b,a){};c.prototype.keypress=function(b,a){};c.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};c.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)}})();(function(){var c=mxLib.SelEntityCmd=function(b,a,c){mxLib.Command.prototype.constructor.call(this,b,a,c);this.options.showToolbar=!1===this.options.showToolbar?!1:!0;this.options.showRightMenu=!1===this.options.showRightMenu?!1:!0};mxLib.Lang.inherits(c,mxLib.Command);c.prototype.start=function(b){mxLib.Command.prototype.start.call(this,b);this.options.tip&&mxLib.Util.toastInfo(this.options.tip,{delay:3E3});var a=this;if(this.options.showToolbar){var c=new mxLib.LinkButtonGroupControl([{text:"\u786e\u5b9a\u9009\u62e9",colorIndex:1,callback:function(){a.end(!1)}},{text:"\u53d6\u6d88\u9009\u62e9",colorIndex:2,callback:function(){a.end(!0)}}],{style:"border:1px solid #070;padding:3px",anchor:MX_ANCHOR_BOTTOM_LEFT,offest:new mxLib.Size(10,50),opacity:0.7,vLayout:!0});b.addControl(c);this.buttonCtrl=c}if(this.options.showRightMenu){var c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a\u9009\u62e9","","",function(b){a.end(!1)});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88\u9009\u62e9","","",function(b){a.end(!0)});c.appendItem(e);b.addContextMenu(c)}this.options.singeSel=!1===this.options.singeSel?!1:!0;this.result=[];this.selEntMap={};b.setCursor("crosshair")};c.prototype.end=function(b){this.buttonCtrl&&(this.map.removeControl(this.buttonCtrl),this.buttonCtrl=null);this.polygon&&(this.map.removeOverlay(this.polygon),this.polygon=null);var a=this,c=$.isNumeric(this.options.clearSelTime)?this.options.clearSelTime:0;c?setTimeout(function(){a.map.cancelEntitySelect()},c):a.map.cancelEntitySelect();mxLib.Command.prototype.end.call(this,b)};c.prototype.retCmd=function(b,a,c,e){return mxLib.Command.prototype.retCmd(this,b,a,c,e)};c.prototype.leftMousedown=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);this.options.singeSel||this.endPoint||(this.points=[],this.startPoint=c,this.endPoint=this.polygon=null)};c.prototype.mousemove=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);!this.options.singeSel&&this.startPoint&&(this.polygon?(this.points[1].x=c.x,this.points[2]=c,this.points[3].y=c.y,this.polygon.setPath(this.points),c.x<this.startPoint.x?(this.polygon.setFillColor("#C0FFC0"),this.polygon.setStrokeStyle("dashed")):(this.polygon.setFillColor("#C0C0FF"),this.polygon.setStrokeStyle("solid")),this.endPoint=c):(this.points.push(this.startPoint),this.points.push(new mxLib.Point(c.x,this.startPoint.y)),this.points.push(c),this.points.push(new mxLib.Point(this.startPoint.x,c.y)),c=new mxLib.Polygon(this.points,{strokeColor:"#3399FF",fillColor:"#C0C0FF",strokeWidth:1,strokeOpacity:0.9,enableClicking:!1}),this.map.addOverlay(c),this.polygon=c))};c.prototype.leftMouseup=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);if(this.options.singeSel)c=this.map.getEntityByPoint(c.x,c.y,this.options.typeOpt,this.options.attOpt),""!=c&&(c=$.parseJSON(c),c.handle&&this.map.setEntityAttribute(c.handle,"DWG_ENT_HIGHLIGHT","true"),this.result.push(c),this.selEntMap[c.handle]=c.handle,this.end(!1));else{if(this.polygon){this.map.removeOverlay(this.polygon);var e=1;this.endPoint.x<this.startPoint.x&&(e=2);e=this.map.getEntityByBounds(this.startPoint.x,this.startPoint.y,c.x,c.y,this.options.typeOpt,this.options.attOpt,e);if(""!=e){for(var e=$.parseJSON(e),h=0;h<e.length;h++)c=e[h],this.selEntMap[c.handle]||(this.map.setEntityAttribute(c.handle,"DWG_ENT_HIGHLIGHT","true",!1),this.result.push(c),this.selEntMap[c.handle]=c.handle);this.map.update()}}else c=this.map.getEntityByPoint(c.x,c.y,this.options.typeOpt,this.options.attOpt),""!=c&&(c=$.parseJSON(c),this.selEntMap[c.handle]||(c.handle&&this.map.setEntityAttribute(c.handle,"DWG_ENT_HIGHLIGHT","true"),this.result.push(c),this.selEntMap[c.handle]=c.handle));this.endPoint=this.startPoint=this.polygon=null}};c.prototype.rightMouseup=function(b,a){this.map.showContextMenu(b)}})();(function(){var c=mxLib.DrawCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.mode=null};mxLib.Lang.inherits(c,mxLib.Command);c.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=new mxLib.DrawingTool(this,this.options.drawToolOpts);a.addControl(b);this.drawingTool=b};c.prototype.end=function(a){this.drawingTool&&(this.map.removeControl(this.drawingTool),this.drawingTool=null);this.mode=null;mxLib.Command.prototype.end.call(this,a)};c.prototype.retCmd=function(c,f,l,m){"\u753b\u70b9"==f?this.map.startCommand(new b("\u753b\u70b9",this)):"\u753b\u6298\u7ebf"==f?this.map.startCommand(new a("\u753b\u6298\u7ebf",this)):"\u753b\u591a\u8fb9\u5f62"==f?this.map.startCommand(new h("\u753b\u591a\u8fb9\u5f62",this)):"\u753b\u77e9\u5f62"==f?this.map.startCommand(new e("\u753b\u77e9\u5f62",this)):"\u753b\u5706"==f&&this.map.startCommand(new k("\u753b\u5706",this));return mxLib.Command.prototype.retCmd(this,c,f,l,m)};c.prototype.setDrawingMode=function(c){"exithander"==c?this.end(!1):"marker"==c?this.map.startCommand(new b("\u753b\u70b9",this)):"polyline"==c?this.map.startCommand(new a("\u753b\u6298\u7ebf",this)):"circle"==c?this.map.startCommand(new k("\u753b\u5706",this)):"rectangle"==c?this.map.startCommand(new e("\u753b\u77e9\u5f62",this)):"polygon"==c&&this.map.startCommand(new h("\u753b\u591a\u8fb9\u5f62",this))};c.prototype.rightMouseup=function(a,b){};c.prototype.keypress=function(a,b){27==a.charCode&&this.end(!0)};c.prototype.fireAddOverlayEvent=function(a){mxLib.Util.dispatchEvent(this,"addOverlay",{overlay:a})};c.prototype.addEventListener=function(a,b){return mxLib.Command.prototype.addEventListener.call(this,a,b)};var b=mxLib.DrawDotCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.options.drawOneDot=!0===this.options.drawOneDot?!0:!1};mxLib.Lang.inherits(b,mxLib.Command);b.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);if(this.dotStyle)c=new mxLib.Marker(c,{icon:new mxLib.Symbol(this.dotStyle,{scale:2,fillColor:"yellow",fillOpacity:0.8})}),this.dot=e,this.map.addOverlay(c),this.parentCmd&&this.parentCmd.fireAddOverlayEvent(c);else{var e=new mxLib.Marker(c);this.map.addOverlay(e);this.dot=e;this.parentCmd&&this.parentCmd.fireAddOverlayEvent(e)}this.options.drawOneDot&&this.end(!1)};b.prototype.rightMouseup=function(a,b){for(var c in this.contextMenu.menuItems)this.contextMenu.menuItems.hasOwnProperty(c)&&this.contextMenu.unCheckItem(this.contextMenu.menuItems[c].text);this.contextMenu.checkItem(this.dotStyleName);this.map.showContextMenu(a)};b.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor);var b=this,c=new mxLib.ContextMenu;this.dotStyleName="\u9ed8\u8ba4\u70b9\u7b26\u53f7";var e=new mxLib.MenuItem("\u9ed8\u8ba4\u70b9\u7b26\u53f7","","",function(a){b.dotStyle=null;b.dotStyleName="\u9ed8\u8ba4\u70b9\u7b26\u53f7"});c.appendItem(e);for(var k=[{name:"\u4e94\u89d2\u661f",style:4},{name:"\u5b9a\u4f4d\u70b9\u56fe\u6807",style:9},{name:"\u98de\u673a",style:10},{name:"\u7167\u76f8\u673a",style:11},{name:"\u8b66\u544a\u7b26\u53f7",style:12},{name:"\u7b11\u8138\u5f62\u72b6",style:13},{name:"\u949f\u8868\u5f62\u72b6",style:14}],e=function(a){return function(){b.dotStyle=k[a].style;b.dotStyleName=k[a].name}},h=0;h<k.length;h++){var r=new mxLib.MenuItem(k[h].name,"","",e(h));c.appendItem(r)}a.addContextMenu(c);this.contextMenu=c;mxLib.Util.toastInfo("\u70b9\u51fb\u53f3\u952e\u53ef\u6539\u53d8\u70b9\u7b26\u53f7",{delay:3E3,align:"left",offset:{from:"top",amount:80}})};b.prototype.getDrawOverlay=function(){return this.dot};b.prototype.end=function(a){this.map.removeContextMenu(this.contextMenu);mxLib.Command.prototype.end.call(this,a)};var a=mxLib.DrawPolylineCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.points=[];this.options.strokeColor=this.options.strokeColor||"green";this.options.strokeWidth=this.options.strokeWidth||3;this.options.strokeOpacity=this.options.strokeOpacity||0.9;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.options.strokeStyle||"solid"};mxLib.Lang.inherits(a,mxLib.Command);a.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.points.push(c);1==this.points.length?(this.points.push(c),c=new mxLib.Polyline(this.points,{strokeStyle:this.options.strokeStyle,strokeColor:this.options.strokeColor,strokeWidth:this.options.strokeWidth,strokeOpacity:this.options.strokeOpacity,enableClicking:this.options.enableClicking}),this.map.addOverlay(c),this.polyline=c):(this.points[this.points.length-1]=c,this.points.push(c),this.polyline.setPath(this.points))};a.prototype.rightMouseup=function(a,b){0<this.points.length&&this.map.showContextMenu(a)};a.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);0<this.points.length&&this.polyline.setPositionAt(this.polyline.getPath().length-1,c)};a.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=this,c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a","","",function(a){b.end()});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88","","",function(a){b.points.length=1;b.end()});c.appendItem(e);a.addContextMenu(c);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};a.prototype.getDrawOverlay=function(){return this.polyline};a.prototype.end=function(a){0<this.points.length&&(this.points.pop(),this.polyline.setPath(this.points),this.parentCmd&&this.parentCmd.fireAddOverlayEvent(this.polyline));mxLib.Command.prototype.end.call(this,a)};var k=mxLib.DrawCircleCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.options.strokeColor=this.options.strokeColor||"blue";this.options.fillColor=this.options.fillColor||"green";this.options.strokeWidth=this.options.strokeWidth||2;this.options.strokeOpacity=this.options.strokeOpacity||0.2;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.strokeStyle||"solid";this.options.fillOpacity=this.fillOpacity||0.65};mxLib.Lang.inherits(k,mxLib.Command);k.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=this,c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a","","",function(a){b.end()});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88","","",function(a){b.end(!0)});c.appendItem(e);a.addContextMenu(c);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};k.prototype.rightMouseup=function(a,b){this.centerPoint&&this.map.showContextMenu(a)};k.prototype.leftMousedown=function(a,b){mxLib.Util.getEventPoint(this.map,a)};k.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.centerPoint&&(this.circle?this.circle.setRadius(this.centerPoint.distanceTo(c)):(c=new mxLib.Circle(this.centerPoint,this.centerPoint.distanceTo(c),{fillOpacity:this.options.fillOpacity,strokeStyle:this.options.strokeStyle,strokeColor:this.options.strokeColor,fillColor:this.options.fillColor,strokeWidth:this.options.strokeWidth,strokeOpacity:this.options.strokeOpacity,enableClicking:this.options.enableClicking}),this.map.addOverlay(c),this.circle=c))};k.prototype.getDrawOverlay=function(){return this.circle};k.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.centerPoint?this.end():this.centerPoint=c};k.prototype.end=function(a){a?this.circle&&(this.map.removeOverlay(this.circle),this.centerPoint=null):this.parentCmd&&this.circle&&this.parentCmd.fireAddOverlayEvent(this.circle);mxLib.Command.prototype.end.call(this,a)};var e=mxLib.DrawRectCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.points=[];this.options.strokeColor=this.options.strokeColor||"orange";this.options.fillColor=this.options.fillColor||"#FFA0FD";this.options.strokeWidth=this.options.strokeWidth||3;this.options.strokeOpacity=this.options.strokeOpacity||0.9;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.options.strokeStyle||"solid";this.options.fillOpacity=this.options.fillOpacity||0.65};mxLib.Lang.inherits(e,mxLib.Command);e.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};e.prototype.leftMousedown=function(a,b){mxLib.Util.getEventPoint(this.map,a)};e.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.startPoint&&(this.polygon?(this.points[1].x=c.x,this.points[2]=c,this.points[3].y=c.y,this.polygon.setPath(this.points)):(this.points.push(this.startPoint),this.points.push(new mxLib.Point(c.x,this.startPoint.y)),this.points.push(c),this.points.push(new mxLib.Point(this.startPoint.x,c.y)),c=new mxLib.Polygon(this.points,{fillOpacity:this.options.fillOpacity,strokeStyle:this.options.strokeStyle,strokeColor:this.options.strokeColor,fillColor:this.options.fillColor,strokeWidth:this.options.strokeWidth,strokeOpacity:this.options.strokeOpacity,enableClicking:this.options.enableClicking}),this.map.addOverlay(c),this.polygon=c))};e.prototype.getDrawOverlay=function(){return this.polygon};e.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.startPoint?(this.parentCmd&&this.polygon&&this.parentCmd.fireAddOverlayEvent(this.polygon),this.end()):this.startPoint=c};e.prototype.end=function(a){a?this.polygon&&(this.map.removeOverlay(this.polygon),this.polygon=null):this.parentCmd&&this.polygon&&this.parentCmd.fireAddOverlayEvent(this.polygon);mxLib.Command.prototype.end.call(this,a)};var h=mxLib.DrawPolygonCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.points=[];this.options.strokeColor=this.options.strokeColor||"red";this.options.fillColor=this.options.fillColor||"yellow";this.options.strokeWidth=this.options.strokeWidth||3;this.options.strokeOpacity=this.options.strokeOpacity||0.9;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.options.strokeStyle||"solid";this.options.fillOpacity=this.options.fillOpacity||0.65};mxLib.Lang.inherits(h,mxLib.Command);h.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);0==this.points.length?(this.points.push(c),this.points.push(c),c=new mxLib.Polygon(this.points,{fillOpacity:this.options.fillOpacity,strokeStyle:this.options.strokeStyle,strokeColor:this.options.strokeColor,fillColor:this.options.fillColor,strokeWidth:this.options.strokeWidth,strokeOpacity:this.options.strokeOpacity,enableClicking:this.options.enableClicking}),this.map.addOverlay(c),this.polygon=c):(this.points[this.points.length-1]=c,this.points.push(c),this.polygon.setPath(this.points))};h.prototype.getDrawOverlay=function(){return this.polygon};h.prototype.rightMouseup=function(a,b){0<this.points.length&&this.map.showContextMenu(a)};h.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);0<this.points.length&&this.polygon.setPositionAt(this.polygon.getPath().length-1,c)};h.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=this,c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a","","",function(a){b.end()});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88","","",function(a){b.points.length=1;b.end()});c.appendItem(e);a.addContextMenu(c);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};h.prototype.end=function(a){0<this.points.length&&(this.points.pop(),this.polygon.setPath(this.points),this.parentCmd&&this.parentCmd.fireAddOverlayEvent(this.polygon));mxLib.Command.prototype.end.call(this,a)}})();(function(){var c=mxLib.RectZoomCmd=function(b,a,c){mxLib.Command.prototype.constructor.call(this,b,a,c)};mxLib.Lang.inherits(c,mxLib.Command);c.prototype.start=function(b){mxLib.Command.prototype.start.call(this,b);this.points=[];b.setCursor("crosshair")};c.prototype.leftMousedown=function(b,a){this.startPoint=mxLib.Util.getEventPoint(this.map,b)};c.prototype.mousemove=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);this.startPoint&&(this.polygon?(this.points[1].x=c.x,this.points[2]=c,this.points[3].y=c.y,this.polygon.setPath(this.points),this.endPoint=c):(this.points.push(this.startPoint),this.points.push(new mxLib.Point(c.x,this.startPoint.y)),this.points.push(c),this.points.push(new mxLib.Point(this.startPoint.x,c.y)),c=new mxLib.Polygon(this.points,{strokeColor:"#3399FF",fillColor:"#A8CAEC",strokeWidth:1,strokeOpacity:0.9,enableClicking:!1}),this.map.addOverlay(c),this.polygon=c))};c.prototype.leftMouseup=function(b,a){mxLib.Util.getEventPoint(this.map,b);this.polygon&&this.map.removeOverlay(this.polygon);this.startPoint&&this.endPoint&&this.map.setViewport(new mxLib.Bounds(this.startPoint,this.endPoint));this.endPoint=this.startPoint=this.polygon=null;this.points=[]};c.prototype.end=function(b){this.polygon&&this.map.removeOverlay(this.polygon);mxLib.Command.prototype.end.call(this,b)}})();