(function(){(mxLib.Lang={}).inherits=function(f,b){var a,c,e=f.prototype;c=new Function;c.prototype=b.prototype;c=f.prototype=new c;for(a in e)c[a]=e[a];f.prototype.constructor=f;f.superClass=b.prototype}})();(function(){$.Toast=function(f,b,a){function c(){$.Toast.remove(g)}a=$.extend(!0,{},$.Toast.defaultOptions,a);b='\x3cdiv class\x3d"simply-toast toast-alert toast-alert-'+(b?b:a.type)+" "+(a.customClass?a.customClass:"")+'"\x3e';a.allowDismiss&&(b+='\x3cspan class\x3d"toast-close" data-dismiss\x3d"toast-alert"\x3e\x26times;\x3c/span\x3e');b=b+f+"\x3c/div\x3e";var e=a.offset.amount;a.stack||$(".simply-toast").each(function(){return e=Math.max(e,parseInt($(this).css(a.offset.from))+this.offsetHeight+a.spacing)});f={position:"absolute",margin:0,"z-index":"9999",display:"none","min-width":a.minWidth,"max-width":a.maxWidth};f[a.offset.from]=e+"px";var g=$(b).css(f).appendTo(a.appendTo);switch(a.align){case "center":g.css({left:"50%","margin-left":"-"+g.outerWidth()/2+"px"});break;case "left":g.css("left","20px");break;default:g.css("right","20px")}g.fadeIn?g.fadeIn():g.css({display:"block",opacity:1});0<a.delay&&setTimeout(c,a.delay);g.find('[data-dismiss\x3d"toast-alert"]').removeAttr("data-dismiss").click(c);return g};$.Toast.remove=function(f){return f.fadeOut?f.fadeOut(function(){return f.remove()}):f.remove()};$.Toast.defaultOptions={appendTo:"body",stack:!0,customClass:!1,type:"info",offset:{from:"top",amount:5},align:"center",minWidth:50,maxWidth:500,delay:3E3,allowDismiss:!1,spacing:10}})();(function(f){"function"===typeof define&&define.amd?define(["jquery"],f):"object"===typeof exports?module.exports=f:f(jQuery)})(function(f){function b(c){var b=c||window.event,e=g.call(arguments,1),t=0,n=0,u=0,v=0,z=0,x=0;c=f.event.fix(b);c.type="mousewheel";"detail"in b&&(u=-1*b.detail);"wheelDelta"in b&&(u=b.wheelDelta);"wheelDeltaY"in b&&(u=b.wheelDeltaY);"wheelDeltaX"in b&&(n=-1*b.wheelDeltaX);"axis"in b&&b.axis===b.HORIZONTAL_AXIS&&(n=-1*u,u=0);t=0===u?n:u;"deltaY"in b&&(t=u=-1*b.deltaY);"deltaX"in b&&(n=b.deltaX,0===u&&(t=-1*n));if(0!==u||0!==n){1===b.deltaMode?(v=f.data(this,"mousewheel-line-height"),t*=v,u*=v,n*=v):2===b.deltaMode&&(v=f.data(this,"mousewheel-page-height"),t*=v,u*=v,n*=v);v=Math.max(Math.abs(u),Math.abs(n));if(!h||v<h)h=v,l.settings.adjustOldDeltas&&"mousewheel"===b.type&&0===v%120&&(h/=40);l.settings.adjustOldDeltas&&"mousewheel"===b.type&&0===v%120&&(t/=40,n/=40,u/=40);t=Math[1<=t?"floor":"ceil"](t/h);n=Math[1<=n?"floor":"ceil"](n/h);u=Math[1<=u?"floor":"ceil"](u/h);l.settings.normalizeOffset&&this.getBoundingClientRect&&(b=this.getBoundingClientRect(),z=c.clientX-b.left,x=c.clientY-b.top);c.deltaX=n;c.deltaY=u;c.deltaFactor=h;c.offsetX=z;c.offsetY=x;c.deltaMode=0;e.unshift(c,t,n,u);k&&clearTimeout(k);k=setTimeout(a,200);return(f.event.dispatch||f.event.handle).apply(this,e)}}function a(){h=null}var c=["wheel","mousewheel","DOMMouseScroll","MozMousePixelScroll"],e="onwheel"in document||9<=document.documentMode?["wheel"]:["mousewheel","DomMouseScroll","MozMousePixelScroll"],g=Array.prototype.slice,k,h;if(f.event.fixHooks)for(var n=c.length;n;)f.event.fixHooks[c[--n]]=f.event.mouseHooks;var l=f.event.special.mousewheel={version:"3.1.12",setup:function(){if(this.addEventListener)for(var a=e.length;a;)this.addEventListener(e[--a],b,!1);else this.onmousewheel=b;f.data(this,"mousewheel-line-height",l.getLineHeight(this));f.data(this,"mousewheel-page-height",l.getPageHeight(this))},teardown:function(){if(this.removeEventListener)for(var a=e.length;a;)this.removeEventListener(e[--a],b,!1);else this.onmousewheel=null;f.removeData(this,"mousewheel-line-height");f.removeData(this,"mousewheel-page-height")},getLineHeight:function(a){a=f(a);var c=a["offsetParent"in f.fn?"offsetParent":"parent"]();c.length||(c=f("body"));return parseInt(c.css("fontSize"),10)||parseInt(a.css("fontSize"),10)||16},getPageHeight:function(a){return f(a).height()},settings:{adjustOldDeltas:!0,normalizeOffset:!0}};f.fn.extend({mousewheel:function(a){return a?this.bind("mousewheel",a):this.trigger("mousewheel")},unmousewheel:function(a){return this.unbind("mousewheel",a)}})});(function(){function f(a,c,b){null!=c&&(a=Math.max(a,c));null!=b&&(a=Math.min(a,b));return a}function b(a,c,b){for(;a>b;)a-=b-c;for(;a<c;)a+=b-c;return a}function a(){}function c(){if(0==arguments.length)this.nType=1,this.a=6378245,this.b=6356863.018773047;else if(1==arguments.length){var a=arguments[0];this.nType=a;switch(a){case 1:this.a=6378245;this.b=6356863.018773047;break;case 2:this.a=6378140;this.b=6356755.288157528;break;case 3:this.a=6378137;this.b=6356752.314245179;break;case 4:this.a=6378137,this.b=6356752.314140356}}}function e(){}function g(){0==arguments.length?this.z=this.y=this.x=0:3==arguments.length&&(this.x=arguments[0],this.y=arguments[1],this.z=arguments[2])}function k(a,b){if(72.004>b||137.8347<b||.8293>a||55.8271<a)return{mgLat:a,mgLon:b};var e=new c(1),m=e.a,e=e.get_e12(),g;g=b-105;var k=a-35,h=-100+2*g+3*k+.2*k*k+.1*g*k+.2*Math.sqrt(Math.abs(g)),h=h+2*(20*Math.sin(18.84955592153876*g)+20*Math.sin(6.283185307179586*g))/3,h=h+2*(20*Math.sin(3.141592653589793*k)+40*Math.sin(k/3*3.141592653589793))/3;g=h+=2*(160*Math.sin(k/12*3.141592653589793)+320*Math.sin(3.141592653589793*k/30))/3;var k=b-105,h=a-35,h=300+k+2*h+.1*k*k+.1*k*h+.1*Math.sqrt(Math.abs(k)),h=h+2*(20*Math.sin(18.84955592153876*k)+20*Math.sin(6.283185307179586*k))/3,h=h+2*(20*Math.sin(3.141592653589793*k)+40*Math.sin(k/3*3.141592653589793))/3,k=h+=2*(150*Math.sin(k/12*3.141592653589793)+300*Math.sin(k/30*3.141592653589793))/3,h=a/180*3.141592653589793,r=Math.sin(h),r=1-e*r*r,f=Math.sqrt(r);g=180*g/(m*(1-e)/(r*f)*3.141592653589793);k=180*k/(m/f*Math.cos(h)*3.141592653589793);return{mgLat:a+g,mgLon:b+k}}function h(a,c){for(var b=.01,e=.01,m=a-b,g=c-e,h=a+b,r=c+e,f,q,t=0;;){f=(m+h)/2;q=(g+r)/2;e=k(f,q);b=e.mgLat;e=e.mgLon;b-=a;e-=c;if(1E-9>Math.abs(b)&&1E-9>Math.abs(e))break;0<b?h=f:m=f;0<e?r=q:g=q;if(1E4<++t)break}return{mgLat:f,mgLon:q}}function n(a,c){var b,e;b=Math.sqrt(c*c+a*a)+2E-5*Math.sin(52.35987755982988*a);var m=Math.atan2(a,c)+3E-6*Math.cos(52.35987755982988*c);e=b*Math.cos(m)+.0065;b=b*Math.sin(m)+.006;return{bd_lon:e,bd_lat:b}}function l(a,c){var b,e;e=c-.0065;var m=a-.006;b=Math.sqrt(e*e+m*m)-2E-5*Math.sin(52.35987755982988*m);m=Math.atan2(m,e)-3E-6*Math.cos(52.35987755982988*e);e=b*Math.cos(m);b*=Math.sin(m);return{gg_lon:e,gg_lat:b}}function m(a,c){var b=l(a,c),b=h(b.gg_lat,b.gg_lon);return{wgs84_lat:b.mgLat,wgs84_lon:b.mgLon}}function q(a,c){var b=k(a,c);return n(b.mgLat,b.mgLon)}function r(a){a=1E-9>=a&&-1E-9<=a?a:a-6.283185307179586*Math.floor(a/6.283185307179586);return 180*a/3.141592653589793}function t(a){a=1E-9>=a&&-1E-9<=a?a:a-360*Math.floor(a/360);return 3.141592653589793*a/180}function w(a,c,b){for(var e=0;e<c.length;e++){var m=a,k=c[e],h=t(k.y),r=t(k.x),k=k.z,f=m.get_N(h),m=m.get_e12(),q=new g;q.x=(f+k)*Math.cos(h)*Math.cos(r);q.y=(f+k)*Math.cos(h)*Math.sin(r);q.z=(f*(1-m)+k)*Math.sin(h);b.push(q)}return b}function u(a,c,b){var e=a.GetEllipsoid();a.GetYPlusProjNo();switch(a.coStyle){case 0:w(e,c,b);break;case 1:for(var m=[],k=0;k<c.length;k++){var h=a,f=c[k],q=new g,n=h.GetEllipsoid(),u=h.centerL,l=h.constantX,h=h.GetYPlusProjNo(),v=f.x-l,f=f.y-h,z=n.a,h=n.get_e1(),l=n.get_e2(),u=t(u),x=1+.75*Math.pow(h,2)+.703125*Math.pow(h,4)+.68359375*Math.pow(h,6)+11025/16384*Math.pow(h,8),v=v/(z*(1-Math.pow(h,2))*x),x=(x-1)/2,z=-(.984375*Math.pow(h,4)+2.1640625*Math.pow(h,6)+58239/16384*Math.pow(h,8))/3,B=(1.1796875*Math.pow(h,6)+4.179931640625*Math.pow(h,8))/3,h=-(1.60693359375*Math.pow(h,8))/3,A=Math.sin(v)*Math.sin(v),h=v+Math.sin(2*v)*(x+A*(z+A*(B+h*A))),v=tan(h),x=n.get_N(h),n=n.get_M(h),l=l*cos(h),n=h-v/(2*n)*f*(f/x)*(1-1/12*(5+3*v*v+l*l-9*v*v*l*l)*Math.pow(f/x,2)+1/360*(61+90*v*v+45*Math.pow(v,4))*Math.pow(f/x,4)),f=1/Math.cos(h)*(f/x)*(1-1/6*(1+2*v*v+l*l)*Math.pow(f/x,2)+1/120*(5+28*v*v+24*Math.pow(v,4)+6*l*l+8*l*l*v*v)*Math.pow(f/x,4));q.x=r(u+f);q.y=r(n);m.push_back(q)}w(e,m,b);break;case 2:for(a=0;a<c.length;a++)b.push(c[a])}}function v(a,c,b){for(var e=0;e<c.length;e++){var m=a,k=c[e],h=new g,f=k.x,q=k.y,n=k.z,t=m.get_e12(),w=m.a,k=Math.atan(q/f);0>k&&(k+=3.141592653589793);var u=Math.sqrt(f*f+q*q),l=t/(1-t),t=w*Math.sqrt(1+l)*t,l=1+l,v=w=n/u,z=0;do w=v,u=Math.sqrt(f*f+q*q),v=n/u+t*w/(u*Math.sqrt(l+w*w)),z++;while(1E-10<Math.abs(w-v)&&1E5>z);f=Math.atan(v);0>f&&(f+=3.141592653589793);m=m.get_N(f);m=u/Math.cos(f)-m;h.x=r(k);h.y=r(f);h.z=m;b.push(h)}}function z(a,c,b){var e=a.GetEllipsoid();a.GetYPlusProjNo();switch(a.coStyle){case 0:v(e,c,b);break;case 1:var m=[];v(e,c,m);for(c=0;c<m.length;c++){var k=a,h=m[c],e=new g,r=k.GetEllipsoid(),f=k.centerL,q=k.constantX,k=k.GetYPlusProjNo(),n=t(h.y),w=t(h.x),u=r.a,l=r.get_e1(),h=r.get_e2(),r=r.get_N(n),f=w-t(f),w=1+.75*Math.pow(l,2)+.703125*Math.pow(l,4)+.68359375*Math.pow(l,6)+11025/16384*Math.pow(l,8)+43659/65536*Math.pow(l,10),z=-(.75*Math.pow(l,2)+.9375*Math.pow(l,4)+1.025390625*Math.pow(l,6)+1.07666015625*Math.pow(l,8)+72765/65536*Math.pow(l,10))/2,x=(.234375*Math.pow(l,4)+.41015625*Math.pow(l,6)+.538330078125*Math.pow(l,8)+10395/16384*Math.pow(l,10))/4,B=-(35/512*Math.pow(l,6)+.15380859375*Math.pow(l,8)+31185/131072*Math.pow(l,10))/6,A=(315/16384*Math.pow(l,8)+3465/65536*Math.pow(l,10))/8,D=-693/131072*Math.pow(l,10)/10,l=u*(1-Math.pow(l,2))*(w*n+z*Math.sin(2*n)+x*Math.sin(4*n)+B*Math.sin(6*n)+A*Math.sin(8*n)+D*Math.sin(10*n)),u=Math.tan(n),h=h*Math.cos(n),n=Math.cos(n)*f,l=l+r*u*Math.pow(n,2)*(.5+1/24*(5-Math.pow(u,2)+9*Math.pow(h,2)+4*Math.pow(h,4))*Math.pow(n,2)+1/720*(61-58*Math.pow(u,2)+Math.pow(u,4))*Math.pow(n,4)),l=l+q,q=r*n*(1+1/6*(1-Math.pow(u,2)+Math.pow(h,2))*Math.pow(n,2)+1/120*(5-18*Math.pow(u,2)+Math.pow(u,4)+14*Math.pow(h,2)-58*Math.pow(h,2)*Math.pow(u,2))*Math.pow(n,4)),q=q+k;e.x=l;e.y=q;b.push(e)}break;case 2:for(a=0;a<c.length;a++)b.push(c[a])}}function x(a,c,b,e,r){var f=b.length;switch(c.coSys){case 3:switch(e.coSys){case 5:for(var t=0;t<f;t++)e=b[t].x,a=b[t].y,a=k(a,e),e=a.mgLat,a=a.mgLon,r.push(new g(a,e,0));return!0;case 6:for(t=0;t<f;t++)e=b[t].x,a=b[t].y,a=q(a,e),e=a.bd_lat,a=a.bd_lon,r.push(new g(a,e,0));return!0;case 3:for(t=0;t<b.length;t++)r.push(b[t])}break;case 5:switch(e.coSys){case 3:for(t=0;t<f;t++)e=b[t].x,a=b[t].y,a=h(a,e),e=a.mgLat,a=a.mgLon,r.push(new g(a,e,0));return!0;case 6:for(t=0;t<f;t++)e=b[t].x,a=b[t].y,a=n(a,e),e=a.bd_lat,a=a.bd_lon,r.push(new g(a,e,0));return!0;case 5:for(t=0;t<b.length;t++)r.push(b[t])}break;case 6:switch(e.coSys){case 5:for(t=0;t<f;t++)e=b[t].x,a=b[t].y,a=l(a,e),e=a.gg_lat,a=a.gg_lon,r.push(new g(a,e,0));return!0;case 3:for(t=0;t<f;t++)e=b[t].x,a=b[t].y,a=m(a,e),e=a.wgs84_lat,a=a.wgs84_lon,r.push(new g(a,e,0));return!0;case 6:for(t=0;t<b.length;t++)r.push(b[t])}}f=[];switch(c.coSys){case 5:for(var t=[],w=0;w<b.length;w++){var v=new g,x=h(b[w].y,b[w].x);v.y=x.mgLat;v.x=x.mgLon;t.push(v)}u(c,t,f);break;case 3:u(c,b,f);break;case 6:t=[];for(w=0;w<b.length;w++)v=new g,x=m(b[w].y,b[w].x),v.y=x.wgs84_lat,v.x=x.wgs84_lon,t.push(v);u(c,t,f);break;case 1:u(c,b,f);break;case 2:u(c,b,f)}b=[];c=a.k;t=c*a.Wx;w=c*a.Wy;v=c*a.Wz;for(x=0;x<f.length;x++){var B=new g;B.x=a.X0+c*f[x].x+0-w*f[x].z+v*f[x].y;B.y=a.Y0+c*f[x].y+t*f[x].z+0-v*f[x].x;B.z=a.Z0+c*f[x].z-t*f[x].y+w*f[x].x+0;b.push(B)}switch(e.coSys){case 5:a=[];z(e,b,a);for(e=0;e<a.length;e++)b=new g,f=k(a[e].x,a[e].y),b.x=f.mgLat,b.y=f.mgLon,r.push(b);break;case 3:z(e,b,r);break;case 6:a=[];z(e,b,a);for(e=0;e<a.length;e++)b=new g,f=q(a[e].x,a[e].y),b.x=f.mgLat,b.y=f.mgLon,r.push(b);break;case 1:z(e,b,r);break;case 2:z(e,b,r)}return!0}function B(a,c,b,e,m){var k=new g;k.x=e;k.y=m;e=[];e.push(k);k=[];x(a,c,e,b,k);a=new g;0<k.length&&(a=k[0]);return{x:a.x,y:a.y}}mxLib.guid="$MetaMap$";(function(){window[mxLib.guid]={};mxLib.dom=mxLib.dom||{};mxLib.dom.g=function(a){return"string"==typeof a||a instanceof String?document.getElementById(a):a&&a.nodeName&&(1==a.nodeType||9==a.nodeType)?a:null};mxLib.g=mxLib.G=mxLib.dom.g;mxLib.lang=mxLib.lang||{};mxLib.lang.isString=function(a){return"[object String]"==Object.prototype.toString.call(a)};mxLib.isString=mxLib.lang.isString;mxLib.dom._g=function(a){return mxLib.lang.isString(a)?document.getElementById(a):a};mxLib._g=mxLib.dom._g;mxLib.dom.getDocument=function(a){a=mxLib.dom.g(a);return 9==a.nodeType?a:a.ownerDocument||a.document};mxLib.browser=mxLib.browser||{};mxLib.browser.ie=/msie (\d+\.\d+)/i.test(navigator.userAgent)?document.documentMode||+RegExp.$1:void 0;mxLib.dom.getComputedStyle=function(a,c){a=mxLib.dom._g(a);var b=mxLib.dom.getDocument(a);return b.defaultView&&b.defaultView.getComputedStyle&&(b=b.defaultView.getComputedStyle(a,null))?b[c]||b.getPropertyValue(c):""};mxLib.dom._styleFixer=mxLib.dom._styleFixer||{};mxLib.dom._styleFilter=mxLib.dom._styleFilter||[];mxLib.dom._styleFilter.filter=function(a,c,b){for(var e=0,m=mxLib.dom._styleFilter,g;g=m[e];e++)if(g=g[b])c=g(a,c);return c};mxLib.string=mxLib.string||{};mxLib.string.toCamelCase=function(a){return 0>a.indexOf("-")&&0>a.indexOf("_")?a:a.replace(/[-_][^-_]/g,function(a){return a.charAt(1).toUpperCase()})};mxLib.dom.getStyle=function(a,c){var b=mxLib.dom;a=b.g(a);c=mxLib.string.toCamelCase(c);var e=a.style[c]||(a.currentStyle?a.currentStyle[c]:"")||b.getComputedStyle(a,c);if(!e){var m=b._styleFixer[c];m&&(e=m.get?m.get(a):mxLib.dom.getStyle(a,m))}if(m=b._styleFilter)e=m.filter(c,e,"get");return e};mxLib.getStyle=mxLib.dom.getStyle;mxLib.dom.setStyle=function(a,c,b){var e=mxLib.dom,m;a=e.g(a);c=mxLib.string.toCamelCase(c);if(m=e._styleFilter)b=m.filter(c,b,"set");(m=e._styleFixer[c])&&m.set?m.set(a,b):a.style[m||c]=b;return a};mxLib.setStyle=mxLib.dom.setStyle;mxLib.dom.setStyles=function(a,c){a=mxLib.dom.g(a);for(var b in c)mxLib.dom.setStyle(a,b,c[b]);return a};mxLib.setStyles=mxLib.dom.setStyles;mxLib.dom._NAME_ATTRS=function(){var a={cellpadding:"cellPadding",cellspacing:"cellSpacing",colspan:"colSpan",rowspan:"rowSpan",valign:"vAlign",usemap:"useMap",frameborder:"frameBorder"};8>mxLib.browser.ie?(a["for"]="htmlFor",a["class"]="className"):(a.htmlFor="for",a.className="class");return a}();mxLib.dom.setAttr=function(a,c,b){a=mxLib.dom.g(a);"style"==c?a.style.cssText=b:(c=mxLib.dom._NAME_ATTRS[c]||c,a.setAttribute(c,b));return a};mxLib.setAttr=mxLib.dom.setAttr;mxLib.dom.setAttrs=function(a,c){a=mxLib.dom.g(a);for(var b in c)mxLib.dom.setAttr(a,b,c[b]);return a};mxLib.setAttrs=mxLib.dom.setAttrs;mxLib.getAttr=mxLib.dom.getAttr=function(a,c){a=mxLib.dom.g(a);if("style"==c)return a.style.cssText;c=mxLib.dom._NAME_ATTRS[c]||c;return a.getAttribute(c)};mxLib.dom.create=function(a,c){var b=document.createElement(a);return mxLib.dom.setAttrs(b,c||{})};/opera\/(\d+\.\d)/i.test(navigator.userAgent)&&(mxLib.browser.opera=+RegExp.$1);mxLib.browser.isWebkit=/webkit/i.test(navigator.userAgent);mxLib.browser.isGecko=/gecko/i.test(navigator.userAgent)&&!/like gecko/i.test(navigator.userAgent);mxLib.browser.isStrict="CSS1Compat"==document.compatMode;mxLib.dom.getPosition=function(a){a=mxLib.dom.g(a);var c=mxLib.dom.getDocument(a),b=mxLib.browser,e=mxLib.dom.getStyle;0<b.isGecko&&c.getBoxObjectFor&&e(a,"position");var m={left:0,top:0},g;if(a==(b.ie&&!b.isStrict?c.body:c.documentElement))return m;if(a.getBoundingClientRect)a=a.getBoundingClientRect(),m.left=Math.floor(a.left)+Math.max(c.documentElement.scrollLeft,c.body.scrollLeft),m.top=Math.floor(a.top)+Math.max(c.documentElement.scrollTop,c.body.scrollTop),m.left-=c.documentElement.clientLeft,m.top-=c.documentElement.clientTop,a=c.body,c=parseInt(e(a,"borderLeftWidth")),e=parseInt(e(a,"borderTopWidth")),b.ie&&!b.isStrict&&(m.left-=isNaN(c)?2:c,m.top-=isNaN(e)?2:e);else{g=a;do{m.left+=g.offsetLeft;m.top+=g.offsetTop;if(0<b.isWebkit&&"fixed"==e(g,"position")){m.left+=c.body.scrollLeft;m.top+=c.body.scrollTop;break}g=g.offsetParent}while(g&&g!=a);if(0<b.opera||0<b.isWebkit&&"absolute"==e(a,"position"))m.top-=c.body.offsetTop;for(g=a.offsetParent;g&&g!=c.body;)m.left-=g.scrollLeft,b.opera&&"TR"==g.tagName||(m.top-=g.scrollTop),g=g.offsetParent}return m};mxLib.object=mxLib.object||{};mxLib.extend=mxLib.object.extend=function(a,c){for(var b in c)a[b]=c[b];return a};mxLib.lang=mxLib.lang||{};mxLib.lang.guid=function(){return"MX__"+(window[mxLib.guid]._counter++).toString(36)};window[mxLib.guid]._counter=window[mxLib.guid]._counter||1;window[mxLib.guid]._instances=window[mxLib.guid]._instances||{};mxLib.lang.Class=function(a){this.guid=a||mxLib.lang.guid();window[mxLib.guid]._instances[this.guid]=this};window[mxLib.guid]._instances=window[mxLib.guid]._instances||{};mxLib.lang.decontrol=function(a){var c=window[mxLib.guid];c._instances&&delete c._instances[a]};mxLib.lang.isString=function(a){return"[object String]"==Object.prototype.toString.call(a)};mxLib.lang.isFunction=function(a){return"[object Function]"==Object.prototype.toString.call(a)};mxLib.lang.Class.prototype.toString=function(){return"[object "+(this._className||"Object")+"]"};mxLib.lang.Event=function(a,c){this.type=a;this.returnValue=!0;this.target=c||null;this.currentTarget=null};mxLib.lang.Class.prototype.addEventListener=function(a,c,b){if(mxLib.lang.isFunction(c)){!this.__listeners&&(this.__listeners={});var e=this.__listeners,m;if("string"==typeof b&&b){if(/[^\w\-]/.test(b))throw"nonstandard key:"+b;m=c.hashCode=b}0!=a.indexOf("on")&&(a="on"+a);"object"!=typeof e[a]&&(e[a]={});m=m||mxLib.lang.guid();c.hashCode=m;e[a][m]=c;return m}};mxLib.lang.Class.prototype.removeEventListener=function(a,c){if(mxLib.lang.isFunction(c))c=c.hashCode;else if(!mxLib.lang.isString(c))return;!this.__listeners&&(this.__listeners={});0!=a.indexOf("on")&&(a="on"+a);var b=this.__listeners;b[a]&&b[a][c]&&delete b[a][c]};mxLib.lang.Class.prototype.dispatchEvent=function(a,c){mxLib.lang.isString(a)&&(a=new mxLib.lang.Event(a));!this.__listeners&&(this.__listeners={});c=c||{};for(var b in c)a[b]=c[b];var e=this.__listeners,m=a.type;a.target=a.target||this;a.currentTarget=this;0!=m.indexOf("on")&&(m="on"+m);mxLib.lang.isFunction(this[m])&&this[m].apply(this,arguments);if("object"==typeof e[m])for(b in e[m])e[m][b].apply(this,arguments);return a.returnValue};mxLib.lang.inherits=function(a,c,b){var e,m,g=a.prototype;m=new Function;m.prototype=c.prototype;m=a.prototype=new m;for(e in g)m[e]=g[e];a.prototype.constructor=a;a.superClass=c.prototype;"string"==typeof b&&(m._className=b)};mxLib.event=mxLib.event||{};mxLib.event._listeners=mxLib.event._listeners||[];mxLib.on=mxLib.event.on=function(a,c,b){c=c.replace(/^on/i,"");a=mxLib.g(a);var e=function(c){b.call(a,c)},m=mxLib.event._listeners,g=mxLib.event._eventFilter,k=c;c=c.toLowerCase();g&&g[c]&&(e=g[c](a,c,e),k=e.type,e=e.listener);a.addEventListener?a.addEventListener(k,e,!1):a.attachEvent&&a.attachEvent("on"+k,e);m[m.length]=[a,c,b,e,k];a._on_event_||(a._on_event_={});a._on_event_[c]=b;return a};mxLib.un=mxLib.event.un=function(a,c,b){a=mxLib._g(a);c=c.replace(/^on/i,"").toLowerCase();for(var e=mxLib.event._listeners,m=e.length,g=!b,k,h;m--;)k=e[m],k[1]!==c||k[0]!==a||!g&&k[2]!==b||(h=k[4],k=k[3],a.removeEventListener?a.removeEventListener(h,k,!1):a.detachEvent&&a.detachEvent("on"+h,k),e.splice(m,1));a._on_event_&&delete a._on_event_[c];return a};mxLib.getEvent=mxLib.event.getEvent=function(a){return window.event||a};mxLib.getTarget=mxLib.event.getTarget=function(a){a=mxLib.getEvent(a);return a.target||a.srcElement};mxLib.preventDefault=mxLib.event.preventDefault=function(a){a=mxLib.getEvent(a);a.preventDefault?a.preventDefault():a.returnValue=!1};mxLib.stopBubble=mxLib.event.stopBubble=function(a){a=mxLib.getEvent(a);a.stopPropagation?a.stopPropagation():a.cancelBubble=!0}})();var A=mxLib.Util={};A.createUniqueID=function(a){null==a&&(a="id_");return a+Math.round(1E7*Math.random())};A.removeItem=function(a,c){if(0==a instanceof Array)return!1;var b=a.indexOf(c);return-1<b?(a.splice(b,1),!0):!1};A.getValueOfNoPX=function(a){if(a){if(-1!=a.indexOf("px")){var c=a.indexOf("px");return Number(a.substring(0,c))}return Number(a)}};A.isPageMxMode=function(){return $.isEmptyObject(MxHost)?!1:!0};A.toast=function(a,c,b){var e="";a==MX_MSGTYPE_SUCCESS?e="success":a==MX_MSGTYPE_WARN?(b=b||{},b.delay=b.delay||1E4,b.allowDismiss=!1===b.allowDismiss?!1:!0,e="warning"):a==MX_MSGTYPE_ERROR?(b=b||{},b.delay=b.delay||12E4,b.allowDismiss=!1===b.allowDismiss?!1:!0,e="danger"):e="info";$.Toast(c,e,b)};A.toastInfo=function(a,c){this.toast(MX_MSGTYPE_INFO,a,c)};A.toastSuccess=function(a,c){this.toast(MX_MSGTYPE_SUCCESS,a,c)};A.toastWarn=function(a,c){this.toast(MX_MSGTYPE_WARN,a,c)};A.toastError=function(a,c){this.toast(MX_MSGTYPE_ERROR,a,c)};A.color=function(){function a(c){c=c.replace(/^#?([a-f\d])([a-f\d])([a-f\d])$/i,function(a,c,b,e){return c+c+b+b+e+e});return(c=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(c))?"rgb("+parseInt(c[1],16)+","+parseInt(c[2],16)+","+parseInt(c[3],16)+")":p}var c={aliceblue:"#f0f8ff",antiquewhite:"#faebd7",aqua:"#00ffff",aquamarine:"#7fffd4",azure:"#f0ffff",beige:"#f5f5dc",bisque:"#ffe4c4",black:"#000000",blanchedalmond:"#ffebcd",blue:"#0000ff",blueviolet:"#8a2be2",brown:"#a52a2a",burlywood:"#deb887",cadetblue:"#5f9ea0",chartreuse:"#7fff00",chocolate:"#d2691e",coral:"#ff7f50",cornflowerblue:"#6495ed",cornsilk:"#fff8dc",crimson:"#dc143c",cyan:"#00ffff",darkblue:"#00008b",darkcyan:"#008b8b",darkgoldenrod:"#b8860b",darkgray:"#a9a9a9",darkgreen:"#006400",darkkhaki:"#bdb76b",darkmagenta:"#8b008b",darkolivegreen:"#556b2f",darkorange:"#ff8c00",darkorchid:"#9932cc",darkred:"#8b0000",darksalmon:"#e9967a",darkseagreen:"#8fbc8f",darkslateblue:"#483d8b",darkslategray:"#2f4f4f",darkturquoise:"#00ced1",darkviolet:"#9400d3",deeppink:"#ff1493",deepskyblue:"#00bfff",dimgray:"#696969",dodgerblue:"#1e90ff",firebrick:"#b22222",floralwhite:"#fffaf0",forestgreen:"#228b22",fuchsia:"#ff00ff",gainsboro:"#dcdcdc",ghostwhite:"#f8f8ff",gold:"#ffd700",goldenrod:"#daa520",gray:"#808080",green:"#008000",greenyellow:"#adff2f",honeydew:"#f0fff0",hotpink:"#ff69b4","indianred ":"#cd5c5c",indigo:"#4b0082",ivory:"#fffff0",khaki:"#f0e68c",lavender:"#e6e6fa",lavenderblush:"#fff0f5",lawngreen:"#7cfc00",lemonchiffon:"#fffacd",lightblue:"#add8e6",lightcoral:"#f08080",lightcyan:"#e0ffff",lightgoldenrodyellow:"#fafad2",lightgrey:"#d3d3d3",lightgreen:"#90ee90",lightpink:"#ffb6c1",lightsalmon:"#ffa07a",lightseagreen:"#20b2aa",lightskyblue:"#87cefa",lightslategray:"#778899",lightsteelblue:"#b0c4de",lightyellow:"#ffffe0",lime:"#00ff00",limegreen:"#32cd32",linen:"#faf0e6",magenta:"#ff00ff",maroon:"#800000",mediumaquamarine:"#66cdaa",mediumblue:"#0000cd",mediumorchid:"#ba55d3",mediumpurple:"#9370d8",mediumseagreen:"#3cb371",mediumslateblue:"#7b68ee",mediumspringgreen:"#00fa9a",mediumturquoise:"#48d1cc",mediumvioletred:"#c71585",midnightblue:"#191970",mintcream:"#f5fffa",mistyrose:"#ffe4e1",moccasin:"#ffe4b5",navajowhite:"#ffdead",navy:"#000080",oldlace:"#fdf5e6",olive:"#808000",olivedrab:"#6b8e23",orange:"#ffa500",orangered:"#ff4500",orchid:"#da70d6",palegoldenrod:"#eee8aa",palegreen:"#98fb98",paleturquoise:"#afeeee",palevioletred:"#d87093",papayawhip:"#ffefd5",peachpuff:"#ffdab9",peru:"#cd853f",pink:"#ffc0cb",plum:"#dda0dd",powderblue:"#b0e0e6",purple:"#800080",red:"#ff0000",rosybrown:"#bc8f8f",royalblue:"#4169e1",saddlebrown:"#8b4513",salmon:"#fa8072",sandybrown:"#f4a460",seagreen:"#2e8b57",seashell:"#fff5ee",sienna:"#a0522d",silver:"#c0c0c0",skyblue:"#87ceeb",slateblue:"#6a5acd",slategray:"#708090",snow:"#fffafa",springgreen:"#00ff7f",steelblue:"#4682b4",tan:"#d2b48c",teal:"#008080",thistle:"#d8bfd8",tomato:"#ff6347",turquoise:"#40e0d0",violet:"#ee82ee",wheat:"#f5deb3",white:"#ffffff",whitesmoke:"#f5f5f5",yellow:"#ffff00",yellowgreen:"#9acd32"},b=/^#([A-Fa-f0-9]{6}|[A-Fa-f0-9]{3})$/,e=/rgb\(\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*\)/,m=/rgba\(\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(\d|\d\d|1\d\d|2[0-4]\d|25[0-5])\s*,\s*(0|1|0\.[1-9])\s*\)/;return{oI:function(a){if(b.test(a))return a;if(e.test(a))return a=a.match(e),"#"+("0"+parseInt(a[1],10).toString(16)).slice(-2)+("0"+parseInt(a[2],10).toString(16)).slice(-2)+("0"+parseInt(a[3],10).toString(16)).slice(-2);if(c[a])return c[a]},b0:a,$Z:function(a){return b.test(a)?a:c[a]?c[a]:"#000"},mB:function(g,k){if(m.test(g))return g;"undefined"!=typeof c[g.toLowerCase()]&&(g=c[g.toLowerCase()]);b.test(g)&&(g=a(g));e.test(g)?(g=g.replace(/rgb/g,"rgba"),g=g.replace(/\)/,","+k+")")):g="rgba(0,0,0,1)";return g}}}();A.dispatchEvent=function(a,c,b){0!=c.indexOf("on")&&(c="on"+c);c=new mxLib.lang.Event(c);if(b)for(var e in b)c[e]=b[e];a.dispatchEvent(c)};A.stopAndPrevent=function(a){a=window.event||a;a.stopPropagation?a.stopPropagation():a.cancelBubble=!0;return mxLib.preventDefault(a)};A.purge=function(a){if(a){var c=a.attributes,b="";if(c)for(var e=0,m=c.length;e<m;e++)b=c[e].name,"function"===typeof a[b]&&(a[b]=null);if(c=a.childnodes)for(e=0,m=c.length;e<m;e++)mxLib.Util.purge(a.childnodes[e])}};A._setCursor=function(a){var c="",c={dragstart:"-moz-grab",dragging:"-moz-grabbing",dragend:"pointer"},b={dragstart:"move",dragging:"move",dragend:"pointer"};return c=-1!==navigator.userAgent.indexOf("Gecko/")?c[a]:b[a]};A.setAnimation=function(a,c,b){a&&(c==MX_ANIMATION_BOUNCE?($(a).addClass("markerball"),b&&0<b&&setTimeout(function(){$(a).removeClass("markerball")},b)):c==MX_ANIMATION_SHADOW?$(a).addClass("markerShadow"):c==MX_ANIMATION_DROP?(c=$(a).offset().top,b=$(a).height(),a.style.top="0px",$(a).animate({top:c+"px",bottom:c+b+"px"},500),$(a).animate({top:c-30+"px",bottom:c+b+"px"},200),$(a).animate({top:c+"px",bottom:c+b+"px"},100),$(a).animate({top:c-15+"px",bottom:c+b+"px"},200),$(a).animate({top:c+"px",bottom:c+b+"px"},100),$(a).animate({top:c-5+"px",bottom:c+b+"px"},100),$(a).animate({top:c+"px",bottom:c+b+"px"},50),a.style.top=c+"px",$(a).height(b)):c==MX_ANIMATION_FLASH?a&&a.snap?(a.setAttribute("class","markerflash"),b&&0<b&&setTimeout(function(){a.removeAttribute("class")},b)):($(a).addClass("markerflash"),b&&0<b&&setTimeout(function(){$(a).removeClass("markerflash")},b)):!c&&a&&($(a).removeClass("markerball"),$(a).removeClass("markerShadow"),$(a).removeClass("markerflash"),a.snap&&a.removeAttribute("class")))};A.loadCss=function(a){$("\x3clink\x3e").attr({rel:"stylesheet",type:"text/css",href:a}).appendTo("head")};A.getPointArrayBounds=function(a){if(0==a.length)return null;for(var c=new mxLib.Bounds(a[0],a[0]),b=1;b<a.length;b++)c.extend(a[b]);return c};A.getEventPoint=function(a,c){if(null==c)return new mxLib.Point(0,0);var b=(c.clientX||c.x)-$(c.currentTarget).offset().left,e=(c.clientY||c.y)-$(c.currentTarget).offset().top,b=b||0,e=e||0;return a?a.pixelToPoint(new mxLib.Pixel(b,e)):new mxLib.Point(b,e)};A.getEventPixel=function(a){if(null==a)return new mxLib.Pixel(0,0);var c=(a.clientX||a.x)-$(a.currentTarget).offset().left;a=(a.clientY||a.y)-$(a.currentTarget).offset().top;return new mxLib.Pixel(c||0,a||0)};A.stringFormat=function(){if(0==arguments.length)return null;for(var a=arguments[0],c=1;c<arguments.length;c++)a=a.replace(new RegExp("\\{"+(c-1)+"\\}","gm"),arguments[c]);return a};A.distance=function(a,c){if(a instanceof mxLib.Point)return a.distanceTo(c);if(4==arguments.length){var b=arguments[0],e=arguments[1],m=arguments[2],g=arguments[3];return Math.sqrt((b-m)*(b-m)+(e-g)*(e-g))}};A.getSvgPathBounds=function(a){return(new CanvablePath(a)).bounds()};A.getSvgPathMatrixResult=function(a,c,b,e,m,g,k){if(!Snap)return"";c=new Snap.Matrix(c,b,e,m,g,k);return Snap.path.map(a,c).toString()};A.parseOptions=function(a,c){var b=$(a),e={},m=$.trim(b.attr("data-options"));m&&("{"!=m.substring(0,1)&&(m="{"+m+"}"),e=(new Function("return "+m))());$.map("width height left top minWidth maxWidth minHeight maxHeight".split(" "),function(c){var b=$.trim(a.style[c]||"");b&&(-1==b.indexOf("%")&&(b=parseInt(b)||void 0),e[c]=b)});if(c){for(var m={},g=0;g<c.length;g++){var k=c[g];if("string"==typeof k)m[k]=b.attr(k);else for(var h in k){var r=k[h];"boolean"==r?m[h]=b.attr(h)?"true"==b.attr(h):void 0:"number"==r&&(m[h]="0"==b.attr(h)?0:parseFloat(b.attr(h))||void 0)}}$.extend(e,m)}return e};A.isLowerVersion=function(){return 0<=navigator.userAgent.indexOf("Safari/534.34")?!0:!1};A.supportHtml5=function(){return bSupportHtml5};A.initCanvas=function(a){bSupportHtml5||window.G_vmlCanvasManager&&window.G_vmlCanvasManager.initElement(a)};A.getButton=function(a){if(a.which)return a.which-1;a=a.button;var c={1:0,4:1,2:2};return bSupportHtml5?a:c[a]};A.cloneObject=function(a){if(null===a||"object"!==typeof a)return a;if(a instanceof Array){var c=[],b;for(b in a)a.hasOwnProperty(b)&&("object"===typeof a[b]?c.push(this.cloneObject(a[b])):c.push(a[b]));return c}b={};for(c in a)a.hasOwnProperty(c)&&("object"===typeof a[c]?"[object Date]"==Object.prototype.toString.call(a[c])?b[c]=a[c]:b[c]=a[c]&&"function"==typeof a[c].clone?a[c].clone():this.cloneObject(a[c]):b[c]=a[c]);return b};A.calcCoTransParam=function(a,c){if(a.length!=c.length)return null;for(var b=a.length,e=Array(b),m=Array(b),g=Array(b),k=Array(b),h=0;h<b;h++)e[h]=a[h].x,m[h]=a[h].y,g[h]=c[h].x,k[h]=c[h].y;for(var r,f,q,t,h=t=q=f=r=0;h<b;h++)r+=e[h],f+=m[h],q+=g[h],t+=k[h];r/=b;f/=b;q/=b;t/=b;for(var n=Array(b),w=Array(b),l=Array(b),u=Array(b),h=0;h<b;h++)n[h]=e[h]-r,w[h]=m[h]-f,l[h]=g[h]-q,u[h]=k[h]-t;for(var v=k=g=m=e=0,z=0,h=0;h<b;h++)e+=l[h]*n[h],g+=u[h]*w[h],v+=l[h]*l[h],z+=u[h]*u[h],m+=u[h]*n[h],k+=l[h]*w[h];return{X0:r,Y0:f,x0:q,y0:t,c1:(e+g)/(v+z),d1:(m-k)/(v+z)}};A.calcCoTransValue=function(a,c){var b=a.x,e=a.y,m=c.x0,g=c.y0,k=c.c1,h=c.d1;return new mxLib.Point(c.X0+k*(b-m)+h*(e-g),c.Y0-h*(b-m)+k*(e-g))};mxLib.Util=A;var D=mxLib.GeoUtils={};D.getPointOnLine=function(a,c,b){return new mxLib.Point(c.x+a*(b.x-c.x),c.y+a*(b.y-c.y))};D.getSubPathArray=function(a,c){var b=[];if(1>=c||2>a.length)return b.push(a),b;for(var e=this.getPolylineDistance(a,!1)/c,m=0;m<c;m++){for(var g=[],k=m*e,h=(m+1)*e,r=0,f=0,q=0;q<a.length-1;q++){var t=this.getDistance(a[q],a[q+1]),r=r+t;if(0==f)r<k||(f=(r-k)/t,f=this.getPointOnLine(1-f,a[q],a[q+1]),g.push(f),--q,r-=t,f=1);else if(1==f)if(r<h)g.push(a[q+1]);else{f=(r-h)/t;f=this.getPointOnLine(1-f,a[q],a[q+1]);g.push(f);break}}b.push(g)}return b};D.isPointInRect=function(a,c){if(!(a instanceof mxLib.Point&&c instanceof mxLib.Bounds))return!1;var b=c.getSouthWest(),e=c.getNorthEast();return a.y>=b.y&&a.y<=e.y&&a.x>=b.x&&a.x<=e.x};D.isPointInCircle=function(a,c){if(!(a instanceof mxLib.Point&&c instanceof mxLib.Circle))return!1;var b=c.getCenter(),e=c.getRadius();return D.getDistance(a,b)<=e?!0:!1};D.isPointOnPolyline=function(a,c,b){b=b||1E-5;if(!(a instanceof mxLib.Point&&c instanceof mxLib.Polyline))return!1;var e=c.getBounds();if(!this.isPointInRect(a,e))return!1;c=c.getPath();for(e=0;e<c.length-1;e++){var m=c[e],g=c[e+1];if(a.y>=Math.min(m.y,g.y)&&a.y<=Math.max(m.y,g.y)&&a.x>=Math.min(m.x,g.x)&&a.x<=Math.max(m.x,g.x)&&(m=(m.y-a.y)*(g.x-a.x)-(g.y-a.y)*(m.x-a.x),m<b&&m>-b))return!0}return!1};D.isPointInPolygon=function(a,c){if(!(a instanceof mxLib.Point&&c instanceof mxLib.Polygon))return!1;var b=c.getBounds();if(!this.isPointInRect(a,b))return!1;var b=c.getPath(),e=b.length,m=0,g,k;g=b[0];for(var h=1;h<=e;++h){if(a.equals(g))return!0;k=b[h%e];if(!(a.x<Math.min(g.x,k.x)||a.x>Math.max(g.x,k.x)))if(a.x>Math.min(g.x,k.x)&&a.x<Math.max(g.x,k.x)){if(a.y<=Math.max(g.y,k.y)){if(g.x==k.x&&a.y>=Math.min(g.y,k.y))return!0;if(g.y==k.y){if(g.y==a.y)return!0;++m}else{g=(a.x-g.x)*(k.y-g.y)/(k.x-g.x)+g.y;if(2E-10>Math.abs(a.y-g))return!0;a.y<g&&++m}}}else if(a.x==k.x&&a.y<=k.y){var r=b[(h+1)%e];a.x>=Math.min(g.x,r.x)&&a.x<=Math.max(g.x,r.x)?++m:m+=2}g=k}return 0==m%2?!1:!0};D.degreeToRad=function(a){return Math.PI*a/180};D.radToDegree=function(a){return 180*a/Math.PI};D.getDistance=function(a,c){return mxLib.Util.distance(a,c)};D.getDistanceSphere=function(a,c){if(!(a instanceof mxLib.Point&&c instanceof mxLib.Point))return 0;var e,m,g,k;e=b(a.x,-180,180);m=f(a.y,-74,74);g=b(c.x,-180,180);k=f(c.y,-74,74);e=D.degreeToRad(e);m=D.degreeToRad(m);g=D.degreeToRad(g);k=D.degreeToRad(k);return 6370996.81*Math.acos(Math.sin(m)*Math.sin(k)+Math.cos(m)*Math.cos(k)*Math.cos(g-e))};D.getPolylineDistance=function(a,c){if(a instanceof mxLib.Polyline||a instanceof Array){var b;b=a instanceof mxLib.Polyline?a.getPath():a;if(2>b.length)return 0;for(var e=0,m=0;m<b.length-1;m++)var g=b[m],k=b[m+1],h=0,h=c?D.getDistanceSphere(g,k):D.getDistance(g,k),e=e+h;return e}return 0};D.getPolygonArea=function(a){if(!(a instanceof mxLib.Polygon||a instanceof Array))return 0;var c;c=a instanceof mxLib.Polygon?a.getPath():a;if(3>c.length)return 0;for(var b=a=0,e=0,m=0,g=0,k=0,h=0,r=0,f=g=m=0,q=b=0,t=h=k=e=0,n=0,w=a=h=r=f=q=n=t=k=e=q=b=f=0,l=0,u=0,v=0,z=c.length,v=0;v<z;v++)0==v?(b=c[z-1].y*Math.PI/180,e=c[z-1].x*Math.PI/180,m=c[0].y*Math.PI/180,g=c[0].x*Math.PI/180,k=c[1].y*Math.PI/180,h=c[1].x*Math.PI/180):v==z-1?(b=c[z-2].y*Math.PI/180,e=c[z-2].x*Math.PI/180,m=c[z-1].y*Math.PI/180,g=c[z-1].x*Math.PI/180,k=c[0].y*Math.PI/180,h=c[0].x*Math.PI/180):(b=c[v-1].y*Math.PI/180,e=c[v-1].x*Math.PI/180,m=c[v].y*Math.PI/180,g=c[v].x*Math.PI/180,k=c[v+1].y*Math.PI/180,h=c[v+1].x*Math.PI/180),r=Math.cos(g)*Math.cos(m),m=Math.cos(g)*Math.sin(m),g=Math.sin(g),f=Math.cos(e)*Math.cos(b),b=Math.cos(e)*Math.sin(b),q=Math.sin(e),e=Math.cos(h)*Math.cos(k),k=Math.cos(h)*Math.sin(k),h=Math.sin(h),t=(r*r+m*m+g*g)/(r*f+m*b+g*q),n=(r*r+m*m+g*g)/(r*e+m*k+g*h),f=t*f-r,b=t*b-m,q=t*q-g,e=n*e-r,k=n*k-m,t=n*h-g,h=(e*f+k*b+t*q)/(Math.sqrt(e*e+k*k+t*t)*Math.sqrt(f*f+b*b+q*q)),h=Math.acos(h),n=k*q-t*b,q=0-(e*q-t*f),f=e*b-k*f,r=0!=r?n/r:0!=m?q/m:f/g,0<r?(a+=h,u++):(w+=h,l++);c=a+(2*Math.PI*l-w);u=2*Math.PI*u-a+w;v=a>w?1>c-(z-2)*Math.PI?c:u:1>u-(z-2)*Math.PI?u:c;return a=4.058960035303017E13*(v-(z-2)*Math.PI)};mxLib.GeoUtils=D;var C=mxLib.Animation=function(a){var c={duration:1E3,fps:30,delay:0,transition:F.linear,stop:null};this._anis=[];if(a)for(var b in a)c[b]=a[b];this._opts=c;this._opts.iter=this._opts.iter||this._opts.render;this._opts.stop=this._opts.stop||this._opts.finish;if("number"==typeof c.delay){var e=this;setTimeout(function(){e.start()},c.delay)}else c.delay!=C.INFINITE&&this.start()};C.INFINITE="INFINITE";C.prototype.start=function(){this._beginTime=(new Date).getTime();this._endTime=this._beginTime+this._opts.duration;this._curCount=0;this._launch()};C.prototype.add=function(a){this._anis.push(a)};C.prototype._launch=function(){var a=this,c=(new Date).getTime();a._curCount++;c>=a._endTime?(a._opts.iter&&a._opts.iter(a._opts.transition(1),a._curCount),a._opts.finish&&a._opts.finish(),0<a._anis.length&&(c=a._anis[0],c._anis=[].concat(a._anis.slice(1)),c.start())):(a.schedule=a._opts.transition((c-a._beginTime)/a._opts.duration),a._opts.iter&&a._opts.iter(a.schedule,a._curCount),a.terminative||(a._timer=setTimeout(function(){a._launch()},1E3/a._opts.fps)))};C.prototype.stop=function(a){this.terminative=!0;for(var c=0;c<this._anis.length;c++)this._anis[c].stop(),this._anis[c]=null;this._curCount=this._anis.length=0;this._timer&&(clearTimeout(this._timer),this._timer=null);this._opts.stop&&this._opts.stop(this.schedule);a&&(this._endTime=this._beginTime,this._launch())};C.prototype.cancel=function(){this._timer&&clearTimeout(this._timer);this._endTime=this._beginTime;this._curCount=this.schedule=0};C.prototype.setFinishCallback=function(a){0<this._anis.length?this._anis[this._anis.length-1]._opts.finish=a:this._opts.finish=a};var F={linear:function(a){return a},reverse:function(a){return 1-a},easeInQuad:function(a){return a*a},easeInCubic:function(a){return Math.pow(a,3)},easeOutQuad:function(a){return-(a*(a-2))},easeOutCubic:function(a){return Math.pow(a-1,3)+1},easeInOutQuad:function(a){return.5>a?a*a*2:-2*(a-2)*a-1},easeInOutCubic:function(a){return.5>a?4*Math.pow(a,3):4*Math.pow(a-1,3)+1},easeInOutSine:function(a){return(1-Math.cos(Math.PI*a))/2}};F["ease-in"]=F.easeInQuad;F["ease-out"]=F.easeOutQuad;mxLib.Transitions=F;mxLib.kBj54=1;mxLib.kXa80=2;mxLib.kWgs84=3;mxLib.k2000=4;mxLib.kGcj02=5;mxLib.kBaidu=6;mxLib.kCoBLH=0;mxLib.kCoGxyh=1;mxLib.kCoXYZ=2;mxLib.kBJ54=1;mxLib.kXA80=2;mxLib.kWGS84=3;a.prototype.X0=0;a.prototype.Y0=0;a.prototype.Z0=0;a.prototype.Wx=0;a.prototype.Wy=0;a.prototype.Wz=0;a.prototype.k=1;mxLib.Param7=a;c.prototype.nType=0;c.prototype.a=0;c.prototype.b=0;c.prototype.get_f=function(){return(this.a-this.b)/this.a};c.prototype.get_e1=function(){return Math.sqrt(this.a*this.a-this.b*this.b)/this.a};c.prototype.get_e2=function(){return Math.sqrt(this.a*this.a-this.b*this.b)/this.b};c.prototype.get_e12=function(){return(this.a*this.a-this.b*this.b)/(this.a*this.a)};c.prototype.get_N=function(a){a=Math.sin(a);a=Math.sqrt(1-this.get_e12()*a*a);return this.a/a};c.prototype.get_M=function(a){a=sin(a);a=Math.sqrt(1-this.get_e12()*a*a);return this.a*(1-this.get_e12())/Math.pow(a,3)};e.prototype.coSys=0;e.prototype.coStyles=0;e.prototype.centerLs=0;e.prototype.constantXs=0;e.prototype.constantYs=0;e.prototype.bProjNos=0;e.prototype.nZoneWidths=0;mxLib.TransCfg=e;e.prototype.GetYConst=function(a,c,b){var e=0;b&&(e=3==c?e+1E6*parseInt(a/3):e+1E6*parseInt((a+3)/6));return e};e.prototype.GetEllipsoid=function(){switch(this.coSys){case 3:case 5:case 6:var a=new c(3);return a;case 1:return a=new c(1);case 2:return a=new c(2);case 4:return a=new c(4)}return a=new c};e.prototype.GetYPlusProjNo=function(){return this.constantY+this.GetYConst(this.centerL,this.nZoneWidth,this.bProjNo)};g.prototype.x=0;g.prototype.y=0;g.prototype.z=0;var G=new mxLib.TransCfg,H=new mxLib.TransCfg,E=new mxLib.TransCfg;G.coSys=mxLib.kBaidu;G.coStyle=mxLib.kCoBLH;G.centerL=120;G.constantX=0;G.constantY=5E5;G.bProjNo=0;G.nZoneWidth=3;H.coSys=mxLib.kGcj02;H.coStyle=mxLib.kCoBLH;H.centerL=120;H.constantX=0;H.constantY=5E5;H.bProjNo=0;H.nZoneWidth=3;E.coSys=mxLib.kWgs84;E.coStyle=mxLib.kCoBLH;E.centerL=120;E.constantX=0;E.constantY=5E5;E.bProjNo=0;E.nZoneWidth=3;var I=new mxLib.Param7;I.X0=0;I.Y0=0;I.Z0=0;I.Wx=0;I.Wy=0;I.Wz=0;I.k=1;mxLib.Util.baiduToGoogle=function(a,c){return B(I,G,H,a,c)};mxLib.Util.googleToBaidu=function(a,c){return B(I,H,G,a,c)};mxLib.Util.wgs84ToGoogle=function(a,c){return B(I,E,H,a,c)};mxLib.Util.googleToWgs84=function(a,c){return B(I,H,E,a,c)};mxLib.Util.wgs84ToBaidu=function(a,c){return B(I,E,G,a,c)};mxLib.Util.baiduToWgs84=function(a,c){return B(I,G,E,a,c)};mxLib.Util.coordTrans=B})();(function(){var f=mxLib.Point=function(b,a){this.x="string"==typeof b?parseFloat(b):b;this.y="string"==typeof a?parseFloat(a):a;this.IsRealEqual=mxLib.MxHost.IsRealEqual||function(a,b){return a==b}};f.prototype.x=0;f.prototype.y=0;f.prototype.equals=function(b){var a=null;1<arguments.length&&$.isNumeric(arguments[1])&&(a=arguments[1]);return a?Math.abs(b.x-this.x)<=a&&Math.abs(b.y-this.y)<=a?!0:!1:this.IsRealEqual(b.x,this.x)&&this.IsRealEqual(b.y,this.y)};f.prototype.toPixel=function(b){return b?b.pointToPixel(this.x,this.y):null};f.prototype.distanceTo=function(b){var a=this.x,c=this.y;1==arguments.length&&arguments[0]instanceof mxLib.Point?(a=arguments[0].x,c=arguments[0].y):2==arguments.length&&$.isNumeric(arguments[0])&&$.isNumeric(arguments[1])&&(a=arguments[0],c=arguments[1]);return Math.sqrt((a-this.x)*(a-this.x)+(c-this.y)*(c-this.y))};f.prototype.lng=function(){return this.x};f.prototype.lat=function(){return this.y};f.prototype.clone=function(){return new mxLib.Point(this.x,this.y)}})();(function(){var f=mxLib.Pixel=function(b,a){this.x=b;this.y=a};f.prototype.x=0;f.prototype.y=0;f.prototype.equals=function(b){return this.x==b.x&&this.y==b.y?!0:!1};f.prototype.toPoint=function(b){return b?b.pointToPixel(this.x,this.y):null};f.prototype.clone=function(){return new mxLib.Pixel(this.x,this.y)}})();(function(){var f=mxLib.Bounds=function(){if(4==arguments.length){var b=arguments[0]||0,a=arguments[1]||0,c=arguments[2]||0,e=arguments[3]||0;this.leftBtmPoint=new mxLib.Point(Math.min(b,c),Math.min(a,e));this.rightTopPoint=new mxLib.Point(Math.max(b,c),Math.max(a,e))}else 2==arguments.length?(b=arguments[0],a=arguments[1],b=b||new mxLib.Point(0,0),a=a||new mxLib.Point(0,0),b.x=b.x||0,a.x=a.x||0,b.y=b.y||0,a.y=a.y||0,this.leftBtmPoint=new mxLib.Point(Math.min(b.x,a.x),Math.min(b.y,a.y)),this.rightTopPoint=new mxLib.Point(Math.max(b.x,a.x),Math.max(b.y,a.y))):(this.leftBtmPoint=new mxLib.Point,this.rightTopPoint=new mxLib.Point);this.width=this.rightTopPoint.x-this.leftBtmPoint.x;this.height=this.rightTopPoint.y-this.leftBtmPoint.y};f.prototype.width=0;f.prototype.height=0;f.prototype.equals=function(b){return b?this.leftBtmPoint.equals(b.leftBtmPoint)&&this.rightTopPoint.equals(b.rightTopPoint)?!0:!1:!1};f.prototype.containsPoint=function(b,a){return b instanceof mxLib.Point?a&&(this.leftBtmPoint.equals(b)||this.rightTopPoint.equals(b))?!0:b.x>=this.leftBtmPoint.x&&b.x<=this.rightTopPoint.x&&b.y>=this.leftBtmPoint.y&&b.y<=this.rightTopPoint.y?!0:!1:!1};f.prototype.containsBounds=function(b,a){if(!b)return!1;if(!1!==a)return this.containsPoint(b.leftBtmPoint)&&this.containsPoint(b.rightTopPoint)&&this.containsPoint(b.getRightBottom())&&this.containsPoint(b.getLeftTop())?!0:!1;var c=this.leftBtmPoint.x,e=this.leftBtmPoint.y,g=this.rightTopPoint.x,k=this.rightTopPoint.y,h=b.leftBtmPoint.x,f=b.leftBtmPoint.y,l=b.rightTopPoint.x,m=b.rightTopPoint.y;return 1==Math.abs((c+g)/2-(h+l)/2)>(Math.abs(c-g)+Math.abs(h-l))/2||1==Math.abs((e+k)/2-(f+m)/2)>(Math.abs(e-k)+Math.abs(f-m))/2?!1:!0};f.prototype.getCenter=function(){return new mxLib.Point((this.leftBtmPoint.x+this.rightTopPoint.x)/2,(this.leftBtmPoint.y+this.rightTopPoint.y)/2)};f.prototype.getLeftTop=function(){return new mxLib.Point(this.leftBtmPoint.x,this.rightTopPoint.y)};f.prototype.getLeftBottom=function(){return this.leftBtmPoint};f.prototype.getRightBottom=function(){return new mxLib.Point(this.rightTopPoint.x,this.leftBtmPoint.y)};f.prototype.getRightTop=function(){return this.rightTopPoint};f.prototype.getSouthWest=function(){return this.leftBtmPoint};f.prototype.getNorthEast=function(){return this.rightTopPoint};f.prototype.clone=function(){return new mxLib.Bounds(this.leftBtmPoint,this.rightTopPoint)};f.prototype.extend=function(b){if(void 0==this.leftBtmPoint.x||null==this.leftBtmPoint.x)this.leftBtmPoint.x=b.x;if(void 0==this.leftBtmPoint.y||null==this.leftBtmPoint.y)this.leftBtmPoint.y=b.y;if(void 0==this.rightTopPoint.x||null==this.rightTopPoint.x)this.rightTopPoint.x=b.x;if(void 0==this.rightTopPoint.y||null==this.rightTopPoint.y)this.rightTopPoint.y=b.y;this.containsPoint(b)||(this.leftBtmPoint.x>b.x&&(this.leftBtmPoint.x=b.x),this.rightTopPoint.x<b.x&&(this.rightTopPoint.x=b.x),this.leftBtmPoint.y>b.y&&(this.leftBtmPoint.y=b.y),this.rightTopPoint.y<b.y&&(this.rightTopPoint.y=b.y),this.width=this.rightTopPoint.x-this.leftBtmPoint.x,this.height=this.rightTopPoint.y-this.leftBtmPoint.y)}})();(function(){var f=mxLib.Size=function(){if(4==arguments.length){var b=arguments[0],a=arguments[1],c=arguments[2],e=arguments[3];this.leftTopPixel=new mxLib.Pixel(Math.min(b,c),Math.min(a,e));this.rightBtmPixel=new mxLib.Pixel(Math.max(b,c),Math.max(a,e))}else 2==arguments.length?arguments[0]instanceof mxLib.Pixel?(b=arguments[0],a=arguments[1],this.leftTopPixel=new mxLib.Pixel(Math.min(b.x,a.x),Math.min(b.y,a.y)),this.rightBtmPixel=new mxLib.Pixel(Math.max(b.x,a.x),Math.max(b.y,a.y))):(b=arguments[0],a=arguments[1],this.leftTopPixel=new mxLib.Pixel(0,0),this.rightBtmPixel=new mxLib.Pixel(b,a)):(this.leftTopPixel=new mxLib.Pixel,this.rightBtmPixel=new mxLib.Pixel);this.width=this.rightBtmPixel.x-this.leftTopPixel.y;this.height=this.rightBtmPixel.y-this.leftTopPixel.y};f.prototype.width=0;f.prototype.height=0;f.prototype.equals=function(b){return b?this.leftTopPixel.equals(b.leftTopPixel)&&this.rightBtmPixel.equals(b.rightBtmPixel)?!0:!1:!1};f.prototype.containsPixel=function(b){return this.leftTopPixel.equals(b)||this.rightBtmPixel.equals(b)?!0:b.x>this.leftTopPixel.x&&b.x<this.rightBtmPixel.x&&b.y>this.leftTopPixel.y&&b.y<this.rightBtmPixel.y?!0:!1};f.prototype.containsSize=function(b,a){return!1!==a?this.containsPixel(b.leftTopPixel)&&this.containsPixel(b.rightBtmPixel)?!0:!1:this.containsPixel(b.leftTopPixel)||this.containsPixel(b.rightBtmPixel)?!0:!1};f.prototype.getCenter=function(){return new mxLib.Pixel((this.leftTopPixel.x+this.rightBtmPixel.x)/2,(this.leftTopPixel.y+this.rightBtmPixel.y)/2)};f.prototype.getLeftTop=function(){return this.leftTopPixel};f.prototype.getRightBottom=function(){return this.rightBtmPixel};f.prototype.clone=function(){return new mxLib.Size(this.leftTopPixel,this.rightBtmPixel)}})();(function(){function f(a,c,b){var e=b[0]+b[1]*Math.abs(a),g=Math.abs(c)/b[9];b=b[2]+b[3]*g+b[4]*g*g+b[5]*g*g*g+b[6]*g*g*g*g+b[7]*g*g*g*g*g+b[8]*g*g*g*g*g*g;g={};g.x=e*(0>a?-1:1);g.y=b*(0>c?-1:1);return g}function b(a,c){a=-85.051128>a?-85.051128:85.051128<a?85.051128:a;c=-180<=c&&180>=c?c:((c- -180)%360+360)%360+-180;return{lat:a,lng:c,x:c,y:a}}function a(a,c){var e=b(a,c),g=new mxLib.Point(0,0);g.x=128+.7111111111111111*e.lng;var e=Math.sin(Math.PI/180*e.lat),k=-(1-1E-15),h=1-1E-15,e=e<k?k:e>h?h:e;g.y=128+-20.371832715762604*Math.log((1+e)/(1-e));return g}function c(a,c){return b((2*Math.atan(Math.exp((c-128)/-40.74366543152521))-Math.PI/2)/(Math.PI/180),(a-128)/.7111111111111111)}var e=mxLib.MapType=function(a){this.model=a};e.prototype.getSrc=function(a,c,b,e,g,k){};e.prototype.toMmPoint=function(a){return a};e.prototype.fromMmPoint=function(a){return a};e.prototype.isGCJ02=function(){return null};e=mxLib.MapType_AutoCad=function(a){this.model=a};mxLib.Lang.inherits(e,mxLib.MapType);e.prototype.getSrc=function(a,c,b,e,g,k){if(g=this.model.getMapTileRequestUrl(e,k)){g=g.replace(/{baseurl}/g,this.model.getMapSourceBaseDir());g=g.replace(/{layer}/g,this.model.getMapSourceLayerName());g=g.replace(/{zoom}/g,a);g=g.replace(/{row}/g,c);g=g.replace(/{col}/g,b);g=g.replace(/{width}/g,this.model.getTileWidth());g=g.replace(/{height}/g,this.model.getTileHeight());if(-1!=g.indexOf("{bbox}")){var h=(b-1)*this.model.getTileWidth(),f=(c-1)*this.model.getTileWidth(),n=b*this.model.getTileWidth();k=c*this.model.getTileWidth();var l=this.model.getMapBounds().getLeftTop(),h=l.x+this.model.pixelDistToPointDist(h,!0),f=l.y-this.model.pixelDistToPointDist(f,!1),n=l.x+this.model.pixelDistToPointDist(n,!0);k=l.y-this.model.pixelDistToPointDist(k,!1);g=g.replace(/{bbox}/g,h+","+k+","+n+","+f)}for(var A in this.model.mapTypes)(k=this.model.mapTypes[A])&&0!=k instanceof mxLib.MapType&&(g=k.getSrc(a,c,b,e,g))}else k&&(g=null);return g};var g=[1.289059486E7,8362377.87,5591021,3481989.83,1678043.12,0],k=[75,60,45,30,15,0],h=[[1.410526172116255E-8,8.98305509648872E-6,-1.9939833816331,200.9824383106796,-187.2403703815547,91.6087516669843,-23.38765649603339,2.57121317296198,-.03801003308653,1.73379812E7],[-7.435856389565537E-9,8.983055097726239E-6,-.78625201886289,96.32687599759846,-1.85204757529826,-59.36935905485877,47.40033549296737,-16.50741931063887,2.28786674699375,1.026014486E7],[-3.030883460898826E-8,8.98305509983578E-6,.30071316287616,59.74293618442277,7.357984074871,-25.38371002664745,13.45380521110908,-3.29883767235584,.32710905363475,6856817.37],[-1.981981304930552E-8,8.983055099779535E-6,.03278182852591,40.31678527705744,.65659298677277,-4.44255534477492,.85341911805263,.12923347998204,-.04625736007561,4482777.06],[3.09191371068437E-9,8.983055096812155E-6,6.995724062E-5,23.10934304144901,-2.3663490511E-4,-.6321817810242,-.00663494467273,.03430082397953,-.00466043876332,2555164.4],[2.890871144776878E-9,8.983055095805407E-6,-3.068298E-8,7.47137025468032,-3.53937994E-6,-.02145144861037,-1.234426596E-5,1.0322952773E-4,-3.23890364E-6,826088.5]],n=[[-.0015702102444,111320.7020616939,0x60e374c3105a3,-0x24bb4115e2e164,0x5cc55543bb0ae8,-0x7ce070193f3784,0x5e7ca61ddf8150,-0x261a578d8b24d0,0x665d60f3742ca,82.5],[8.277824516172526E-4,111320.7020463578,6.477955746671607E8,-4.082003173641316E9,1.077490566351142E10,-1.517187553151559E10,1.205306533862167E10,-5.124939663577472E9,9.133119359512032E8,67.5],[.00337398766765,111320.7020202162,4481351.045890365,-2.339375119931662E7,7.968221547186455E7,-1.159649932797253E8,9.723671115602145E7,-4.366194633752821E7,8477230.501135234,52.5],[.00220636496208,111320.7020209128,51751.86112841131,3796837.749470245,992013.7397791013,-1221952.21711287,1340652.697009075,-620943.6990984312,144416.9293806241,37.5],[-3.441963504368392E-4,111320.7020576856,278.2353980772752,2485758.690035394,6070.750963243378,54821.18345352118,9540.606633304236,-2710.55326746645,1405.483844121726,22.5],[-3.218135878613132E-4,111320.7020701615,.00369383431289,823725.6402795718,.46104986909093,2351.343141331292,1.58060784298199,8.77738589078284,.37238884252424,7.45]],e=mxLib.MapType_Baidu=function(a){this.model=a};mxLib.Lang.inherits(e,mxLib.MapType);e.prototype.baiduTileToMmTile=function(a,c,b,e){var g={};g.tileX=e?a-Math.pow(2,b-4)+1:Math.pow(2,b-4)+a-1;g.tileY=2*Math.pow(2,b-4)-c;return g};e.prototype.getSrc=function(a,c,b,e,g){a=this.baiduTileToMmTile(b,c,a,!1);g=g.replace(/{brow}/g,a.tileX);g=g.replace(/{bcol}/g,a.tileY);g=g.replace(/{time}/g,(new Date).getTime());if(-1!=g.indexOf("{bbbox}")){var k=(b-1)*this.model.getTileWidth(),h=(c-1)*this.model.getTileWidth(),f=b*this.model.getTileWidth();a=c*this.model.getTileWidth();e=this.model.getMapBounds().getLeftTop();k=e.x+this.model.pixelDistToPointDist(k,!0);h=e.y-this.model.pixelDistToPointDist(h,!1);f=e.x+this.model.pixelDistToPointDist(f,!0);a=e.y-this.model.pixelDistToPointDist(a,!1);a=this.fromMmPoint(k,a);e=this.fromMmPoint(f,h);g=g.replace(/{bbbox}/g,a.x+","+a.y+","+e.x+","+e.y)}a={TILE_BASE_URLS:["shangetu0.map.bdimg.com","shangetu1.map.bdimg.com","shangetu2.map.bdimg.com","shangetu3.map.bdimg.com","shangetu4.map.bdimg.com"],TILE_ONLINE_URLS:["online0.map.bdimg.com","online1.map.bdimg.com","online2.map.bdimg.com","online3.map.bdimg.com","online4.map.bdimg.com"]};e=(c+b)%a.TILE_ONLINE_URLS.length;g=g.replace(/{TILE_BASE_URLS}/g,a.TILE_BASE_URLS[(c+b)%a.TILE_BASE_URLS.length]);return g=g.replace(/{TILE_ONLINE_URLS}/g,a.TILE_ONLINE_URLS[e])};e.prototype._BaiduPointToMxPoint=function(a,c){var b,e,g=null;for(b=a;180<b;)b-=360;for(;-180>b;)b+=360;e=c;e=Math.max(e,-74);e=Math.min(e,74);for(var h=0;h<k.length;h++)if(e>=k[h]){g=n[h];break}if(null!=g)for(h=k.length-1;0<=h;h--)if(e<=-k[h]){g=n[h];break}b=f(b,e,g);g=b.x-4194304;b=b.y;e=new mxLib.Point(37.677664,0);var h=new mxLib.Point(150.710656,75.355328),l=768*Math.pow(2,14),z=512*Math.pow(2,14);return new mxLib.Point(e.x+g*(h.x-e.x)/l,e.y+b*(h.y-e.y)/z)};e.prototype.toMmPoint=function(a){if(2==arguments.length)return this._BaiduPointToMxPoint(arguments[0],arguments[1]);if(1==arguments.length&&a instanceof mxLib.Point)return this._BaiduPointToMxPoint(a.x,a.y);if(1==arguments.length&&$.isArray(a)){for(var c=[],b=0;b<a.length;b++)c.push(this._BaiduPointToMxPoint(a[b].x,a[b].y));return c}for(var c="",e=a.split(";"),b=0;b<e.length;b++){var g=e[b].split(","),k=parseFloat(g[0]),g=parseFloat(g[1]),k=this._BaiduPointToMxPoint(k,g);0!=b&&(c+=";");c+=k.lng||k.x;c+=",";c+=k.lat||k.y}return c};e.prototype._MxPointToBaiduPoint=function(a,c){for(var b=new mxLib.Point(37.677664,0),e=new mxLib.Point(150.710656,75.355328),k=768*Math.pow(2,14),n=512*Math.pow(2,14),l=a-b.x,z=c-b.y,n=z*n/(e.y-b.y),l=l*k/(e.x-b.x)+4194304,b=n,e=null,l=Math.abs(l),b=Math.abs(b),k=0;k<g.length;k++)if(b>=g[k]){e=h[k];break}l=f(l,b,e);return new mxLib.Point(l.x,l.y)};e.prototype.fromMmPoint=function(a){if(2==arguments.length)return this._MxPointToBaiduPoint(arguments[0],arguments[1]);if(1==arguments.length&&a instanceof mxLib.Point)return this._MxPointToBaiduPoint(a.x,a.y);if(1==arguments.length&&$.isArray(a)){for(var c=[],b=0;b<a.length;b++)c.push(this._MxPointToBaiduPoint(a[b].x,a[b].y));return c}for(var c="",e=a.split(";"),b=0;b<e.length;b++){var g=e[b].split(","),k=parseFloat(g[0]),g=parseFloat(g[1]),k=this._MxPointToBaiduPoint(k,g);0!=b&&(c+=";");c+=k.lng||k.x;c+=",";c+=k.lat||k.y}return c};e.prototype.fromDistMeter=function(a){return 75.355328*a/6684791.283727115};e.prototype.toDistMeter=function(a){return 6684791.283727115*a/75.355328};e.prototype.isGCJ02=function(){return!1};e=mxLib.MapType_QQ=function(a){this.model=a};mxLib.Lang.inherits(e,mxLib.MapType);e.prototype.QQTileToMmTile=function(a,c,b,e){var g={};0==e&&(g.tileX=11*Math.pow(2,b-4)+a-1,g.tileY=11*Math.pow(2,b-4)-c);return g};var l=[0,0,0,0,0,3,0,3,0,3,0,3,0,7,0,7,0,15,0,15,0,31,0,31,0,63,4,59,0,127,12,115,0,225,28,227,356,455,150,259,720,899,320,469,1440,1799,650,929,2880,3589,1200,2069,5760,7179,2550,3709,11520,14349,5100,7999,23060,28689,10710,15429,46120,57369,20290,29849,89990,124729,41430,60689,184228,229827,84169,128886];e.prototype.getSrc=function(a,c,b,e,g){e=this.QQTileToMmTile(b,c,a,!1);var k=Math.pow(2,a)-1;if(0<=g.indexOf("{qcol_2}")){var h=4*a;a=l[h++];var f=l[h++],n=l[h++],h=l[h];if(!(e.tileX>=a&&e.tileX<=f&&k-e.tileY>=n&&k-e.tileY<=h))return""}g=g.replace(/{qrow16}/g,Math.floor(e.tileX/16));g=g.replace(/{qcol16}/g,Math.floor(e.tileY/16));g=g.replace(/{qrow10}/g,Math.floor(e.tileX/10));g=g.replace(/{qcol10}/g,Math.floor(e.tileY/10));g=g.replace(/{qcol10_2}/g,Math.floor((k-e.tileY)/10));g=g.replace(/{qrow}/g,e.tileX);g=g.replace(/{qcol}/g,e.tileY);g=g.replace(/{qcol_2}/g,k-e.tileY);g=g.replace(/{time}/g,parseInt((new Date).getTime()/1E4));-1!=g.indexOf("{qbbox}")&&(a=(b-1)*this.model.getTileWidth(),f=(c-1)*this.model.getTileWidth(),n=b*this.model.getTileWidth(),e=c*this.model.getTileWidth(),k=this.model.getMapBounds().getLeftTop(),a=k.x+this.model.pixelDistToPointDist(a,!0),f=k.y-this.model.pixelDistToPointDist(f,!1),n=k.x+this.model.pixelDistToPointDist(n,!0),e=k.y-this.model.pixelDistToPointDist(e,!1),e=this.fromMmPoint(a,e),k=this.fromMmPoint(n,f),g=g.replace(/{qbbox}/g,e.x+","+e.y+","+k.x+","+k.y));e={TILE_BASE_URLS:["p1.map.gtimg.com","p2.map.gtimg.com","p3.map.gtimg.com"]};return g=g.replace(/{TILE_BASE_URLS}/g,e.TILE_BASE_URLS[(c+b)%e.TILE_BASE_URLS.length])};e.prototype._QQPointToMxPoint=function(c,b){var e=a(b,c);e.x-=176;e.y-=128;return new mxLib.Point(67.5+1.40625*e.x,-(0+1.40625*e.y))};e.prototype.toMmPoint=function(a){if(2==arguments.length)return this._QQPointToMxPoint(arguments[0],arguments[1]);if(1==arguments.length&&a instanceof mxLib.Point)return this._QQPointToMxPoint(a.x,a.y);if(1==arguments.length&&$.isArray(a)){for(var c=[],b=0;b<a.length;b++)c.push(this._QQPointToMxPoint(a[b].x,a[b].y));return c}for(var c=a.split(";"),e="",b=0;b<c.length;b++){var g=c[b].split(","),k=parseFloat(g[0]),g=parseFloat(g[1]),k=this._QQPointToMxPoint(k,g);0!=b&&(e+=";");e+=k.lng||k.x;e+=",";e+=k.lat||k.y}return e};e.prototype._MxPointToQQPoint=function(a,b){var e=16/22.5;a=176+(a-67.5)*e;b=128+(b-0)*e;e=c(a,b);e.lat*=-1;e.y*=-1;return new mxLib.Point(e.lng,e.lat)};e.prototype.fromMmPoint=function(a){if(2==arguments.length)return this._MxPointToQQPoint(arguments[0],arguments[1]);if(1==arguments.length&&a instanceof mxLib.Point)return this._MxPointToQQPoint(a.x,a.y);if(1==arguments.length&&$.isArray(a)){for(var c=[],b=0;b<arr.length;b++)c.push(this._MxPointToQQPoint(arr[b].x,arr[b].y));return c}for(var c=a.split(";"),e="",b=0;b<c.length;b++){var g=c[b].split(","),k=parseFloat(g[0]),g=parseFloat(g[1]),k=this._MxPointToQQPoint(k,g);0!=b&&(e+=";");e+=k.lng||k.x;e+=",";e+=k.lat||k.y}return e};e.prototype.fromDistMeter=function(a){return 67.5*a/6209019.7};e.prototype.toDistMeter=function(a){return 6209019.7*a/67.5};e.prototype.isGCJ02=function(){return!0};e=mxLib.MapType_Google=function(a,c){this.model=a;this.opt=c||{};this.opt.offsetTileX=parseInt(this.opt.offsetTileX||11);this.opt.offsetTileY=parseInt(this.opt.offsetTileY||5)};mxLib.Lang.inherits(e,mxLib.MapType);e.prototype.GGTileToMmTile=function(a,c,b,e){var g={};0==e&&(g.tileX=Math.pow(2,b-4)*this.opt.offsetTileX+a-1,g.tileY=Math.pow(2,b-4)*this.opt.offsetTileY+c-1);return g};e.prototype.getSrc=function(a,c,b,e,g){a=this.GGTileToMmTile(b,c,a,!1);g=g.replace(/{grow16}/g,Math.floor(a.tileX/16));g=g.replace(/{gcol16}/g,Math.floor(a.tileY/16));g=g.replace(/{grow}/g,a.tileX);g=g.replace(/{gcol}/g,a.tileY);if(-1!=g.indexOf("{gbbox}")){var k=(b-1)*this.model.getTileWidth(),h=(c-1)*this.model.getTileWidth(),f=b*this.model.getTileWidth();a=c*this.model.getTileWidth();e=this.model.getMapBounds().getLeftTop();k=e.x+this.model.pixelDistToPointDist(k,!0);h=e.y-this.model.pixelDistToPointDist(h,!1);f=e.x+this.model.pixelDistToPointDist(f,!0);a=e.y-this.model.pixelDistToPointDist(a,!1);a=this.fromMmPoint(k,a);e=this.fromMmPoint(f,h);g=g.replace(/{gbbox}/g,a.x+","+a.y+","+e.x+","+e.y)}a={TILE_BASE_URLS:["mt1.google.cn","mt2.google.cn","mt2.google.cn"]};return g=g.replace(/{TILE_BASE_URLS}/g,a.TILE_BASE_URLS[(c+b)%a.TILE_BASE_URLS.length])};e.prototype._GGPointToMxPoint=function(c,b){var e=a(b,c);e.x-=176;e.y-=128;return new mxLib.Point(67.5+1.40625*e.x,-(0+1.40625*e.y))};e.prototype.toMmPoint=function(a){if(2==arguments.length)return this._GGPointToMxPoint(arguments[0],arguments[1]);if(1==arguments.length&&a instanceof mxLib.Point)return this._GGPointToMxPoint(a.x,a.y);if(1==arguments.length&&$.isArray(a)){for(var c=[],b=0;b<a.length;b++)c.push(this._GGPointToMxPoint(a[b].x,a[b].y));return c}for(var c=a.split(";"),e="",b=0;b<c.length;b++){var g=c[b].split(",");parseFloat(g[0]);parseFloat(g[1]);g=this._GGPointToMxPoint(arr[b].x,arr[b].y);0!=b&&(e+=";");e+=g.lng||g.x;e+=",";e+=g.lat||g.y}return e};e.prototype._MxPointToGGPoint=function(a,b){var e=16/22.5;a=176+(a-67.5)*e;b=128+(b-0)*e;e=c(a,b);e.lat*=-1;e.y*=-1;return new mxLib.Point(e.lng,e.lat)};e.prototype.fromMmPoint=function(a){if(2==arguments.length)return this._MxPointToGGPoint(arguments[0],arguments[1]);if(1==arguments.length&&a instanceof mxLib.Point)return this._MxPointToGGPoint(a.x,a.y);if(1==arguments.length&&$.isArray(a)){for(var c=[],b=0;b<a.length;b++)c.push(this._MxPointToGGPoint(a[b].x,a[b].y));return c}for(var c=a.split(";"),e="",b=0;b<c.length;b++){var g=c[b].split(",");parseFloat(g[0]);parseFloat(g[1]);g=this._MxPointToGGPoint(arr[b].x,arr[b].y);0!=b&&(e+=";");e+=g.lng||g.x;e+=",";e+=g.lat||g.y}return e};e.prototype.fromDistMeter=function(a){return 67.5*a/6209019.7};e.prototype.toDistMeter=function(a){return 6209019.7*a/67.5};e.prototype.isGCJ02=function(){return!0}})();(function(){var f=mxLib.MapZoom=function(b,a){this.zoom=a;this.model=b;var c=Math.round(b.getMapTilesHeight()/b.getTileHeight()),e=Math.round(b.getMapTilesWidth()/b.getTileWidth()),g=a-(b.config.sliceZoom?b.config.sliceZoom:5),c=c*Math.pow(2,g),e=e*Math.pow(2,g);this.tileRows=c;this.tileCols=e;this.tileNum=this.tileRows*this.tileCols};f.prototype.getZoom=function(){return this.zoom};f.prototype.getTileRows=function(){return this.tileRows};f.prototype.getTileCols=function(){return this.tileCols};f.prototype.getTileNum=function(){return this.tileNum};f.prototype.getMapPixelWidth=function(){return this.tileCols*this.model.getTileWidth()-1};f.prototype.getMapPixelHeight=function(){return this.tileRows*this.model.getTileHeight()-1};f.prototype.pixelDistToPointDist=function(b,a){return a?b*this.model.getMapBounds().width/this.getMapPixelWidth():b*this.model.getMapBounds().height/this.getMapPixelHeight()};f.prototype.pointDistToPixelDist=function(b,a){return a?b*this.getMapPixelWidth()/this.model.getMapBounds().width:b*this.getMapPixelHeight()/this.model.getMapBounds().height};f.prototype.pointInTileRowCol=function(b){var a=this.model.getMapBounds(),c=b.x-a.getLeftTop().x;b=a.getLeftTop().y-b.y;c=this.model.pointDistToPixelDist(c,!0);b=this.model.pointDistToPixelDist(b,!1);b=Math.ceil(b/this.model.getTileHeight());c=Math.ceil(c/this.model.getTileWidth());return{row:b,col:c}};f.prototype.tileInBounds=function(b,a,c){var e=this.model.getMapBounds(),g=new mxLib.Point,k=new mxLib.Point;k.x=this.pixelDistToPointDist(a*this.model.getTileWidth(),!0)+e.getLeftTop().x;k.y=e.getLeftTop().y-this.pixelDistToPointDist(b*this.model.getTileHeight(),!1);g.x=k.x-this.pixelDistToPointDist(this.model.getTileWidth(),!0);g.y=k.y+this.pixelDistToPointDist(this.model.getTileHeight(),!1);a=new mxLib.Bounds(g,k);b=a.containsBounds(c,!1);c=c.containsBounds(a,!1);return b||c?!0:!1};f.prototype.getTiles=function(){for(var b=this.model.getViewBounds(),a=this.pointInTileRowCol(b.getLeftTop()),b=this.pointInTileRowCol(b.getRightBottom()),c=[],e=Math.ceil(this.tileRows),g=Math.ceil(this.tileCols),k=0>a.row-0?0:a.row-0,h=b.row+0>this.tileRows?e:b.row+0,f=0>a.col-0?0:a.col-0,l=b.col+0>this.tileCols?g:b.col+0,m=this.model.getMapTileLayerIndex(),q=0;q<m;q++)if(""!==this.model.getMapTileRequestUrl(q,!1)){var r=this.model.getMapTileLayerIndexAtt(q);if(!r||!1!==r.visible){var t=null,w=null;if(!(r&&r.imgShowMaxZoom&&this.zoom>r.imgShowMaxZoom)){r&&r.useTryImgMaxZoom&&this.zoom>=r.useTryImgMaxZoom&&(w=!0);if(r&&r.imgMaxZoom&&this.zoom>r.imgMaxZoom)if(!0===r.bExImgMaxZoomShow)t=r.imgMaxZoom;else continue;for(var u=k;u<=h;u++)for(var v=f;v<=l;v++)if(!(0>=u||0>=v||u>e||v>g||!(u>=a.row&&u<=b.row&&v>=a.col&&v<=b.col)||r&&r.visibleBounds&&!this.tileInBounds(u,v,r.visibleBounds))){var z=new mxLib.MapTile(u,v,this.zoom,q,this.model,t,w,r?r.offsetPoint:null);c.push(z)}for(u=k;u<=h;u++)for(v=f;v<=l;v++)0>=u||0>=v||u>e||v>g||!(u<a.row||u>b.row||v<a.col||v>b.col)||r&&r.visibleBounds&&!this.tileInBounds(u,v,r.visibleBounds)||(z=new mxLib.MapTile(u,v,this.zoom,q,this.model,t,w,r?r.offsetPoint:null),c.push(z))}}}return c}})();(function(){var f=mxLib.MapTile=function(b,a,c,e,g,k,h,f){this.row=b;this.column=a;this.zoom=c;this.layeIndex=e;this.model=g;this.imgMaxZoom=0;this.useTryImgMaxZoom=h;k&&0<k&&(this.imgMaxZoom=k);this.offsetPoint=f};f.prototype.getRow=function(){return this.row};f.prototype.getColumn=function(){return this.column};f.prototype.getZoom=function(){return this.zoom};f.prototype.getLayeIndex=function(){return this.layeIndex};f.prototype.getMapModel=function(){return this.model};f.prototype.getPosition=function(){var b=(this.column-1)*this.model.getTileWidth(),a=(this.row-1)*this.model.getTileWidth(),c=this.model.getMapBounds().getLeftTop();c.x+=this.model.pixelDistToPointDist(b,!0);c.y-=this.model.pixelDistToPointDist(a,!1);b=this.model.pointToPixel(c);b.x+=this.model.getMapTilesExtendPixel();b.y+=this.model.getMapTilesExtendPixel();this.offsetPoint&&(b.x+=this.model.pointDistToPixelDist(this.offsetPoint.x,!0),b.y+=this.model.pointDistToPixelDist(this.offsetPoint.y,!1));b.x=Math.round(b.x);b.y=Math.round(b.y);return b};f.prototype.getSrc=function(b){if(this.useTryImgMaxZoom){if(b)return null;b=!0}var a=this.zoom,c=this.row,e=this.column;this.imgMaxZoom&&(c=Math.ceil(c/Math.pow(2,this.zoom-this.imgMaxZoom)),e=Math.ceil(e/Math.pow(2,this.zoom-this.imgMaxZoom)),a=this.imgMaxZoom);return this.model.getCurrentMapType().getSrc(a,c,e,this.layeIndex,null,b)}})();(function(){function f(a,c,b,g){a._zoomAnimation&&(a._zoomAnimation.stop(),a._zoomAnimation=null);var k=a.map.getPanes().tilePane.style.zIndex;a.map.getPanes().tilePane.style.zIndex=9999999;var h=[],f;for(f in c)h.push(c[f]);var l=[];g=Math.pow(2,g);f=new mxLib.Pixel(-a.mapTilesExtendPixel,-a.mapTilesExtendPixel);b.x-=f.x;b.y-=f.y;for(f=h.length-1;-1<f;f--){var m=h[f].style,q={};q.top=parseInt(m.top)||0;q.left=parseInt(m.left)||0;q.width=parseInt(m.width);q.height=parseInt(m.height);q.dw=q.width*g-q.width;q.dh=q.height*g-q.height;q.dx=(q.left-b.x)*g-(q.left-b.x);q.dy=(q.top-b.y)*g-(q.top-b.y);m.zIndex=100;l[f]=q}b=new mxLib.Animation({fps:a.zoomerFps,duration:a.enableContinuousZoom?a.zoomerDuration||1E3:1,transition:mxLib.Transitions.easeInQuad,iter:function(a,c){if(!(.1>a))for(var b=h.length-1;-1<b;b--){var e=h[b].style,g=l[b];e.top=Math.round(g.top+g.dy*a)+"px";e.left=Math.round(g.left+g.dx*a)+"px";e.width=Math.ceil(g.width+g.dw*a)+"px";e.height=Math.ceil(g.height+g.dh*a)+"px"}},finish:function(){for(var b in c)c[b]&&a.map.getTilesContainer().removeChild(c[b]);a._zoomAnimation=null;a.map.getPanes().tilePane.style.zIndex=k||0},stop:this.finish});a._zoomAnimation=b}var b=mxLib.MapModel=function(a,c){this.map=a;this.config=c||{};this.config.googleSuperMapOffsetTileY=1;this.mc=null;this.mapType=new mxLib.MapType_AutoCad(this);this.mapTilesAutoWH=!1;this.calAutoWidthHeight();this.config.zoom=parseInt(this.config.zoom);this.config.sliceZoom=parseInt(this.config.sliceZoom);this.mapZoom=new mxLib.MapZoom(this,this.config.zoom);this.mapCenter=this.config.center||this.config.mapBounds.getCenter();this.minZoom=this.config.minZoom||1;this.maxZoom=this.config.maxZoom||12;this.oldTiles={};this.mapTypeUrl={};this.mapTypes={};this.mapTileLayerAtt={};this._bloadTilesImmediate=!0;this.enableContinuousZoom=!1===this.config.enableContinuousZoom?!1:!0;this.zoomerDuration=parseInt(this.config.zoomerDuration)||500;this.zoomerFps=parseInt(this.config.zoomerFps)||5;this.mapBlankUrl="true"==this.config.mapBlankUrl?!0:!1;this.config.mapTilesExtendPixel=this.config.mapTilesExtendPixel?parseInt(this.config.mapTilesExtendPixel):null;var b=500;window.bIsMobile&&(b=0);this.mapTilesExtendPixel=null===this.config.mapTilesExtendPixel?b:this.config.mapTilesExtendPixel;this.mapContainerWidth=$(this.map.getContainer()).width();this.mapContainerHeight=$(this.map.getContainer()).height();this.init();1!=this.config.initNoLoadMap&&this.setCenter(this.mapCenter);this._setEventDispath()};b.prototype.init=function(){var a=document.createElement("div");a.id=mxLib.Util.createUniqueID("tiles");a.style.position="absolute";var c=$(this.map.container).width()+2*this.mapTilesExtendPixel,b=$(this.map.container).height()+2*this.mapTilesExtendPixel,g=-this.mapTilesExtendPixel,k=-this.mapTilesExtendPixel;a.style.width=c+"px";a.style.height=b+"px";a.style.top=g+"px";a.style.left=k+"px";$(a).bind("dragstart",function(a){return!1});this.config.backgroundImage?a.style.backgroundImage=this.config.backgroundImage:this.config.backgroundColor&&(a.style.backgroundColor=this.config.backgroundColor);this.map.panes.tilePane.appendChild(a);this.map.tilesContainer=a;if(0==this.config.mapTileRequestUrl instanceof Array){-1!=this.config.mapTileRequestUrl.indexOf("|")&&(b=this.config.mapTileRequestUrl.split("|"),this.config.mapTileRequestUrl=b[0],this.config.mapTileRequestUrlTry=b[1]);if(b=this.getMaptypeUrl(this.config.mapTileRequestUrl))this.config.mapTileRequestUrl=b;this.config.mapTileRequestUrlTry&&(b=this.getMaptypeUrl(this.config.mapTileRequestUrlTry))&&(this.config.mapTileRequestUrlTry=b)}else for(this.config.mapTileRequestUrlTry=[],c=0;c<this.config.mapTileRequestUrl.length;c++)this.config.mapTileRequestUrlTry.push(""),-1!=this.config.mapTileRequestUrl[c].indexOf("|")&&(b=this.config.mapTileRequestUrl[c].split("|"),this.config.mapTileRequestUrl[c]=b[0],this.config.mapTileRequestUrlTry[c]=b[1]),(b=this.getMaptypeUrl(this.config.mapTileRequestUrl[c]))&&(this.config.mapTileRequestUrl[c]=b),this.config.mapTileRequestUrlTry[c]&&(b=this.getMaptypeUrl(this.config.mapTileRequestUrlTry[c]))&&(this.config.mapTileRequestUrlTry[c]=b);window.bIsMobile&&(this.mc=new Hammer(a)).get("pinch").set({enable:!0})};b.prototype.setLoadTilesImmediate=function(a){(this._bloadTilesImmediate=a)&&this.loadTiles()};b.prototype.setMapBounds=function(a){this.config.mapBounds=a.clone();this.mapCenter=this.config.mapBounds.getCenter();this.setCenter(this.mapCenter)};b.prototype.getMapBounds=function(){return this.config.mapBounds.clone()};b.prototype.getCenter=function(){return new mxLib.Point(this.mapCenter.x,this.mapCenter.y)};b.prototype.setCenter=function(a){var c=!1,b=!1,g=0,k=0;1==arguments.length?(g=a.x,k=a.y,2<=arguments.length&&(c=arguments[1]),3<=arguments.length&&(b=arguments[2])):1<arguments.length&&(g=arguments[0],k=arguments[1],3<=arguments.length&&(c=arguments[2]),4<=arguments.length&&(b=arguments[3]));if(b){var h=this.getCenter(),c=this._bloadTilesImmediate;this._bloadTilesImmediate=!0;var f=(g-h.x)/10,l=(k-h.y)/10,m=this;new mxLib.Animation({fps:10,duration:1E3,transition:mxLib.Transitions.easeInQuad,iter:function(a,c){m.mapCenter=new mxLib.Point(h.x+f*c,h.y+l*c);m.loadTiles()},finish:function(){m.mapCenter=new mxLib.Point(g,k);m._bloadTilesImmediate&&(m.loadTiles(),$(m.map.getContainer()).trigger("moveend"))},stop:this.finish});this._bloadTilesImmediate=c}else this._bloadTilesImmediate&&$(this.map.getContainer()).trigger("movestart"),this.mapCenter=new mxLib.Point(g,k),this._bloadTilesImmediate&&(this.loadTiles(),$(this.map.getContainer()).trigger("moveend")),c&&this.setZoom(this.getFitZoom())};b.prototype.calAutoWidthHeight=function(){0==this.mapTilesAutoWH?(this._old_mapTilesWidth=this.config.mapTilesWidth,this._old_mapTilesHeight=this.config.mapTilesHeight):(this.config.mapTilesWidth=this._old_mapTilesWidth,this.config.mapTilesHeight=this._old_mapTilesHeight);if("w"==this.config.mapTilesWidth)this.config.mapTilesWidth=mxLib.MvHost.GetWidth?mxLib.View.getWidth():$(this.map.getContainer()).width(),this.mapTilesAutoWH=!0;else if(this.config.mapTilesWidth&&this.config.mapTilesWidth.indexOf&&0<=this.config.mapTilesWidth.indexOf("w")){var a=0,a=mxLib.MvHost.GetWidth?mxLib.View.getWidth():$(this.map.getContainer()).width();this.config.mapTilesWidth=this.config.mapTilesWidth.replace("w",a);this.config.mapTilesWidth=parseInt(eval(this.config.mapTilesWidth));this.mapTilesAutoWH=!0}"h"==this.config.mapTilesHeight?(this.config.mapTilesHeight=mxLib.MvHost.GetHeight?mxLib.View.getHeight():$(this.map.getContainer()).height(),this.mapTilesAutoWH=!0):this.config.mapTilesHeight&&this.config.mapTilesHeight.indexOf&&0<=this.config.mapTilesHeight.indexOf("h")&&(a=0,a=mxLib.MvHost.GetHeight?mxLib.View.getHeight():$(this.map.getContainer()).height(),this.config.mapTilesHeight=this.config.mapTilesHeight.replace("h",a),this.config.mapTilesHeight=parseInt(eval(this.config.mapTilesHeight)),this.mapTilesAutoWH=!0);if("fit"==this.config.mapTilesStrechMode){var a=this.config.mapBounds.width*this.config.mapTilesHeight/this.config.mapBounds.height,c=this.config.mapBounds.height*this.config.mapTilesWidth/this.config.mapBounds.width;a<this.config.mapTilesWidth?this.config.mapTilesWidth=parseInt(a):this.config.mapTilesHeight=parseInt(c)}};b.prototype.zoomWindow=function(){var a,c,b,g;2==arguments.length&&arguments[0]instanceof mxLib.Point&&arguments[1]instanceof mxLib.Point?(a=arguments[0].x,c=arguments[0].y,b=arguments[1].x,g=arguments[1].y):4==arguments.length&&(a=arguments[0],c=arguments[1],b=arguments[2],g=arguments[3]);if(a&&c&&b&&g){var k=Math.abs(a-b),h=Math.abs(g-c),f=parseInt(this.getMaxZoom()),l=parseInt(this.getFullZoom());for(f;f>=this.getMinZoom();f--){var m=new mxLib.MapZoom(this,f);if(m.pointDistToPixelDist(k,!0)<=this.getContainerWidth()&&m.pointDistToPixelDist(h,!1)<=this.getContainerHeight()){l=f;break}}a=new mxLib.Point((b+a)/2,(g+c)/2);this.zoomPixelPos=this.map.pointToPixel(a);this.centerAndZoom(a,l)}};b.prototype.getMinZoom=function(){return this.minZoom};b.prototype.getMaxZoom=function(){return this.maxZoom};b.prototype.getFullZoom=function(){return this.config.fullZoom||5};b.prototype.getFitZoom=function(){return this.config.fitZoom||9};b.prototype.getMapTilesWidth=function(){return this.config.mapTilesWidth};b.prototype.getMapTilesHeight=function(){return this.config.mapTilesHeight};b.prototype.getTileWidth=function(){return this.config.tileWidth};b.prototype.getTileHeight=function(){return this.config.tileHeight};b.prototype.getMapTilesExtendPixel=function(){return this.mapTilesExtendPixel};b.prototype.getContainerWidth=function(){return this.mapContainerWidth};b.prototype.getContainerHeight=function(){return this.mapContainerHeight};b.prototype.getViewBounds=function(){var a=this.pixelToPoint(0,0),c=this.pixelToPoint(this.mapContainerWidth,this.mapContainerHeight);return new mxLib.Bounds(a,c)};b.prototype.pointToPixel=function(a,c){var b=a,g=c;a instanceof mxLib.Point&&(b=a.x,g=a.y);var k=g-this.mapCenter.y,g=this.mapContainerWidth/2,h=this.mapContainerHeight/2,b=this.pointDistToPixelDist(b-this.mapCenter.x,!0),k=this.pointDistToPixelDist(k,!1);return new mxLib.Pixel(Math.round(g+b),Math.round(h-k))};b.prototype.pixelToPoint=function(a,c){var b=a,g=c;a instanceof mxLib.Pixel&&(b=a.x,g=a.y);g=(g||0)-this.mapContainerHeight/2;b=this.pixelDistToPointDist((b||0)-this.mapContainerWidth/2,!0);g=this.pixelDistToPointDist(g,!1);return new mxLib.Point(this.mapCenter.x+b,this.mapCenter.y-g)};b.prototype.pixelDistToPointDist=function(a,c){return this.mapZoom.pixelDistToPointDist(a,c)};b.prototype.pointDistToPixelDist=function(a,c){return this.mapZoom.pointDistToPixelDist(a,c)};b.prototype.getCurrentMapType=function(){return this.mapType};b.prototype.setMapSourceBaseDir=function(a){this.config.mapSourceBase=a};b.prototype.getMapSourceBaseDir=function(){return this.config.mapSourceBase};b.prototype.setServiceUrl=function(a){this.config.serviceUrl=a};b.prototype.getServiceUrl=function(){return this.config.serviceUrl};b.prototype.setMapTileRequestUrl=function(a){this.config.mapTileRequestUrl=a;this.config.mapTileRequestUrlTry="";if(-1==a.indexOf("^")){if(-1!=this.config.mapTileRequestUrl.indexOf("|")){var c=this.config.mapTileRequestUrl.split("|");this.config.mapTileRequestUrl=c[0];this.config.mapTileRequestUrlTry=c[1]}if(c=this.getMaptypeUrl(this.config.mapTileRequestUrl))this.config.mapTileRequestUrl=c;this.config.mapTileRequestUrlTry&&(c=this.getMaptypeUrl(this.config.mapTileRequestUrlTry))&&(this.config.mapTileRequestUrlTry=c)}else for(this.config.mapTileRequestUrl=a.split("^"),this.config.mapTileRequestUrlTry=[],a=0;a<this.config.mapTileRequestUrl.length;a++)this.config.mapTileRequestUrlTry.push(""),-1!=this.config.mapTileRequestUrl[a].indexOf("|")&&(c=this.config.mapTileRequestUrl[a].split("|"),this.config.mapTileRequestUrl[a]=c[0],this.config.mapTileRequestUrlTry[a]=c[1]),(c=this.getMaptypeUrl(this.config.mapTileRequestUrl[a]))&&(this.config.mapTileRequestUrl[a]=c),this.config.mapTileRequestUrlTry[a]&&(c=this.getMaptypeUrl(this.config.mapTileRequestUrlTry[a]))&&(this.config.mapTileRequestUrlTry[a]=c)};b.prototype.setMapTileLayerRequestUrl=function(a,c){var b="",g=[];if(0==this.config.mapTileRequestUrl instanceof Array)if(0==a)this.config.mapTileRequestUrl=c;else{var k=this.config.mapTileRequestUrl;this.config.mapTileRequestUrlTry&&(k=k+"|"+this.config.mapTileRequestUrlTry);g.push(k);for(var h=1;h<a;h++)g.push("");g.push(c)}else for(h=0;h<=a;h++)h==a?g.push(c):h<this.config.mapTileRequestUrl.length?(k=this.config.mapTileRequestUrl[h],this.config.mapTileRequestUrlTry[h]&&(k=k+"|"+this.config.mapTileRequestUrlTry[h]),g.push(k)):g.push("");for(h=0;h<g.length;h++)0!=h&&(b+="^"),b+=g[h];this.setMapTileRequestUrl(b||c)};b.prototype.getMapTileRequestUrl=function(a,c){return c?0==this.config.mapTileRequestUrlTry instanceof Array?a?null:this.config.mapTileRequestUrlTry:a<this.config.mapTileRequestUrlTry.length?this.config.mapTileRequestUrlTry[a]:null:0==this.config.mapTileRequestUrl instanceof Array?a?null:this.config.mapTileRequestUrl:a<this.config.mapTileRequestUrl.length?this.config.mapTileRequestUrl[a]:null};b.prototype.clearMapTileLayers=function(){this.setMapTileRequestUrl("")};b.prototype.setMapTileLayerIndexVisible=function(a,c){var b=this.getMapTileLayerIndexAtt(a);null==b&&(b={});b.visible=0==c?!1:!0;this.setMapTileLayerIndexAtt(a,b)};b.prototype.setMapTileLayerIndexAtt=function(a,b){a>=this.getMapTileLayerIndex()||(this.mapTileLayerAtt[a]=b)};b.prototype.getMapTileLayerIndexAtt=function(a){return a>=this.getMapTileLayerIndex()?null:this.mapTileLayerAtt[a]};b.prototype.getMapTileLayerIndex=function(){return 0==this.config.mapTileRequestUrl instanceof Array?1:this.config.mapTileRequestUrl.length};b.prototype.setMapSourceLayerName=function(a){this.config.mapSourceLayerName=a};b.prototype.getMapSourceLayerName=function(){return this.config.mapSourceLayerName};b.prototype.getMapZoom=function(){return this.mapZoom};b.prototype.setZoom=function(a){a=parseInt(a);a>this.maxZoom?a=this.maxZoom:a<this.minZoom&&(a=this.minZoom);this.getZoom()!=a&&(this.mapZoom=new mxLib.MapZoom(this,a),this._bloadTilesImmediate&&(this.zoomPixelPos=this.map.pointToPixel(this.getCenter()),this.loadTiles(),$(this.map.getContainer()).trigger("zoomend",a)))};b.prototype.setMaptypeUrl=function(a,b){this.mapTypeUrl[a]=b};b.prototype.newMapType=function(a){if("baiduWeb"==a||"baiduSate"==a||"baiduLabel"==a||"baiduTraffic"==a)this.getMapType("baidu")||this.registerMapType("baidu",new mxLib.MapType_Baidu(this));else if("qqWeb"==a||"qqTraffic"==a)this.getMapType("qq")||this.registerMapType("qq",new mxLib.MapType_QQ(this));else if("googleWeb"==a||"googleSate"==a||0==a.indexOf("google"))this.config[a+"OffsetTileX"]||this.config[a+"OffsetTileY"]?this.getMapType(a)||(offsetTileX=this.config[a+"OffsetTileX"],offsetTileY=this.config[a+"OffsetTileY"],this.registerMapType(a,new mxLib.MapType_Google(this,{offsetTileX:offsetTileX,offsetTileY:offsetTileY}))):this.getMapType("google")||this.registerMapType("google",new mxLib.MapType_Google(this));else return!1;return!0};b.prototype.getMaptypeUrl=function(a){0==this.newMapType(a)&&this.config.maptype&&this.newMapType(this.config.maptype);if(!this.mapTypeUrl[a]){if("baiduWeb"==a)return this.config.baiduWeb||"http://{TILE_ONLINE_URLS}/tile/?qt\x3dtile\x26styles\x3dpl\x26x\x3d{brow}\x26y\x3d{bcol}\x26z\x3d{zoom}";if("baiduSate"==a)return this.config.baiduSate||"http://{TILE_BASE_URLS}/it/u\x3dx\x3d{brow};y\x3d{bcol};z\x3d{zoom};v\x3d009;type\x3dsate\x26fm\x3d46\x26udt\x3d";if("baiduLabel"==a)return this.config.baiduLabel||"http://online3.map.bdimg.com/onlinelabel/?qt\x3dtile\x26x\x3d{brow}\x26y\x3d{bcol}\x26z\x3d{zoom}\x26styles\x3dsl\x26v\x3d083\x26p\x3d1\x26udt\x3d";if("baiduTraffic"==a)return this.config.baiduTraffic||"http://its.map.baidu.com:8002/traffic/TrafficTileService?level\x3d{zoom}\x26x\x3d{brow}\x26y\x3d{bcol}\x26time\x3d{time}\x26v\x3d081";if("qqWeb"==a)return this.config.qqWeb||"http://{TILE_BASE_URLS}/maptilesv2/{zoom}/{qrow16}/{qcol16}/{qrow}_{qcol}.png";if("qqTraffic"==a)return this.config.qqTraffic||"http://rtt2.map.qq.com/live/{zoom}/{qrow10}/{qcol10_2}/{qrow}_{qcol_2}.png?timeKey\x3d{time}";if("googleWeb"==a)return this.config.googleWeb||"http://{TILE_BASE_URLS}/vt/hl\x3dzh-CN\x26gl\x3dCN\x26src\x3dapp\x26x\x3d{grow}\x26y\x3d{gcol}\x26z\x3d{zoom}\x26s\x3dGa";if("googleSate"==a)return this.config.googleSate||"http://{TILE_BASE_URLS}/vt/lyrs\x3dy\x26hl\x3dzh-cn\x26gl\x3dcn\x26x\x3d{grow}\x26y\x3d{gcol}\x26z\x3d{zoom}";if(0==a.indexOf("google"))return this.config[a]}return null};b.prototype.registerMapType=function(a,b){0!=b instanceof mxLib.MapType&&(b.model=this,this.mapTypes[a]=b)};b.prototype.getMapType=function(a){if(!a){for(var b in this.mapTypes)return this.mapTypes[b];return null}a=this.mapTypes[a];return 0==a instanceof mxLib.MapType?null:a};b.prototype.getZoom=function(){return this.mapZoom.getZoom()};b.prototype.zoomIn=function(){this.setZoom(this.getZoom()+1)};b.prototype.zoomOut=function(){this.setZoom(this.getZoom()-1)};b.prototype.centerAndZoom=function(a,b){this.setLoadTilesImmediate(!1);this.setZoom(b);this.zoomPixelPos=this.map.pointToPixel(a);this.setLoadTilesImmediate(!0);this.setCenter(a)};b.prototype.loadTiles=function(){if(!this.mapBlankUrl){var a=this.getMapZoom(),b=a.getTiles(),e=this.oldTilesZoom&&a.getZoom()!=this.oldTilesZoom,g=e;window.bIsIe9or10&&(e=!1);0==this.enableContinuousZoom&&(e=!1);if(g&&!e||1==this.noZoomAnimate)$(this.map.getTilesContainer()).empty(),this.oldTiles=[];e&&1!=this.noZoomAnimate&&f(this,this.oldTiles,this.zoomPixelPos,a.getZoom()-this.oldTilesZoom);g={};if(b)for(var k=0;k<b.length;k++){var h=b[k],n=h.getPosition(),l=b[k].getSrc();if(""!=l&&null!=l){var m=mxLib.Util.stringFormat("\x26row\x3d{0}\x26col\x3d{1}\x26zoom\x3d{2}\x26layer\x3d{3}",h.row,h.column,h.zoom,h.layeIndex),q=this.oldTiles[l+m],r=0<h.imgMaxZoom;if(r){if(this._newTiles&&this._newTiles[l+m])continue}else if(q){q.style.left=n.x+"px";q.style.top=n.y+"px";q.style.zIndex=b[k].getLayeIndex();g[l+m]=q;this.oldTiles[l+m]=null;continue}q=document.createElement("img");bIsMsIe6&&(0<l.indexOf(".png")||0<l.indexOf(".PNG"))&&$(q).addClass("pngImg");q.src=l;q.trySrc=b[k].getSrc(!0);q.style.position="absolute";q.style.left=n.x+"px";q.style.top=n.y+"px";var t=0;this.config.tileStretchPixel&&(t=parseInt(this.config.tileStretchPixel));q.style.width=this.getTileWidth()+t+"px";q.style.height=this.getTileHeight()+t+"px";q.style.zIndex=b[k].getLayeIndex();q.galleryImg="no";q.onmousedown=null;if(r){var r=this.getTileWidth(),t=this.getTileHeight(),w=h.column%Math.pow(2,h.zoom-h.imgMaxZoom);0==w&&(w=Math.pow(2,h.zoom-h.imgMaxZoom));--w;n.x-=w*r;w=h.row%Math.pow(2,h.zoom-h.imgMaxZoom);0==w&&(w=Math.pow(2,h.zoom-h.imgMaxZoom));--w;n.y-=w*t;q.style.left=Math.round(n.x)+"px";q.style.top=Math.round(n.y)+"px";q.style.width=Math.round(r*Math.pow(2,h.zoom-h.imgMaxZoom))+"px";q.style.height=Math.round(t*Math.pow(2,h.zoom-h.imgMaxZoom))+"px"}var u=parseInt(this.config.errorRefrshInterval);if(0<u){var v=this;q.onerror=function(){var a=this,b=a.src;v.config.errorImg&&(this.src=v.config.errorImg);a.trySrc?(a.src=a.trySrc,a.trySrc=null,b=a.src):setTimeout(function(){if(a&&b)if("false"===v.config.tryTimestamp)a.src=b;else{var c=b,e=c.indexOf("\x26_mmtimestamp_\x3d");-1!=e&&(c=c.substr(0,e));a.src=c+"\x26_mmtimestamp_\x3d"+(new Date).getTime()}},u)}}else if(this.config.errorImg||q.trySrc)v=this,q.onerror=function(){this.trySrc?(v.config.errorImg&&(this.src=v.config.errorImg),this.src=this.trySrc,this.trySrc=null):v.config.errorImg&&(this.src=v.config.errorImg)};this.map.getTilesContainer().appendChild(q);g[l+m]=q}}if(!e)for(var z in this.oldTiles)this.oldTiles[z]&&this.map.getTilesContainer().removeChild(this.oldTiles[z]);this.oldTiles=g;this.oldTilesZoom=a.getZoom()}};b.prototype._setEventDispath=function(a){function b(a,c,e){var g=new mxLib.Pixel(a,c),m=k.pixelToPoint(a,c);k.setLoadTilesImmediate(!1);var h=0<e;window.bIsMobile&&(h=1<e);h?window.bIsMobile?(e=Math.round(e),0==e&&(e=1),k.setZoom(k.getZoom()+e)):k.zoomIn():window.bIsMobile?(e=Math.round(1/e),0==e&&(e=1),k.setZoom(k.getZoom()-e)):k.zoomOut();a-=k.mapContainerWidth/2;c-=k.mapContainerHeight/2;a=k.pixelDistToPointDist(a,!0);c=k.pixelDistToPointDist(c,!1);m.x-=a;m.y+=c;k.setCenter(m);k.zoomPixelPos=g;k.setLoadTilesImmediate(!0);$(k.map.getContainer()).trigger("zoomend",k.getZoom())}function e(a,b){if(h){f&&(f=!1,k.setLoadTilesImmediate(!1),$(k.map.getContainer()).trigger("dragstart"));var c=b-q,e=l.x-k.pixelDistToPointDist(a-m,!0),c=l.y+k.pixelDistToPointDist(c,!1);k.setCenter(new mxLib.Point(e,c));$(k.map.getContainer()).trigger("dragging")}}function g(a,b){if(l)if(f)f=h=!1,l=null;else{f=h=!1;var c=b-q,e=l.x-k.pixelDistToPointDist(a-m,!0),c=l.y+k.pixelDistToPointDist(c,!1);l=null;k.setLoadTilesImmediate(!1);k.setCenter(new mxLib.Point(e,c));k.setLoadTilesImmediate(!0);$(k.map.getContainer()).trigger("dragend")}}var k=this;!0!==a&&($(this.map.getContainer()).mousewheel(function(a,e){var g=mxLib.Util.getEventPixel(a);b(g.x,g.y,e)}),$(window).resize(function(){var a,b;a=$(k.map.getContainer()).width();b=$(k.map.getContainer()).height();var c=!1;if(a!=k.mapContainerWidth||b!=k.mapContainerHeight)c=!0;k.mapContainerWidth=a;k.mapContainerHeight=b;c&&(k.mapTilesAutoWH&&"fit"==k.config.mapTilesResizeMode&&(k.calAutoWidthHeight(),k.mapZoom=new mxLib.MapZoom(k,k.getZoom())),k.loadTiles(),$(k.map.getContainer()).trigger("resize"))}));var h=!1,f=!0,l=null,m=null,q=null;$(this.map.getContainer()).mousedown(function(a){var b=mxLib.Util.getButton(a);k.map.isLeftButtonPan()&&0==b&&(b=1);1==b&&(b=mxLib.Util.getEventPixel(a),a=b.x,b=b.y,f=h=!0,l=k.getCenter(),m=a,q=b)});$(this.map.getContainer()).mousemove(function(a){a=mxLib.Util.getEventPixel(a);e(a.x,a.y)});$(this.map.getContainer()).mouseup(function(a){var b=mxLib.Util.getButton(a);k.map.isLeftButtonPan()&&0==b&&(b=1);1==b&&(a=mxLib.Util.getEventPixel(a),g(a.x,a.y))});window.bIsMobile&&(this.mc.on("panstart",function(a){var b=a.center.x;a=a.center.y;f=h=!0;l=k.getCenter();m=b;q=a}),this.mc.on("panmove",function(a){e(a.center.x,a.center.y)}),this.mc.on("panend",function(a){g(a.center.x,a.center.y)}),this.mc.on("pinchstart pinchmove pinchend",function(a){var e=k;if("pinchstart"==a.type){a=a.center;k.zoomPixelPos=new mxLib.Pixel(a.x,a.y);k._oldTilePaneZIndex=e.map.getPanes().tilePane.style.zIndex;e.map.getPanes().tilePane.style.zIndex=9999999;a=[];for(var g in k.oldTiles)a.push(k.oldTiles[g]);for(var m=a.length-1;-1<m;m--){var h=a[m],h=h.style;h.oldLeft=h.left;h.oldTop=h.top}}else if("pinchend"==a.type){e.map.getPanes().tilePane.style.zIndex=k._oldTilePaneZIndex||0;var f=a.scale;k.noZoomAnimate=!0;b(k.zoomPixelPos.x,k.zoomPixelPos.y,f);k.noZoomAnimate=!1}else if("pinchmove"==a.type){f=a.scale;a=[];for(g in k.oldTiles)a.push(k.oldTiles[g]);g=k.zoomPixelPos;m=new mxLib.Pixel(-e.mapTilesExtendPixel,-e.mapTilesExtendPixel);g.x-=m.x;g.y-=m.y;for(m=a.length-1;-1<m;m--){var h=a[m],h=h.style,q,n,l,D,C,F,G,H;q=parseInt(h.oldTop)||0;n=parseInt(h.oldLeft)||0;l=e.getTileWidth();D=e.getTileHeight();C=l*f-l;F=D*f-D;G=(n-g.x)*f-(n-g.x);H=(q-g.y)*f-(q-g.y);h.zIndex=100;h.top=Math.round(q+H)+"px";h.left=Math.round(n+G)+"px";h.width=Math.ceil(l+C)+"px";h.height=Math.ceil(D+F)+"px"}}}))}})();(function(){function f(a){function c(){if(a.panesParentDiv){var b=a.getCenter(),e=b.x-a._centerOld.x,b=b.y-a._centerOld.y,e=a.pointDistToPixelDist(Math.abs(e),!0)*(0<e?-1:1),b=a.pointDistToPixelDist(Math.abs(b),!1)*(0<b?1:-1);a.panesParentDiv.style.left=e+"px";a.panesParentDiv.style.top=b+"px";a._isMiddleMode&&(a._MiddleMaskImg.style.left=e+a._SaveContainerPos.left+"px",a._MiddleMaskImg.style.top=b+a._SaveContainerPos.top+"px")}}$(a.container).dblclick(function(b){if(0!=mxLib.Util.getButton(b)||!a.isControlMode()||b.target.id!=a.container.id||!a.eventInMapTarget(b))return!0;var c=mxLib.Util.getEventPixel(b);b=c.x;c=c.y;if("true"!=mxLib.View.getExtData(MV_ATTR_DBCLICKNOPANMAP))return"true"!=mxLib.View.getExtData(MV_ATTR_DBCCLKPANMAPNOFIT)?a.element.PanToPixel(b,c,!1):a.element.PanToPixel(b,c,!0),!1});$(a.container).mousedown(function(a){mxLib.Util.getButton(a)});$(a.container).mouseup(function(b){if(1!=mxLib.Util.getButton(b)&&2==mxLib.Util.getButton(b)&&a._ContextMenu)return a.showContextMenu(b),!1});a.addEventListener("message",function(a,b){mxLib.Util.toast(a,b)});a.addEventListener("zoomend",function(b){a.panesParentDiv&&(a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px");for(b=0;b<a.overlays.length;b++)a.overlays[b].draw(!0);for(b=0;b<a.controls.length;b++)a.controls[b].curZoomInRange()});a.addEventListener("dragstart",function(b){a.panesParentDiv&&(a._centerOld=a.getCenter());a._bDragstart=!0;a._isMiddleMode&&(a._saveStyleLeft&&(a._MiddleMaskImg.style.left=a._saveStyleLeft,a._MiddleMaskImg.style.top=a._saveStyleTop,a.setRealRefresh(!0)),a._SaveContainerPos=$(a.container).position(),a._saveStyleLeft=a._MiddleMaskImg.style.left,a._saveStyleTop=a._MiddleMaskImg.style.top);!0===a.isDragging&&a.panesParentDiv&&(a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px");a.isDragging=!0});a.addEventListener("dragging",function(b){a._bDragstart&&(a._isMiddleMode&&a.setRealRefresh(!1),a._bDragstart=!1);c()});a.addEventListener("dragend",function(b){a.panesParentDiv&&(a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px");a._isMiddleMode&&(!1===a._bDragstart&&a.setRealRefresh(!0),a._MiddleMaskImg.style.left=a._saveStyleLeft,a._MiddleMaskImg.style.top=a._saveStyleTop,a._saveStyleLeft=null,a._saveStyleTop=null);for(b=0;b<a.overlays.length;b++)a.overlays[b].draw();a.isDragging=!1});a.addEventListener("movestart",function(b){if(a.panesParentDiv||a._isMiddleMode)a._centerOld=a.getCenter(),a._bMovestart=!0,a._isMiddleMode&&(a._saveStyleLeft=a.container.style.left,a._saveStyleTop=a.container.style.top)});a.addEventListener("moving",function(b){a._bMovestart&&(a._isMiddleMode&&a.setRealRefresh(!1),a._bMovestart=!1);c()});a.addEventListener("moveend",function(b){if(a.panesParentDiv||a._isMiddleMode)a.panesParentDiv.style.left="0px",a.panesParentDiv.style.top="0px",a._isMiddleMode&&(!1===a._bMovestart&&a.setRealRefresh(!0),a.container.style.left=a._saveStyleLeft,a.container.style.top=a._saveStyleTop,a._saveStyleLeft=null,a._saveStyleTop=null);for(b=0;b<a.overlays.length;b++)a.overlays[b].draw()});a.addEventListener("resize",function(){for(var b=0;b<a.overlays.length;b++)a.overlays[b].draw()});b(a)}function b(a){function b(c){c=mxLib.Util.getEventPixel(c);c=new mxLib.Pixel(c.x,c.y);var e=a.pixelToPoint(c);return{pixel:c,point:e}}if(0==a.hotspots.length)a.hotspotpixels_visble.length=0,a._hotspot_clickFunc&&a.removeEventListener("click",a._hotspot_clickFunc),a._hotspot_mousemoveFunc&&a.removeEventListener("mousemove",a._hotspot_mousemoveFunc);else if(!a._hotspot_clickFunc){setTimeout(function(){c(a)},100);a.addEventListener("zoomend",function(b){c(a)});a.addEventListener("dragend",function(){c(a)});a.addEventListener("moveend",function(){c(a)});a.addEventListener("resize",function(){c(a)});a.addEventListener("mouseup",a._hotspot_clickFunc=function(c){if(1!=mxLib.Util.getButton(c))for(var e=mxLib.Util.getEventPixel(c),g=e.x,e=e.y,k=b(c),h=0;h<a.hotspotpixels_visble.length;h++)if(g>=a.hotspotpixels_visble[h].x-a.hotspots_visble[h].offsets[3]&&g<=a.hotspotpixels_visble[h].x+a.hotspots_visble[h].offsets[1]&&e>=a.hotspotpixels_visble[h].y-a.hotspots_visble[h].offsets[0]&&e<=a.hotspotpixels_visble[h].y+a.hotspots_visble[h].offsets[2]){0==mxLib.Util.getButton(c)?$(a.container).trigger("hotspotclick",{point:k.point,pixel:k.pixel,spots:a.hotspots_visble[h]}):2==mxLib.Util.getButton(c)&&$(a.container).trigger("hotspotrightclick",{point:k.point,pixel:k.pixel,spots:a.hotspots_visble[h]});break}});var e=a.container.style.cursor;a.addEventListener("mousemove",a._hotspot_mousemoveFunc=function(c){var g=mxLib.Util.getEventPixel(c),k=g.x,h=g.y;if(!a.isDragging){c=b(c);for(var g=!1,f=0;f<a.hotspotpixels_visble.length;f++)if(k>=a.hotspotpixels_visble[f].x-a.hotspots_visble[f].offsets[3]&&k<=a.hotspotpixels_visble[f].x+a.hotspots_visble[f].offsets[1]&&h>=a.hotspotpixels_visble[f].y-a.hotspots_visble[f].offsets[0]&&h<=a.hotspotpixels_visble[f].y+a.hotspots_visble[f].offsets[2]){a.container.style.cursor="pointer";g=!0;a._curHotspotPointIndex!==f&&($(a.container).trigger("hotspotover",{point:c.point,pixel:c.pixel,spots:a.hotspots_visble[f]}),""!=a.hotspots_visble[f].getText()&&a.hotspot_lable&&(a.hotspot_lable.setContent(a.hotspots_visble[f].getText()),k=a.hotspots_visble[f].getPosition(),k=a.pointToPixel(k),k.y+=a.hotspots_visble[f].offsets[2],k=a.pixelToPoint(k),a.hotspot_lable.setPosition(k),a.hotspot_lable.show(),a.hotspot_lable.draw()),a.hotspot_marker&&a.hotspot_symbol&&(k=Math.abs(a.hotspots_visble[f].offsets[3]+a.hotspots_visble[f].offsets[1]),h=Math.abs(a.hotspots_visble[f].offsets[0]+a.hotspots_visble[f].offsets[2]),a.hotspot_symbol.style.shapeRectWidth=k,a.hotspot_symbol.style.shapeRectHeight=h,a.config.enableCustomHotspotMarker?$(a.container).trigger("hotspotmarker",{point:c.point,pixel:c.pixel,spots:a.hotspots_visble[f],width:k,height:h,icon:a.hotspot_symbol,marker:a.hotspot_marker,hotspotPositon:a.hotspots_visble[f].getPosition()}):(a.hotspot_symbol.init(),a.hotspot_marker.setIcon(a.hotspot_symbol),a.hotspot_marker.setPosition(a.hotspots_visble[f].getPosition()),a.hotspot_marker.show())),(a._curHotspotPointIndex||0===a._curHotspotPointIndex)&&$(a.container).trigger("hotspotout",{point:c.point,pixel:c.pixel,spots:a.hotspots_visble[a._curHotspotPointIndex]}),a._curHotspotPointIndex=f);break}!g&&(a.container.style.cursor=e,a._curHotspotPointIndex||0===a._curHotspotPointIndex)&&($(a.container).trigger("hotspotout",{point:c.point,pixel:c.pixel,spots:a.hotspots_visble[a._curHotspotPointIndex]}),a._curHotspotPointIndex=null,a.hotspot_lable&&a.hotspot_lable.hide(),a.hotspot_marker&&a.hotspot_marker.hide())}})}}function a(a){if(a._isMiddleMode){a.element.style.zIndex=-999999;var b="mc_maskimg_"+a.elementId;$(a.container).append($('\x3cdiv id\x3d"'+b+'" style\x3d"position:absolute;left:0px;top:0px;width:100%;height:100%"/\x3e'));a._MiddleMaskImg=$("#"+b)[0]}}function c(a){var b=a.getBounds(!1);a.hotspots_visble.length=0;for(var c=a.hotspotpixels_visble.length=0;c<a.hotspots.length;c++)a.curZoomInRange(a.hotspots[c].options.minZoom,a.hotspots[c].options.maxZoom)&&b.containsPoint(a.hotspots[c].getPosition())&&(a.hotspotpixels_visble.push(a.pointToPixel(a.hotspots[c].getPosition())),a.hotspots_visble.push(a.hotspots[c]))}function e(a){a.hotspot_lable=null;a.hotspot_symbol=null;a.hotspot_marker=null;var b=new mxLib.Label("",{enableMassClear:!1,offset:new mxLib.Size(0,16)});b.setStyle({backgroundcolor:"rgb(255, 255, 225)",border:"1px solid rgb(140, 140, 140)",padding:"1px",whitespace:"nowrap",font:"12px arial,simsun,sans-serif",color:"blue"});a.addOverlay(b);b.setZIndex(19E6);b.hide();var c=new mxLib.Symbol(MX_Symbol_SHAPE_RECTANGLE,{scale:1,fillColor:"rgb(220,220,220)",fillOpacity:.2,shapeRectWidth:0,shapeRectHeight:0,strokeColor:"rgb(220,220,220)",strokeWeight:1}),e=new mxLib.Marker(new mxLib.Point(0,0),{icon:c,enableMassClear:!1});a.addOverlay(e);e.setZIndex(19E6);e.hide();a.hotspot_lable=b;a.hotspot_symbol=c;a.hotspot_marker=e}function g(a){function b(a,c){var e=mxLib.dom.create("div",{style:"overflow: visible; position: absolute; left: 0px; top: 0px;"});e.style.zIndex=c;a.appendChild(e);return e}var c=mxLib.dom.create("div",{style:"overflow: visible; position: absolute; z-index: 0; left: 0px; top: 0px;"});a.panes.floatPane=b(c,800);a.panes.markerMouseTarget=b(c,700);a.panes.floatShadow=b(c,600);a.panes.labelPane=b(c,500);a.panes.markerPane=b(c,400);a.panes.markerShadow=b(c,300);a.panes.mapVertex=b(c,250);a.panes.vectorLayer=b(c,200);a.panes.mapPane=b(c,100);a.isControlMode()||(a.panes.tilePane=b(c,0));a.panesParentDiv=c;$(a.container).append(c)}function k(a,b){var c=b.parentNode;c.lastChild==b?c.appendChild(a,b):c.insertBefore(a,b.nextSibling)}function h(a,b){if(b&&b.length){a._saveOverlaysEvents=[];for(var c=0;c<b.length;c++){var e={},g=b[c]instanceof mxLib.lang.Class,k=g?null:$._data(b[c],"events");e._clickEvents=k?k.click:null;e._dblclickEvents=k?k.dblclick:null;e._mousedownEvents=k?k.mousedown:null;e._mousemoveEvents=k?k.mousemove:null;e._mouseupEvents=k?k.mouseup:null;e._mouseoutEvents=k?k.mouseout:null;e._mouseoverEvents=k?k.mouseover:null;k&&(k.click=null,k.dblclick=null,k.mousedown=null,k.mousemove=null,k.mouseup=null,k.mouseout=null,k.mouseover=null);e._ContextMenu=b[c]._ContextMenu;b[c]._ContextMenu=null;g&&(g=b[c].__listeners)&&(e._onlickEvents=g.onclick,e._ondblclickEvents=g.ondblclick,e._onmousedownEvents=g.onmousedown,e._onmousemoveEvents=g.onmousemove,e._onmouseupEvents=g.onmouseup,e._onmouseoutEvents=g.onmouseout,e._onmouseoverEvents=g.onmouseover,e._ondragstart=g.ondragstart,e._ondragging=g.ondragging,e._ondragend=g.ondragend,g.onclick=void 0,g.ondblclick=void 0,g.onmousedown=void 0,g.onmousemove=void 0,g.onmouseup=void 0,g.onmouseout=void 0,g.onmouseover=void 0,g.ondragstart=void 0,g.ondragging=void 0,g.ondragend=void 0);a._saveOverlaysEvents.push(e)}}}function n(a,b,c){a._saveEventOverlays=c;h(a,c);$._data(document,"events")?(a._keydownEvents=$._data(document,"events").keydown,a._keypressEvents=$._data(document,"events").keypress,a._keyupEvents=$._data(document,"events").keyup):(a._keydownEvents=null,a._keypressEvents=null,a._keyupEvents=null);$._data(a.getContainer(),"events")?(a._clickEvents=$._data(a.getContainer(),"events").click,a._dblclickEvents=$._data(a.getContainer(),"events").dblclick,a._mousedownEvents=$._data(a.getContainer(),"events").mousedown,a._mousemoveEvents=$._data(a.getContainer(),"events").mousemove,a._mouseupEvents=$._data(a.getContainer(),"events").mouseup):(a._clickEvents=null,a._dblclickEvents=null,a._mousedownEvents=null,a._mousemoveEvents=null,a._mouseupEvents=null);if(mxLib.Util.supportHtml5())$._data(a.getContainer(),"events")&&($._data(a.getContainer(),"events").click=null,$._data(a.getContainer(),"events").dblclick=null,$._data(a.getContainer(),"events").mousedown=null,$._data(a.getContainer(),"events").mousemove=null,$._data(a.getContainer(),"events").mouseup=null);else{a._clickEventsHandler=[];a._dblclickEventsHandler=[];a._mousedownEventsHandler=[];a._mousemoveEventsHandler=[];a._mouseupEventsHandler=[];if(a._clickEvents){for(var e=0;e<a._clickEvents.length;e++)a._clickEventsHandler.push(a._clickEvents[e].handler);$(a.getContainer()).unbind("click")}if(a._dblclickEvents){for(e=0;e<a._dblclickEvents.length;e++)a._dblclickEventsHandler.push(a._dblclickEvents[e].handler);$(a.getContainer()).unbind("dblclick")}if(a._mousedownEvents){for(e=0;e<a._mousedownEvents.length;e++)a._mousedownEventsHandler.push(a._mousedownEvents[e].handler);$(a.getContainer()).unbind("mousedown")}if(a._mousemoveEvents){for(e=0;e<a._mousemoveEvents.length;e++)a._mousemoveEventsHandler.push(a._mousemoveEvents[e].handler);$(a.getContainer()).unbind("mousemove")}if(a._mouseupEvents){for(e=0;e<a._mouseupEvents.length;e++)a._mouseupEventsHandler.push(a._mouseupEvents[e].handler);$(a.getContainer()).unbind("mouseup")}}$._data(document,"events")&&($._data(document,"events").keydown=null,$._data(document,"events").keypress=null,$._data(document,"events").keyup=null);a._saveContextMenu=a._ContextMenu;a._ContextMenu=null;a._saveCursor=a.container.style.cursor;b||(b={markerMouseTarget:!1,floatShadow:!1,labelPane:!1,markerPane:!1,markerShadow:!1,mapVertex:!1,mapPane:!1,vectorLayer:!1});!0!==b.markerMouseTarget&&(b.markerMouseTarget=!1);!0!==b.floatShadow&&(b.floatShadow=!1);!0!==b.labelPane&&(b.labelPane=!1);!0!==b.markerPane&&(b.markerPane=!1);!0!==b.markerShadow&&(b.markerShadow=!1);!0!==b.mapVertex&&(b.mapVertex=!1);!0!==b.mapPane&&(b.mapPane=!1);!0!==b.vectorLayer&&(b.vectorLayer=!1);if(c)for(e=0;e<c.length;e++)c[e].getEventPane&&(c[e].getEventPane()==a.getPanes().floatPane?b.floatPane=!0:c[e].getEventPane()==a.getPanes().markerMouseTarget?b.markerMouseTarget=!0:c[e].getEventPane()==a.getPanes().labelPane?b.labelPane=!0:c[e].getEventPane()==a.getPanes().markerPane?b.markerPane=!0:c[e].getEventPane()==a.getPanes().markerShadow?b.markerShadow=!0:c[e].getEventPane()==a.getPanes().mapVertex?b.mapVertex=!0:c[e].getEventPane()==a.getPanes().mapPane?b.mapPane=!0:c[e].getEventPane()==a.getPanes().vectorLayer&&(b.vectorLayer=!0));if(a._saveCaptureEvents=b)if(!1===b.floatPane&&$(a.getPanes().floatPane).css("pointer-events","none"),!1===b.markerMouseTarget&&$(a.getPanes().markerMouseTarget).css("pointer-events","none"),!1===b.floatShadow&&$(a.getPanes().floatShadow).css("pointer-events","none"),!1===b.labelPane&&$(a.getPanes().labelPane).css("pointer-events","none"),!1===b.markerPane&&$(a.getPanes().markerPane).css("pointer-events","none"),!1===b.markerShadow&&$(a.getPanes().markerShadow).css("pointer-events","none"),!1===b.mapVertex&&$(a.getPanes().mapVertex).css("pointer-events","none"),!1===b.mapPane&&$(a.getPanes().mapPane).css("pointer-events","none"),!1===b.vectorLayer&&$(a.getPanes().vectorLayer).css("pointer-events","none"),b.noEventDoms&&0<b.noEventDoms.length)for(c=0;c<b.noEventDoms.length;c++)$(b.noEventDoms[c]).css("pointer-events","none");a.isControlMode()||a.mapModel._setEventDispath(!0);a.addEventListener("keypress",function(b,c){if(27==b.charCode){if(a.hasFocus()){0<a.commandStack.length&&a.commandStack[a.commandStack.length-1].end(!0);return}var e=(new Date).getTime();a._escLastPresTime=a._escLastPresTime||0;a._escPresCount=a._escPresCount||0;a._escPresCount+=1;if(5==a._escPresCount){if(3E3>e-a._escLastPresTime){a.exitAllCommand();return}a._escPresCount=0;a._escLastPresTime=e}}0!=a.commandStack.length&&a.commandStack[a.commandStack.length-1].keypress(b,c)});a.addEventListener("keyup",function(b,c){0!=a.commandStack.length&&a.commandStack[a.commandStack.length-1].keyup(b,c)});a.addEventListener("keydown",function(b,c){0!=a.commandStack.length&&a.commandStack[a.commandStack.length-1].keydown(b,c)});a.addEventListener("dblclick",function(b,c){0==mxLib.Util.getButton(b)&&0!=a.commandStack.length&&a.eventInMapTarget(b)&&a.commandStack[a.commandStack.length-1].dblclick(b,c)});a.addEventListener("click",function(b,c){0==mxLib.Util.getButton(b)&&0!=a.commandStack.length&&a.eventInMapTarget(b)&&a.commandStack[a.commandStack.length-1].click(b,c)});a.addEventListener("mousedown",function(b,c){if(0!=a.commandStack.length&&a.eventInMapTarget(b)){var e=a.commandStack[a.commandStack.length-1];0==mxLib.Util.getButton(b)?e.leftMousedown(b,c):2==mxLib.Util.getButton(b)&&e.rightMousedown(b,c)}});a.addEventListener("mouseup",function(b,c){if(0!=a.commandStack.length&&a.eventInMapTarget(b)){var e=a.commandStack[a.commandStack.length-1];0==mxLib.Util.getButton(b)?e.leftMouseup(b,c):2==mxLib.Util.getButton(b)&&e.rightMouseup(b,c)}});a.addEventListener("mousemove",function(b,c){0!=a.commandStack.length&&a.eventInMapTarget(b)&&a.commandStack[a.commandStack.length-1].mousemove(b,c)})}var l=mxLib.Map=function(b,c){this.elementId=null==b||void 0==b||""==b?"mmap":b;var h="mc_"+this.elementId;if(document.getElementById(h))alert("\u5730\u56fe\u5bf9\u8c61\u91cd\u590d\u521b\u5efa\uff0cid:"+this.elementId);else{this.config=c=c||{};this.controls=[];this.overlays=[];this.hotspots=[];this.hotspots_visble=[];this.hotspotpixels_visble=[];this.panes={};this.temp={};this.commandStack=[];this.element=document.getElementById(this.elementId);this.mapCtrlMode=this.element.type&&"application/x-qt-plugin"==this.element.type;this.mapPaneSvgExtendPixel=mxLib.Util.supportHtml5()?500:0;this.mapPaneCanvasExtendPixel=mxLib.Util.supportHtml5()?500:0;this.config&&$.isNumeric(this.config.mapPaneSvgExtendPixel)&&(this.mapPaneSvgExtendPixel=this.config.mapPaneSvgExtendPixel);this.config&&$.isNumeric(this.config.mapPaneCanvasExtendPixel)&&(this.mapPaneCanvasExtendPixel=this.config.mapPaneCanvasExtendPixel);if(this.mapCtrlMode){var n=document.createElement("div");n.id=h;k(n,this.element);_ElementSameStyle(n,this.element);this.container=n}else if(this.container=this.element,$(this.container).css("overflow","hidden"),this.container.oncontextmenu=function(){return!1},2<$(this.element).find("div").length){alert("\u5730\u56fe\u5bf9\u8c61\u91cd\u590d\u521b\u5efa\uff0cid:"+this.elementId);return}this._isMiddleMode=this.element&&this.element.GetZMode&&1==this.element.GetZMode()?!0:!1;a(this);UpdateDwgImg("maskimg_"+this.elementId,"");this.element.SetLoadJsBegin&&this.element.SetLoadJsBegin();g(this);if(!this.mapCtrlMode){n=this.element.getAttribute("param");h={tileUrl:"",mapSourceBase:"",mapSourceLayerName:"",mapBounds:new mxLib.Bounds(0,0,0,0),zoom:5,sliceZoom:5,serviceUrl:"",mapTilesWidth:768,mapTilesHeight:512,tileWidth:256,tileHeight:256,backgroundColor:"#FFFFFF",maxZoom:13,minZoom:1,fullZoom:5,fitZoom:9};if(n)for(var n=n.split(";"),l=0;l<n.length;l++){var u=n[l].split(":");if(2<=u.length)if("bounds"==u[0])u=u[1].split(" "),4==u.length&&(h.mapBounds=new mxLib.Bounds(parseFloat(u[0]),parseFloat(u[1]),parseFloat(u[2]),parseFloat(u[3])));else{u=u[0];"tileUrl"==u&&(u="mapTileRequestUrl");var v=n[l],v=v.replace("tileUrl:",""),v=v.replace("serviceUrl:",""),v=v.replace(u+":","");"mapTileRequestUrl"==u&&-1!=v.indexOf("^")&&(v=v.split("^"));h[u]=v}}if(c)for(var z in c)h[z]=c[z];this.mapModel=new mxLib.MapModel(this,h);this.mapService=new mxLib.Service(this)}f(this);e(this);!1!==this.config.focus&&this.setFocus();this.setWheelCapture(!1);1!=this.config.disableLeftButtonPan&&this.enableLeftButtonPan()}};_ElementSameStyle=function(a,b){var c=b.style;$(a).css("position","absolute");$(a).css("overflow","hidden");$(a).css("-webkit-user-select","none");a.onselectstart=function(){return!1};if(c.length)for(var e=0;e<c.length;e++){var g=c[e],k=c[g];"position"==g.toLowerCase()&&"relative"==k.toLowerCase()&&(k="absolute");$(a).css(g,k)}else for(c=["width","height","left","top","zIndex"],e=0;e<c.length;e++)k=$(b).css(c[e]),void 0!==k&&$(a).css(c[e],k)};l.prototype.getMapPaneSvg=function(){if(this._MapPaneSvg)return this._MapPaneSvg;if(this.panes&&this.panes.mapPane){var a=$(this.container).width()+2*this.mapPaneSvgExtendPixel,b=$(this.container).height()+2*this.mapPaneSvgExtendPixel,c=-this.mapPaneSvgExtendPixel,e=-this.mapPaneSvgExtendPixel,g=mxLib.Util.createUniqueID("svg");if(!document.createElementNS){var k=Raphael(c,e,a,b);$(this.panes.mapPane).append($(k.canvas));k.canvas.id=g;k.canvas.style.position="absolute";k.canvas.style.width=a+"px";k.canvas.style.height=b+"px";k.canvas.style.top=c+"px";k.canvas.style.left=e+"px";k.setViewBox(c,e,a,b,!0);this._MapPaneSvgDomElement=k.canvas;return this._MapPaneSvg=k}k=document.createElementNS("http://www.w3.org/2000/svg","svg");k.id=g;k.style.position="absolute";k.style.width=a+"px";k.style.height=b+"px";k.style.top=c+"px";k.style.left=e+"px";$(k).attr("viewBox",c+" "+e+" "+a+" "+b);this.panes.mapPane.appendChild(k);this._MapPaneSvgDomElement=k;this._MapPaneSvg=Snap("#"+k.id);window.bIsMobile&&$(this.panes.mapPane).css("pointer-events","none");return this._MapPaneSvg}return null};l.prototype.enableLeftButtonPan=function(){mxLib.Ax.setExtData(window.MX_ATTR_LEFTPAN,"true");if(this.isControlMode()){var a=!1,b=!0,c=null,e=null,g=null,a=!1,b=!0,g=e=null,k=this;$(k.getContainer()).mousedown(function(h){if(k.isLeftButtonPan()&&0==mxLib.Util.getButton(h)){var f=mxLib.Util.getEventPixel(h);h=f.x;f=f.y;b=a=!0;c=k.getCenter();e=h;g=f}});$(k.getContainer()).mousemove(function(c){if(k.isLeftButtonPan()){var h=mxLib.Util.getEventPixel(c);c=h.x;h=h.y;a&&(b&&(b=!1,k.element.PanViewBegin&&k.element.PanViewBegin(e,g)),k.element.PanViewIng&&k.element.PanViewIng(c,h))}});$(k.getContainer()).mouseup(function(e){if(k.isLeftButtonPan()&&0==mxLib.Util.getButton(e)){var g=mxLib.Util.getEventPixel(e);e=g.x;g=g.y;c&&(b?(b=a=!1,c=null):(b=a=!1,c=null,k.element.PanViewEnd&&k.element.PanViewEnd(e,g)))}})}};l.prototype.disableLeftButtonPan=function(){mxLib.Ax.setExtData(window.MX_ATTR_LEFTPAN,"false")};l.prototype.isLeftButtonPan=function(){return"true"==mxLib.Ax.getExtData(window.MX_ATTR_LEFTPAN)};l.prototype.isControlMode=function(){return this.mapCtrlMode};l.prototype.getTilesContainer=function(){return this.tilesContainer};l.prototype.getElement=function(){return this.element};l.prototype.getContainer=function(){return this.container};l.prototype.getMapImagePlaceholder=function(){return this._MiddleMaskImg};l.prototype.addControl=function(a){0!=a instanceof mxLib.Control&&-1==this.controls.indexOf(a)&&(a.domElement=a.initialize(this),mxLib.Control.prototype.initialize.call(a,this),this.controls.push(a))};l.prototype.removeControl=function(a){0!=a instanceof mxLib.Control&&-1!=this.controls.indexOf(a)&&($(a.domElement).remove(),mxLib.Util.removeItem(this.controls,a),a.remove())};l.prototype.addOverlay=function(a){0!=a instanceof mxLib.Overlay&&a._initAddOverlay&&(a._initAddOverlay(this),this.overlays.push(a))};l.prototype.removeOverlay=function(a){if(0!=a instanceof mxLib.Overlay&&-1!=this.overlays.indexOf(a)){if(a.embedElement&&a.embedElement.getSVGDocument){var b=a.embedElement.getSVGDocument();b&&(b.location.href="about:blank")}$(a.domElement).remove();mxLib.Util.removeItem(this.overlays,a);a.remove()}};l.prototype.getOverlays=function(a){return this.overlays};l.prototype.clearOverlays=function(a){this._ZoomVectorLayer&&(this._ZoomVectorLayer={});if(a)for(a=0;a<this.overlays.length;a++)this.overlays[a].enableMassClear&&this.removeOverlay(this.overlays[a]);else{for(var b in this.panes)if(this.isControlMode()||"tilePane"!=b)this.panes[b].innerHTML="";for(a=0;a<this.overlays.length;a++)b=this.overlays[a],b.embedElement&&b.embedElement.getSVGDocument&&(b=b.embedElement.getSVGDocument())&&(b.location.href="about:blank"),this.overlays[a].remove();this.overlays.length=0;this._MapPaneSvg=null;e(this)}};l.prototype.addHotspot=function(a){0!=a instanceof mxLib.Hotspot&&(a.initialize(this),this.hotspots.push(a),b(this))};l.prototype.removeHotspot=function(a){0!=a instanceof mxLib.Hotspot&&-1!=this.hotspots.indexOf(a)&&(mxLib.Util.removeItem(this.hotspots,a),b(this))};l.prototype.clearHotspots=function(){this.hotspots.length=0;b(this)};l.prototype.openInfoWindow=function(a,b){if(a instanceof mxLib.Overlay&&b instanceof mxLib.Point){var c=this.temp;if(a.marker)c.marker.setPosition(b);else{var e=new mxLib.Icon(scriptBaseDir+"mxImg/blank.gif",{width:1,height:1});c.marker=new mxLib.Marker(b,{icon:e,width:1,height:1,offset:new mxLib.Size(0,0),infoWindowOffset:new mxLib.Size(0,0),clickable:!1});c.marker._fromMap=!0}this.addOverlay(c.marker);c.marker.openInfoWindow(a)}};l.prototype.closeInfoWindow=function(){var a=this.temp._infoWin;a&&a.close()};l.prototype.openDwg=function(a){return this.element.OpenDwg(a)};l.prototype.getElementId=function(){return this.element.GetID()};l.prototype.getContainerId=function(){return"mc_"+this.elementId};l.prototype.setFocus=function(){this.element.SetFocus&&this.element.SetFocus()};l.prototype.hasFocus=function(){return this.element.HasFocus?this.element.HasFocus():!1};l.prototype.setVisible=function(a){this.isControlMode()?this.element.SetVisible(a):a?$(this.getTilesContainer()).show():$(this.getTilesContainer()).hide()};l.prototype.getVisble=function(){return this.isControlMode()?this.element.GetVisible():$(this.getTilesContainer()).is(":visible")};l.prototype.setRealRefresh=function(a){this.element.SetRealRefresh&&this.element.SetRealRefresh(a)};l.prototype.getRealRefresh=function(){return this.element.GetIsRealRefresh?this.element.GetIsRealRefresh():!0};l.prototype.setOveralyDragEventDom=function(a){this._overalyDragEventDom=a};l.prototype.getOveralyDragEventDom=function(){return this._overalyDragEventDom?this._overalyDragEventDom:this.container};l.prototype.setWheelCapture=function(a){if(this.isControlMode()){this.element.wheelViewCapture=a;var b=this,c=function(a,c){var e=mxLib.Util.getEventPixel(a),g=e.x,e=e.y;if(!b.eventInMapTarget(a))return!0;b.element.WheelZoom&&b.element.WheelZoom(c,g,e)};a?this._isMiddleMode&&this._MiddleMaskImg?$(this._MiddleMaskImg).unbind("mousewheel"):$(this.getContainer()).unbind("mousewheel"):this._isMiddleMode&&this._MiddleMaskImg?$(this._MiddleMaskImg).bind("mousewheel",c):$(this.getContainer()).bind("mousewheel",c)}};l.prototype.setZoomRange=function(a,b,c,e){this.element.SetScaleFactor?this.element.SetScaleFactor(a,b,c,e):(a&&(this.mapModel.minZoom=this.mapModel.config.minZoom=a),b&&(this.mapModel.maxZoom=this.mapModel.config.maxZoom=b),c&&(this.mapModel.config.fullZoom=c),e&&(this.mapModel.config.fitZoom=e))};l.prototype.getMinZoom=function(){return this.element.GetMinScale?this.element.GetMinScale():this.mapModel.getMinZoom()};l.prototype.getMaxZoom=function(){return this.element.GetMaxScale?this.element.GetMaxScale():this.mapModel.getMaxZoom()};l.prototype.getFullZoom=function(){return this.element.GetFullScale?this.element.GetFullScale():this.mapModel.getFullZoom()};l.prototype.getFitZoom=function(){return this.element.GetFitScale?this.element.GetFitScale():this.mapModel.getFitZoom()};l.prototype.curZoomInRange=function(a,b){var c=0,c=this.element.GetZoomScale?this.element.GetZoomScale():this.mapModel.getZoom();return a&&c<a||b&&c>b?!1:!0};l.prototype.curZoomVectorLayer=function(a,b,c){a=a||0;b=b||0;var e="";c&&(e=JSON.stringify(c));c=c||{};this._ZoomVectorLayer||(this._ZoomVectorLayer={});e=a+"-"+b+"-"+(e||"");this._ZoomVectorLayer[e]||(c.minZoom=a,c.maxZoom=b,a=new mxLib.VectorLayer(c),this.addOverlay(a),this._ZoomVectorLayer[e]=a);return this._ZoomVectorLayer[e]};l.prototype.pointToPixel=function(a,b){var c=a,e=b;a instanceof mxLib.Point&&(c=a.x,e=a.y);return this.getElement().GetDevPt?(c=this.getElement().GetDevPt(c||0,e||0),c=$.parseJSON(c),new mxLib.Pixel(c.x,c.y)):this.mapModel.pointToPixel(c,e)};l.prototype.pixelToPoint=function(a,b){var c=a,e=b;a instanceof mxLib.Pixel&&(c=a.x,e=a.y);c=c||0;e=e||0;return this.getElement().GetGeoPt?(c=this.getElement().GetGeoPt(c,e),c=$.parseJSON(c),new mxLib.Point(c.x,c.y)):this.mapModel.pixelToPoint(c,e)};l.prototype.pointToSvgPixel=function(a,b){var c=a,e=b;a instanceof mxLib.Point&&(c=a.x,e=a.y);if(this.getElement().GetDevPt)return c=this.getElement().GetDevPt(c||0,e||0),c=$.parseJSON(c),new mxLib.Pixel(c.x+this.mapPaneSvgExtendPixel,c.y+this.mapPaneSvgExtendPixel);c=this.mapModel.pointToPixel(c||0,e||0);return new mxLib.Pixel(c.x+this.mapPaneSvgExtendPixel,c.y+this.mapPaneSvgExtendPixel)};l.prototype.pixelDistToPointDist=function(a,b){return this.getElement().GeoByPixel?this.getElement().GeoByPixel(a):this.mapModel.pixelDistToPointDist(a,!1===b?!1:!0)};l.prototype.pointDistToPixelDist=function(a,b){return this.getElement().PixelByGeo?this.getElement().PixelByGeo(a):this.mapModel.pointDistToPixelDist(a,!1===b?!1:!0)};l.prototype.centerAndZoom=function(a,b){this.isControlMode()?this.element.CenterZoom(a.x,a.y,b):this.mapModel.centerAndZoom(a,b)};l.prototype.getCenter=function(){if(!this.element.GetViewCenter)return this.mapModel.getCenter();var a=this.element.GetViewCenter(),a=$.parseJSON(a);return new mxLib.Point(a.cx,a.cy)};l.prototype.setCenter=function(a){a instanceof mxLib.Point&&$.isNumeric(a.x)&&$.isNumeric(a.y)&&this.panTo(a.x,a.y,!1)};l.prototype.panTo=function(){var a=!1,b=!1;arguments[0]instanceof mxLib.Point?this.element.PanTo?this.element.PanTo(arguments[0].x,arguments[0].y,arguments[1]):(2<=arguments.length&&(a=arguments[1]),3<=arguments.length&&(b=arguments[2]),this.mapModel.setCenter(arguments[0].x,arguments[0].y,a,b)):$.isNumeric(arguments[0])&&$.isNumeric(arguments[1])&&(this.element.PanTo?this.element.PanTo(arguments[0],arguments[1],arguments[2]):(3<=arguments.length&&(a=arguments[2]),4<=arguments.length&&(b=arguments[3]),this.mapModel.setCenter(arguments[0],arguments[1],a,b)))};l.prototype.panToPixel=function(){if(1==arguments.length&&arguments[0]instanceof mxLib.Pixel)if(this.isControlMode())this.element.PanToPixel(arguments[0].x,arguments[0].y,arguments[1]);else{var a=this.pixelToPoint(arguments[0].x,arguments[0].y);this.setCenter(a)}else $.isNumeric(arguments[0])&&$.isNumeric(arguments[1])&&(this.isControlMode()?this.element.PanToPixel(arguments[0],arguments[1],arguments[2]):(a=this.pixelToPoint(arguments[0],arguments[1]),this.setCenter(a)))};l.prototype.panBy=function(){if(1==arguments.length&&arguments[0]instanceof mxLib.Pixel)if(this.isControlMode())this.element.PanBy&&this.element.PanBy(arguments[0].x,arguments[0].y);else{var a=this.pixelDistToPointDist(arguments[0].x,!0),b=this.pixelDistToPointDist(arguments[0].y,!1),c=this.getCenter();c.x+=a;c.y-=b;this.setCenter(c)}else 2==arguments.length&&(this.isControlMode()?this.element.PanBy&&this.element.PanBy(arguments[0],arguments[1]):(a=this.pixelDistToPointDist(arguments[0],!0),b=this.pixelDistToPointDist(arguments[1],!1),c=this.getCenter(),c.x-=a,c.y-=b,this.setCenter(c)))};l.prototype.panPointToPixel=function(){var a=null,b=null;2==arguments.length&&arguments[0]instanceof mxLib.Point&&arguments[1]instanceof mxLib.Pixel?this.isControlMode()?this.element.PanToDes(arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y):(a=new mxLib.Point(arguments[0].x,arguments[0].y),b=new mxLib.Pixel(arguments[1].x,arguments[1].y)):4==arguments.length&&(this.isControlMode()?this.element.PanToDes(arguments[0],arguments[1],arguments[2],arguments[3]):(a=new mxLib.Point(arguments[0],arguments[1]),b=new mxLib.Pixel(arguments[2],arguments[3])));if(!this.isControlMode()&&a&&b){var c=this.mapModel.getContainerWidth(),b=this.mapModel.getContainerHeight(),b=b/2,c=this.pixelDistToPointDist(c/2,!0),b=this.pixelDistToPointDist(b,!1);a.x+=c;a.y-=b;this.setCenter(a)}};l.prototype.setZoom=function(a){this.element.SetZoomScale?this.element.SetZoomScale(a):this.mapModel.setZoom(a)};l.prototype.getZoom=function(){return this.element.GetZoomScale?this.element.GetZoomScale():this.mapModel.getZoom()};l.prototype.zoomIn=function(){this.element.ZoomIn?this.element.ZoomIn():this.mapModel.zoomIn()};l.prototype.zoomOut=function(){this.element.ZoomOut?this.element.ZoomOut():this.mapModel.zoomOut()};l.prototype.zoomWindowSel=function(){if(this.element.ZoomWindowSel)this.element.ZoomWindowSel();else{var a=new mxLib.RectZoomCmd;map.startCommand(a)}};l.prototype.zoomWindow=function(){this.element.ZoomWindow?2==arguments.length&&arguments[0]instanceof mxLib.Point&&arguments[1]instanceof mxLib.Point?this.element.ZoomWindow(arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y):4==arguments.length&&this.element.ZoomWindow(arguments[0],arguments[1],arguments[2],arguments[3]):this.mapModel.zoomWindow.apply(this.mapModel,arguments)};l.prototype.zoomWindowByPixel=function(){var a,b,c,e;2==arguments.length&&arguments[0]instanceof mxLib.Pixel&&arguments[1]instanceof mxLib.Pixel?this.element.ZoomWindowPixel?this.element.ZoomWindowPixel(arguments[0].x,arguments[0].y,arguments[1].x,arguments[1].y):(a=arguments[0].x,b=arguments[0].y,c=arguments[1].x,e=arguments[1].y):4==arguments.length&&(this.element.ZoomWindowPixel?this.element.ZoomWindowPixel(arguments[0],arguments[1],arguments[2],arguments[3]):(a=arguments[0],b=arguments[1],c=arguments[2],e=arguments[3]));this.isControlMode()&&a&&c&&b&&e&&(a=new mxLib.Pixel(a,b),c=new mxLib.Pixel(c,e),e=this.pixelToPoint(a),c=this.pixelToPoint(c),this.zoomWindow(e,c))};l.prototype.zoomExtent=function(){this.element.ZoomExtent?this.element.ZoomExtent():this.zoomWindow(this.mapModel.getMapBounds().getLeftTop(),this.mapModel.getMapBounds().getRightBottom())};l.prototype.setViewport=function(a,b){if(a instanceof mxLib.Bounds){var c=b||{};if(!c.margins||4>c.margins.length)c.margins=[30,60,30,60];var e=this.pixelDistToPointDist(c.margins[0],!1),g=this.pixelDistToPointDist(c.margins[1],!0),k=this.pixelDistToPointDist(c.margins[2],!1),h=this.pixelDistToPointDist(c.margins[3],!0);this.zoomWindow(a.getSouthWest().x-h,a.getSouthWest().y-k,a.getNorthEast().x+g,a.getNorthEast().y+e);c.zoomFactor&&this.setZoom(this.getZoom()+c.zoomFactor)}};l.prototype.getBounds=function(a){if(this.element.GetBounds)return a=this.element.GetBounds(a?!0:!1),a=JSON.parse(a),new mxLib.Bounds(a.minx,a.miny,a.maxx,a.maxy);if(a)return this.mapModel.getMapBounds().clone();var b=this.getSize();a=this.pixelToPoint(new mxLib.Pixel(0,0));b=this.pixelToPoint(new mxLib.Pixel(b.width,b.height));return new mxLib.Bounds(a.x,b.y,b.x,a.y)};l.prototype.getSize=function(a){if(this.element.GetViewSize&&a)return a=this.element.GetViewSize(),a=JSON.parse(a),new mxLib.Size(a.left,a.top,a.right,a.bottom);a=$(this.element).width();var b=$(this.element).height();0==a&&MvHost&&MvHost.width&&(a=MvHost.width);0==b&&MvHost&&MvHost.height&&(b=MvHost.height);a||(a=$(document.body).width());b||(b=$(document).height());return new mxLib.Size(0,0,a,b)};l.prototype.isBkTransparent=function(){if(this.element.IsBkTransparent)return this.element.IsBkTransparent()};l.prototype.getDistance=function(){var a=0,b=0,c=0,e=0;2==arguments.length?arguments[0]instanceof mxLib.Point&&arguments[1]instanceof mxLib.Point?(a=arguments[0].x,c=arguments[0].y,b=arguments[1].x,e=arguments[1].y):arguments[0]instanceof mxLib.Pixel&&arguments[1]instanceof mxLib.Pixel&&(a=arguments[0].x,c=arguments[0].y,b=arguments[1].x,e=arguments[1].y):4==arguments.length&&$.isNumeric(arguments[0])&&$.isNumeric(arguments[1])&&$.isNumeric(arguments[2])&&$.isNumeric(arguments[3])&&(a=arguments[0],c=arguments[1],b=arguments[2],e=arguments[3]);return Math.sqrt((b-a)*(b-a)+(e-c)*(e-c))};l.prototype.selEntity=function(a,b,c){return this.element.EntSel?this.element.EntSel(b||MX_EntAtt_kAttDefault,a||MX_EntType_kTypeDefault,c||!1):"{}"};l.prototype.getEntityByBounds=function(a,b,c,e,g,k,h,f,n){k=k||MX_EntAtt_kAttDefault;g=g||MX_EntType_kTypeDefault;h=2===h?2:1;if(this.isControlMode())return this.element.EntRegion(a,b,c,e,g,k,h);if(this.mapModel&&this.mapModel.getServiceUrl()){var l=this.mapModel.getServiceUrl(),l=l.replace("{functionname}","getEntityByBounds");a="dMinX@"+a+";"+("dMinY@"+b+";");a+="dMaxX@"+c+";";a+="dMaxY@"+e+";";a+="typeOpt@"+g+";";a+="attOpt@"+k+";";a+="selType@"+h+";";var l=l.replace("{functionparam}",a),A;$.ajax({type:"POST",url:l,async:f?!0:!1,success:function(a){f?f(a):A=a},error:function(){n&&n()}});return A}};l.prototype.getEntityBySize=function(a,b,c,e,g,k,h,f){k=k||MX_EntAtt_kAttDefault;g=g||MX_EntType_kTypeDefault;if(this.isControlMode())return this.element.EntRegionPixel(b,a,e,c,g,k);a=map.pixelToPoint(a,b);c=map.pixelToPoint(c,e);this.getEntityByBounds(a.x,a.y,c.x,c.y,g,k,null,h,f)};l.prototype.getEntityByPoint=function(a,b,c,e,g,k){e=e||MX_EntAtt_kAttDefault;c=c||MX_EntType_kTypeDefault;if(this.isControlMode())return this.element.EntPoint(a,b,c,e);if(this.mapModel&&this.mapModel.getServiceUrl()){var h=this.mapModel.getServiceUrl(),h=h.replace("{functionname}","getEntityByPoint");a="x@"+a+";"+("y@"+b+";");a+="typeOpt@"+c+";";a+="attOpt@"+e+";";var h=h.replace("{functionparam}",a),f;$.ajax({type:"POST",url:h,async:g?!0:!1,success:function(a){g?g(a):f=a},error:function(){k&&k()}});return f}};l.prototype.getEntityByPixel=function(a,b,c,e,g,k){e=e||MX_EntAtt_kAttDefault;c=c||MX_EntType_kTypeDefault;a=this.pixelToPoint(a,b);if(this.isControlMode())return this.element.EntPoint(a.x,a.y,c,e);this.getEntityByPoint(a.x,a.y,c,e,g,k)};l.prototype.getLayer=function(a,b,c,e){var g=b||MX_LayerAtr_kLayerDefault;if(this.isControlMode())return this.element.LayerFromDb(a,g);if(this.mapModel&&this.mapModel.getServiceUrl()){b=this.mapModel.getServiceUrl();b=b.replace("{functionname}","getLayer");a="layerName@"+a+";"+("layerOpt@"+g+";");b=b.replace("{functionparam}",a);var k;$.ajax({type:"POST",url:b,async:c?!0:!1,success:function(a){c?c(a):k=a},error:function(){e&&e()}});return k}};l.prototype.getLayerByBounds=function(a,b,c,e,g,k,h){g=g||MX_LayerAtr_kLayerDefault;if(this.isControlMode())return this.element.LayerFromRegion(a,b,c,e,g);if(this.mapModel&&this.mapModel.getServiceUrl()){var f=this.mapModel.getServiceUrl(),f=f.replace("{functionname}","getLayerByBounds");a="dMinX@"+a+";"+("dMinY@"+b+";");a+="dMaxX@"+c+";";a+="dMaxY@"+e+";";a+="layerOpt@"+g+";";var f=f.replace("{functionparam}",a),n;$.ajax({type:"POST",url:f,async:k?!0:!1,success:function(a){k?k(a):n=a},error:function(){h&&h()}});return n}};l.prototype.getEntityByLayer=function(a,b,c,e,g){c=c||MX_EntAtt_kAttDefault;var k=b||MX_EntType_kTypeDefault;if(this.isControlMode())return this.element.EntFromLayer(a,c,k);if(this.mapModel&&this.mapModel.getServiceUrl()){b=this.mapModel.getServiceUrl();b=b.replace("{functionname}","getEntityByLayer");a="layerName@"+a+";"+("typeOpt@"+k+";");a+="attOpt@"+c+";";b=b.replace("{functionparam}",a);var h;$.ajax({type:"POST",url:b,async:e?!0:!1,success:function(a){e?e(a):h=a},error:function(){g&&g()}});return h}};l.prototype.getEntityByHandle=function(a,b,c,e){var g=b||MX_EntAtt_kAttDefault;if(this.isControlMode())return this.element.EntFromHandle(a,g);if(this.mapModel&&this.mapModel.getServiceUrl()){b=this.mapModel.getServiceUrl();b=b.replace("{functionname}","getEntityByHandle");a="handle@"+a+";"+("attOpt@"+g+";");b=b.replace("{functionparam}",a);var k;$.ajax({type:"POST",url:b,async:c?!0:!1,success:function(a){c?c(a):k=a},error:function(){e&&e()}});return k}};l.prototype.setEntityAttribute=function(a,b,c,e){if(a&&this.element.SetEntAtt)return this.element.SetEntAtt(a,b,c,!1===e?!1:!0)};l.prototype.setLayerAttribute=function(a,b,c){if(a&&this.element.SetLayerAtt)return this.element.SetLayerAtt(a,b,c)};l.prototype.update=function(){if(this.element.OnRender)return this.element.OnRender()};l.prototype.getEntityPoints=function(a,b,c,e){b=b||100;if(this.isControlMode()){var g=this.element.GetEntPoints(a,b);if(""==g)return null;a=[];g=$.parseJSON(g);for(b=0;b<g.length;b++)a.push(new mxLib.Point(g[b].x,g[b].y));return a}if(this.mapModel&&this.mapModel.getServiceUrl()){g=this.mapModel.getServiceUrl();g=g.replace("{functionname}","getEntityPoints");a="handle@"+a+";"+("ptCount@"+b+";");var g=g.replace("{functionparam}",a),k;$.ajax({type:"POST",url:g,async:c?!0:!1,success:function(a){var b=[];if(""!=a){a=$.parseJSON(a);for(var e=0;e<a.length;e++)b.push(new mxLib.Point(a[e].x,a[e].y))}c?c(b):k=b},error:function(){e&&e()}});return k}};l.prototype.cancelEntitySelect=function(){if(this.element.CancelEntSel)return this.element.CancelEntSel()};l.prototype.positionEntity=function(a){if(this.element.EntPosition)return this.element.EntPosition(a)};l.prototype.PtInRegion=function(a,b){if(!(this.element.PtInRegion&&a instanceof mxLib.Point&&b.length))return!1;for(var c="[",e=0;e<b.length;e++){0!=e&&(c+=",");var g=mxLib.Util.stringFormat('{"x":{0},"y":{1}}',b[e].x,b[e].y),c=c+g}return this.element.PtInRegion(a.x,a.y,c+"]")?!0:!1};l.prototype.ptCloseToLine=function(a,b){if(this.element.PtCloseToLine&&a instanceof mxLib.Point&&b.length){for(var c="[",e=0;e<b.length;e++){0!=e&&(c+=",");var g=mxLib.Util.stringFormat('{"x":{0},"y":{1}}',b[e].x,b[e].y),c=c+g}c=this.element.PtCloseToLine(a.x,a.y,c+"]");if(!c)return null;c=$.parseJSON(c);return mxLib.Point(c.x,c.y)}};l.prototype.flashEntity=function(a,b,c){if(a){c=c||8;var e=null,g=!0,k=0,e=setInterval(function(){g=!g;k++;k==c&&clearInterval(e);map.setEntityAttribute(a,"DWG_ENT_VISBLE",g?"true":"false")},b||400)}};l.prototype.getDwgFileName=function(){return this.element.GetDwgFileName()};l.prototype.setTransparent=function(a){if(this.element.SetTransparent)return this.element.SetTransparent(a)};l.prototype.setDwgBackColor=function(a){if(this.element.SetDwgBackColor)return this.element.SetDwgBackColor(a)};l.prototype.savePicture=function(a,b,c,e,g,k,h,f){return this.element.SavePicture(!1===a?!1:!0,b,c||"PNG",e||-1,g||0,k||0,h||0,f||0)};l.prototype.paintPicture=function(a){return this.element.PaintPicture(!1===a?!1:!0)};l.prototype.sendEscKey=function(){return this.element.SendEscKey()};l.prototype.eventInMapTarget=function(a){var b=a.target.id;if(""==b)for(var c=a.target;c;){if(c.id&&0==c.id.indexOf("mw_"))return!1;c=c.parentElement}""!=b&&mxLib.Util.supportHtml5()||(b=a.currentTarget.id);a=!1;b==this.container.id&&(a=!0);!a&&this._MapPaneSvgDomElement&&b==this._MapPaneSvgDomElement.id&&(a=!0);0==b.indexOf("vl_new_")&&(a=!0);0==b.indexOf("canvas_new_")&&(a=!0);return this._isMiddleMode&&b==this._MiddleMaskImg.id?!0:a};l.prototype.startCommand=function(a){if(a.parentCmd){for(c=this.commandStack.length-1;0<=c&&this.commandStack[c].parentCmd!=a.parentCmd;c--);if(0<=c&&c<this.commandStack.length)for(var b=this.commandStack.length-1;b>=c;b--)this.commandStack[b].end(!0)}else if(0<this.commandStack.length)for(var c=0;c<this.commandStack.length;c++)this.commandStack[c].end(!0);0==this.commandStack.length&&n(this,a.options?a.options.captureEvents:null,a.options?a.options.saveEventOverlays:null);this.commandStack.push(a);a.start(this)};l.prototype.endCommand=function(a,b){if(0!=this.commandStack.length){var c=this.commandStack.indexOf(a);if(-1!=c&&(this.commandStack.splice(c,this.commandStack.length-c),0==this.commandStack.length)){if((c=this._saveEventOverlays)&&c.length){for(var e=0;e<c.length;e++){var g=this._saveOverlaysEvents[e],k=c[e]instanceof mxLib.lang.Class,h=k?null:$._data(c[e],"events");h&&(h.click=g._clickEvents,h.dblclick=g._dblclickEvents,h.mousedown=g._mousedownEvents,h.mousemove=g._mousemoveEvents,h.mouseup=g._mouseupEvents,h.mouseout=g._mouseoutEvents,h.mouseover=g._mouseoverEvents);c[e]._ContextMenu=g._ContextMenu;k&&(k=c[e].__listeners)&&(k.onclick=g._onlickEvents,k.ondblclick=g._ondblclickEvents,k.onmousedown=g._onmousedownEvents,k.onmousemove=g._onmousemoveEvents,k.onmouseup=g._onmouseupEvents,k.onmouseout=g._onmouseoutEvents,k.onmouseover=g._onmouseoverEvents,k.ondragstart=g._ondragstart,k.ondragging=g._ondragging,k.ondragend=g._ondragend)}this._saveOverlaysEvents=null}this._saveEventOverlays=null;if(mxLib.Util.supportHtml5())$._data(this.getContainer(),"events").click=this._clickEvents,$._data(this.getContainer(),"events").dblclick=this._dblclickEvents,$._data(this.getContainer(),"events").mousedown=this._mousedownEvents,$._data(this.getContainer(),"events").mousemove=this._mousemoveEvents,$._data(this.getContainer(),"events").mouseup=this._mouseupEvents,$._data(document,"events")&&($._data(document,"events").keydown=this._keydownEvents,$._data(document,"events").keypress=this._keypressEvents,$._data(document,"events").keyup=this._keyupEvents);else{$(this.getContainer()).unbind("click");$(this.getContainer()).unbind("dblclick");$(this.getContainer()).unbind("mousedown");$(this.getContainer()).unbind("mousemove");$(this.getContainer()).unbind("mouseup");for(c=0;c<this._clickEventsHandler.length;c++)$(this.getContainer()).click(this._clickEventsHandler[c]);for(c=0;c<this._dblclickEventsHandler.length;c++)$(this.getContainer()).dblclick(this._dblclickEventsHandler[c]);for(c=0;c<this._mousedownEventsHandler.length;c++)$(this.getContainer()).mousedown(this._mousedownEventsHandler[c]);for(c=0;c<this._mousemoveEventsHandler.length;c++)$(this.getContainer()).mousemove(this._mousemoveEventsHandler[c]);for(c=0;c<this._mouseupEventsHandler.length;c++)$(this.getContainer()).mouseup(this._mouseupEventsHandler[c])}this._mouseupEvents=this._mousemoveEvents=this._mousedownEvents=this._keyupEvents=this._keypressEvents=this._keydownEvents=this._dblclickEvents=this._clickEvents=null;this._ContextMenu=this._saveContextMenu;this.setCursor(this._saveCursor);if(c=this._saveCaptureEvents)if(!1===c.floatPane&&$(this.getPanes().floatPane).css("pointer-events",""),!1===c.markerMouseTarget&&$(this.getPanes().markerMouseTarget).css("pointer-events",""),!1===c.floatShadow&&$(this.getPanes().floatShadow).css("pointer-events",""),!1===c.labelPane&&$(this.getPanes().labelPane).css("pointer-events",""),!1===c.markerPane&&$(this.getPanes().markerPane).css("pointer-events",""),!1===c.markerShadow&&$(this.getPanes().markerShadow).css("pointer-events",""),!1===c.mapVertex&&$(this.getPanes().mapVertex).css("pointer-events",""),!1===c.mapPane&&$(this.getPanes().mapPane).css("pointer-events",""),!1===c.vectorLayer&&$(this.getPanes().vectorLayer).css("pointer-events",""),c.noEventDoms&&0<c.noEventDoms.length)for(e=0;e<c.noEventDoms.length;e++)$(c.noEventDoms[e]).css("pointer-events","");this._saveCaptureEvents=null}}};l.prototype.exitAllCommand=function(){for(var a=this.commandStack.length-1;0<=a;a--)this.commandStack[a].end(!0)};l.prototype.addEventListener=function(a,b){b&&(this.isControlMode()?"dwgloaded"==a?this.element.dwgloaded&&this.element.dwgloaded.connect(b):"zoomend"==a?this.element.zoomend&&this.element.zoomend.connect(b):"message"==a?this.element.message&&this.element.message.connect(b):"zoomined"==a?this.element.zoomined&&this.element.zoomined.connect(b):"zoomouted"==a?this.element.zoomouted&&this.element.zoomouted.connect(b):"movestart"==a?this.element.movestart&&this.element.movestart.connect(b):"moving"==a?this.element.moving&&this.element.moving.connect(b):"moveend"==a?this.element.moveend&&this.element.moveend.connect(b):"dragstart"==a?this.element.dragstart&&this.element.dragstart.connect(b):"dragging"==a?this.element.dragging&&this.element.dragging.connect(b):"dragend"==a?this.element.dragend&&this.element.dragend.connect(b):"rendered"==a?this.element.rendered&&this.element.rendered.connect(b):"resize"==a?this.element.resize&&this.element.resize.connect(b):"dropFinish"==a?this.element.dropFinish&&this.element.dropFinish.connect(b):"wheel"==a?this.element.wheel&&this.element.wheel.connect(b):"keydown"==a||"keypress"==a||"keyup"==a?$(document).bind(a,b):$(this.container).bind(a,b):"keydown"==a||"keypress"==a||"keyup"==a?$(document).bind(a,b):$(this.container).bind(a,b))};l.prototype.removeEventListener=function(a,b){b&&(this.isControlMode()?"dwgloaded"==a?this.element.dwgloaded&&this.element.dwgloaded.disconnect(b):"zoomend"==a?this.element.zoomend&&this.element.zoomend.disconnect(b):"message"==a?this.element.message&&this.element.message.disconnect(b):"zoomined"==a?this.element.zoomined&&this.element.zoomined.disconnect(b):"zoomouted"==a?this.element.zoomouted&&this.element.zoomouted.disconnect(b):"movestart"==a?this.element.movestart&&this.element.movestart.disconnect(b):"moving"==a?this.element.moving&&this.element.moving.disconnect(b):"moveend"==a?this.element.moveend&&this.element.moveend.disconnect(b):"dragstart"==a?this.element.dragstart&&this.element.dragstart.disconnect(b):"dragging"==a?this.element.dragging&&this.element.dragging.disconnect(b):"dragend"==a?this.element.dragend&&this.element.dragend.disconnect(b):"rendered"==a?this.element.rendered&&this.element.rendered.disconnect(b):"resize"==a?this.element.resize&&this.element.resize.disconnect(b):"dropFinish"==a?this.element.dropFinish&&this.element.disconnect.connect(b):"wheel"==a?this.element.wheel&&this.element.wheel.disconnect(b):"keydown"==a||"keypress"==a||"keyup"==a?$(document).unbind(a,b):$(this.container).unbind(a,b):"keydown"==a||"keypress"==a||"keyup"==a?$(document).unbind(a,b):$(this.container).unbind(a,b))};l.prototype.createContextMenu=function(){var a=mxLib.dom.create("div",{style:"overflow: visible; position: absolute; z-index: 10000000; left: 0px; top: 0px;"});$(a).addClass("easyui-menu");$(a).mxMenu();$(this.container).append(a);return a};l.prototype.addContextMenu=function(a){a instanceof mxLib.ContextMenu&&(this._ContextMenu&&this.removeContextMenu(this._ContextMenu),a.initialize(this),this._ContextMenu=a)};l.prototype.removeContextMenu=function(a){a instanceof mxLib.ContextMenu&&a&&a.destroy()};l.prototype.showContextMenu=function(a){var b=mxLib.Util.getEventPixel(a),c=b.x,b=b.y;if(this._ContextMenu)return this._ContextMenu.show(new mxLib.Pixel(c,b)),a.stopPropagation(),!1};l.prototype.setCursor=function(a){this.container.style.cursor=a};l.prototype.getPanes=function(){return{floatPane:this.panes.floatPane,markerMouseTarget:this.panes.markerMouseTarget,floatShadow:this.panes.floatShadow,labelPane:this.panes.labelPane,markerPane:this.panes.markerPane,markerShadow:this.panes.markerShadow,mapVertex:this.panes.mapVertex,vectorLayer:this.panes.vectorLayer,mapPane:this.panes.mapPane,tilePane:this.panes.tilePane}};l.prototype.setPanAnimation=function(a){mxLib.View.setExtData(MV_ATTR_DWG_ANIMATION,a?"true":"false")};l.prototype.queryInfo=function(a){return this.element.QueryInfo(a)};l.prototype.runViewEntInfo=function(a,b,c){return this.element.RunViewEntInfo(a,b,c)};l.prototype.debug=function(a){if(a){var b=this;this._debug_clickFunc||this.addEventListener("click",this._debug_clickFunc=function(a){var c=mxLib.Util.getEventPoint(b,a);console.log(c.x+","+c.y);console.log("zoom:"+b.getZoom());c=mxLib.Util.getEventPoint(b,a);b.isControlMode()?mxLib.Util.toastInfo(c.x+","+c.y+"\x3cbr/\x3e\u7f29\u653e\u7ea7\u522b:"+b.getZoom(),{delay:8E3}):(zoom=b.mapModel.getMapZoom(),rc=zoom.pointInTileRowCol(c),mxLib.Util.toastInfo(c.x+","+c.y+"\x3cbr/\x3e\u7f29\u653e\u7ea7\u522b:"+zoom.getZoom()+"\x3cbr/\x3e\u6240\u5728\u74e6\u7247\u884c\u5217:"+rc.row+","+rc.col,{delay:8E3}))})}else this._debug_clickFunc&&(this.removeEventListener("click",this._debug_clickFunc),this._debug_clickFunc=null)}})();(function(){function f(a,b,e){if(null!=a&&void 0!=a)switch(a.style.position="absolute",b){case MX_ANCHOR_TOP_LEFT:a.style.left=e.width+"px";a.style.top=e.height+"px";break;case MX_ANCHOR_TOP_RIGHT:a.style.right=e.width+"px";a.style.top=e.height+"px";break;case MX_ANCHOR_BOTTOM_LEFT:a.style.left=e.width+"px";a.style.bottom=e.height+"px";break;case MX_ANCHOR_BOTTOM_RIGHT:a.style.right=e.width+"px",a.style.bottom=e.height+"px"}}window.MX_ANCHOR_TOP_LEFT=0;window.MX_ANCHOR_TOP_RIGHT=1;window.MX_ANCHOR_BOTTOM_LEFT=2;window.MX_ANCHOR_BOTTOM_RIGHT=3;var b=mxLib.Control=function(){this.domElement=this.defaultOffset=this.defaultAnchor=null};mxLib.lang.inherits(mxLib.Control,mxLib.lang.Class,"Control");b.prototype.initialize=function(a){this._map=a;f(this.domElement,this.defaultAnchor,this.defaultOffset)};b.prototype.setAnchor=function(a){this.defaultAnchor=a;f(this.domElement,this.defaultAnchor,this.defaultOffset)};b.prototype.getAnchor=function(){return this.defaultAnchor};b.prototype.setOffset=function(a){this.defaultOffset=a;f(this.domElement,this.defaultAnchor,this.defaultOffset)};b.prototype.getOffset=function(){return this.defaultOffset};b.prototype.show=function(){this.domElement&&$(this.domElement).show()};b.prototype.getDomElement=function(){return this.domElement};b.prototype.hide=function(){$(this.domElement).hide()};b.prototype.isVisible=function(){return $(this.domElement).is(":visible")};b.prototype.curZoomInRange=function(){if(!this._map||!this.domElement)return!0;if(this.options){var a=this.options.minZoom,b=this.options.maxZoom;if(!a&&!b)return!0;a=this._map.curZoomInRange(a,b);b=!1;b=this.isVisible();if(a){if(a!=b){if(2!=this._zoomVisibleOpt)return!1;this.show();this._zoomVisibleOpt=1}return!0}a!=b&&(this.hide(),this._zoomVisibleOpt=2);return!1}};b.prototype.remove=function(){}})();(function(){function f(a,b){var e=a.getMinZoom(),g=a.getMaxZoom(),k=b;if(k<e||k>g)k=e;var h=this._navBarLength,f=(k-e)*h/(g-e),e=this._navBarBeginTop+h-(k-e)*h/(g-e);$("#ctrl_navi_bar_"+this._ctrlId).css("top",e+"px");$("#ctrl_navi_bar_fill_"+this._ctrlId).css("top",e+this._navBarHeight+"px");$("#ctrl_navi_bar_fill_"+this._ctrlId).css("height",f+"px")}var b=mxLib.NavigationControl=function(a){a=a||{};this.defaultAnchor=a.anchor||MX_ANCHOR_TOP_LEFT;this.defaultOffset=a.offset||a.offest||new mxLib.Size(10,10);this.options=a;this.options.panPanel=a.panPanel||1};mxLib.Lang.inherits(b,mxLib.Control);b.prototype.initialize=function(a){function b(c,e){var g=$("#ctrl_navi_bar_full_"+n).offset().top,g=c-g,h=k._navBarLength;0>g?g=0:g>h&&(g=h);var l=a.getMinZoom(),m=a.getMaxZoom();r=l+(h-g)*(m-l)/h;f.call(k,a,r);e&&(a.setZoom(r),k.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+r.toFixed(0),{delay:300}))}function e(a){b(a.clientY||a.y)}function g(){$(a.getOveralyDragEventDom()).unbind("mousemove",e);$(a.getOveralyDragEventDom()).unbind("mouseup",g);null!=r&&(a.setZoom(r),k.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+r.toFixed(0),{delay:300}))}this.map=a;var k=this,h=document.createElement("div");this.domElement=h;h.style.width="66px";h.style.height="230px";h.style.zIndex="1100";var n=mxLib.Util.createUniqueID();this._ctrlId=n;var l="",l=k.options.panPanel?' \x3cdiv style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: 0px 0px; width: 56px; height: 56px; left: 11px; top: 0px;"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_bar_full_CTRLID"   style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -36px -80px; width: 8px; height: 118px; left: 35px; top: 88px;"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_bar_fill_CTRLID"  style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -10px -80px; width: 8px; height: 58px; left: 35px; top: 149px;"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_zoomin_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -1px -56px; width: 26px; height: 26px; cursor: pointer;\r\n                                left: 26px; top: 64px;" title\x3d"\u653e\u5927"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_zoomout_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -1px -196px; width: 26px; height: 26px; cursor: pointer;\r\n                                left: 26px; top: 205px;" title\x3d"\u7f29\u5c0f"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_up_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -19px -5px; width: 20px; height: 18px; cursor: pointer;\r\n                                left: 30px; top: 5px;" title\x3d"\u5411\u4e0a\u5e73\u79fb"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_down_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -19px -32px; width: 20px; height: 18px; cursor: pointer;\r\n                                left: 30px; top: 32px;" title\x3d"\u5411\u4e0b\u5e73\u79fb"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_left_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -5px -19px; width: 17px; height: 18px; cursor: pointer;\r\n                                left: 16px; top: 19px;" title\x3d"\u5411\u5de6\u5e73\u79fb"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_right_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -36px -19px; width: 17px; height: 18px; cursor: pointer;\r\n                                left: 47px; top: 19px;" title\x3d"\u5411\u53f3\u5e73\u79fb"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_bar_CTRLID"  style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -53px -56px; width: 24px; height: 14px; cursor: pointer;\r\n                                left: 27px; top: 141px;"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -81px -120px; width: 28px; height: 18px; cursor: pointer;\r\n                                left: 0px; top: 193px; display: none;"\x3e\r\n                            \x3c/div\x3e':' \x3cdiv id\x3d"ctrl_navi_bar_full_CTRLID"   style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -36px -80px; width: 8px; height: 118px; left: 35px; top: 88px;"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_bar_fill_CTRLID"  style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -10px -80px; width: 8px; height: 58px; left: 35px; top: 149px;"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_zoomin_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -1px -56px; width: 26px; height: 26px; cursor: pointer;\r\n                                left: 26px; top: 64px;" title\x3d"\u653e\u5927"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv id\x3d"ctrl_navi_zoomout_CTRLID" style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -1px -196px; width: 26px; height: 26px; cursor: pointer;\r\n                                left: 26px; top: 205px;" title\x3d"\u7f29\u5c0f"\x3e\r\n                            \x3c/div\x3e\x3cdiv id\x3d"ctrl_navi_bar_CTRLID"  style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -53px -56px; width: 24px; height: 14px; cursor: pointer;\r\n                                left: 27px; top: 141px;"\x3e\r\n                            \x3c/div\x3e\r\n                            \x3cdiv style\x3d"position: absolute; background-image: url(SCRIPTDIRmxImg/nav.png);\r\n                                background-position: -81px -120px; width: 28px; height: 18px; cursor: pointer;\r\n                                left: 0px; top: 193px; display: none;"\x3e\r\n                            \x3c/div\x3e',l=l.replace(/CTRLID/g,n),l=l.replace(/SCRIPTDIR/g,scriptBaseDir);$(h).append($(l));$(a.getContainer()).append(h);$("#ctrl_navi_up_"+n).hover(function(){$(this).css("background-position","-75px -5px")},function(){$(this).css("background-position","-19px -5px")}).click(function(){a.panBy(0,-80)});$("#ctrl_navi_down_"+n).hover(function(){$(this).css("background-position","-75px -32px")},function(){$(this).css("background-position","-19px -32px")}).click(function(){a.panBy(0,80)});$("#ctrl_navi_left_"+n).hover(function(){$(this).css("background-position","-61px -19px")},function(){$(this).css("background-position","-5px -19px")}).click(function(){a.panBy(-80,-0)});$("#ctrl_navi_right_"+n).hover(function(){$(this).css("background-position","-92px -19px")},function(){$(this).css("background-position","-36px -19px")}).click(function(){a.panBy(80,-0)});$("#ctrl_navi_zoomin_"+n).hover(function(){$(this).css("background-position","-27px -56px")},function(){$(this).css("background-position","-1px -56px")}).click(function(){a.zoomIn();k.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+a.getZoom().toFixed(0),{delay:300})});$("#ctrl_navi_zoomout_"+n).hover(function(){$(this).css("background-position","-27px -196px")},function(){$(this).css("background-position","-1px -196px")}).click(function(){a.zoomOut();k.showToast&&mxLib.Util.toastInfo("\u5f53\u524d\u7f29\u653e\u7ea7\u4e3a:"+a.getZoom().toFixed(0),{delay:300})});var l=$("#ctrl_navi_bar_"+n).css("height"),m=$("#ctrl_navi_bar_full_"+n).css("height"),q=$("#ctrl_navi_bar_full_"+n).css("top");this._navBarHeight=mxLib.Util.getValueOfNoPX(l);this._navBarLength=mxLib.Util.getValueOfNoPX(m)-mxLib.Util.getValueOfNoPX(l);this._navBarBeginTop=mxLib.Util.getValueOfNoPX(q);f(a,a.getZoom());this.zoomChange=l=function(b){f.call(k,a,1<arguments.length?arguments[1]:b)};a.addEventListener("zoomend",l);var r=null;$("#ctrl_navi_bar_"+n).mousedown(function(b){$(a.getOveralyDragEventDom()).mousemove(e);$(a.getOveralyDragEventDom()).mouseup(g);return!1});$("#ctrl_navi_bar_full_"+n).mousedown(function(a){b(a.clientY||a.y,!0)});$("#ctrl_navi_bar_fill_"+n).mousedown(function(a){b(a.clientY||a.y,!0)});return h};b.prototype.remove=function(){map.removeEventListener("zoomend",this.zoomChange);mxLib.Control.prototype.remove.call(this)}})();(function(){function f(){var a=this.map,b=a.getBounds(!0),e=145*b.height/b.width,g=2+(145-e)/2;$("#OV_CTRL_BOUNDS_"+this._ctrlId).css("height",e);$("#OV_CTRL_BOUNDS_"+this._ctrlId).css("top",g);var a=a.getBounds(!1),g=145*a.width/b.width,k=e*a.height/b.height,h=2+145*(a.getLeftTop().x-b.getLeftTop().x)/b.width,b=2+e*(b.getLeftTop().y-a.getLeftTop().y)/b.height;$("#OV_CTRL_VIEW_"+this._ctrlId).css("width",g);$("#OV_CTRL_VIEW_"+this._ctrlId).css("height",k);$("#OV_CTRL_VIEW_"+this._ctrlId).css("left",h);$("#OV_CTRL_VIEW_"+this._ctrlId).css("top",b);this.pixelPointDistW=a.width/g;this.pixelPointDistH=a.height/k}var b=mxLib.OverviewMapControl=function(a){a=a||{};this.defaultAnchor=a.anchor||MX_ANCHOR_BOTTOM_RIGHT;this.defaultOffset=a.offset||new mxLib.Size(0,0);this.options=a};mxLib.Lang.inherits(b,mxLib.Control);b.prototype.initialize=function(a){this.map=a;var b=this,e=document.createElement("div");this.domElement=e;e.style.width="150px";e.style.height="150px";e.style.zIndex="1200";var g=mxLib.Util.createUniqueID();this._ctrlId=g;var k;k='\x3cdiv id\x3d"OV_CTRL_FRAME_CTRLID" unselectable\x3d"on" style\x3d"width: 150px; height: 150px; bottom: 0px; right: 0px; top: auto; left: auto; position: absolute; z-index: 10; text-size-adjust: none;background-color: #fff;overflow: hidden;border:1px solid #777; "\x3e \r\n   \x3cdiv  id\x3d"OV_CTRL_BOUNDS_CTRLID"  style\x3d" position: absolute;left:2px;top:2px; width: 145px; height: 145px;background-color: #CEE9FE;border:1px solid #777; "\x3e \r\n     \x3cdiv id\x3d"OV_CTRL_VIEW_CTRLID" style\x3d"cursor: pointer;default; width: 0px; height: 0px; left: 0px; top: 0px;opacity:0.6; position: absolute; background-color: #ff0;border:1px solid #777; "\x3e \r\n     \x3c/div\x3e \r\n     \x3cdiv id\x3d"OV_CTRL_VIEW2_CTRLID" style\x3d"pointer-events:none;display:none;cursor: pointer;default; z-Index:100;width: 0px; height: 0px; left: 0px; top: 0px;opacity:0.5; position: absolute; background-color: #0f0;border:1px solid #777; "\x3e \r\n     \x3c/div\x3e  \r\n   \x3c/div\x3e \r\n   \x3cdiv id\x3d"OV_CTRL_CLOSE_CTRLID" style\x3d"top: 0px; right: 1px; left: auto;width:10px;height:10px;position: absolute;\tcursor: pointer;overflow: hidden;z-index: 1210;background: url(SCRIPTDIRmxImg/iw_close.gif)"\x3e\x3c/div\x3e \r\n  \x3c/div\x3e'.replace(/CTRLID/g,g);k=k.replace(/SCRIPTDIR/g,scriptBaseDir);$(e).append($(k));$(a.getContainer()).append(e);var h=!1,n=!0,l=null,m=null,q=null,r=null;$("#OV_CTRL_FRAME_"+g).mousedown(function(a){a.stopPropagation()});$("#OV_CTRL_CLOSE_"+g).mouseup(function(e){a.removeControl(b);e.stopPropagation()});$("#OV_CTRL_VIEW_"+g).mousedown(function(b){var c=b.clientX||b.x;y=b.clientY||b.y;n=h=!0;l=c;m=y;r=a.getCenter();q=$("#OV_CTRL_VIEW_"+g).offset();$("#OV_CTRL_VIEW2_"+g).css("display","");$("#OV_CTRL_VIEW2_"+g).offset({left:q.left,top:q.top});$("#OV_CTRL_VIEW2_"+g).css("width",$("#OV_CTRL_VIEW_"+g).css("width"));$("#OV_CTRL_VIEW2_"+g).css("height",$("#OV_CTRL_VIEW_"+g).css("height"));b.stopPropagation()});$("#OV_CTRL_BOUNDS_"+g).mousemove(function(a){var b=a.clientX||a.x;y=a.clientY||a.y;if(h){n&&(n=!1);var b=b-l,c=y-m;$("#OV_CTRL_VIEW2_"+g).offset({left:q.left+b,top:q.top+c});this._deltaX=b;this._deltaY=c}a.stopPropagation()});$("#OV_CTRL_BOUNDS_"+g).mouseup(function(e){if(h){var k=$("#OV_CTRL_VIEW2_"+g).offset();$("#OV_CTRL_VIEW_"+g).offset({left:k.left,top:k.top});$("#OV_CTRL_VIEW2_"+g).css("display","none");(this._deltaX||this._deltaY)&&a.setCenter(new mxLib.Point(r.x+b.pixelPointDistW*this._deltaX,r.y-b.pixelPointDistH*this._deltaY))}n=h=!1;r=m=l=q=null;e.stopPropagation()});this._updateCtrl=k=function(){f.call(b)};f.call(this);a.addEventListener("zoomend",k);a.addEventListener("dragend",k);a.addEventListener("moveend",k);a.addEventListener("resize",k);k=mxLib.View.getExtData("_overview_map");""!=k&&($("#OV_CTRL_BOUNDS_"+g).css("background","url("+k+")"),$("#OV_CTRL_BOUNDS_"+g).css("background-size","cover"));return e};b.prototype.remove=function(){map.removeEventListener("zoomend",this._updateCtrl);map.removeEventListener("dragend",this._updateCtrl);map.removeEventListener("moveend",this._updateCtrl);map.removeEventListener("resize",this._updateCtrl);mxLib.Control.prototype.remove.call(this)}})();(function(f){function b(a,b){var c=f.data(a,"linkbutton").options;b&&f.extend(c,b);if(c.width||c.height||c.fit){var e=f(a),l=e.parent(),m=e.is(":visible");if(!m){var q=f('\x3cdiv style\x3d"display:none"\x3e\x3c/div\x3e').insertBefore(a),r={position:e.css("position"),display:e.css("display"),left:e.css("left")};e.appendTo("body");e.css({position:"absolute",display:"inline-block",left:-2E4})}e.size(c,l);c=e.find(".mx-l-btn-left");c.css("margin-top",0);c.css("margin-top",parseInt((e.height()-c.height())/2)+"px");m||(e.insertAfter(q),e.css(r),q.remove())}}function a(a){var b=f.data(a,"linkbutton").options,h=f(a).empty();h.addClass("mx-l-btn").removeClass("mx-l-btn-plain mx-l-btn-selected mx-l-btn-plain-selected");h.removeClass("mx-l-btn-small mx-l-btn-medium mx-l-btn-large").addClass("mx-l-btn-"+b.size);b.plain&&h.addClass("mx-l-btn-plain");b.selected&&h.addClass(b.plain?"mx-l-btn-selected mx-l-btn-plain-selected":"mx-l-btn-selected");h.attr("group",b.group||"");h.attr("id",b.id||"");var n=f('\x3cspan class\x3d"mx-l-btn-left"\x3e\x3c/span\x3e').appendTo(h);b.text?f('\x3cspan class\x3d"mx-l-btn-text"\x3e\x3c/span\x3e').html(b.text).appendTo(n):f('\x3cspan class\x3d"mx-l-btn-text mx-l-btn-empty"\x3e\x26nbsp;\x3c/span\x3e').appendTo(n);b.iconCls&&(f('\x3cspan class\x3d"mx-l-btn-icon"\x3e\x26nbsp;\x3c/span\x3e').addClass(b.iconCls).appendTo(n),n.addClass("mx-l-btn-icon-"+b.iconAlign));h.unbind(".linkbutton").bind("focus.linkbutton",function(){b.disabled||f(this).addClass("mx-l-btn-focus")}).bind("blur.linkbutton",function(){f(this).removeClass("mx-l-btn-focus")}).bind("click.linkbutton",function(){b.disabled||(b.toggle&&(b.selected?f(this).linkbutton("unselect"):f(this).linkbutton("select")),b.onClick.call(this))});c(a,b.selected);e(a,b.disabled)}function c(a,b){var c=f.data(a,"linkbutton").options;b?(c.group&&f('a.mx-l-btn[group\x3d"'+c.group+'"]').each(function(){var a=f(this).linkbutton("options");a.toggle&&(a.colorIndex?f(this).removeClass("mx-l-btn-selected-"+c.colorIndex+" mx-l-btn-plain-selected-"+c.colorIndex):f(this).removeClass("mx-l-btn-selected mx-l-btn-plain-selected"),a.selected=!1)}),c.colorIndex?f(a).addClass(c.plain?"mx-l-btn-selected-"+c.colorIndex+" mx-l-btn-plain-selected-"+c.colorIndex:"mx-l-btn-selected-"+c.colorIndex):f(a).addClass(c.plain?"mx-l-btn-selected mx-l-btn-plain-selected":"mx-l-btn-selected"),c.selected=!0):c.group||(c.colorIndex?f(a).removeClass("mx-l-btn-selected-"+c.colorIndex+" mx-l-btn-plain-selected-"+c.colorIndex):f(a).removeClass("mx-l-btn-selected mx-l-btn-plain-selected"),c.selected=!1)}function e(a,b){var c=f.data(a,"linkbutton"),e=c.options;f(a).removeClass("mx-l-btn-disabled mx-l-btn-plain-disabled");if(b){e.disabled=!0;var l=f(a).attr("href");l&&(c.href=l,f(a).attr("href","javascript:void(0)"));a.onclick&&(c.onclick=a.onclick,a.onclick=null);e.plain?f(a).addClass("mx-l-btn-disabled mx-l-btn-plain-disabled"):f(a).addClass("mx-l-btn-disabled")}else e.disabled=!1,c.href&&f(a).attr("href",c.href),c.onclick&&(a.onclick=c.onclick)}mxLib.NoUseMxButtonStyle||(f.fn.linkbutton=function(c,e){if("string"==typeof c)return f.fn.linkbutton.methods[c](this,e);c=c||{};return this.each(function(){var e=f.data(this,"linkbutton");e?f.extend(e.options,c):(f.data(this,"linkbutton",{options:f.extend({},f.fn.linkbutton.defaults,f.fn.linkbutton.parseOptions(this),c)}),f(this).removeAttr("disabled"),f(this).bind("_resize",function(a,c){c&&b(this);return!1}));a(this);b(this)})},f.fn.linkbutton.methods={options:function(a){return f.data(a[0],"linkbutton").options},resize:function(a,c){return a.each(function(){b(this,c)})},enable:function(a){return a.each(function(){e(this,!1)})},disable:function(a){return a.each(function(){e(this,!0)})},select:function(a){return a.each(function(){c(this,!0)})},unselect:function(a){return a.each(function(){c(this,!1)})}},f.fn.linkbutton.parseOptions=function(a){var b=f(a);return f.extend({},mxLib.Util.parseOptions(a,["id","iconCls","iconAlign","group","size",{plain:"boolean",toggle:"boolean",selected:"boolean"}]),{disabled:b.attr("disabled")?!0:void 0,text:f.trim(b.html()),iconCls:b.attr("icon")||b.attr("iconCls")})},f.fn.linkbutton.defaults={id:null,disabled:!1,toggle:!1,selected:!1,group:null,plain:!1,text:"",iconCls:null,iconAlign:"left",size:"small",onClick:function(){}})})(jQuery);(function(){var f=mxLib.LinkButtonControl=function(b,a,c){this.text=b;this.callback=c;b=a||{};this.defaultAnchor=b.anchor||MX_ANCHOR_TOP_LEFT;this.colorIndex=b.colorIndex||0;this.iconCls=b.iconCls;this.defaultOffset=b.offset||b.offest||new mxLib.Size(10,10);this.options=b};mxLib.Lang.inherits(f,mxLib.Control);f.prototype.initialize=function(b){var a=$('\x3ca href\x3d"#"\x3e'+this.text+"\x3c/a\x3e ");$(b.container).append(a);this.domElement=a[0];this.iconCls?a.linkbutton&&a.linkbutton({iconCls:this.iconCls}):a.linkbutton&&a.linkbutton();this.options.opacity&&a.css("opacity",this.options.opacity);this.callback&&a.bind("click",this.callback);this.colorIndex&&(this.colorIndex%=8,0==this.colorIndex&&(this.colorIndex=8),a.addClass("mx-c"+this.colorIndex));(this.options.width||this.options.height)&&this.resize(this.options.width,this.options.height);return a[0]};f.prototype.resize=function(b,a){b&&a?$(this.domElement).linkbutton("resize",{width:b,height:a}):b?$(this.domElement).linkbutton("resize",{width:b}):a&&$(this.domElement).linkbutton("resize",{height:a})};f.prototype.enable=function(){$(this.domElement).linkbutton("enable");this.callback&&$(this.domElement).unbind("click",this.callback);this.callback&&$(this.domElement).bind("click",this.callback)};f.prototype.disable=function(){$(this.domElement).linkbutton("disable");this.callback&&$(this.domElement).unbind("click",this.callback)};f.prototype.remove=function(){this.callback&&$(this.domElement).unbind("click",this.callback);mxLib.Control.prototype.remove.call(this)}})();(function(){var f=mxLib.LinkButtonGroupControl=function(b,a){this.buttons=b;var c=a||{};this.defaultAnchor=c.anchor||MX_ANCHOR_TOP_LEFT;this.defaultOffset=c.offset||c.offest||new mxLib.Size(10,10);this.options=c;this.options.margin=this.options.margin||3};mxLib.Lang.inherits(f,mxLib.Control);f.prototype.initialize=function(b){var a=$("\x3cdiv "+(this.options.style?'style\x3d"'+this.options.style+'"':"")+"\x3e ");$(b.container).append(a);this.domElement=a[0];this.options.opacity&&a.css("opacity",this.options.opacity);for(b=0;b<this.buttons.length;b++){var c=$('\x3ca href\x3d"#"\x3e'+this.buttons[b].text+"\x3c/a\x3e ");this.options.margin&&(this.options.vLayout?(c.css("margin-top",this.options.margin+"px"),c.css("margin-bottom",this.options.margin+"px")):(c.css("margin-left",this.options.margin+"px"),c.css("margin-right",this.options.margin+"px")));if(this.options.vLayout){var e=$("\x3cdiv/\x3e");a.append(e);e.append(c)}else a.append(c);c.linkbutton&&(this.buttons[b].iconCls?c.linkbutton({iconCls:this.buttons[b].iconCls}):this.options.colorIndex?(this.buttons[b].colorIndex=this.options.colorIndex,c.linkbutton({colorIndex:this.options.colorIndex})):c.linkbutton());this.buttons[b].group&&c.linkbutton({group:this.buttons[b].group,toggle:!0,selected:this.buttons[b].selected||!1});this.buttons[b].callback&&c.bind("click",this.buttons[b].callback);this.buttons[b].colorIndex&&(this.buttons[b].colorIndex%=8,0==this.buttons[b].colorIndex&&(this.buttons[b].colorIndex=8),c.addClass("mx-c"+this.buttons[b].colorIndex));(this.buttons[b].width||this.buttons[b].height)&&c.linkbutton("resize",{width:this.buttons[b].width,height:this.buttons[b].height})}return a[0]};f.prototype.remove=function(){mxLib.Control.prototype.remove.call(this)}})();(function(){window.MX_DRAWING_MARKER="marker";window.MX_DRAWING_POLYLINE="polyline";window.MX_DRAWING_CIRCLE="circle";window.MX_DRAWING_RECTANGLE="rectangle";window.MX_DRAWING_POLYGON="polygon";mxLib.DrawingTool=DrawingTool=function(f,b){this.DrawCommand=f;b=this.drawingToolOptions=b||{};this.defaultAnchor=MX_ANCHOR_TOP_LEFT;this.defaultOffset=new mxLib.Size(10,10);this.options=b;this.defaultDrawingModes=[MX_DRAWING_MARKER,MX_DRAWING_CIRCLE,MX_DRAWING_POLYLINE,MX_DRAWING_POLYGON,MX_DRAWING_RECTANGLE];this.drawingModes=b.drawingModes?b.drawingModes:this.defaultDrawingModes;b.anchor&&this.setAnchor(b.anchor);b.offset&&this.setOffset(b.offset)};DrawingTool.prototype=new mxLib.Control;DrawingTool.prototype.initialize=function(f){var b=this.container=document.createElement("div");b.className="MxLib_Drawing";var a=this.panel=document.createElement("div");a.className="MxLib_Drawing_panel";this.drawingToolOptions&&this.drawingToolOptions.scale&&this._setScale(this.drawingToolOptions.scale);b.appendChild(a);a.innerHTML=this._generalHtml();this._bind(a);f.getContainer().appendChild(b);return b};DrawingTool.prototype._generalHtml=function(f){var b={};b[MX_DRAWING_MARKER]="\u753b\u70b9";b[MX_DRAWING_CIRCLE]="\u753b\u5706";b[MX_DRAWING_POLYLINE]="\u753b\u6298\u7ebf";b[MX_DRAWING_POLYGON]="\u753b\u591a\u8fb9\u5f62";b[MX_DRAWING_RECTANGLE]="\u753b\u77e9\u5f62";b.exithander="\u9000\u51fa";f=function(a,c){return'\x3ca class\x3d"'+a+'" drawingType\x3d"'+c+'" href\x3d"javascript:void(0)" title\x3d"'+b[c]+'" onfocus\x3d"this.blur()"\x3e\x3c/a\x3e'};for(var a=[],c=0,e=this.drawingModes.length;c<e;c++){var g="MxLib_box MxLib_"+this.drawingModes[c];c==e-1&&(g+=" MxLib_last");a.push(f(g,this.drawingModes[c]))}a.push(f("MxLib_box MxLib_exithander","exithander"));return a.join("")};DrawingTool.prototype._setScale=function(f){var b=-parseInt((390-390*f)/2,10),a=-parseInt((50-50*f)/2,10);this.container.style.cssText=["-moz-transform: scale("+f+");","-o-transform: scale("+f+");","-webkit-transform: scale("+f+");","transform: scale("+f+");","margin-left:"+b+"px;","margin-top:"+a+"px;","*margin-left:0px;*margin-top:0px;margin-left:0px\\0;margin-top:0px\\0;filter: progid:DXImageTransform.Microsoft.Matrix(","M11\x3d"+f+",","M12\x3d0,M21\x3d0,","M22\x3d"+f+",","SizingMethod\x3d'auto expand');"].join("")};DrawingTool.prototype._bind=function(f){var b=this;mxLib.on(this.panel,"click",function(a){a=mxLib.getTarget(a).getAttribute("drawingType");b.setStyleByDrawingMode(a);b._bindEventByDraingMode(a)})};DrawingTool.prototype.setStyleByDrawingMode=function(f){if(f)for(var b=this.panel.getElementsByTagName("a"),a=0,c=b.length;a<c;a++){var e=b[a];if(e.getAttribute("drawingType")==f){var g="MxLib_box MxLib_"+f+"_hover";a==c-1&&(g+=" MxLib_last");e.className=g}else e.className=e.className.replace(/_hover/,"")}};DrawingTool.prototype._bindEventByDraingMode=function(f){var b=this.DrawCommand;b&&("exithander"==f?b.end(!0):b.setDrawingMode(f));mxLib.Util.dispatchEvent(this,"click",{drawingType:f,control:this})}})();(function(){CanvablePath=function(f){f=f.replace(/,/gm," ");f=f.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");f=f.replace(/([MmZzLlHhVvCcSsQqTtAa])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");f=f.replace(/([MmZzLlHhVvCcSsQqTtAa])([^\s])/gm,"$1 $2");f=f.replace(/([^\s])([MmZzLlHhVvCcSsQqTtAa])/gm,"$1 $2");f=f.replace(/([0-9])([+\-])/gm,"$1 $2");f=f.replace(/(\.[0-9]*)(\.)/gm,"$1 $2");f=f.replace(/([Aa](\s+[0-9]+){3})\s+([01])\s*([01])/gm,"$1 $3 $4 ");f=CanvablePath.compressSpaces(f);f=CanvablePath.trim(f);this.PathParser=new function(b){this.tokens=b.split(" ");this.reset=function(){this.__index_=-1;this.__previousCommand_=this.__command_="";this.__start_=new CanvablePath.Point(0,0);this.__control_=new CanvablePath.Point(0,0);this.__current_=new CanvablePath.Point(0,0);this.__points_=[];this.__angles_=[]};this.isEnd=function(){return this.__index_>=this.tokens.length-1};this.isCommandOrEnd=function(){return this.isEnd()?!0:null!=this.tokens[this.__index_+1].match(/^[A-Za-z]$/)};this.isRelativeCommand=function(){switch(this.__command_){case "m":case "l":case "h":case "v":case "c":case "s":case "q":case "t":case "a":case "z":return!0}return!1};this.getToken=function(){this.__index_++;return this.tokens[this.__index_]};this.getScalar=function(){return parseFloat(this.getToken())};this.nextCommand=function(){this.__previousCommand_=this.__command_;this.__command_=this.getToken()};this.getPoint=function(){var a=new CanvablePath.Point(this.getScalar(),this.getScalar());return this.makeAbsolute(a)};this.getAsControlPoint=function(){var a=this.getPoint();return this.__control_=a};this.getAsCurrentPoint=function(){var a=this.getPoint();return this.__current_=a};this.getReflectedControlPoint=function(){return"c"!=this.__previousCommand_.toLowerCase()&&"s"!=this.__previousCommand_.toLowerCase()&&"q"!=this.__previousCommand_.toLowerCase()&&"t"!=this.__previousCommand_.toLowerCase()?this.__current_:new CanvablePath.Point(2*this.__current_.x-this.__control_.x,2*this.__current_.y-this.__control_.y)};this.makeAbsolute=function(a){this.isRelativeCommand()&&(a.x+=this.__current_.x,a.y+=this.__current_.y);return a};this.addMarker=function(a,b,e){null!=e&&0<this.__angles_.length&&null==this.__angles_[this.__angles_.length-1]&&(this.__angles_[this.__angles_.length-1]=this.__points_[this.__points_.length-1].angleTo(e));this.addMarkerAngle(a,null==b?null:b.angleTo(a))};this.addMarkerAngle=function(a,b){this.__points_.push(a);this.__angles_.push(b)};this.getMarkerPoints=function(){return this.__points_};this.getMarkerAngles=function(){for(var a=0;a<this.__angles_.length;a++)if(null==this.__angles_[a])for(var b=a+1;b<this.__angles_.length;b++)if(null!=this.__angles_[b]){this.__angles_[a]=this.__angles_[b];break}return this.__angles_}}(f);this.bounds=function(){return this.draw(null)};this.draw=function(b){var a=this.PathParser;a.reset();var c=new CanvablePath.BoundingBox;for(null!=b&&b.beginPath();!a.isEnd();)switch(a.nextCommand(),a.__command_){case "M":case "m":var e=a.getAsCurrentPoint();a.addMarker(e);c.addPoint(e.x,e.y);null!=b&&b.moveTo(e.x,e.y);for(a.__start_=a.__current_;!a.isCommandOrEnd();)e=a.getAsCurrentPoint(),a.addMarker(e,a.__start_),c.addPoint(e.x,e.y),null!=b&&b.lineTo(e.x,e.y);break;case "L":case "l":for(;!a.isCommandOrEnd();){var g=a.__current_,e=a.getAsCurrentPoint();a.addMarker(e,g);c.addPoint(e.x,e.y);null!=b&&b.lineTo(e.x,e.y)}break;case "H":case "h":for(;!a.isCommandOrEnd();)e=new CanvablePath.Point((a.isRelativeCommand()?a.__current_.x:0)+a.getScalar(),a.__current_.y),a.addMarker(e,a.__current_),a.__current_=e,c.addPoint(a.__current_.x,a.__current_.y),null!=b&&b.lineTo(a.__current_.x,a.__current_.y);break;case "V":case "v":for(;!a.isCommandOrEnd();)e=new CanvablePath.Point(a.__current_.x,(a.isRelativeCommand()?a.__current_.y:0)+a.getScalar()),a.addMarker(e,a.__current_),a.__current_=e,c.addPoint(a.__current_.x,a.__current_.y),null!=b&&b.lineTo(a.__current_.x,a.__current_.y);break;case "C":case "c":for(;!a.isCommandOrEnd();){var k=a.__current_,g=a.getPoint(),h=a.getAsControlPoint(),e=a.getAsCurrentPoint();a.addMarker(e,h,g);c.addBezierCurve(k.x,k.y,g.x,g.y,h.x,h.y,e.x,e.y);null!=b&&b.bezierCurveTo(g.x,g.y,h.x,h.y,e.x,e.y)}break;case "S":case "s":for(;!a.isCommandOrEnd();)k=a.__current_,g=a.getReflectedControlPoint(),h=a.getAsControlPoint(),e=a.getAsCurrentPoint(),a.addMarker(e,h,g),c.addBezierCurve(k.x,k.y,g.x,g.y,h.x,h.y,e.x,e.y),null!=b&&b.bezierCurveTo(g.x,g.y,h.x,h.y,e.x,e.y);break;case "Q":case "q":for(;!a.isCommandOrEnd();)k=a.__current_,h=a.getAsControlPoint(),e=a.getAsCurrentPoint(),a.addMarker(e,h,h),c.addQuadraticCurve(k.x,k.y,h.x,h.y,e.x,e.y),null!=b&&b.quadraticCurveTo(h.x,h.y,e.x,e.y);break;case "T":case "t":for(;!a.isCommandOrEnd();)k=a.__current_,h=a.getReflectedControlPoint(),a.__control_=h,e=a.getAsCurrentPoint(),a.addMarker(e,h,h),c.addQuadraticCurve(k.x,k.y,h.x,h.y,e.x,e.y),null!=b&&b.quadraticCurveTo(h.x,h.y,e.x,e.y);break;case "A":case "a":for(;!a.isCommandOrEnd();){var k=a.__current_,f=a.getScalar(),l=a.getScalar(),g=a.getScalar()*(Math.PI/180),m=a.getScalar(),h=a.getScalar(),e=a.getAsCurrentPoint(),q=new CanvablePath.Point(Math.cos(g)*(k.x-e.x)/2+Math.sin(g)*(k.y-e.y)/2,-Math.sin(g)*(k.x-e.x)/2+Math.cos(g)*(k.y-e.y)/2),r=Math.pow(q.x,2)/Math.pow(f,2)+Math.pow(q.y,2)/Math.pow(l,2);1<r&&(f*=Math.sqrt(r),l*=Math.sqrt(r));m=(m==h?-1:1)*Math.sqrt((Math.pow(f,2)*Math.pow(l,2)-Math.pow(f,2)*Math.pow(q.y,2)-Math.pow(l,2)*Math.pow(q.x,2))/(Math.pow(f,2)*Math.pow(q.y,2)+Math.pow(l,2)*Math.pow(q.x,2)));isNaN(m)&&(m=0);var t=new CanvablePath.Point(m*f*q.y/l,m*-l*q.x/f),k=new CanvablePath.Point((k.x+e.x)/2+Math.cos(g)*t.x-Math.sin(g)*t.y,(k.y+e.y)/2+Math.sin(g)*t.x+Math.cos(g)*t.y),w=function(a){return Math.sqrt(Math.pow(a[0],2)+Math.pow(a[1],2))},u=function(a,b){return(a[0]*b[0]+a[1]*b[1])/(w(a)*w(b))},v=function(a,b){return(a[0]*b[1]<a[1]*b[0]?-1:1)*Math.acos(u(a,b))},m=v([1,0],[(q.x-t.x)/f,(q.y-t.y)/l]),r=[(q.x-t.x)/f,(q.y-t.y)/l],t=[(-q.x-t.x)/f,(-q.y-t.y)/l],q=v(r,t);-1>=u(r,t)&&(q=Math.PI);1<=u(r,t)&&(q=0);r=1-h?1:-1;t=m+q/2*r;v=new CanvablePath.Point(k.x+f*Math.cos(t),k.y+l*Math.sin(t));a.addMarkerAngle(v,t-r*Math.PI/2);a.addMarkerAngle(e,t-r*Math.PI);c.addPoint(e.x,e.y);null!=b&&(u=f>l?f:l,e=f>l?1:f/l,f=f>l?l/f:1,b.translate(k.x,k.y),b.rotate(g),b.scale(e,f),b.arc(0,0,u,m,m+q,1-h),b.scale(1/e,1/f),b.rotate(-g),b.translate(-k.x,-k.y))}break;case "Z":case "z":null!=b&&b.closePath(),a.__current_=a.__start_}return c};this.getMarkers=function(){for(var b=this.PathParser.getMarkerPoints(),a=this.PathParser.getMarkerAngles(),c=[],e=0;e<b.length;e++)c.push([b[e],a[e]]);return c}};CanvablePath.trim=function(f){return f.replace(/^\s+|\s+$/g,"")};CanvablePath.compressSpaces=function(f){return f.replace(/[\s\r\t\n]+/gm," ")};CanvablePath.Point=function(f,b){this.x=f;this.y=b};CanvablePath.Point.prototype.angleTo=function(f){return Math.atan2(f.y-this.y,f.x-this.x)};CanvablePath.Point.prototype.applyTransform=function(f){var b=this.x*f[1]+this.y*f[3]+f[5];this.x=this.x*f[0]+this.y*f[2]+f[4];this.y=b};CanvablePath.BoundingBox=function(f,b,a,c){this.y2=this.x2=this.y1=this.x1=Number.NaN;this.x=function(){return this.x1};this.y=function(){return this.y1};this.width=function(){return this.x2-this.x1};this.height=function(){return this.y2-this.y1};this.addPoint=function(a,b){if(null!=a){if(isNaN(this.x1)||isNaN(this.x2))this.x2=this.x1=a;a<this.x1&&(this.x1=a);a>this.x2&&(this.x2=a)}if(null!=b){if(isNaN(this.y1)||isNaN(this.y2))this.y2=this.y1=b;b<this.y1&&(this.y1=b);b>this.y2&&(this.y2=b)}};this.addX=function(a){this.addPoint(a,null)};this.addY=function(a){this.addPoint(null,a)};this.addBoundingBox=function(a){this.addPoint(a.x1,a.y1);this.addPoint(a.x2,a.y2)};this.addQuadraticCurve=function(a,b,c,h,f,l){c=a+2/3*(c-a);h=b+2/3*(h-b);this.addBezierCurve(a,b,c,c+1/3*(f-a),h,h+1/3*(l-b),f,l)};this.addBezierCurve=function(a,b,c,h,f,l,m,q){var r=[a,b],t=[c,h],w=[f,l],u=[m,q];this.addPoint(r[0],r[1]);this.addPoint(u[0],u[1]);for(__index_=0;1>=__index_;__index_++)a=function(a){return Math.pow(1-a,3)*r[__index_]+3*Math.pow(1-a,2)*a*t[__index_]+3*(1-a)*Math.pow(a,2)*w[__index_]+Math.pow(a,3)*u[__index_]},b=6*r[__index_]-12*t[__index_]+6*w[__index_],c=-3*r[__index_]+9*t[__index_]-9*w[__index_]+3*u[__index_],h=3*t[__index_]-3*r[__index_],0==c?0!=b&&(b=-h/b,0<b&&1>b&&(0==__index_&&this.addX(a(b)),1==__index_&&this.addY(a(b)))):(h=Math.pow(b,2)-4*h*c,0>h||(f=(-b+Math.sqrt(h))/(2*c),0<f&&1>f&&(0==__index_&&this.addX(a(f)),1==__index_&&this.addY(a(f))),b=(-b-Math.sqrt(h))/(2*c),0<b&&1>b&&(0==__index_&&this.addX(a(b)),1==__index_&&this.addY(a(b)))))};this.isPointInBox=function(a,b){return this.x1<=a&&a<=this.x2&&this.y1<=b&&b<=this.y2};this.addPoint(f,b);this.addPoint(a,c)}})();(function(){window.MX_ANIMATION_DROP=1;window.MX_ANIMATION_BOUNCE=2;window.MX_ANIMATION_FLASH=3;window.MX_ANIMATION_SHADOW=4;var f=mxLib.Overlay=function(){this.domElement=null};mxLib.lang.inherits(mxLib.Overlay,mxLib.lang.Class,"Overlay");f.prototype._initAddOverlay=function(b){!this.domElement&&this.initialize&&(mxLib.Overlay.prototype.initialize.call(this,b),this.domElement=this.initialize(b))&&(this.domElement.style.WebkitUserSelect="none");this._bOverlayInternal||this.draw()};f.prototype.initialize=function(b){this._map=b};f.prototype.draw=function(){};f.prototype.drawend=function(b,a){a=a||this.domElement;if(b&&b.zoomScale&&a){var c=this._map.getZoom(),e=1;b.minScale&&c<b.zoomScale?e=Math.pow(2,c-b.zoomScale):b.maxScale&&c>b.zoomScale&&(e=Math.pow(2,c-b.zoomScale));$(a).css("transform","scale("+e+")");$(a).css("-ms-transform-origin","scale("+e+")");$(a).css("-webkit-transform","scale("+e+")");$(a).css("-o-transform","scale("+e+")");$(a).css("-moz-transform","scale("+e+")");$(a).css("transform-origin",b.scaleOrigin||"0% 0%");$(a).css("-ms-transform-origin",b.scaleOrigin||"0% 0%");$(a).css("-webkit-transform-origin",b.scaleOrigin||"0% 0%");$(a).css("-moz-transform-origin",b.scaleOrigin||"0% 0%");$(a).css("-o-transform-origin",b.scaleOrigin||"0% 0%")}};f.prototype.getDomElement=function(){return this.domElement};f.getZIndex=function(b){return(b*=1)?-1E5*b<<1:0};f.prototype.show=function(){this.domElement&&($(this.domElement).show(),this.draw())};f.prototype.hide=function(){$(this.domElement).hide()};f.prototype.isVisible=function(){return"none"==this.domElement.style.display?!1:!0};f.prototype.curZoomInRange=function(b,a,c,e){if(!this._map||!this.domElement||!b&&!a)return!0;b=this._map.curZoomInRange(b,a);a=this.domElement&&"http://www.w3.org/2000/svg"==this.domElement.namespaceURI;e=!1;e=a?"none"!=this.domElement.style.display:this.isVisible();if(b){if(b!=e){if(2!=this._zoomVisibleOpt)return!1;a?this.domElement.style.display="":this.show();if(c)for(b=0;b<c.length;b++)c[b]!=this.domElement&&(c[b]&&c[b].domElement&&c[b].show?c[b].show():c[b]&&(c[b].style.display=""));this._zoomVisibleOpt=1}return!0}if(b!=e){a?this.domElement.style.display="none":this.hide();if(c)for(b=0;b<c.length;b++)c[b]&&c[b].domElement&&c[b].hide?c[b].hide():c[b]&&(c[b].style.display="none");this._zoomVisibleOpt=2}return!1};f.prototype.remove=function(){this.removeContextMenu();this.un();this.domElement=null};f.prototype.addContextMenu=function(b){if(this.domElement&&b instanceof mxLib.ContextMenu){this._ContextMenu&&this.removeContextMenu(this._ContextMenu);b.initialize(this._map);this._ContextMenu=b;var a=this;this._funcContextMenu||(this._funcContextMenu=function(b){var e=b.clientX||b.x||0,g=b.clientY||b.y||0;if(2==mxLib.Util.getButton(b)&&a._ContextMenu)return a._map.ovlCtxMenuTargetObj=a,a._ContextMenu.targetObject=a,a._ContextMenu.show(new mxLib.Pixel(e,g)),b.stopPropagation(),!1});$(this.domElement).bind("mouseup",this._funcContextMenu)}};f.prototype.removeContextMenu=function(){this.domElement&&this._ContextMenu&&(this._ContextMenu.releaseRef(),this._funcContextMenu&&$(this.domElement).unbind("mouseup",this._funcContextMenu),this._ContextMenu=null)};f.prototype.un=function(b){b||(b=this._eventDiv);if(b&&b._on_event_)for(var a in b._on_event_)mxLib.un(b,a,b._on_event_[a])};f.prototype.setEventDispath=function(b,a){function c(a){a=window.event||a;a=new mxLib.Pixel(a.pageX||a.clientX||0,a.pageY||a.clientY||0);var b=l.pixelToPoint(a);return{pixel:a,point:b}}var e=this;b=b||e.domElement;var g=!1,k={};a=!1===a?!1:!0;var h=null,f=null,l=e.map||e._map;this._eventDiv=b;mxLib.on(b,"onclick",function(a){var b=c(a);if(!h||h.pixel.x==b.pixel.x&&h.pixel.y==b.pixel.y)h=b,mxLib.Util.dispatchEvent(e,"onclick"),mxLib.Util.stopAndPrevent(a)});mxLib.on(b,"ontouchend",function(a){mxLib.Util.dispatchEvent(e,"ontouchend");mxLib.Util.dispatchEvent(e,"onclick");mxLib.Util.stopAndPrevent(a)});mxLib.on(b,"ondblclick",function(a){var b=c(a);mxLib.Util.dispatchEvent(e,"ondblclick",{point:b.point,pixel:b.pixel});mxLib.Util.stopAndPrevent(a)});b.onmouseover=function(a){var b=c(a);mxLib.Util.dispatchEvent(e,"onmouseover",{point:b.point,pixel:b.pixel});mxLib.Util.stopAndPrevent(a)};b.onmouseout=function(a){var b=c(a);mxLib.Util.dispatchEvent(e,"onmouseout",{point:b.point,pixel:b.pixel});mxLib.Util.stopAndPrevent(a)};var m=function(h){var t=c(h);mxLib.Util.dispatchEvent(e,"onmouseup",{point:t.point,pixel:t.pixel});if(a){var w=l;mxLib.un(w.getOveralyDragEventDom(),"onmousemove",q);mxLib.un(w.getOveralyDragEventDom(),"onmouseup",m);0==mxLib.Util.getButton(h)&&e.isDraggable()&&(b.style.cursor=f,b.releaseCapture&&b.releaseCapture(),mxLib.Util.dispatchEvent(e,"ondragend",{point:t.point,pixel:t.pixel}),g=!1,k={},mxLib.Util.stopAndPrevent(h))}};if(a)var q=function(a){if(g){g=!1;f=b.style.cursor;var h=mxLib.Util._setCursor("dragstart");b.style.cursor!=h&&(b.style.cursor=h)}h=c(a);e.setDragPoint(new mxLib.Point(h.point.x+k.x,h.point.y+k.y));e.draw();mxLib.Util.dispatchEvent(e,"ondragging",{point:h.point,pixel:h.pixel});mxLib.Util.stopAndPrevent(a)};mxLib.on(b,"onmousedown",function(b){var f=c(b);h=f;mxLib.Util.dispatchEvent(e,"onmousedown",{point:f.point,pixel:f.pixel});if(0==mxLib.Util.getButton(b)&&e.isDraggable()&&a){var n=l;mxLib.on(n.getOveralyDragEventDom(),"onmousemove",q);mxLib.on(n.getOveralyDragEventDom(),"onmouseup",m);if(n=e.getDragPoint())k.x=n.x-f.point.x,k.y=n.y-f.point.y,mxLib.Util.dispatchEvent(e,"ondragstart",{point:f.point,pixel:f.pixel}),g=!0,mxLib.Util.stopAndPrevent(b)}})};f.prototype.enableDragging=function(){this.options||(this.options={});this.options.enableDragging||(this.options.enableDragging={});this.options.enableDragging=!0};f.prototype.disableDragging=function(){this.options||(this.options={});this.options.enableDragging||(this.options.enableDragging={});this.options.enableDragging=!1};f.prototype.isDraggable=function(){return this.options&&this.options.enableDragging?!0:!1};f.prototype.getDragPoint=function(){return this.point};f.prototype.setDragPoint=function(b){this.point&&(this.point=b)};f.prototype.isPointIn=function(b){if(!b||!this.domElement||!this._map)return!1;var a=$(this.domElement).position(),c=$(this.domElement).width(),e=$(this.domElement).height();b=this._map.pointToPixel(b);return(new mxLib.Size(a.left,a.top,a.left+c,a.top+e)).containsPixel(b)}})();(function(){function f(a,b){var e=new Image;e.src=a;e.complete?b.call(e):e.onload=function(){b.call(e)}}window.MX_Icon_SHAPE_DROP_RED=1;window.MX_Icon_SHAPE_DROP_BLUE=2;window.MX_Icon_SHAPE_STAR_SMALL=3;window.MX_Icon_SHAPE_STAR_BIG=4;var b=mxLib.Icon=function(a,b,e){a&&("number"===typeof a&&(a==MX_Icon_SHAPE_DROP_RED?(a=scriptBaseDir+"mxImg/red-marker.png",b||(b=new mxLib.Size(10,13))):a==MX_Icon_SHAPE_DROP_BLUE?(a=scriptBaseDir+"mxImg/blue-marker.png",b||(b=new mxLib.Size(15,16))):a==MX_Icon_SHAPE_STAR_SMALL?(a=scriptBaseDir+"mxImg/star.png",b||(b=new mxLib.Size(16,16))):a==MX_Icon_SHAPE_STAR_BIG&&(a=scriptBaseDir+"mxImg/star_big.png",b||(b=new mxLib.Size(38,38)))),b&&(this.imageUrl=a,this.size=b,a={anchor:new mxLib.Size(Math.floor(b.width/2),Math.floor(b.height/2)),imageOffset:new mxLib.Size(0,0)},e=e||{},$.extend(a,e),this.anchor=a.anchor,this.imageOffset=a.imageOffset,this.infoWindowAnchor=e.infoWindowAnchor||this.anchor))};b.prototype.anchor=null;b.prototype.size=null;b.prototype.imageOffset=null;b.prototype.imageSize=null;b.prototype.imageUrl=null;b.prototype.infoWindowAnchor=null;b.prototype.setImageUrl=function(a){a&&(this.imageUrl=a,this._image=null)};b.prototype.draw=function(a,b,e){this.imageUrl&&(this._image?e?e.call(this._image):(e=a.getContext("2d"),e.save(),b instanceof mxLib.Pixel&&e.translate(b.x,b.y),e.drawImage(this._image,0,0,this.size.width,this.size.height),e.restore()):(this._image=b=new Image,b.src=this.imageUrl,e&&f(this.imageUrl,e)))};b.prototype.setSize=function(a){a&&(this.size=new mxLib.Size(a.width,a.height))};b.prototype.getSize=function(){return this.size};b.prototype.setAnchor=function(a){a&&(this.anchor=new mxLib.Size(a.width,a.height))};b.prototype.getAnchor=function(){return this.anchor};b.prototype.setImageOffset=function(a){a&&(this.imageOffset=new mxLib.Size(a.width,a.height))};b.prototype.setInfoWindowAnchor=function(a){a&&(this.infoWindowAnchor=new mxLib.Size(a.width,a.height))};b.prototype.toString=function(){return"Icon"}})();(function(){var f=mxLib.Label=function(b,a){mxLib.Overlay.prototype.constructor.call(this);this.content=b;this.Size=this.map=null;a=a||{};this.options={width:0,offset:a.offset||new mxLib.Size(0,0),style:{backgroundColor:"#fff",border:"1px solid #f00",padding:"1px",whiteSpace:"nowrap",font:"12px \u5b8b\u4f53,Tahoma,Arial,Helvetica,sans-serif;",zIndex:"80"},position:a.position||null,enableMassClear:!1===a.enableMassClear?!1:!0,enableClicking:!0,minZoom:a.minZoom||0,maxZoom:a.maxZoom||0,zoomScale:a.zoomScale||0,minScale:a.minScale||!0,maxScale:a.maxScale||!1,scaleOrigin:a.scaleOrigin};0>this.options.width&&(this.options.width=0);"undefined"!=typeof a.enableClicking&&(this.options.enableClicking=a.enableClicking);this.point=this.options.position};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){this.map=b;var a=mxLib.dom.create("label",{"class":"MxLabel",onselectstart:"return false;"}),c=this.options,e=this.content;c.title&&(a.title=c.title);var g=a.style;g.position="absolute";0==c.width||"auto"==c.width?g.display="inline":(g.width=c.width+"px",g.display="block",g.overflow="hidden");1==c.enableClicking&&(g.cursor="pointer");a.innerHTML=e;this._bOverlayInternal||b.getPanes().labelPane.appendChild(a);this.domElement=a;this.setStyle(c.style);mxLib.Overlay.prototype.setEventDispath.call(this);return a};f.prototype.getEventPane=function(){return this._map.getPanes().labelPane};f.prototype.draw=function(){mxLib.Overlay.prototype.draw.call(this);if(this.domElement){if(!this.point||!this.curZoomInRange(this.options.minZoom,this.options.maxZoom))return;var b=this.options.offset,a=this.map.pointToPixel(this.point);this.domElement.style.left=a.x+b.width+"px";this.domElement.style.top=a.y+b.height+"px"}mxLib.Overlay.prototype.drawend.call(this,this.options)};f.prototype.remove=function(){mxLib.Overlay.prototype.remove.call(this)};f.prototype.setStyle=function(b){$.extend(this.options.style,b);this.domElement&&mxLib.dom.setStyles(this.domElement,this.options.style)};f.prototype.setContent=function(b){this.content=b;this.domElement&&(this.domElement.innerHTML=b)};f.prototype.setPosition=function(b){this.point=b;this.draw()};f.prototype.getPosition=function(){return this.point};f.prototype.setOffset=function(b){this.options.offset=b;this.draw()};f.prototype.getOffset=function(){return this.options.offset};f.prototype.setTitle=function(b){this.options.title=b};f.prototype.getTitle=function(){return this.options.title};f.prototype.setTop=function(b){this._bZIndexTop=b;this._updateZIndex()};f.prototype._updateZIndex=function(){if(this.domElement){var b=this.zIndex=this.domElement.style.zIndex;this._bSetZIndex||(b=mxLib.Overlay.getZIndex(this.point.y),this._bZIndexTop&&(b+=Math.abs(b)+1E5));b!=this.zIndex&&(this.domElement.style.zIndex=b)}};f.prototype.enableMassClear=function(){this.options.enableMassClear=!0};f.prototype.disableMassClear=function(){this.options.enableMassClear=!1};f.prototype.setZIndex=function(b){this.options.style.zIndex=b};f.prototype.getMap=function(){return this.map};f.prototype.addContextMenu=function(b){};f.prototype.removeContextMenu=function(b){};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)}})();(function(){window.MX_Symbol_SHAPE_CIRCLE=1;window.MX_Symbol_SHAPE_RECTANGLE=2;window.MX_Symbol_SHAPE_RHOMBUS=3;window.MX_Symbol_SHAPE_STAR=4;window.MX_Symbol_SHAPE_BACKWARD_CLOSED_ARROW=5;window.MX_Symbol_SHAPE_FORWARD_CLOSED_ARROW=6;window.MX_Symbol_SHAPE_BACKWARD_OPEN_ARROW=7;window.MX_Symbol_SHAPE_FORWARD_OPEN_ARROW=8;window.MX_Symbol_SHAPE_POINT=9;window.MX_Symbol_SHAPE_PLANE=10;window.MX_Symbol_SHAPE_CAMERA=11;window.MX_Symbol_SHAPE_WARNING=12;window.MX_Symbol_SHAPE_SMILE=13;window.MX_Symbol_SHAPE_CLOCK=14;var f={14:"m-0.00573,-10c-5.51975,0 -9.99427,4.47453 -9.99427,9.99428c0,5.51974 4.47452,9.99425 9.99427,9.99425c5.51972,0 9.99426,-4.47452 9.99426,-9.99425c0,-5.51975 -4.47453,-9.99428 -9.99426,-9.99428zm0,17.92491c-4.37412,0 -7.93132,-3.55788 -7.93132,-7.93063c0,-4.37345 3.5572,-7.93134 7.93132,-7.93134c4.37411,0 7.93062,3.55721 7.93062,7.93134c0,4.37412 -3.55789,7.93063 -7.93062,7.93063zm-0.00068,-15.4088c-0.38027,0 -0.68696,0.30807 -0.68696,0.68765l0,6.34078l-4.15752,1.81815c-0.34794,0.15266 -0.50611,0.55837 -0.35344,0.90632c0.11278,0.25787 0.36445,0.4119 0.6292,0.4119c0.09214,0 0.18635,-0.01857 0.27575,-0.05845l4.55635,-1.99279c0.00344,-0.00137 0.00619,-0.00275 0.00894,-0.00412l0.00275,-0.00138c0.01032,-0.00413 0.01581,-0.01376 0.02545,-0.01719c0.07151,-0.03576 0.13821,-0.07771 0.19185,-0.1341c0.02337,-0.02338 0.03644,-0.05364 0.05431,-0.08045c0.03301,-0.04401 0.06946,-0.08733 0.0894,-0.14028c0.0165,-0.04126 0.01787,-0.08596 0.02613,-0.12997c0.00894,-0.04469 0.02614,-0.08389 0.02614,-0.1286l0,-6.7905c0,-0.37889 -0.30807,-0.68697 -0.68833,-0.68697z",13:"m-0.00706,-9.5c-5.24281,0 -9.49294,4.25065 -9.49294,9.49294c0,5.24331 4.25014,9.49294 9.49294,9.49294c5.24281,0 9.49294,-4.24964 9.49294,-9.49294c0,-5.2423 -4.25013,-9.49294 -9.49294,-9.49294zm3.08857,3.85997c0.61044,0 1.10279,0.96873 1.10279,2.16271s-0.49384,2.1647 -1.10279,2.1647c-0.60844,0 -1.10228,-0.96873 -1.10228,-2.16372s0.49434,-2.16369 1.10228,-2.16369zm-6.28628,0c0.60844,0 1.10228,0.96873 1.10228,2.16271s-0.49284,2.1647 -1.10228,2.1647s-1.10277,-0.96873 -1.10277,-2.16372s0.49383,-2.16369 1.10277,-2.16369zm3.21167,12.16493c-1.87667,0 -3.63373,-1.14814 -5.14663,-3.14239c1.56571,1.02156 3.27993,1.59064 5.07786,1.59064c1.90905,0 3.72343,-0.63985 5.36539,-1.78497c-1.54429,2.11685 -3.35767,3.33672 -5.29662,3.33672l-0.00001,0z",12:"m9.27295,5.92958l-2.64443,-4.57961c-0.79727,-1.37992 -2.10131,-3.63983 -2.8986,-5.01973l-2.64441,-4.57858c-0.79782,-1.38093 -2.10186,-1.38093 -2.89913,0l-2.64335,4.57858c-0.79728,1.3799 -2.10188,3.63981 -2.89916,5.01973l-2.64387,4.57961c-0.79728,1.38101 -0.14472,2.50988 1.44983,2.50988l16.37221,0c1.59561,0 2.24711,-1.12887 1.45091,-2.50988l0,0zm-8.88166,0.70811l-1.56837,0l0,-1.50484l1.56837,0l0,1.50484zm-0.07527,-2.61447l-1.41621,0l-0.14044,-6.44231l1.68427,0l-0.12761,6.44231l0,0z",11:"m8.08295,-6.56414l-3.59319,0l0,-1.43586l-8.98155,0l0,1.43586l-3.59321,0c-1.0569,0 -1.915,0.85509 -1.915,1.91159l0,9.92258c0,1.05357 0.8581,1.91158 1.915,1.91158l16.16796,0c1.05692,0 1.91501,-0.85801 1.91501,-1.91158l0,-9.92258c0,-1.0565 -0.85809,-1.91159 -1.91501,-1.91159l0,0zm-8.08397,12.66884c-3.20143,0 -5.80643,-2.60031 -5.80643,-5.79596c0,-3.19569 2.605,-5.79891 5.80643,-5.79891s5.80789,2.60322 5.80789,5.79891c0,3.19565 -2.60794,5.79596 -5.80789,5.79596zm0,-9.6804c-2.15036,0 -3.89142,1.7394 -3.89142,3.88444c0,2.14503 1.74252,3.8844 3.89142,3.8844c2.1489,0 3.89141,-1.73937 3.89141,-3.8844c0,-2.14503 -1.74105,-3.88444 -3.89141,-3.88444z",10:"m0,-10c-0.20885,0 -0.39491,0.08583 -0.55177,0.24149c-0.15674,0.15536 -0.28646,0.37838 -0.39429,0.65665c-0.21586,0.55655 -0.34853,1.33844 -0.42114,2.27477c-0.07231,0.93446 -0.08474,2.02273 -0.05447,3.18765c-2.58175,1.05925 -7.81787,3.24648 -8.23854,3.73474c-0.56001,0.65029 -0.37908,1.3954 -0.15331,1.89002l8.608,-1.75235c0.18202,2.28374 0.4407,4.5455 0.66615,6.31771c-0.8418,0.24646 -2.41323,0.73303 -2.73754,1.03474c-0.4469,0.41562 -0.4469,1.75793 -0.4469,1.75793l3.52318,-0.28665c0.08286,0.57874 0.13486,0.9163 0.13486,0.9163l0.00511,0.03042l0.02778,0l0.06486,0l0.02778,0l0.00511,-0.03042c0,0 0.05185,-0.33756 0.13486,-0.9163l3.52424,0.28665c0,0 0,-1.34231 -0.44688,-1.75793c-0.32446,-0.30172 -1.89697,-0.7895 -2.73847,-1.0358c0.22484,-1.76681 0.4832,-4.02001 0.66507,-6.29634l8.50712,1.73203c0.22561,-0.49462 0.40765,-1.23973 -0.15237,-1.89002c-0.41538,-0.48221 -5.52504,-2.62071 -8.1386,-3.69423c0.03119,-1.17999 0.01971,-2.28285 -0.05353,-3.22816l0,-0.00233c-0.07263,-0.93523 -0.20545,-1.71635 -0.42114,-2.27244c-0.10784,-0.27827 -0.23634,-0.50114 -0.3932,-0.65665c-0.15689,-0.15567 -0.34293,-0.24149 -0.55195,-0.24149l0,0l0,0l0,0l0.00001,0l0,0l-0.00003,0.00001z",3:"m-10,0l10,-10l10,10l-10,10l-10,-10z",5:"M0,0 L-5,-15 0,-10 5,-15 z",6:"M0,0 L5,15 0,10 -5,15z",7:"M-5,-15 L0,0 5,-15",8:"M-5,15 L0,0 5,15",9:"m0,-24c-4.4183,0 -8,3.58167 -8,8c0,1.42102 0.3816,2.75 1.0312,3.90601c0.1079,0.19202 0.221,0.38098 0.3438,0.56299l6.625,11.53101l6.625,-11.53101c0.102,-0.151 0.19,-0.31097 0.281,-0.46899l0.063,-0.09399c0.649,-1.15601 1.031,-2.48499 1.031,-3.90601c0,-4.41833 -3.582,-8 -8,-8zm0,4c2.209,0 4,1.79089 4,4c0,2.20898 -1.791,4 -4,4c-2.2091,0 -4,-1.79102 -4,-4c0,-2.20911 1.7909,-4 4,-4z"},b=mxLib.Symbol=function(a,b){a&&(b=b||{},this.style={},this.style.anchor=b.anchor||new mxLib.Size(0,0),this.style.fillColor=b.fillColor||"#000",this.style.fillOpacity=b.fillOpacity||1,this.style.scale=b.scale||1,this.style.rotation=b.rotation||0,this.style.strokeColor=b.strokeColor||"#000",this.style.strokeOpacity=b.strokeOpacity||1,this.style.strokeWeight=b.strokeWeight,this.style.svgMarkerOrient=b.svgMarkerOrient||"auto",this.style.svgMarkerX=b.svgMarkerX||0,this.style.svgMarkerY=b.svgMarkerY||0,this.style.svgMarkerWidth=b.svgMarkerWidth||0,this.style.svgMarkerHeight=b.svgMarkerHeight||0,this.style.svgMarkerRefX=b.svgMarkerRefX||0,this.style.svgMarkerRefY=b.svgMarkerRefY||0,this.style.shapeRectWidth=b.shapeRectWidth||4,this.style.shapeRectHeight=b.shapeRectHeight||2,this.path="number"===typeof a?a:"UserDefined",this._andchorVar=null,"string"===typeof this.style.anchor?this._andchorVar=this.style.anchor:(this.anchor=this.style.anchor,this._anchor=new mxLib.Size(this.anchor.width,this.anchor.height)),this.transSize=new mxLib.Size(0,0),this.path=a,this.init())};b.prototype._calcAnchorVar=function(){if(this._andchorVar){var a=this._andchorVar.split(",");if(2<=a.length){a[0]=a[0].replace("w",this.size.width);a[1]=a[1].replace("h",this.size.height);var b=parseInt(eval(a[0])),a=parseInt(eval(a[1]));this.anchor=new mxLib.Size(b,a);this._anchor=new mxLib.Size(b,a)}}};b.prototype.init=function(){var a=this.path;f[a]&&(a=f[a]);this.svgPath=a;switch(a){case 1:var b=a=this.Pt(2),e=this.style.scale,g=this._anchor;this.size=new mxLib.Size(a,b);this._calcAnchorVar();this.anchor=new mxLib.Size(a/2+g.width*e,b/2+g.height*e);this.path=1;this.style.svgMarkerWidth||(this.style.svgMarkerWidth=this.size.width);this.style.svgMarkerHeight||(this.style.svgMarkerHeight=this.size.height);this.style.svgMarkerRefX||(this.style.svgMarkerRefX=this.size.width/2+this.style.svgMarkerX);this.style.svgMarkerRefY||(this.style.svgMarkerRefY=this.size.height/2+this.style.svgMarkerY);break;case 2:var a=this.Pt(this.style.shapeRectWidth),b=this.Pt(this.style.shapeRectHeight),g=this._anchor,k=this.style.strokeWeight?this.style.strokeWeight:this.style.scale,e=this.style.scale;this.size=new mxLib.Size(a,b);this._calcAnchorVar();this.transSize=new mxLib.Size(Math.floor(-k/2),Math.floor(-k/2));this.anchor=new mxLib.Size(a/2+g.width*e,b/2+g.height*e);this.path=2;this.style.svgMarkerWidth||(this.style.svgMarkerWidth=this.size.width);this.style.svgMarkerHeight||(this.style.svgMarkerHeight=this.size.height);this.style.svgMarkerRefX||(this.style.svgMarkerRefX=this.size.width/2+this.style.svgMarkerX);this.style.svgMarkerRefY||(this.style.svgMarkerRefY=this.size.height/2+this.style.svgMarkerY);break;case 4:b=a=this.Pt(20);g=this._anchor;e=this.style.scale;this.size=new mxLib.Size(a,b);this._calcAnchorVar();this.anchor=new mxLib.Size(a/2+g.width*e,b/2+g.height*e);this.path=4;break;default:var a=new CanvablePath(a),h=a.bounds(),b=this.style.rotation*Math.PI/180,k=this.style.strokeWeight?this.style.strokeWeight:this.style.scale,e=this.style.scale,n=new mxLib.Size(Math.floor(h.x1*e-k/2),Math.floor(h.y1*e-k/2));this.size=n;this._calcAnchorVar();var g=this._anchor,e={CM:new mxLib.Pixel(Math.floor(h.x1*e-k/2)-e*g.width,Math.floor(h.y1*e-k/2)-e*g.height),TZ:new mxLib.Pixel(Math.floor(h.x1*e-k/2)-e*g.width,Math.ceil(h.y2*e-k/2)-e*g.height),s1:new mxLib.Pixel(Math.ceil(h.x2*e+k/2)-e*g.width,Math.floor(h.y1*e-k/2)-e*g.height),UZ:new mxLib.Pixel(Math.ceil(h.x2*e+k/2)-e*g.width,Math.ceil(h.y2*e+k/2)-e*g.height)},g={},k=[],l=[],m;for(m in e){var q=Math.cos(b)*e[m].x-Math.sin(b)*e[m].y,r=Math.sin(b)*e[m].x+Math.cos(b)*e[m].y;g[m]=new mxLib.Pixel(q,r);k.push(q);l.push(r)}xmax=Math.max.apply(Math,k);ymax=Math.max.apply(Math,l);xmin=Math.min.apply(Math,k);ymin=Math.min.apply(Math,l);this.size=new mxLib.Size(Math.ceil(xmax-xmin),Math.ceil(ymax-ymin));this._calcAnchorVar();this.anchor=new mxLib.Size(-xmin,-ymin);this.transSize=new mxLib.Size(xmin-g.CM.x,ymin-g.CM.y);this.translatePos=new mxLib.Pixel(n.width,n.height);this.rotation=b;this.path=a;this.style.svgMarkerX||(this.style.svgMarkerX=Math.min(h.x1,h.x2));this.style.svgMarkerY||(this.style.svgMarkerY=Math.min(h.y1,h.y2));this.style.svgMarkerWidth||(this.style.svgMarkerWidth=Math.abs(h.x1-h.x2));this.style.svgMarkerHeight||(this.style.svgMarkerHeight=Math.abs(h.y1-h.y2));this.style.svgMarkerRefX||(this.style.svgMarkerRefX=h.width/2+this.style.svgMarkerX);this.style.svgMarkerRefY||(this.style.svgMarkerRefY=h.height)}this.infoWindowAnchor=new mxLib.Size(this.size.width/2,0)};b.prototype.getSize=function(a){return this.size};b.prototype.Pt=function(a){return this.style.strokeWeight?a*this.style.scale+this.style.strokeWeight%3+this.style.strokeWeight:a*this.style.scale+this.style.scale+this.style.scale%2};b.prototype.draw=function(a,b){var e=this.style.scale;size=this.size;this.canvas=a;a=this.canvas2d=a.getContext("2d");a.save();a.fillStyle=mxLib.Util.color.mB(this.style.fillColor,this.style.fillOpacity);a.strokeStyle=mxLib.Util.color.mB(this.style.strokeColor,this.style.strokeOpacity);a.lineCap="round";a.lineJoin="round";a.lineWidth=this.style.strokeWeight||e;b instanceof mxLib.Pixel&&a.translate(b.x,b.y);this.size&&a.translate(-this.transSize.width,-this.transSize.height);this.rotation&&a.rotate(this.rotation);this.translatePos&&a.translate(-this.translatePos.x,-this.translatePos.y);switch(this.path){case 1:a.arc(size.width/2,size.height/2,e,0,2*Math.PI);break;case 2:a.rect(0,0,this.style.shapeRectWidth*e,this.style.shapeRectHeight*e);break;case 4:a.beginPath();for(var g=size.width/2,e=10*e,k=2*Math.PI/10,h=11;0!=h;h--){var f=e*(h%2+1)/2,l=k*h;a.lineTo(f*Math.sin(l)+g,f*Math.cos(l)+g)}a.closePath();break;default:a.lineWidth/=e,a.scale(e,e),this.path.draw(a)}a.fill();a.stroke();a.restore()};b.prototype.getSvgMarker=function(a,b){if(!a)return null;if(this.svgMarker)return this.svgMarker;var e=null,g=this.style.scale;size=this.size;switch(this.path){case 1:e=a.paper.circle(size.width/2,size.height/2,g);break;case 2:e=a.paper.rect(0,0,4*g,2*g);break;case 4:break;default:e=a.paper.path(this.svgPath)}e.attr({fill:this.style.fillColor,"fill-opacity":this.style.fillOpacity,stroke:this.style.strokeColor,"stroke-width":this.style.strokeWeight,"stroke-opacity":this.style.strokeOpacity});if(b)for(var k in b)e.attr(k,b[k]);this.style.rotation&&(e.transform((new Snap.Matrix).rotate(this.style.rotation)),g=e.getBBox(),this.style.svgMarkerX=g.x,this.style.svgMarkerY=Math.min(g.y,g.y2),this.style.svgMarkerWidth=g.width,this.style.svgMarkerHeight=g.height);this.svgMarker=e.marker(this.style.svgMarkerX,this.style.svgMarkerY,this.style.svgMarkerWidth,this.style.svgMarkerHeight,this.style.svgMarkerRefX,this.style.svgMarkerRefY);1!=this.style.scale&&this.svgMarker.attr({markerWidth:this.style.svgMarkerWidth*this.style.scale,markerHeight:this.style.svgMarkerHeight*this.style.scale});"auto"!=this.style.svgMarkerOrient&&this.svgMarker.attr({orient:this.style.svgMarkerOrient});return this.svgMarker};b.prototype.setPath=function(a){this.path=a;this.init()};b.prototype.setAnchor=function(a){this.anchor=this.style.anchor=a;this._anchor=new mxLib.Size(this.anchor.width,this.anchor.height);this.init()};b.prototype.getAnchor=function(){return this._anchor};b.prototype.setRotation=function(a){this.style.rotation=a;this.init()};b.prototype.setScale=function(a){this.style.scale=a;this.init()};b.prototype.setStrokeWeight=function(a){this.style.strokeWeight=a;this.init()};b.prototype.setStrokeColor=function(a){this.style.strokeColor=a;this.init()};b.prototype.setStrokeOpacity=function(a){this.style.strokeOpacity=a;this.init()};b.prototype.setFillOpacity=function(a){this.style.fillOpacity=a;this.init()};b.prototype.setFillColor=function(a){this.style.fillColor=a;this.init()};b.prototype.toString=function(){return"Symbol"}})();(function(){function f(a){var b="",b=a.imageOffset,g=a.imageSize,b=['\x3cimg src\x3d"',a.imageUrl,'" style\x3d"display: block; border:none;margin-left:'+b.width+"px","; margin-top:"+b.height+"px","; "];g&&b.push("; width:"+g.width+"px; height:"+g.height+"px;");b.push('" /\x3e');return b.join("")}var b=new mxLib.Icon(scriptBaseDir+"mxImg/marker_red_sprite.png",new mxLib.Size(19,25),{anchor:new mxLib.Size(10,25),infoWindowAnchor:new mxLib.Size(10,0)}),a=mxLib.Marker=function(a,e){mxLib.Overlay.prototype.constructor.call(this);e=e||{};this.point=a;this.map=null;this.options={offset:e.offset||new mxLib.Size(0,0),icon:e.icon||b,shadow:e.shadow||null,title:e.title||"",label:null,baseZIndex:e.baseZIndex||0,top:!1,enableMassClear:!1===e.enableMassClear?!1:!0,enableDragging:!0===e.enableDragging?!0:!1,enableClicking:!1===e.enableClicking?!1:!0,draggingCursor:e.draggingCursor||"-moz-grabbing",rotation:e.rotation||0,shadowAniamte:!1===e.shadowAniamte?!1:!0,minZoom:e.minZoom||0,maxZoom:e.maxZoom||0};e.icon&&!e.shadow&&(this.options.shadow=null);this.options.zoomScale=e.zoomScale||0;this.options.minScale=e.minScale||!0;this.options.maxScale=e.maxScale||!1;this.options.scaleOrigin=e.scaleOrigin};mxLib.Lang.inherits(a,mxLib.Overlay);a.prototype.initialize=function(a){this.map=a;this._appendContent();this.setPosition(this.point);this.setIcon(this.options.icon);this.setShadow(this.options.shadow);this.setRotation(this.options.rotation);this.setLabel(this.options.label);this.setTitle(this.options.title);this._setEventDispath();return this._mouseTargetElement};a.prototype.getEventPane=function(){return this.map.getPanes().markerMouseTarget};a.prototype.getContentPane=function(){return this.map.getPanes().markerPane};a.prototype.getShadowPane=function(){if(!this._markerShadowElement)return this.map.getPanes().markerShadow};a.prototype._appendContent=function(){this._mouseTargetElement=$(this._createMouseTargetElement())[0];this.map.getPanes().markerMouseTarget.appendChild(this._mouseTargetElement);this._markerPaneElement=$(this._createMarkerPaneElement())[0];this.map.getPanes().markerPane.appendChild(this._markerPaneElement)};a.prototype._setEventDispath=function(){function a(c){c=window.event||c;c=new mxLib.Pixel(c.pageX||c.clientX||0,c.pageY||c.clientY||0);var g=b.map.pixelToPoint(c);return{pixel:c,point:g}}var b=this,g=b._mouseTargetElement,k=!1,h={};mxLib.on(g,"onclick",function(a){mxLib.Util.dispatchEvent(b,"onclick");mxLib.Util.stopAndPrevent(a)});mxLib.on(g,"ontouchend",function(a){mxLib.Util.dispatchEvent(b,"ontouchend");mxLib.Util.dispatchEvent(b,"onclick");mxLib.Util.stopAndPrevent(a)});mxLib.on(g,"ondblclick",function(g){var k=a(g);mxLib.Util.dispatchEvent(b,"ondblclick",{point:k.point,pixel:k.pixel});mxLib.Util.stopAndPrevent(g)});g.onmouseover=function(g){var k=a(g);mxLib.Util.dispatchEvent(b,"onmouseover",{point:k.point,pixel:k.pixel});mxLib.Util.stopAndPrevent(g)};g.onmouseout=function(g){var k=a(g);mxLib.Util.dispatchEvent(b,"onmouseout",{point:k.point,pixel:k.pixel});mxLib.Util.stopAndPrevent(g)};var f=function(m){var q=a(m);mxLib.Util.dispatchEvent(b,"onmouseup",{point:q.point,pixel:q.pixel});b._mouseTargetElement&&b._mouseTargetElement.releaseCapture?(mxLib.un(g,"onmousemove",l),mxLib.un(g,"onmouseup",f)):(mxLib.un(b.map.getOveralyDragEventDom(),"onmousemove",l),mxLib.un(b.map.getOveralyDragEventDom(),"onmouseup",f));b.options.enableDragging&&0==mxLib.Util.getButton(m)&&(b._mouseTargetElement&&b._mouseTargetElement.releaseCapture&&b._mouseTargetElement.releaseCapture(),mxLib.Util.dispatchEvent(b,"ondragend",{point:q.point,pixel:q.pixel}),k=!1,h={},b._mouseTargetElement&&(q=mxLib.Util._setCursor("dragend"),b._mouseTargetElement.style.cursor!=q&&(b._mouseTargetElement.style.cursor=q),b._mouseTargetElement.style.MozUserSelect="",b._mouseTargetElement.style.KhtmlUserSelect="",b._mouseTargetElement.style.WebkitUserSelect="",b._mouseTargetElement.unselectable="off",b._mouseTargetElement.onselectstart=function(){}));mxLib.Util.stopAndPrevent(m)},l=function(g){if(b.options.enableDragging&&k){var f=a(g);b.point.x=f.point.x+h.x;b.point.y=f.point.y+h.y;b.draw();var n=mxLib.Util._setCursor("dragging");b._mouseTargetElement.style.cursor!=n&&(b._mouseTargetElement.style.cursor=n);mxLib.Util.dispatchEvent(b,"ondragging",{point:f.point,pixel:f.pixel});mxLib.Util.stopAndPrevent(g)}};mxLib.on(g,"onmousedown",function(m){var q=a(m);mxLib.Util.dispatchEvent(b,"onmousedown",{point:q.point,pixel:q.pixel});b._mouseTargetElement&&b._mouseTargetElement.setCapture?(mxLib.on(g,"onmousemove",l),mxLib.on(g,"onmouseup",f)):(mxLib.on(b.map.getOveralyDragEventDom(),"onmousemove",l),mxLib.on(b.map.getOveralyDragEventDom(),"onmouseup",f));b.options.enableDragging&&0==mxLib.Util.getButton(m)&&(h.x=b.point.x-q.point.x,h.y=b.point.y-q.point.y,mxLib.Util.dispatchEvent(b,"ondragstart",{point:q.point,pixel:q.pixel}),k=!0,b._mouseTargetElement&&(q=mxLib.Util._setCursor("dragstart"),b._mouseTargetElement.style.cursor!=q&&(b._mouseTargetElement.style.cursor=q),b._mouseTargetElement.setCapture&&b._mouseTargetElement.setCapture(),b._mouseTargetElement.style.MozUserSelect="none",b._mouseTargetElement.style.KhtmlUserSelect="none",b._mouseTargetElement.style.WebkitUserSelect="none",b._mouseTargetElement.unselectable="on",b._mouseTargetElement.onselectstart=function(){return!1}));mxLib.Util.stopAndPrevent(m)})};a.prototype._createMouseTargetElement=function(){var a=['\x3cspan class\x3d"MX_Marker MX_noprint" unselectable\x3d"on" '];this.options.title&&a.push('title\x3d"'+this.options.title+'"');a.push(' style\x3d"position:absolute;padding:0;margin:0;border:0;width:0;height:0;-moz-user-select:none;');a.push(this.options.enableClicking?"cursor:pointer;":"");a.push("background:url("+scriptBaseDir+"mxImg/blank.gif) repeat scroll 0% 0% transparent;");a.push("width:"+this.options.icon.size.width+"px;");a.push("height:"+this.options.icon.size.height+"px;");a.push('"\x3e\x3c/span\x3e');return a.join("")};a.prototype._createMarkerPaneElement=function(){var a=['\x3cspan class\x3d"MX_Marker" unselectable\x3d"on" '];a.push('style\x3d"position:absolute;padding:0;margin:0;border:0;');a.push('width:0;height:0;-moz-user-select:none"\x3e\x3c/span\x3e');return a.join("")};a.prototype._createMarkerShadowElement=function(){var a=['\x3cspan class\x3d"MX_MarkerShadow"  unselectable\x3d"on" '];a.push('style\x3d"position:absolute;padding:0;margin:0;border:0;');a.push('width:0;height:0;-moz-user-select:none"\x3e\x3c/span\x3e');return a.join("")};a.prototype._iconPixelPos=function(){var a=this.options.offset||new Size(0,0),b=this.options.icon.anchor||new Size(0,0),g=this.map.pointToPixel(this.getPosition()),b=[new mxLib.Pixel(g.x+a.width-b.width,g.y+a.height-b.height)];if(this.options.shadow){var k=this.options.shadow.anchor||new Size(0,0);b[1]=new mxLib.Pixel(g.x+a.width-k.width,g.y+a.height-k.height)}else b[1]=new mxLib.Pixel(g.x+a.width-4,g.y+a.height);return b};a.prototype.draw=function(){if(this._mouseTargetElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)){var a=this._iconPixelPos();this._mouseTargetElement.style.left=a[0].x+"px";this._mouseTargetElement.style.top=a[0].y+"px";this._markerPaneElement&&(this._markerPaneElement.style.left=a[0].x+"px",this._markerPaneElement.style.top=a[0].y+"px");this._markerShadowElement&&(this._markerShadowElement.style.left=a[1].x+"px",this._markerShadowElement.style.top=a[1].y+"px");if(this.options.zoomScale){var a=this._map.getZoom(),b=1;this.options.minScale&&a<this.options.zoomScale?b=Math.pow(2,a-this.options.zoomScale):this.options.maxScale&&a>this.options.zoomScale&&(b=Math.pow(2,a-this.options.zoomScale));this._markerPaneElement&&($(this._markerPaneElement).css("transform","scale("+b+")"),$(this._markerPaneElement).css("-ms-transform-origin","scale("+b+")"),$(this._markerPaneElement).css("-webkit-transform","scale("+b+")"),$(this._markerPaneElement).css("-o-transform","scale("+b+")"),$(this._markerPaneElement).css("-moz-transform","scale("+b+")"),$(this._markerPaneElement).css("transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerPaneElement).css("-ms-transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerPaneElement).css("-webkit-transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerPaneElement).css("-moz-transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerPaneElement).css("-o-transform-origin",this.options.scaleOrigin||"0% 0%"));this._markerShadowElement&&($(this._markerShadowElement).css("transform","scale("+b+")"),$(this._markerShadowElement).css("-ms-transform-origin","scale("+b+")"),$(this._markerShadowElement).css("-webkit-transform","scale("+b+")"),$(this._markerShadowElement).css("-o-transform","scale("+b+")"),$(this._markerShadowElement).css("-moz-transform","scale("+b+")"),$(this._markerShadowElement).css("transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerShadowElement).css("-ms-transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerShadowElement).css("-webkit-transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerShadowElement).css("-moz-transform-origin",this.options.scaleOrigin||"0% 0%"),$(this._markerShadowElement).css("-o-transform-origin",this.options.scaleOrigin||"0% 0%"))}this._updateZIndex()}};a.prototype.remove=function(){this.setAnimation(null);this._markerPaneElement&&this._markerPaneElement.parentNode&&this._markerPaneElement.parentNode.removeChild(this._markerPaneElement);this._markerShadowElement&&this._markerShadowElement.parentNode&&this._markerShadowElement.parentNode.removeChild(this._markerShadowElement);this._mouseTargetElement&&this._mouseTargetElement.parentNode&&this._mouseTargetElement.parentNode.removeChild(this._mouseTargetElement);this._markerPaneElement=this._markerShadowElement=this._mouseTargetElement=null;this.options.label&&(this._labelRemoveListerner&&this.options.label.removeEventListener("remove",this._labelRemoveListerner),this.options.label=null);mxLib.Overlay.prototype.un(this._mouseTargetElement);mxLib.Overlay.prototype.remove.call(this)};a.prototype.openInfoWindow=function(a){this.map&&(this.map.closeInfoWindow(),this.map.temp._infoWin=a,a.overlay=this,mxLib.lang.Class.call(a,a.guid),a.open(this))};a.prototype.closeInfoWindow=function(){this.map&&this.map.temp._infoWin&&(this.map.temp._infoWin._visible=!1,mxLib.lang.decontrol(this.map.temp._infoWin.guid),this.map.temp._infoWin=null)};a.prototype.setIcon=function(a){if((this.options.icon=a)&&this.map&&this._mouseTargetElement&&this._markerPaneElement){try{this._markerDiv&&(this._markerPaneElement.removeChild(this._markerDiv),this._markerDiv=null),this._markerPaneElement.style.width=a.size.width+"px",this._markerPaneElement.style.height=a.size.height+"px"}catch(b){}if(this.options.icon){var g=this._markerDiv=document.createElement(a instanceof mxLib.Icon?"div":"canvas");a instanceof mxLib.Icon||mxLib.Util.initCanvas(this._markerDiv);this._markerPaneElement.appendChild(this._markerDiv);var k=g.style;k.position="absolute";k.padding=k.margin="0";k.width=a.size.width+"px";k.height=a.size.height+"px";k.overflow="hidden";a instanceof mxLib.Symbol?(g.width=a.size.width,g.height=a.size.height,a.draw(g)):g.innerHTML=f(a)}this.draw()}};a.prototype.getIcon=function(){return this.options.icon};a.prototype.setShadow=function(a){if(a instanceof mxLib.Icon&&(this.options.shadow=a,this.map&&this._mouseTargetElement&&this._markerPaneElement)){this._markerShadowElement||(this._markerShadowElement=$(this._createMarkerShadowElement())[0],this.map.getPanes().markerShadow.appendChild(this._markerShadowElement));try{this._shadowDiv&&(this._markerShadowElement.removeChild(this._shadowDiv),this._shadowDiv=null),this._markerShadowElement.style.width=a.size.width+"px",this._markerShadowElement.style.height=a.size.height+"px"}catch(b){}if(this.options.shadow){var g=this._shadowDiv=document.createElement("div"),k=g.style;k.position="absolute";k.padding=k.margin="0";k.width=a.size.width+"px";k.height=a.size.height+"px";k.overflow="hidden";g.innerHTML=f(a);this._markerShadowElement.appendChild(this._shadowDiv)}this.draw()}};a.prototype.getShadow=function(){return this.options.shadow};a.prototype.setPosition=function(a){a instanceof mxLib.Point&&(this.point=this.options.point=new mxLib.Point(a.x,a.y),this.draw())};a.prototype.getPosition=function(){return this.point};a.prototype.setOffset=function(a){a instanceof mxLib.Size&&(this.options.offset=a,this.draw())};a.prototype.getOffset=function(){return this.options.offset};a.prototype.getLabel=function(){return this.options.label};a.prototype.setLabel=function(a){if(a&&a instanceof mxLib.Label){this.options.label=a;var b=this;this.options.label._bRemoveListerner||(this.options.label._bRemoveListerner=!0,this._labelRemoveListerner=function(){b.options.label=null},this.options.label.addEventListener("remove",this._labelRemoveListerner));a.point=this.map.pixelToPoint(new mxLib.Pixel(0,0));if(this.map){a.domElement||(a._bOverlayInternal=!0,a._initAddOverlay(this.map));this._markerPaneElement.appendChild(a.domElement);a._marker=this;var g=a.domElement.style;g.left=a.options.offset.width+"px";g.top=a.options.offset.height+"px";a.draw()}}};a.prototype.setTitle=function(a){this.options.title=a;this.options.label&&(this.options.label.title=a)};a.prototype.getTitle=function(){return this.options.title};a.prototype.setTop=function(a){this._bZIndexTop=a;this._updateZIndex()};a.prototype.enableDragging=function(){this.options.enableDragging=!0};a.prototype.disableDragging=function(){this.options.enableDragging=!1};a.prototype.enableMassClear=function(){this.options.enableMassClear=!0};a.prototype.disableMassClear=function(){this.options.enableMassClear=!1};a.prototype._updateZIndex=function(){if(this._mouseTargetElement){var a=this.zIndex=this._mouseTargetElement.style.zIndex;this._bSetZIndex||(a=mxLib.Overlay.getZIndex(this.point.y),this._bZIndexTop&&(a+=Math.abs(a)+1E5));a!=this.zIndex&&(this._mouseTargetElement.style.zIndex=a,this._markerPaneElement.style.zIndex=a)}};a.prototype.setZIndex=function(a){this._bSetZIndex=!0;this._mouseTargetElement.style.zIndex=a;this._markerPaneElement.style.zIndex=a};a.prototype.getMap=function(){return this.map};a.prototype.setAnimation=function(a,b){if(a==MX_ANIMATION_BOUNCE){if(this._markerPaneElement&&$(this._markerPaneElement).addClass("markerball"),this.options.shadowAniamte&&!this._shadowDiv&&(this._markerShadowElement||(this._markerShadowElement=$(this._createMarkerShadowElement())[0],this.map.getPanes().markerShadow.appendChild(this._markerShadowElement),this.draw()),$(this._markerShadowElement).addClass("markerShadow")),b&&0<b){var g=this;setTimeout(function(){$(g._markerPaneElement).removeClass("markerball");g.options.shadowAniamte&&!g._shadowDiv&&$(g._markerShadowElement).removeClass("markerShadow")},b)}}else if(a==MX_ANIMATION_DROP){if(this._markerPaneElement){var k=$(this._markerPaneElement).offset().top;this._markerPaneElement.style.top="0px";$(this._markerPaneElement).animate({top:k+"px"},500);$(this._markerPaneElement).animate({top:k-30+"px"},200);$(this._markerPaneElement).animate({top:k+"px"},100);$(this._markerPaneElement).animate({top:k-15+"px"},200);$(this._markerPaneElement).animate({top:k+"px"},100);$(this._markerPaneElement).animate({top:k-5+"px"},100);$(this._markerPaneElement).animate({top:k+"px"},50);this._markerPaneElement.style.top=k+"px"}}else a==MX_ANIMATION_FLASH?($(this._markerPaneElement).addClass("markerflash"),b&&0<b&&(g=this,setTimeout(function(){$(g._markerPaneElement).removeClass("markerflash")},b))):a||(this._markerPaneElement&&($(this._markerPaneElement).removeClass("markerball"),$(this._markerPaneElement).removeClass("markerflash")),this._markerShadowElement&&($(this._markerShadowElement).removeClass("markerShadow"),$(this._markerShadowElement).removeClass("markerflash")))};a.prototype.setRotation=function(a){if(a&&(this.options.rotation=a,this.map&&this._mouseTargetElement&&this._markerPaneElement))try{if(this._markerDiv){var b=this._markerDiv.style;b.webkitTransform="rotate("+this.options.rotation+"deg)";b.transform="rotate("+this.options.rotation+"deg)"}this._shadowDiv&&(b=this._markerPaneElement.style,b.webkitTransform="rotate("+this.options.rotation+"deg)",b.transform="rotate("+this.options.rotation+"deg)")}catch(g){}};a.prototype.getRotation=function(){return this.options.rotation};a.prototype.show=function(){mxLib.Overlay.prototype.show.call(this);this._mouseTargetElement&&$(this._mouseTargetElement).show();this._markerPaneElement&&$(this._markerPaneElement).show();this._markerShadowElement&&$(this._markerShadowElement).show();this.options.label&&this.options.label.domElement&&$(this.options.label.domElement).show()};a.prototype.hide=function(){mxLib.Overlay.prototype.hide.call(this);this._mouseTargetElement&&$(this._mouseTargetElement).hide();this._markerPaneElement&&$(this._markerPaneElement).hide();this._markerShadowElement&&$(this._markerShadowElement).hide();this.options.label&&this.options.label.domElement&&$(this.options.label.domElement).hide()};a.prototype.addEventListener=function(a,b){return mxLib.lang.Class.prototype.addEventListener.call(this,a,b)};a.prototype.removeEventListener=function(a,b){mxLib.lang.Class.prototype.removeEventListener.call(this,a,b)}})();(function(){var f=mxLib.RichMarker=function(b,a,c){b&&a&&a instanceof mxLib.Point&&(this._map=null,this._content=b,this._position=a,this._size=this._container=null,c=c||{},this._opts=mxLib.extend(mxLib.extend(this._opts||{},{enableDragging:!1,anchor:new mxLib.Size(0,0)}),c),this._opts.minZoom=this._opts.minZoom||0,this._opts.maxZoom=this._opts.maxZoom||0,this._opts.zoomScale=this._opts.zoomScale||0,this._opts.minScale=this._opts.minScale||!0,this._opts.maxScale=this._opts.maxScale||!1,this._opts.scaleOrigin=this._opts.scaleOrigin)};f.prototype=new mxLib.Overlay;f.prototype.initialize=function(b){var a=this._container=document.createElement("div");this._map=b;mxLib.extend(a.style,{position:"absolute",zIndex:mxLib.Overlay.getZIndex(this._position.y),cursor:"pointer"});b.getPanes().labelPane.appendChild(a);this._appendContent();this.domElement=a;mxLib.Overlay.prototype.setEventDispath.call(this);this._getContainerSize();return a};f.prototype.getEventPane=function(){return this._map.getPanes().labelPane};f.prototype.draw=function(){if(this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)){var b=this._opts.anchor,a=this._map.pointToPixel(this._position);this._container.style.left=a.x+b.width+"px";this._container.style.top=a.y+b.height+"px";mxLib.Overlay.prototype.drawend.call(this,this._opts,this._container)}};f.prototype.enableDragging=function(){this._opts.enableDragging=!0};f.prototype.disableDragging=function(){this._opts.enableDragging=!1};f.prototype.isDraggable=function(){return this._opts.enableDragging};f.prototype.getPosition=function(){return this._position};f.prototype.setPosition=function(b){!b instanceof mxLib.Point||(this._position=b,this.draw())};f.prototype.getAnchor=function(){return this._opts.anchor};f.prototype.setAnchor=function(b){!b instanceof mxLib.Size||(this._opts.anchor=b,this.draw())};f.prototype._appendContent=function(){var b=this._content;if("string"==typeof b){var a=document.createElement("DIV");a.innerHTML=b;if(1==a.childNodes.length)b=a.removeChild(a.firstChild);else for(b=document.createDocumentFragment();a.firstChild;)b.appendChild(a.firstChild)}this._container.innerHTML="";this._container.appendChild(b)};f.prototype.getContent=function(){return this._content};f.prototype.setContent=function(b){b&&(this._content=b,this._appendContent())};f.prototype._getContainerSize=function(){this._container&&(this._size=new mxLib.Size(this._container.offsetWidth,this._container.offsetHeight))};f.prototype.getWidth=function(){if(this._size)return this._size.width};f.prototype.setWidth=function(b){this._container&&(this._container.style.width=b+"px",this._getContainerSize())};f.prototype.getHeight=function(){if(this._size)return this._size.height};f.prototype.setHeight=function(b){this._container&&(this._container.style.height=b+"px",this._getContainerSize())};f.prototype.getDragPoint=function(){return this._position};f.prototype.setDragPoint=function(b){this._position=b};f.prototype.remove=function(){this._container&&mxLib.Util.purge(this._container);this._container&&this._container.parentNode&&this._container.parentNode.removeChild(this._container);mxLib.Overlay.prototype.remove.call(this)};f.prototype.enableMassClear=function(){this._opts.enableMassClear=!0};f.prototype.disableMassClear=function(){this._opts.enableMassClear=!1}})();(function(){var f=scriptBaseDir+"mxImg/m",b=mxLib.TextIconOverlay=function(a,b,e){this._position=a;this._text=b;this._options=e||{};this._options.minZoom=e.minZoom||0;this._options.maxZoom=e.maxZoom||0;this._styles=this._options.styles||[];!this._styles.length&&this._setupDefaultStyles()};mxLib.lang.inherits(b,mxLib.Overlay,"TextIconOverlay");b.prototype._setupDefaultStyles=function(){for(var a=[53,56,66,78,90],b=0,e;e=a[b];b++)this._styles.push({url:f+b+".png",size:new mxLib.Size(e,e)})};b.prototype.initialize=function(a){this._map=a;this._domElement=document.createElement("div");this._updateCss();this._updateText();this._updatePosition();this._bind();this._map.getPanes().markerMouseTarget.appendChild(this._domElement);return this._domElement};b.prototype.getEventPane=function(){return this._map.getPanes().markerMouseTarget};b.prototype.draw=function(){this.curZoomInRange(this._options.minZoom,this._options.maxZoom)&&this._map&&this._updatePosition()};b.prototype.getText=function(){return this._text};b.prototype.setText=function(a){!a||this._text&&this._text.toString()==a.toString()||(this._text=a,this._updateText(),this._updateCss(),this._updatePosition())};b.prototype.getPosition=function(){return this._position};b.prototype.setPosition=function(a){!a||this._position&&this._position.equals(a)||(this._position=a,this._updatePosition())};b.prototype.getStyleByText=function(a,b){var e=parseInt(a),e=parseInt(e/10),e=Math.max(0,e),e=Math.min(e,b.length-1);return b[e]};b.prototype._updateCss=function(){var a=this.getStyleByText(this._text,this._styles);this._domElement.style.cssText=this._buildCssText(a)};b.prototype._updateText=function(){this._domElement&&(this._domElement.innerHTML=this._text)};b.prototype._updatePosition=function(){if(this._domElement&&this._position){var a=this._domElement.style,b=this._map.pointToPixel(this._position);b.x-=Math.ceil(parseInt(a.width)/2);b.y-=Math.ceil(parseInt(a.height)/2);a.left=b.x+"px";a.top=b.y+"px"}};b.prototype._buildCssText=function(a){var b=a.url,e=a.size,g=a.anchor,k=a.offset,h=a.textColor||"black";a=a.textSize||10;var f=[];7>mxLib.browser.ie?f.push('filter:progid:DXImageTransform.Microsoft.AlphaImageLoader(sizingMethod\x3dscale,src\x3d"'+b+'");'):(f.push("background-image:url("+b+");"),b="0 0",k instanceof mxLib.Size&&(b=k.width+"px "+k.height+"px"),f.push("background-position:"+b+";"));e instanceof mxLib.Size&&(g instanceof mxLib.Size?(0<g.height&&g.height<e.height&&f.push("height:"+(e.height-g.height)+"px; padding-top:"+g.height+"px;"),0<g.width&&g.width<e.width&&f.push("width:"+(e.width-g.width)+"px; padding-left:"+g.width+"px;")):(f.push("height:"+e.height+"px; line-height:"+e.height+"px;"),f.push("width:"+e.width+"px; text-align:center;")));f.push("cursor:pointer; color:"+h+"; position:absolute; font-size:"+a+"px; font-family:Arial,sans-serif; font-weight:bold");return f.join("")};b.prototype.enableMassClear=function(){this._options.enableMassClear=!0};b.prototype.disableMassClear=function(){this._options.enableMassClear=!1};b.prototype._bind=function(){function a(a,b){var c=a.srcElement||a.target,g=a.clientX||a.pageX,f=a.clientY||a.pageY;a&&b&&g&&f&&c&&(c=mxLib.dom.getPosition(e.getContainer()),b.pixel=new mxLib.Pixel(g-c.left,f-c.top),b.point=e.pixelToPoint(b.pixel));return b}if(this._domElement){var b=this,e=this._map,g=mxLib.lang.Event;mxLib.event.on(this._domElement,"mouseover",function(e){b.dispatchEvent(a(e,new g("onmouseover")))});mxLib.event.on(this._domElement,"mouseout",function(e){b.dispatchEvent(a(e,new g("onmouseout")))});mxLib.event.on(this._domElement,"click",function(e){b.dispatchEvent(a(e,new g("onclick")))})}}})();(function(f){var b=function(){var a=function(a){var b={data:[],heatmap:a};this.max=1;this.get=function(a){return b[a]};this.set=function(a,c){b[a]=c}};a.prototype={addDataPoint:function(a,b){if(!(0>a||0>b)){var c=this.get("heatmap"),e=this.get("data");e[a]||(e[a]=[]);e[a][b]||(e[a][b]=0);e[a][b]+=3>arguments.length?1:arguments[2];this.set("data",e);this.max<e[a][b]?(c.get("actx").clearRect(0,0,c.get("width"),c.get("height")),this.setDataSet({max:e[a][b],data:e},!0)):c.drawAlpha(a,b,e[a][b],!0)}},setDataSet:function(a,b){var c=this.get("heatmap"),e=[],f=a.data,m=f.length;c.clear();this.max=a.max;c.get("legend")&&c.get("legend").update(a.max);if(null!=b&&b)for(var q in f){if(void 0!==q)for(var r in f[q])void 0!==r&&c.drawAlpha(q,r,f[q][r],!1)}else for(;m--;)q=f[m],c.drawAlpha(q.x,q.y,q.count,!1),e[q.x]||(e[q.x]=[]),e[q.x][q.y]||(e[q.x][q.y]=0),e[q.x][q.y]=q.count;c.colorize();this.set("data",f)},exportDataSet:function(){var a=this.get("data"),b=[],c;for(c in a)if(void 0!==c)for(var e in a[c])void 0!==e&&b.push({x:parseInt(c,10),y:parseInt(e,10),count:a[c][e]});return{max:this.max,data:b}},generateRandomDataSet:function(a){var b=this.get("heatmap"),c=b.get("width"),b=b.get("height"),e={},f=Math.floor(1E3*Math.random()+1);e.max=f;for(var m=[];a--;)m.push({x:Math.floor(Math.random()*c+1),y:Math.floor(Math.random()*b+1),count:Math.floor(Math.random()*f+1)});e.data=m;this.setDataSet(e)}};var b=function(a){this.config=a;var b={element:null,labelsEl:null,gradientCfg:null,ctx:null};this.get=function(a){return b[a]};this.set=function(a,c){b[a]=c};this.init()};b.prototype={init:function(){var a=this.config,b=a.title||"Legend",c=a.position,e=a.offset||10,a=document.createElement("ul"),f="";this.processGradientObject();f=-1<c.indexOf("t")?f+("top:"+e+"px;"):f+("bottom:"+e+"px;");f=-1<c.indexOf("l")?f+("left:"+e+"px;"):f+("right:"+e+"px;");c=document.createElement("div");c.style.cssText="border-radius:5px;position:absolute;"+f+"font-family:Helvetica; width:256px;z-index:10000000000; background:rgba(255,255,255,1);padding:10px;border:1px solid black;margin:0;";c.innerHTML="\x3ch3 style\x3d'padding:0;margin:0;text-align:center;font-size:16px;'\x3e"+b+"\x3c/h3\x3e";a.style.cssText="position:relative;font-size:12px;display:block;list-style:none;list-style-type:none;margin:0;height:15px;";b=document.createElement("div");b.style.cssText=["position:relative;display:block;width:256px;height:15px;border-bottom:1px solid black; background-image:url(",this.createGradientImage(),");"].join("");c.appendChild(a);c.appendChild(b);this.set("element",c);this.set("labelsEl",a);this.update(1)},processGradientObject:function(){var a=this.config.gradient,b=[],c;for(c in a)a.hasOwnProperty(c)&&b.push({stop:c,value:a[c]});b.sort(function(a,b){return a.stop-b.stop});b.unshift({stop:0,value:"rgba(0,0,0,0)"});this.set("gradientArr",b)},createGradientImage:function(){var a=this.get("gradientArr"),b=a.length,c=document.createElement("canvas");mxLib.Util.initCanvas(c);var e=c.getContext("2d"),f;c.width="256";c.height="15";f=e.createLinearGradient(0,5,256,10);for(var m=0;m<b;m++)f.addColorStop(1/(b-1)*m,a[m].value);e.fillStyle=f;e.fillRect(0,5,256,10);e.strokeStyle="black";e.beginPath();for(m=0;m<b;m++)e.moveTo((1/(b-1)*m*256>>0)+.5,0),e.lineTo((1/(b-1)*m*256>>0)+.5,0==m?15:5);e.moveTo(255.5,0);e.lineTo(255.5,15);e.moveTo(255.5,4.5);e.lineTo(0,4.5);e.stroke();this.set("ctx",e);return c.toDataURL()},getElement:function(){return this.get("element")},update:function(a){for(var b=this.get("gradientArr"),c=this.get("ctx"),e=this.get("labelsEl"),f,m="",q,r=0;r<b.length;r++)f=a*b[r].stop>>0,q=c.measureText(f).width/2>>0,0==r&&(q=0),r==b.length-1&&(q*=2),m+='\x3cli style\x3d"position:absolute;left:'+(((1/(b.length-1)*r*256||0)>>0)-q+.5)+'px"\x3e'+f+"\x3c/li\x3e";e.innerHTML=m}};var e=function(b){var c={radius:40,element:{},canvas:{},acanvas:{},ctx:{},actx:{},legend:null,visible:!0,width:0,height:0,max:!1,gradient:!1,opacity:180,premultiplyAlpha:!1,bounds:{l:1E3,r:0,t:1E3,b:0},debug:!1};this.store=new a(this);this.get=function(a){return c[a]};this.set=function(a,b){c[a]=b};this.configure(b);this.init()};e.prototype={configure:function(a){this.set("radius",a.radius||40);this.set("element",a.element instanceof Object?a.element:document.getElementById(a.element));this.set("visible",null!=a.visible?a.visible:!0);this.set("max",a.max||!1);this.set("gradient",a.gradient||{"0.45":"rgb(0,0,255)","0.55":"rgb(0,255,255)","0.65":"rgb(0,255,0)","0.95":"yellow",1:"rgb(255,0,0)"});this.set("opacity",parseInt(255/(100/a.opacity),10)||180);this.set("width",a.width||0);this.set("height",a.height||0);this.set("debug",a.debug);a.legend&&(a=a.legend,a.gradient=this.get("gradient"),this.set("legend",new b(a)))},resize:function(){var a=this.get("element"),b=this.get("canvas"),c=this.get("acanvas");b.width=c.width=this.get("width")||(a?a.style.width.replace(/px/,""):0)||this.getWidth(a);this.set("width",b.width);b.height=c.height=this.get("height")||(a?a.style.height.replace(/px/,""):0)||this.getHeight(a);this.set("height",b.height)},init:function(){var a=document.createElement("canvas");mxLib.Util.initCanvas(a);var b=document.createElement("canvas");mxLib.Util.initCanvas(b);var c=a.getContext("2d"),e=b.getContext("2d"),f=this.get("element");this.initColorPalette();this.set("canvas",a);this.set("ctx",c);this.set("acanvas",b);this.set("actx",e);this.resize();a.style.cssText=b.style.cssText="position:absolute;top:0;left:0;z-index:10000000;";this.get("visible")||(a.style.display="none");f&&(f.appendChild(a),this.get("legend")&&f.appendChild(this.get("legend").getElement()));this.get("debug")&&document.body.appendChild(b);e.shadowOffsetX=15E3;e.shadowOffsetY=15E3;e.shadowBlur=15},initColorPalette:function(){var a=document.createElement("canvas"),b=this.get("gradient"),c,e;mxLib.Util.initCanvas(a);a.width="1";a.height="256";a=a.getContext("2d");c=a.createLinearGradient(0,0,1,256);if(a.getImageData){e=a.getImageData(0,0,1,1);e.data[0]=e.data[3]=64;e.data[1]=e.data[2]=0;a.putImageData(e,0,0);e=a.getImageData(0,0,1,1);this.set("premultiplyAlpha",60>e.data[0]||70<e.data[0]);for(var f in b)c.addColorStop(f,b[f]);a.fillStyle=c;a.fillRect(0,0,1,256);this.set("gradient",a.getImageData(0,0,1,256).data)}},getWidth:function(a){if(!a)return 0;var b=a.offsetWidth;a.style.paddingLeft&&(b+=a.style.paddingLeft);a.style.paddingRight&&(b+=a.style.paddingRight);return b},getHeight:function(a){if(!a)return 0;var b=a.offsetHeight;a.style.paddingTop&&(b+=a.style.paddingTop);a.style.paddingBottom&&(b+=a.style.paddingBottom);return b},colorize:function(a,b){var c=this.get("width"),e=this.get("radius"),f=this.get("height"),m=this.get("actx"),q=this.get("ctx"),r=3*e,e=this.get("premultiplyAlpha"),t=this.get("gradient"),w=this.get("opacity"),u=this.get("bounds"),v,z,x;null!=a&&null!=b?(a+r>c&&(a=c-r),0>a&&(a=0),0>b&&(b=0),b+r>f&&(b=f-r),v=a,c=b,z=a+r,f=b+r):(v=0>u.l?0:u.l,z=u.r>c?c:u.r,c=0>u.t?0:u.t,f=u.b>f?f:u.b);m=m.getImageData(v,c,z-v,f-c);f=m.data;r=f.length;for(z=3;z<r;z+=4)if(x=f[z],u=4*x)x=x<w?x:w,f[z-3]=t[u],f[z-2]=t[u+1],f[z-1]=t[u+2],e&&(f[z-3]/=255/x,f[z-2]/=255/x,f[z-1]/=255/x),f[z]=x;m.data=f;q.putImageData(m,v,c)},drawAlpha:function(a,b,c,e){var f=this.get("radius"),m=this.get("actx");this.get("max");var q=this.get("bounds"),r=a-1.5*f>>0,t=b-1.5*f>>0,w=a+1.5*f>>0,u=b+1.5*f>>0;m.shadowColor="rgba(0,0,0,"+(c?c/this.store.max:"0.1")+")";m.shadowOffsetX=15E3;m.shadowOffsetY=15E3;m.shadowBlur=15;m.beginPath();m.arc(a-15E3,b-15E3,f,0,2*Math.PI,!0);m.closePath();m.fill();e?this.colorize(r,t):(r<q.l&&(q.l=r),t<q.t&&(q.t=t),w>q.r&&(q.r=w),u>q.b&&(q.b=u))},toggleDisplay:function(){var a=this.get("visible");this.get("canvas").style.display=a?"none":"block";this.set("visible",!a)},isVisible:function(){return this.get("visible")},getImageData:function(){return this.get("canvas").toDataURL()},clear:function(){var a=this.get("width"),b=this.get("height");this.store.set("data",[]);this.get("ctx").clearRect(0,0,a,b);this.get("actx").clearRect(0,0,a,b)},cleanup:function(){this.get("element").removeChild(this.get("canvas"))}};return{create:function(a){return new e(a)},util:{mousePosition:function(a){var b,c;a.layerX?(b=a.layerX,c=a.layerY):a.offsetX&&(b=a.offsetX,c=a.offsetY);if("undefined"!=typeof b)return[b,c]}}}}();f.h337=f.heatmapFactory=b})(window);(function(){var f=mxLib.HeatmapOverlay=function(b){this.conf=b||{};this.heatmap=null;this.latlngs=[];this.bounds=null;this.conf.minZoom=b.minZoom||0;this.conf.maxZoom=b.maxZoom||0;this.conf.boundsInShow=!1===b.boundsInShow?!1:!0};f.prototype=new mxLib.Overlay;f.prototype.initialize=function(b){this._map=b;var a=document.createElement("div");a.style.position="absolute";a.style.top=0;a.style.left=0;a.style.border=0;a.style.width=this._map.getSize().width+"px";a.style.height=this._map.getSize().height+"px";a.style.pointerEvents="none";this.conf.element=a;b.getPanes().mapPane.appendChild(a);this.heatmap=h337.create(this.conf);return this._div=a};f.prototype.getEventPane=function(){return this.map.getPanes().mapPane};f.prototype.draw=function(){if(this.curZoomInRange(this.conf.minZoom,this.conf.maxZoom)&&this.heatmap.isVisible()){var b=this._map.getBounds();this.bounds=b;var a=this._map.pointToPixel(b.getNorthEast()),c=this._map.pointToPixel(b.getSouthWest()),e=a.y<c.y?a.y:c.y,g=c.x,k=Math.abs(c.y-a.y),a=Math.abs(a.x-c.x);this.conf.element.style.left=g+"px";this.conf.element.style.top=e+"px";this.conf.element.style.width=a+"px";this.conf.element.style.height=k+"px";this.heatmap.store.get("heatmap").resize();if(0<this.latlngs.length){this.heatmap.clear();k=this.latlngs.length;for(d={max:this.heatmap.store.max,data:[]};k--;)if(a=this.latlngs[k].latlng,!this.conf.boundsInShow||b.containsPoint(a))a=this._map.pointToPixel(a),a=new mxLib.Pixel(a.x-g,a.y-e),a=this.pixelTransform(a),d.data.push({x:a.x,y:a.y,count:this.latlngs[k].c});this.heatmap.store.setDataSet(d)}}};f.prototype.pixelTransform=function(b){for(var a=this.heatmap.get("width"),c=this.heatmap.get("height");0>b.x;)b.x+=a;for(;b.x>a;)b.x-=a;for(;0>b.y;)b.y+=c;for(;b.y>c;)b.y-=c;b.x>>=0;b.y>>=0;return b};f.prototype.setDataSet=function(b){var a=this._map.getBounds(),c={max:b.max,data:[]};b=b.data;var e=b.length;for(this.latlngs=[];e--;){var g=new mxLib.Point(b[e].x,b[e].y);if(!this.conf.boundsInShow||a.containsPoint(g)){this.latlngs.push({latlng:g,c:b[e].val});var g=this._map.pointToPixel(g),k=this._map.pointToPixel(a.getSouthWest()).x,f=this._map.pointToPixel(a.getNorthEast()).y,g=new mxLib.Pixel(g.x-k,g.y-f),g=this.pixelTransform(g);c.data.push({x:g.x,y:g.y,count:b[e].val})}}this.heatmap.clear();this.heatmap.store.setDataSet(c)};f.prototype.addDataPoint=function(b,a,c){b=new mxLib.Point(b,a);a=this.pixelTransform(this._map.pointToPixel(b));this.heatmap.store.addDataPoint(a.x,a.y,c);this.latlngs.push({latlng:b,c:c})};f.prototype.toggle=function(){this.heatmap.toggleDisplay();this.heatmap.isVisible()&&this.draw()};f.prototype.isPointIn=function(b){return!1};mxLib.HeatmapOverlay=f})();(function(){var f=mxLib.InfoWindow=function(a,c,e){this._opts=e=e||{};this._opts.autoCloseOthers=!1===e.autoCloseOthers?!1:!0;this.guid=b++;this._opts.autoCloseOthers&&(mxLib.InfoWindow.instance[this.guid]=this);this._isOpen=!1;this._map=a;this._content=c||"";this._opts.width=e.width;this._opts.height=e.height;this._opts._title=e.title||"";this._opts.offset=e.offset||new mxLib.Size(0,0);this._opts.enableAutoPan=!0===e.enableAutoPan?!0:!1;this._opts.minZoom=e.minZoom||0;this._opts.maxZoom=e.maxZoom||0;this._opts.tailType=e.tailType||1;this._opts.closedButton=!1===e.closedButton?!1:!0;this._opts.zoomScale=e.zoomScale||0;this._opts.minScale=e.minScale||!0;this._opts.maxScale=e.maxScale||!1;this._opts.scaleOrigin=e.scaleOrigin||"50% 100%"};f.prototype=new mxLib.Overlay;f.prototype.initialize=function(a){this._opts.autoCloseOthers&&this._closeOtherInfoWindow();var b=this,e=this._createInfoTemplate();a=a.getPanes().floatPane;a.style.width="auto";a.appendChild(e);this._initInfoTemplate();this._getInfoWindowSize();this._boxWidth=parseInt(this.container.offsetWidth,10);this._boxHeight=parseInt(this.container.offsetHeight,10);this.draw();mxLib.event.on(e,"onmousedown",function(a){b._stopBubble(a)});mxLib.event.on(e,"ontouchstart",function(a){b._stopBubble(a)});mxLib.event.on(e,"touchmove",function(a){b._stopBubble(a)});mxLib.event.on(e,"touchend",function(a){b._stopBubble(a)});mxLib.event.on(e,"onmouseover",function(a){b._stopBubble(a)});mxLib.event.on(e,"click",function(a){b._stopBubble(a)});mxLib.event.on(e,"dblclick",function(a){b._stopBubble(a)});return this.domElement=e};f.prototype.getEventPane=function(){return this._map.getPanes().floatPane};f.prototype.draw=function(){this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)&&(this._isOpen&&this._adjustPosition(this._point),mxLib.Overlay.prototype.drawend.call(this,this._opts))};f.prototype.open=function(a){this._opts.autoCloseOthers&&this._map.closeInfoWindow();var b=this,e;this._isOpen||(this._map.addOverlay(this),this._isOpen=!0,setTimeout(function(){b._dispatchEvent(b,"open",{point:b._point})},10));a instanceof mxLib.Point?(e=a,this._removeMarkerEvt(),this.marker=null):a instanceof mxLib.Marker&&(this.marker&&this._removeMarkerEvt(),e=a.getPosition(),this.marker=a,this._map.temp.marker=this.marker,!this._markerDragend&&this.marker.addEventListener("dragend",this._markerDragend=function(a){b._point=a.point;b._adjustPosition(b._point);b._panBox();b.show()}),!this._markerDragging&&this.marker.addEventListener("dragging",this._markerDragging=function(){b.hide();b._point=b.marker.getPosition();b._adjustPosition(b._point)}));this.show();this._point=e;this._panBox();this._adjustPosition(this._point);this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)};f.prototype.close=function(){this._isOpen&&(this._map.removeOverlay(this),this._isOpen=!1,this._dispatchEvent(this,"close",{point:this._point}))};f.prototype.enableAutoPan=function(){this._opts.enableAutoPan=!0};f.prototype.disableAutoPan=function(){this._opts.enableAutoPan=!1};f.prototype.setContent=function(a){this._setContent(a);this._getInfoWindowSize();this._adjustPosition(this._point)};f.prototype.setTitle=function(a){this.dom.title.innerHTML=a;this._opts._title=a};f.prototype.getContent=function(){return this.dom.content.innerHTML};f.prototype.getTitle=function(){return this.dom.title.innerHTML};f.prototype.setPosition=function(a){this._point=a;this._adjustPosition(a);this._panBox();this._removeMarkerEvt()};f.prototype.getPosition=function(){return this._point};f.prototype.getOffset=function(){return this._opts.offset};f.prototype._closeOtherInfoWindow=function(){if(this._opts.autoCloseOthers)for(var a=mxLib.InfoWindow.instance,b=a.length;b--;)a[b]&&a[b]._isOpen&&a[b].close()};f.prototype._setContent=function(a){this.dom&&this.dom.content&&("undefined"===typeof a.nodeType?this.dom.content.innerHTML=a:this.dom.content.appendChild(a),this._adjustContainerWidth(),this._content=a)};f.prototype._adjustPosition=function(a){a=this._getPointPosition(a);var b=this.marker&&this.marker.getIcon();this.marker?(this.container.style.bottom=-(a.y-this._opts.offset.height-b.anchor.height+b.infoWindowAnchor.height)-this.marker.getOffset().height+32+"px",this.container.style.left=a.x-this._opts.offset.width-b.anchor.width+this.marker.getOffset().width+b.infoWindowAnchor.width-this._boxWidth/2+28+"px"):(this.container.style.bottom=-(a.y-this._opts.offset.height)+30+"px",this.container.style.left=a.x-this._boxWidth/2+25+"px")};f.prototype._getPointPosition=function(a){return this._pointPosition=this._map.pointToPixel(a)};f.prototype._getInfoWindowSize=function(){this._boxWidth=parseInt(this.container.offsetWidth,10);this._boxHeight=parseInt(this.container.offsetHeight,10)};f.prototype._stopBubble=function(a){a&&a.stopPropagation?a.stopPropagation():window.event.cancelBubble=!0};f.prototype._panBox=function(){if(this._opts.enableAutoPan){var a=parseInt(this._map.getContainer().offsetHeight,10),b=parseInt(this._map.getContainer().offsetWidth,10),e=this._boxHeight,g=this._boxWidth;if(!(e>=a||g>=b)){this._map.getBounds().containsPoint(this._point)||this._map.setCenter(this._point);var k=this._map.pointToPixel(this._point),a=g/2-28-k.x+10,b=g/2+28+k.x-b+10;if(this.marker)var f=this.marker.getIcon();f=this.marker?f.anchor.height+this.marker.getOffset().height-f.infoWindowAnchor.height:0;e=e-k.y+this._opts.offset.height+f+31+10;panX=0<a?a:0<b?-b:0;this._map.panBy(panX,-(0<e?e:0))}}};f.prototype._removeMarkerEvt=function(){this._markerDragend&&this.marker.removeEventListener("dragend",this._markerDragend);this._markerDragging&&this.marker.removeEventListener("dragging",this._markerDragging);this._markerDragend=this._markerDragging=null};f.prototype._dispatchEvent=function(a,b,e){0!=b.indexOf("on")&&(b="on"+b);b=new mxLib.lang.Event(b);if(e)for(var g in e)b[g]=e[g];a.dispatchEvent(b)};f.prototype._initInfoTemplate=function(){this._initDom();""!=this._opts._title&&this.setTitle(this._opts._title);this._opts.height&&(this.dom.content.style.height=parseInt(this._opts.height,10)+"px");this._setContent(this._content);this._bind();this._mendIE6()};f.prototype._createInfoTemplate=function(){if(!this._div){var a=mxLib.dom.create("div",{"class":"MxLib_InfoWindow",id:"MxLib_InfoWindow"+this.guid}),b;b=""==this._opts._title?this._opts.closedButton?['\x3cdiv class\x3d"MxLib_bubble_center"\x3e','\x3cdiv class\x3d"MxLib_bubble_tools"\x3e','\x3cdiv class\x3d"MxLib_bubble_close" title\x3d"\u5173\u95ed" id\x3d"MxLib_bubble_close'+this.guid+'"\x3e',"\x3c/div\x3e","\x3c/div\x3e",'\x3cdiv class\x3d"MxLib_bubble_content" id\x3d"MxLib_bubble_content'+this.guid+'" style\x3d"overflow:hidden"\x3e',"\x3c/div\x3e","\x3c/div\x3e",'\x3cdiv class\x3d"MxLib_bubble_bottom"\x3e\x3c/div\x3e']:['\x3cdiv class\x3d"MxLib_bubble_center"\x3e','\x3cdiv class\x3d"MxLib_bubble_content" id\x3d"MxLib_bubble_content'+this.guid+'" style\x3d"overflow:hidden"\x3e',"\x3c/div\x3e","\x3c/div\x3e",'\x3cdiv class\x3d"MxLib_bubble_bottom"\x3e\x3c/div\x3e']:this._opts.closedButton?['\x3cdiv class\x3d"MxLib_bubble_top"\x3e','\x3cdiv class\x3d"MxLib_bubble_title" id\x3d"MxLib_bubble_title'+this.guid+'"\x3e\x3c/div\x3e','\x3cdiv class\x3d"MxLib_bubble_tools"\x3e','\x3cdiv class\x3d"MxLib_bubble_close" title\x3d"\u5173\u95ed" id\x3d"MxLib_bubble_close'+this.guid+'"\x3e',"\x3c/div\x3e","\x3c/div\x3e","\x3c/div\x3e",'\x3cdiv class\x3d"MxLib_bubble_center"\x3e','\x3cdiv class\x3d"MxLib_bubble_content" id\x3d"MxLib_bubble_content'+this.guid+'" style\x3d"overflow:hidden"\x3e',"\x3c/div\x3e","\x3c/div\x3e",'\x3cdiv class\x3d"MxLib_bubble_bottom"\x3e\x3c/div\x3e']:['\x3cdiv class\x3d"MxLib_bubble_top"\x3e','\x3cdiv class\x3d"MxLib_bubble_title" id\x3d"MxLib_bubble_title'+this.guid+'"\x3e\x3c/div\x3e',"\x3c/div\x3e",'\x3cdiv class\x3d"MxLib_bubble_center"\x3e','\x3cdiv class\x3d"MxLib_bubble_content" id\x3d"MxLib_bubble_content'+this.guid+'" style\x3d"overflow:hidden"\x3e',"\x3c/div\x3e","\x3c/div\x3e",'\x3cdiv class\x3d"MxLib_bubble_bottom"\x3e\x3c/div\x3e'];1==this._opts.tailType?b.push('\x3cimg src\x3d"'+scriptBaseDir+'mxImg/iw_tail.png" width\x3d"58" height\x3d"31" alt\x3d"" class\x3d"MxLib_trans" id\x3d"MxLib_trans'+this.guid+'" style\x3d"left:144px;"/\x3e'):2==this._opts.tailType&&b.push('\x3cdiv class\x3d"arrow"\x3e\x3cem\x3e\x3c/em\x3e\x3cspan\x3e\x3c/span\x3e\x3c/div\x3e');a.innerHTML=b.join("");this._div=a}return this._div};f.prototype._initDom=function(){this.dom||(this.dom={container:mxLib.g("MxLib_InfoWindow"+this.guid),content:mxLib.g("MxLib_bubble_content"+this.guid),title:mxLib.g("MxLib_bubble_title"+this.guid),closeBtn:mxLib.g("MxLib_bubble_close"+this.guid)},1==this._opts.tailType&&(this.dom.transIco=mxLib.g("MxLib_trans"+this.guid)),this.container=this.dom.container)};f.prototype._adjustContainerWidth=function(){this._opts.width?(width=parseInt(this._opts.width,10),width+=10):width=parseInt(this.dom.content.offsetWidth,10);this._width=width;this.container.style.width=this._width+"px";1==this._opts.tailType&&this._adjustTransPosition()};f.prototype._adjustTransPosition=function(){this.dom.transIco.style.left=this.container.offsetWidth/2-2-29+"px";this.dom.transIco.style.top=this.container.offsetHeight-2+"px"};f.prototype._bind=function(){var a=this;this._opts.closedButton&&(mxLib.on(this.dom.closeBtn,"click",function(b){a.close()}),mxLib.on(this.dom.closeBtn,"touchstart",function(b){a.close()}))};f.prototype._mendIE6=function(a){if(mxLib.browser.ie&&!(6<mxLib.browser.ie)){a=this.container.getElementsByTagName("IMG");for(var b=0;b<a.length;b++)0>a[b].src.indexOf(".png")||(a[b].style.cssText+=";FILTER: progid:DXImageTransform.Microsoft.AlphaImageLoader(src\x3d"+a[b].src+",sizingMethod\x3dcrop)",a[b].src=scriptBaseDir+"mxImg/blank.gif")}};f.prototype.isPointIn=function(a){return!1};var b=0;mxLib.InfoWindow.instance=[]})();var mxLib=window.mxLib=mxLib||{};(function(){window.INFOBOX_AT_TOP=1;window.INFOBOX_AT_RIGHT=2;window.INFOBOX_AT_BOTTOM=3;window.INFOBOX_AT_LEFT=4;var f=mxLib.InfoBox=function(b,a,c){this._content=a||"";this._isOpen=!1;this._map=b;this._opts=c=c||{};this._opts.offset=c.offset||new mxLib.Size(0,0);this._opts.boxClass=c.boxClass||"infoBox";this._opts.boxStyle=c.boxStyle||{};this._opts.closeIconMargin=c.closeIconMargin||"2px";this._opts.closeIconUrl=c.closeIconUrl||scriptBaseDir+"mxImg/close.png";this._opts.enableAutoPan=c.enableAutoPan?!0:!1;this._opts.align=c.align||INFOBOX_AT_TOP;this._opts.minZoom=c.minZoom||0;this._opts.maxZoom=c.maxZoom||0;this._opts.zoomScale=c.zoomScale||0;this._opts.minScale=c.minScale||!0;this._opts.maxScale=c.maxScale||!1;this._opts.scaleOrigin=c.scaleOrigin||"50% 100%"};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){var a=this,c=this._div=mxLib.dom.create("div",{"class":this._opts.boxClass});mxLib.dom.setStyles(c,this._opts.boxStyle);c.style.position="absolute";this._setContent(this._content);b=b.getPanes().floatPane;b.style.width="auto";b.appendChild(c);this._getInfoBoxSize();this.draw();mxLib.event.on(c,"onmousedown",function(b){a._stopBubble(b)});mxLib.event.on(c,"onmouseover",function(b){a._stopBubble(b)});mxLib.event.on(c,"click",function(b){a._stopBubble(b)});mxLib.event.on(c,"dblclick",function(b){a._stopBubble(b)});return c};f.prototype.getEventPane=function(){return this._map.getPanes().floatPane};f.prototype.draw=function(){this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)&&(this._isOpen&&this._adjustPosition(this._point),mxLib.Overlay.prototype.drawend.call(this,this._opts,this._div))};f.prototype.open=function(b){var a=this,c;this._isOpen||(this._map.addOverlay(this),this._isOpen=!0,setTimeout(function(){a._dispatchEvent(a,"open",{point:a._point})},10));b instanceof mxLib.Point?(c=b,this._removeMarkerEvt()):b instanceof mxLib.Marker&&(this.marker&&this._removeMarkerEvt(),c=b.getPosition(),this.marker=b,this._map.temp.marker=this.marker,!this._markerDragend&&this.marker.addEventListener("dragend",this._markerDragend=function(b){a._point=a.marker.getPosition();a._adjustPosition(a._point);a._panBox();a.show()}),!this._markerDragging&&this.marker.addEventListener("dragging",this._markerDragging=function(){a.hide();a._point=a.marker.getPosition();a._adjustPosition(a._point)}));this.show();this._point=c;this._panBox();this._adjustPosition(this._point);this.curZoomInRange(this._opts.minZoom,this._opts.maxZoom)};f.prototype.close=function(){this._isOpen&&(this._map.removeOverlay(this),this._remove(),this._isOpen=!1,this._dispatchEvent(this,"close",{point:this._point}))};f.prototype.enableAutoPan=function(){this._opts.enableAutoPan=!0};f.prototype.disableAutoPan=function(){this._opts.enableAutoPan=!1};f.prototype.setContent=function(b){this._setContent(b);this._getInfoBoxSize();this._adjustPosition(this._point)};f.prototype.setPosition=function(b){this._point=b;this._adjustPosition(b);this._removeMarkerEvt()};f.prototype.getPosition=function(){return this._point};f.prototype.getOffset=function(){return this._opts.offset};f.prototype._remove=function(){this.domElement&&this.domElement.parentNode&&(mxLib.event.un(this._div.firstChild,"click",this._closeHandler()),this.domElement.parentNode.removeChild(this.domElement));this.domElement=null;this._isOpen=!1;this.dispatchEvent("onremove")};mxLib.object.extend(f.prototype,{_getCloseIcon:function(){return"\x3cimg src\x3d'"+this._opts.closeIconUrl+"' align\x3d'right' style\x3d'position:absolute;right:0px;cursor:pointer;margin:"+this._opts.closeIconMargin+"'/\x3e"},_setContent:function(b){if(this._div){var a=this._getCloseIcon();"undefined"===typeof b.nodeType?this._div.innerHTML=a+b:(this._div.innerHTML=a,this._div.appendChild(b));this._content=b;this._addEventToClose()}},_adjustPosition:function(b){b=this._getPointPosition(b);var a=this.marker&&this.marker.getIcon();switch(this._opts.align){case INFOBOX_AT_TOP:this._div.style.bottom=this.marker?-(b.y-this._opts.offset.height-a.anchor.height+a.infoWindowAnchor.height)-this.marker.getOffset().height+2+"px":-(b.y-this._opts.offset.height)+"px";break;case INFOBOX_AT_BOTTOM:this._div.style.top=this.marker?b.y+this._opts.offset.height-a.anchor.height+a.infoWindowAnchor.height+this.marker.getOffset().height+"px":b.y+this._opts.offset.height+"px"}this._div.style.left=this.marker?b.x-a.anchor.width+this.marker.getOffset().width+a.infoWindowAnchor.width-this._boxWidth/2+"px":b.x-this._boxWidth/2+"px"},_getPointPosition:function(b){return this._pointPosition=this._map.pointToPixel(b)},_getInfoBoxSize:function(){this._boxWidth=parseInt(this._div.offsetWidth,10);this._boxHeight=parseInt(this._div.offsetHeight,10)},_addEventToClose:function(){mxLib.event.on(this._div.firstChild,"click",this._closeHandler());this._hasBindEventClose=!0},_closeHandler:function(){var b=this;return function(a){b.close()}},_stopBubble:function(b){b&&b.stopPropagation?b.stopPropagation():window.event.cancelBubble=!0},_panBox:function(){if(this._opts.enableAutoPan){var b=parseInt(this._map.getContainer().offsetHeight,10),a=parseInt(this._map.getContainer().offsetWidth,10),c=this._boxHeight,e=this._boxWidth;if(!(c>=b||e>=a)){this._map.getBounds().containsPoint(this._point)||this._map.setCenter(this._point);var g=this._map.pointToPixel(this._point),k,f,n=e/2-g.x,a=e/2+g.x-a;if(this.marker)var l=this.marker.getIcon();switch(this._opts.align){case INFOBOX_AT_TOP:l=this.marker?l.anchor.height+this.marker.getOffset().height-l.infoWindowAnchor.height:0;k=c-g.y+this._opts.offset.height+l+2;break;case INFOBOX_AT_BOTTOM:l=this.marker?-l.anchor.height+l.infoWindowAnchor.height+this.marker.getOffset().height+this._opts.offset.height:0,f=c+g.y-b+l+4}panX=0<n?n:0<a?-a:0;b=0<k?k:0<f?-f:0;0==panX&&0==b||this._map.panBy(panX,b)}}},_removeMarkerEvt:function(){this._markerDragend&&this.marker.removeEventListener("dragend",this._markerDragend);this._markerDragging&&this.marker.removeEventListener("dragging",this._markerDragging);this._markerDragend=this._markerDragging=null},_dispatchEvent:function(b,a,c){0!=a.indexOf("on")&&(a="on"+a);a=new mxLib.lang.Event(a);if(c)for(var e in c)a[e]=c[e];b.dispatchEvent(a)}})})();mxLib=window.mxLib=mxLib||{};(function(){function f(a){this._markerClusterer=a;this._isPointCollectionClusterer=a._isPointCollectionClusterer;this._map=a.getMap();this._minClusterSize=a.getMinClusterSize();this._isAverageCenter=a.isAverageCenter();this._center=null;this._markers=[];this._gridBounds=null;this._isReal=!1;this._isPointCollectionClusterer?(this._clusterMarker={},this._clusterMarker.center=this._center,this._clusterMarker.text=this._markers.length,this._clusterMarker.styles=this._markerClusterer.getStyles()):this._clusterMarker=new mxLib.TextIconOverlay(this._center,this._markers.length,{styles:this._markerClusterer.getStyles()})}var b=function(a,b,c){var f=a.pointToPixel(b.getNorthEast());b=a.pointToPixel(b.getSouthWest());f.x+=c;f.y-=c;b.x-=c;b.y+=c;c=a.pixelToPoint(f);a=a.pixelToPoint(b);return new mxLib.Bounds(a,c)},a=function(a,b){var c=-1;if("[object Array]"===Object.prototype.toString.call(b))if(b.indexOf)c=b.indexOf(a);else for(var f=0,n;n=b[f];f++)if(n===a){c=f;break}return c},c=mxLib.MarkerClusterer=function(a,b){if(a){this._map=a;this._markers=[];this._clusters=[];var c=b||{};this._gridSize=c.gridSize||60;this._maxZoom=c.maxZoom||18;this._minClusterSize=c.minClusterSize||2;this._isDrawViewportMarker=c.isDrawViewportMarker||!1;this._isAverageCenter=!0;this._isPointCollectionClusterer=c.isPointCollectionClusterer;void 0!=c.isAverageCenter&&(this._isAverageCenter=c.isAverageCenter);this._styles=c.styles||[];var f=this;this._map.addEventListener("zoomend",function(){f._redraw();f._isPointCollectionClusterer&&c.pointCollection&&c.pointCollection.draw()});this._isDrawViewportMarker&&(this._map.addEventListener("dragend",function(){f._redraw();f._isPointCollectionClusterer&&c.pointCollection&&c.pointCollection.draw()}),this._map.addEventListener("moveend",function(){f._redraw();f._isPointCollectionClusterer&&f.pointCollection&&f.pointCollection.draw()}));var n=c.markers;if(this._isPointCollectionClusterer)for(var l=0;l<n.length;l++)n[l].getPosition=function(){return this},n[l].getMap=function(){return f._map};"[object Array]"===Object.prototype.toString.call(n)&&this.addMarkers(n)}};c.prototype.addMarkers=function(a){for(var b=0,c=a.length;b<c;b++)a[b].isShowMarker=!1,a[b]._isInCluster=!1,this._markers.push(a[b]);this._createClusters()};c.prototype._pushMarkerTo=function(b){-1===a(b,this._markers)&&(b.isShowMarker=!1,b._isInCluster=!1,this._markers.push(b))};c.prototype.addMarker=function(a){this._pushMarkerTo(a);this._createClusters()};c.prototype._createClusters=function(){for(var a=this._map.getBounds(this._isDrawViewportMarker?!1:!0),a=b(this._map,a,this._gridSize),c=0,f;f=this._markers[c];c++)!f._isInCluster&&a.containsPoint(f.getPosition())&&this._addToClosestCluster(f)};c.prototype._addToClosestCluster=function(a){var b=4E6,c=null;a.getPosition();for(var h=0,n;n=this._clusters[h];h++){var l=n.getCenter();l&&(l=this._map.getDistance(l,a.getPosition()),l<b&&(b=l,c=n))}c&&c.isMarkerInClusterBounds(a)?c.addMarker(a):(n=new f(this),n.addMarker(a),this._clusters.push(n))};c.prototype._clearLastClusters=function(){for(var a=0,b;b=this._clusters[a];a++)b.remove();this._clusters=[];this._removeMarkersFromCluster()};c.prototype._removeMarkersFromCluster=function(){for(var a=0,b;b=this._markers[a];a++)b.isShowMarker=!0,b._isInCluster=!1};c.prototype._removeMarkersFromMap=function(){for(var a=0,b;b=this._markers[a];a++)b.isShowMarker=!1,b._isInCluster=!1,this._isPointCollectionClusterer||this._map.removeOverlay(b)};c.prototype._removeMarker=function(b){var c=a(b,this._markers);if(-1===c)return!1;this._map.removeOverlay(b);b.isShowMarker=!1;this._markers.splice(c,1);return!0};c.prototype.removeMarker=function(a){if(a=this._removeMarker(a))this._clearLastClusters(),this._createClusters();return a};c.prototype.removeMarkers=function(a){for(var b=!1,c=0;c<a.length;c++)var f=this._removeMarker(a[c]),b=b||f;b&&(this._clearLastClusters(),this._createClusters());return b};c.prototype.clearMarkers=function(){this._clearLastClusters();this._removeMarkersFromMap();this._markers=[]};c.prototype._redraw=function(){this._clearLastClusters();this._map.getZoom()>this.getMaxZoom()||this._createClusters()};c.prototype.getGridSize=function(){return this._gridSize};c.prototype.setGridSize=function(a){this._gridSize=a;this._redraw()};c.prototype.getMaxZoom=function(){return this._maxZoom};c.prototype.setMaxZoom=function(a){this._maxZoom=a;this._redraw()};c.prototype.getStyles=function(){return this._styles};c.prototype.setStyles=function(a){this._styles=a;this._redraw()};c.prototype.getMinClusterSize=function(){return this._minClusterSize};c.prototype.setMinClusterSize=function(a){this._minClusterSize=a;this._redraw()};c.prototype.isAverageCenter=function(){return this._isAverageCenter};c.prototype.getMap=function(){return this._map};c.prototype.getMarkers=function(){return this._markers};c.prototype.getClustersCount=function(){for(var a=0,b=0,c;c=this._clusters[b];b++)c.isReal()&&a++;return a};f.prototype.addMarker=function(a){if(this.isMarkerInCluster(a))return!1;if(!this._center)this._center=a.getPosition(),this.updateGridBounds();else if(this._isAverageCenter){var b=this._markers.length+1,c=(this._center.x*(b-1)+a.getPosition().x)/b,b=(this._center.y*(b-1)+a.getPosition().y)/b;this._center=new mxLib.Point(c,b);this.updateGridBounds()}a.isShowMarker=!1;a._isInCluster=!0;this._markers.push(a);c=this._markers.length;if(c<this._minClusterSize)return this._isPointCollectionClusterer?a.isShowMarker=!0:this._map.addOverlay(a),!0;if(c===this._minClusterSize)for(a=0;a<c;a++)this._isPointCollectionClusterer?this._markers[a].isShowMarker=!1:this._markers[a].getMap()&&this._map.removeOverlay(this._markers[a]);this._isPointCollectionClusterer||this._map.addOverlay(this._clusterMarker);this._isReal=!0;this.updateClusterMarker();return!0};f.prototype.isMarkerInCluster=function(a){if(this._markers.indexOf)return-1!=this._markers.indexOf(a);for(var b=0,c;c=this._markers[b];b++)if(c===a)return!0;return!1};f.prototype.isMarkerInClusterBounds=function(a){return this._gridBounds.containsPoint(a.getPosition())};f.prototype.isReal=function(a){return this._isReal};f.prototype.updateGridBounds=function(){var a=new mxLib.Bounds(this._center,this._center);this._gridBounds=b(this._map,a,this._markerClusterer.getGridSize())};f.prototype.updateClusterMarker=function(){if(this._map.getZoom()>this._markerClusterer.getMaxZoom())if(this._isPointCollectionClusterer)for(this._clusterMarke=null,a=0;b=this._markers[a];a++)this._markers[a].isShowMarker=!0;else{this._clusterMarker&&this._map.removeOverlay(this._clusterMarker);for(var a=0,b;b=this._markers[a];a++)this._map.addOverlay(b);return}if(this._markers.length<this._minClusterSize)this._isPointCollectionClusterer?this._clusterMarker.hide=!0:this._clusterMarker.hide();else{this._isPointCollectionClusterer?(this._clusterMarker._center=this._center,this._clusterMarker.text=this._markers.length):(this._clusterMarker.setPosition(this._center),this._clusterMarker.setText(this._markers.length));var c=this._map,f=this.getBounds();this._isPointCollectionClusterer||this._clusterMarker.addEventListener("click",function(a){c.setViewport(f)})}};f.prototype.remove=function(){if(this._isPointCollectionClusterer)for(a=0;this._markers[a];a++)this._markers[a].isShowMarker=!1;else{for(var a=0;this._markers[a];a++)this._markers[a].getMap()&&this._map.removeOverlay(this._markers[a]);this._map.removeOverlay(this._clusterMarker)}this._markers.length=0;delete this._markers};f.prototype.getBounds=function(){for(var a=new mxLib.Bounds(this._center,this._center),b=0,c;c=this._markers[b];b++)a.extend(c.getPosition());return a};f.prototype.getCenter=function(){return this._center};f.prototype.isPointIn=function(a){return!1}})();(function(){var f=mxLib.Vertex=function(b,a){this.point=b;this.isMiddle=a||!1};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){this.map=b;var a="",a=this.isMiddle?"MxLib_vectex MxLib_vectex_nodeT":"MxLib_vectex MxLib_vectex_node",c=this.domElement=document.createElement("div");c.className=a;a=b.pointToPixel(this.point);c.style.left=a.x-5+"px";c.style.top=a.y-5+"px";b.getPanes().mapVertex.appendChild(c);mxLib.Overlay.prototype.setEventDispath.call(this);return c};f.prototype.getEventPane=function(){return this.map.getPanes().mapVertex};f.prototype.draw=function(){if(this.domElement){var b=this.map.pointToPixel(this.point);this.domElement.style.left=b.x-5+"px";this.domElement.style.top=b.y-5+"px"}};f.prototype.getMap=function(){return this.map};f.prototype.isDraggable=function(){return!0};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)}})();(function(){var f=mxLib.Polyline=function(b,a){a=a||{};this.points=b;this.options={};this.options.strokeColor=a.strokeColor||"blue";this.options.strokeWidth=a.strokeWidth||a.strokeWeight||1;this.options.strokeOpacity=a.strokeOpacity||1;this.options.strokeStyle=a.strokeStyle||"solid";this.options.enableMassClear=!1===a.enableMassClear?!1:!0;this.options.enableEditing=a.enableEditing||!1;this.options.enableClicking=!1===a.enableClicking?!1:!0;this.options.minZoom=a.minZoom||0;this.options.maxZoom=a.maxZoom||0};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){this.map=b;b=b.getMapPaneSvg();var a="none";$.isNumeric(this.options.strokeStyle)?a=this.options.strokeStyle:"dashed"==this.options.strokeStyle&&(a=4);this.options.strokeStyle=a;b.polyline?this.svgElement=b.polyline().attr({fill:"none",points:this._toPixelPointsString(),stroke:this.options.strokeColor,"stroke-width":this.options.strokeWidth,"stroke-opacity":this.options.strokeOpacity,"stroke-dasharray":this.options.strokeStyle}):(this.bRaphael=!0,this.svgElement=b.path().attr({path:this._toPixelPointsString(),stroke:this.options.strokeColor,"stroke-width":this.options.strokeWidth,"stroke-opacity":this.options.strokeOpacity,"stroke-dasharray":this.options.strokeStyle}));1==this.options.enableClicking&&this.svgElement.attr({cursor:"pointer"});this.domElement=this.svgElement.node;mxLib.Overlay.prototype.setEventDispath.call(this);this.options.enableEditing?this.enableEditing():this.disableEditing();return this.domElement};f.prototype.getEventPane=function(){return this.map.getPanes().mapPane};f.prototype._toPixelPointsString=function(){var b="";this.bRaphael&&(b="M");for(var a=0;a<this.points.length;a++){var c=this.map.pointToSvgPixel(this.points[a]),b=this.bRaphael?b+(c.x+" "+c.y+" "):b+(c.x+","+c.y+" ");0==a&&this.bRaphael&&(b+="L")}return b};f.prototype.snap=function(){return this.svgElement};f.prototype.draw=function(){this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)&&(this.bRaphael?this.svgElement.attr({path:this._toPixelPointsString()}):this.svgElement.attr({points:this._toPixelPointsString()}))};f.prototype.setSymbol=function(b,a){this.svgElement&&b instanceof mxLib.Symbol&&(0==a?this.svgElement.attr("marker-start",b.getSvgMarker(this.map.getMapPaneSvg())):1==a?this.svgElement.attr("marker-mid",b.getSvgMarker(this.map.getMapPaneSvg())):2==a&&this.svgElement.attr("marker-end",b.getSvgMarker(this.map.getMapPaneSvg())))};f.prototype.setPath=function(b){this.points=b;this.draw()};f.prototype.getPath=function(){return this.points};f.prototype.setStrokeColor=function(b){b!=this.options.strokeColor&&(this.options.strokeColor=b,this.svgElement&&this.svgElement.attr({stroke:this.options.strokeColor}))};f.prototype.getStrokeColor=function(){return this.options.strokeColor};f.prototype.setStrokeOpacity=function(b){b!=this.options.strokeOpacity&&(this.options.strokeOpacity=b,this.svgElement&&this.svgElement.attr({"stroke-opacity":this.options.strokeOpacity}))};f.prototype.getStrokeOpacity=function(){return this.options.strokeOpacity};f.prototype.setStrokeWidth=function(b){b!=this.options.strokeWidth&&(this.options.strokeWidth=b,this.svgElement&&this.svgElement.attr({"stroke-width":b}))};f.prototype.getStrokeWidth=function(){return this.options.strokeWidth};f.prototype.setStrokeStyle=function(b){var a="none";$.isNumeric(b)?a=b:"dashed"==b&&(a=4);a!=this.options.strokeStyle&&(this.options.strokeStyle=a,this.svgElement.attr({"stroke-dasharray":this.options.strokeStyle}))};f.prototype.getStrokeStyle=function(){return this.options.strokeStyle};f.prototype.getBounds=function(){return mxLib.Util.getPointArrayBounds(this.points)};f.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];for(var b=this,a=0;a<this.points.length;a++){var c=new mxLib.Vertex(this.points[a],!1);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];0==a?c.push(b.points[a]):c.push(b.points[a-1]);c.push(b.points[a]);a==b.points.length-1?c.push(b.points[a]):c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.getStrokeColor(),strokeOpacity:.65,strokeWidth:5,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.setPositionAt(a,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}for(a=0;a<this.points.length-1;a++){var e=new mxLib.Point((this.points[a].x+this.points[a+1].x)/2,(this.points[a].y+this.points[a+1].y)/2),c=new mxLib.Vertex(e,!0);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];c.push(b.points[a]);c.push(e);c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.getStrokeColor(),strokeOpacity:.65,strokeWidth:5,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.points.splice(a+1,0,this.point),b.setPositionAt(a+1,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}}};f.prototype.disableEditing=function(){if(this.options.enableEditing){this.options.enableEditing=this._bEnableEditing=!1;for(var b=0;b<this.vertexs.length;b++)this.map.removeOverlay(this.vertexs[b]);this.vertexs.length=0}};f.prototype.getDragPoint=function(){return this.points.length?this.points[0]:null};f.prototype.setDragPoint=function(b){if(this.points.length){var a=b.x-this.points[0].x;b=b.y-this.points[0].y;for(var c=0;c<this.points.length;c++)this.points[c].x+=a,this.points[c].y+=b}};f.prototype.enableMassClear=function(){this.options.enableMassClear=!0};f.prototype.disableMassClear=function(){this.options.enableMassClear=!1};f.prototype.setPositionAt=function(b,a){0>b||b>=this.points.length||(this.points[b]=a,this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing()),this.draw())};f.prototype.getMap=function(){return this.map};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){this.disableEditing();mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};f.prototype.remove=function(){this.disableEditing();mxLib.Overlay.prototype.remove.call(this)};f.prototype.isPointIn=function(b){if(!b||!this.svgElement||!this.curZoomInRange(this.options.minZoom,this.options.maxZoom))return!1;var a=this.map.pixelDistToPointDist(4);return mxLib.GeoUtils.isPointOnPolyline(b,this,a)}})();(function(){var f=mxLib.Polygon=function(b,a){a=a||{};this.points=b;this.options={};this.options.strokeColor=a.strokeColor||"blue";this.options.strokeWidth=a.strokeWidth||a.strokeWeight||1;this.options.strokeOpacity=a.strokeOpacity||1;this.options.strokeStyle=a.strokeStyle||"solid";this.options.enableMassClear=!1===a.enableMassClear?!1:!0;this.options.enableEditing=!0===a.enableEditing?!0:!1;this.options.enableClicking=!1===a.enableClicking?!1:!0;this.options.fillColor=a.fillColor||"#fff";this.options.fillOpacity=a.fillOpacity||.65;this.options.fillPattern=a.fillPattern||"none";this.options.patternStrokeWidth=a.patternStrokeWidth||1;this.options.minZoom=a.minZoom||0;this.options.maxZoom=a.maxZoom||0};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){this.map=b;b=b.getMapPaneSvg();var a="none";$.isNumeric(this.options.strokeStyle)?a=this.options.strokeStyle:"dashed"==this.options.strokeStyle&&(a=4);this.options.strokeStyle=a;b.polygon?(a=this.options.fillColor,"none"!=this.options.fillPattern&&(a=this.options.fillPattern,"hline"==a?a="M0 5 L10 5":"vline"==a?a="M5 0 L5 10":"leftline"==a?a="M0 0 L10 10":"rightline"==a&&(a="M0 10 L10 0"),a=b.path(a).attr({fill:"none",stroke:this.options.fillColor,strokeWidth:this.options.patternStrokeWidth}).pattern(0,0,10,10)),this.svgElement=b.polyline().attr({points:this._toPixelPointsString(),stroke:this.options.strokeColor,"stroke-width":this.options.strokeWidth,"stroke-opacity":this.options.strokeOpacity,fill:a,"fill-opacity":this.options.fillOpacity,"stroke-dasharray":this.options.strokeStyle})):(this.bRaphael=!0,this.svgElement=b.path().attr({path:this._toPixelPointsString(),stroke:this.options.strokeColor,"stroke-width":this.options.strokeWidth,"stroke-opacity":this.options.strokeOpacity,fill:this.options.fillColor,"fill-opacity":this.options.fillOpacity,"stroke-dasharray":this.options.strokeStyle}));1==this.options.enableClicking&&this.svgElement.attr({cursor:"pointer"});this.domElement=this.svgElement.node;mxLib.Overlay.prototype.setEventDispath.call(this);this.options.enableEditing?this.enableEditing():this.disableEditing();return this.domElement};f.prototype.getEventPane=function(){return this.map.getPanes().mapPane};f.prototype._toPixelPointsString=function(){var b="";this.bRaphael&&(b="M");for(var a=0;a<this.points.length;a++){var c=this.map.pointToSvgPixel(this.points[a]),b=this.bRaphael?b+(c.x+" "+c.y+" "):b+(c.x+","+c.y+" ");0==a&&this.bRaphael&&(b+="L")}0<this.points.length&&(c=this.map.pointToSvgPixel(this.points[0]),b=this.bRaphael?b+(c.x+" "+c.y+" "):b+(c.x+","+c.y+" "));this.bRaphael&&(b+="z");return b};f.prototype.snap=function(){return this.svgElement};f.prototype.draw=function(){this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)&&(this.bRaphael?this.svgElement.attr({path:this._toPixelPointsString()}):this.svgElement.attr({points:this._toPixelPointsString()}))};f.prototype.setSymbol=function(b,a){this.svgElement&&b instanceof mxLib.Symbol&&(0==a?this.svgElement.attr("marker-start",b.getSvgMarker(this.map.getMapPaneSvg())):1==a?this.svgElement.attr("marker-mid",b.getSvgMarker(this.map.getMapPaneSvg())):2==a&&this.svgElement.attr("marker-end",b.getSvgMarker(this.map.getMapPaneSvg())))};f.prototype.setPath=function(b){this.points=b;this.draw()};f.prototype.getPath=function(){return this.points};f.prototype.setStrokeColor=function(b){b!=this.options.strokeColor&&(this.options.strokeColor=b,this.svgElement&&this.svgElement.attr({stroke:this.options.strokeColor}))};f.prototype.getStrokeColor=function(){return this.options.strokeColor};f.prototype.setStrokeOpacity=function(b){b!=this.options.strokeOpacity&&(this.options.strokeOpacity=b,this.svgElement&&this.svgElement.attr({"stroke-opacity":this.options.strokeOpacity}))};f.prototype.getStrokeOpacity=function(){return this.options.strokeOpacity};f.prototype.setFillOpacity=function(b){b!=this.options.fillOpacity&&(this.options.fillOpacity=b,this.svgElement&&this.svgElement.attr({"fill-opacity":this.options.fillOpacity}))};f.prototype.getFillOpacity=function(){return this.options.fillOpacity};f.prototype.setFillColor=function(b){b!=this.options.fillColor&&(this.options.fillColor=b,this.svgElement&&this.svgElement.attr({fill:this.options.fillColor}))};f.prototype.getFillColor=function(){return this.options.fillColor};f.prototype.setStrokeWidth=function(b){b!=this.options.strokeWidth&&(this.options.strokeWidth=b,this.svgElement&&this.svgElement.attr({"stroke-width":b}))};f.prototype.getStrokeWidth=function(){return this.options.strokeWidth};f.prototype.setStrokeStyle=function(b){var a="none";$.isNumeric(b)?a=b:"dashed"==b&&(a=4);a!=this.options.strokeStyle&&(this.options.strokeStyle=a,this.svgElement&&this.svgElement.attr({"stroke-dasharray":this.options.strokeStyle}))};f.prototype.getStrokeStyle=function(){return this.options.strokeStyle};f.prototype.getBounds=function(){return mxLib.Util.getPointArrayBounds(this.points)};f.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];for(var b=this,a=0;a<this.points.length;a++){var c=new mxLib.Vertex(this.points[a],!1);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];0==a?c.push(b.points[a]):c.push(b.points[a-1]);c.push(b.points[a]);a==b.points.length-1?c.push(b.points[a]):c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,"stroke-width":b.options.strokeWidth,"stroke-opacity":b.options.strokeOpacity,fill:b.options.fillColor,"fill-opacity":b.options.fillOpacity,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.setPositionAt(a,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}for(a=0;a<this.points.length-1;a++){var e=new mxLib.Point((this.points[a].x+this.points[a+1].x)/2,(this.points[a].y+this.points[a+1].y)/2),c=new mxLib.Vertex(e,!0);this.map.addOverlay(c);this.vertexs.push(c);c.addEventListener("ondragging",function(a){return function(){if(this._tempPoly)this._tempPoly.setPositionAt(1,this.point);else{var c=[];c.push(b.points[a]);c.push(e);c.push(b.points[a+1]);this._tempPoly=new mxLib.Polyline(c,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,"stroke-width":b.options.strokeWidth,"stroke-opacity":b.options.strokeOpacity,fill:b.options.fillColor,"fill-opacity":b.options.fillOpacity,strokeStyle:10});b.map.addOverlay(this._tempPoly)}}}(a));c.addEventListener("ondragend",function(a){return function(){this._tempPoly&&(b.points.splice(a+1,0,this.point),b.setPositionAt(a+1,this.point),b.map.removeOverlay(this._tempPoly),this._tempPoly=null)}}(a))}}};f.prototype.disableEditing=function(){if(this.options.enableEditing){this.options.enableEditing=this._bEnableEditing=!1;for(var b=0;b<this.vertexs.length;b++)this.map.removeOverlay(this.vertexs[b]);this.vertexs.length=0}};f.prototype.enableMassClear=function(){this.options.enableMassClear=!0};f.prototype.disableMassClear=function(){this.options.enableMassClear=!1};f.prototype.setPositionAt=function(b,a){0>b||b>=this.points.length||(this.points[b]=a,this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing()),this.draw())};f.prototype.getDragPoint=function(){return this.points.length?this.points[0]:null};f.prototype.setDragPoint=function(b){if(this.points.length){var a=b.x-this.points[0].x;b=b.y-this.points[0].y;for(var c=0;c<this.points.length;c++)this.points[c].x+=a,this.points[c].y+=b}};f.prototype.getMap=function(){return this.map};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};f.prototype.remove=function(){this.disableEditing();mxLib.Overlay.prototype.remove.call(this)};f.prototype.isPointIn=function(b){return b&&this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom)?mxLib.GeoUtils.isPointInPolygon(b,this):!1}})();(function(){var f=mxLib.Circle=function(b,a,c){c=c||{};this.center=b;this.radius=a;this.options={};this.options.strokeColor=c.strokeColor||"blue";this.options.strokeWidth=c.strokeWidth||c.strokeWeight||1;this.options.strokeOpacity=c.strokeOpacity||1;this.options.strokeStyle=c.strokeStyle||"solid";this.options.enableMassClear=!1===c.enableMassClear?!1:!0;this.options.enableEditing=!0===c.enableEditing?!0:!1;this.options.enableClicking=!1===c.enableClicking?!1:!0;this.options.fillColor=c.fillColor||"#fff";this.options.fillOpacity=c.fillOpacity||.65;this.options.minZoom=c.minZoom||0;this.options.maxZoom=c.maxZoom||0;this.options.meter=c.meter||!1};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){this.map=b;b=b.getMapPaneSvg();var a="none";$.isNumeric(this.options.strokeStyle)?a=this.options.strokeStyle:"dashed"==this.options.strokeStyle&&(a=4);this.options.strokeStyle=a;var a=this.map.pointToSvgPixel(this.center),c=this.radius;this.options.meter&&this.map.mapModel&&(c=this.map.mapModel.getMapType().fromDistMeter(c));c=this.map.pointDistToPixelDist(c,!0);this.svgElement=b.circle(a.x,a.y,c).attr({stroke:this.options.strokeColor,"stroke-width":this.options.strokeWidth,"stroke-opacity":this.options.strokeOpacity,fill:this.options.fillColor,"fill-opacity":this.options.fillOpacity,"stroke-dasharray":this.options.strokeStyle});1==this.options.enableClicking&&this.svgElement.attr({cursor:"pointer"});this.domElement=this.svgElement.node;mxLib.Overlay.prototype.setEventDispath.call(this);this.options.enableEditing?this.enableEditing():this.disableEditing();return this.domElement};f.prototype.getEventPane=function(){return this.map.getPanes().mapPane};f.prototype.snap=function(){return this.svgElement};f.prototype.draw=function(){if(this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom,this.vertexs)){var b=this.map.pointToSvgPixel(this.center),a=this.radius;this.options.meter&&this.map.mapModel&&(a=this.map.mapModel.getMapType().fromDistMeter(a));a=this.map.pointDistToPixelDist(a,!0);this.svgElement.attr({cx:b.x,cy:b.y,r:a})}};f.prototype.setCenter=function(b){this.center=b;this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing());this.draw()};f.prototype.getCenter=function(){return this.center};f.prototype.setRadius=function(b){this.radius=b;this.options.enableEditing&&this._bEnableEditing&&(this.disableEditing(),this.enableEditing());this.draw()};f.prototype.getRadius=function(){return this.radius};f.prototype.setStrokeColor=function(b){b!=this.options.strokeColor&&(this.options.strokeColor=b,this.svgElement&&this.svgElement.attr({stroke:this.options.strokeColor}))};f.prototype.getStrokeColor=function(){return this.options.strokeColor};f.prototype.setFillOpacity=function(b){b!=this.options.fillOpacity&&(this.options.fillOpacity=b,this.svgElement&&this.svgElement.attr({"fill-opacity":this.options.fillOpacity}))};f.prototype.getFillOpacity=function(){return this.options.fillOpacity};f.prototype.setFillColor=function(b){b!=this.options.fillColor&&(this.options.fillColor=b,this.svgElement&&this.svgElement.attr({fill:this.options.fillColor}))};f.prototype.getFillColor=function(){return this.options.fillColor};f.prototype.setStrokeOpacity=function(b){b!=this.options.strokeOpacity&&(this.options.strokeOpacity=b,this.svgElement&&this.svgElement.attr({"stroke-opacity":this.options.strokeOpacity}))};f.prototype.getStrokeOpacity=function(){return this.options.strokeOpacity};f.prototype.setStrokeWidth=function(b){b!=this.options.strokeWidth&&(this.options.strokeWidth=b,this.svgElement&&this.svgElement.attr({"stroke-width":b}))};f.prototype.getStrokeWidth=function(){return this.options.strokeWidth};f.prototype.setStrokeStyle=function(b){var a="none";$.isNumeric(b)?a=b:"dashed"==b&&(a=4);a!=this.options.strokeStyle&&(this.options.strokeStyle=a,this.svgElement.attr({"stroke-dasharray":this.options.strokeStyle}))};f.prototype.getStrokeStyle=function(){return this.options.strokeStyle};f.prototype.getBounds=function(){return mxLib.Util.getPointArrayBounds(this.points)};f.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];var b=this,a=new mxLib.Vertex(this.center,!1);this.map.addOverlay(a);this.vertexs.push(a);a.addEventListener("ondragging",function(){this._tempCircle?this._tempCircle.setCenter(this.point):(this._tempCircle=new mxLib.Circle(b.center,b.radius,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,"stroke-width":b.options.strokeWidth,"stroke-opacity":b.options.strokeOpacity,fill:b.options.fillColor,"fill-opacity":b.options.fillOpacity,strokeStyle:10}),b.map.addOverlay(this._tempCircle))});a.addEventListener("ondragend",function(){this._tempCircle&&(b.setCenter(this.point),b.map.removeOverlay(this._tempCircle),this._tempCircle=null)});vertexRadius=new mxLib.Vertex(new mxLib.Point(this.center.x+this.radius,this.center.y),!1);this.map.addOverlay(vertexRadius);this.vertexs.push(vertexRadius);vertexRadius.addEventListener("ondragging",function(){this._tempCircle?this._tempCircle.setRadius(this.point.distanceTo(b.center)):(this._tempCircle=new mxLib.Circle(b.center,b.radius,{strokeColor:b.options.strokeColor,stroke:b.options.strokeColor,"stroke-width":b.options.strokeWidth,"stroke-opacity":b.options.strokeOpacity,fill:b.options.fillColor,"fill-opacity":b.options.fillOpacity,strokeStyle:10}),b.map.addOverlay(this._tempCircle))});vertexRadius.addEventListener("ondragend",function(){this._tempCircle&&(b.setRadius(this.point.distanceTo(b.center)),b.map.removeOverlay(this._tempCircle),this._tempCircle=null)})}};f.prototype.disableEditing=function(){if(this.options.enableEditing){this.options.enableEditing=this._bEnableEditing=!1;for(var b=0;b<this.vertexs.length;b++)this.map.removeOverlay(this.vertexs[b]);this.vertexs.length=0}};f.prototype.enableMassClear=function(){this.options.enableMassClear=!0};f.prototype.disableMassClear=function(){this.options.enableMassClear=!1};f.prototype.getMap=function(){return this.map};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};f.prototype.remove=function(){this.disableEditing();mxLib.Overlay.prototype.remove.call(this)};f.prototype.isPointIn=function(b){return b&&this.svgElement&&this.curZoomInRange(this.options.minZoom,this.options.maxZoom,this.vertexs)?mxLib.GeoUtils.isPointInCircle(b,this):!1}})();(function(){var f=mxLib.PointCollection=function(b,a,c){this.points=b;this.symbol=a;this.options=c=c||{};this.options.listenMoveEvent=!1===c.listenMoveEvent?!1:!0;this.options.listenClickEvent=!1===c.listenClickEvent?!1:!0;this.options.minZoom=c.minZoom||0;this.options.maxZoom=c.maxZoom||0;this.options.statusSymbol=c.statusSymbol||{};this.options.pointsStatus=c.pointsStatus||{};this.options.pointsVisible=c.pointsVisible||{};this.options.defaultTextStyle=c.defaultTextStyle||{textAnchor:new mxLib.Size(0,0),fillStyle:"blue",textAlign:"center",textBaseline:"top"};this.options.pointsTextStyle=c.pointsTextStyle||{};this.options.pointsTextValue=c.pointsTextValue||{};this.options.drawTextMinZoom=c.drawTextMinZoom||0;this.options.cluster=c.cluster||!1;this.options.clusterOpts=c.clusterOpts||{};this.options.pointScale=c.pointScale||{};this.options.scaleZoom=this.options.pointScale.scaleZoom||0;this.options.scaleRadio=this.options.pointScale.scaleRadio||0;if(this.options.cluster&&!this.options.statusSymbol._cluster_symbol_0)for(b=[53,56,66,78,90],a=0;c=b[a];a++)this.options.statusSymbol["_cluster_symbol_"+a]=new mxLib.Icon(scriptBaseDir+"mxImg/m"+a+".png",new mxLib.Size(c,c))};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){this.map=b;var a=document.createElement("canvas");a.style.cssText="position: absolute; left: 0px; top: 0px;pointer-events:none";var c=b.getSize();a.width=c.width;a.height=c.height;this.bDrawCacheCavas=mxLib.Util.supportHtml5()?!0:!1;mxLib.Util.initCanvas(a);b.getPanes().mapPane.appendChild(a);this.createCache();this.domElement=a;this.drawPointIndexs=[];this.drawPixels=[];this.curPointIndex=null;this._setEventDispath();this.options.cluster&&(c=this.options.clusterOpts||{},c.markers=this.points,c.isPointCollectionClusterer=!0,c.pointCollection=this,c.maxZoom||(c.maxZoom=this.options.maxclusterZoom),this.markerClusterer=new mxLib.MarkerClusterer(b,c));return a};f.prototype.getEventPane=function(){return this.map.getPanes().mapPane};f.prototype._getPtSymbol=function(b){return(b=this.options.pointsStatus[b])&&this.options.statusSymbol[b]?this.options.statusSymbol[b]:this.symbol};f.prototype._isPixelInSymRect=function(b,a,c,e,g,f){var h=this.map.getZoom(),n=this.options.scaleZoom,l=this.options.scaleRadio;if(h<n&&0!=n&&(!this.options.pointScale.noScalePtIndex||"true"!=this.options.pointScale.noScalePtIndex[b])){if(b=Math.pow(l,n-h),a>=e.x-g.width/b&&a<=e.x-g.width/b+f.width/b&&c>=e.y-g.height/b&&c<=e.y-g.height/b+f.height/b)return!0}else return a>=e.x-g.width&&a<=e.x-g.width+f.width&&c>=e.y-g.height&&c<=e.y-g.height+f.height?!0:!1};f.prototype._setEventDispath=function(){function b(b){b=window.event||b;b=new mxLib.Pixel(b.pageX||b.clientX||0,b.pageY||b.clientY||0);var c=a.map.pixelToPoint(b);return{pixel:b,point:c}}var a=this,c=a.map.container.style.cursor;this.map.addEventListener("resize",function(){var b=a.map.getSize();a.domElement.width=b.width;a.domElement.height=b.height;a.createCache();a.draw()});this.options.listenClickEvent&&this.map.addEventListener("mouseup",this._clickFunc=function(c){if(1!=mxLib.Util.getButton(c))for(var g=c.clientX||c.x||0,f=c.clientY||c.y||0,h=b(c),n=0;n<a.drawPixels.length;n++){var l=a._getPtSymbol(n),m=l.getSize(),l=l.getAnchor();if(a._isPixelInSymRect(n,g,f,a.drawPixels[n],l,m)){0==mxLib.Util.getButton(c)?mxLib.Util.dispatchEvent(a,"click",{point:h.point,pixel:h.pixel,index:a.drawPointIndexs[n]}):2==mxLib.Util.getButton(c)&&mxLib.Util.dispatchEvent(a,"rightclick",{point:h.point,pixel:h.pixel,index:a.drawPointIndexs[n]});break}}});this.options.listenMoveEvent&&this.map.addEventListener("mousemove",this._mousemoveFunc=function(e){var g=e.clientX||e.x||0,f=e.clientY||e.y||0;if(!a.map.isDragging){e=b(e);for(var h=!1,n=0;n<a.drawPixels.length;n++){var l=a._getPtSymbol(n),m=l.getSize(),l=l.getAnchor();if(a._isPixelInSymRect(n,g,f,a.drawPixels[n],l,m)){a.map.container.style.cursor="pointer";h=!0;a.curPointIndex!==n&&(mxLib.Util.dispatchEvent(a,"mouseover",{point:e.point,pixel:e.pixel,index:a.drawPointIndexs[n]}),(a.curPointIndex||0===a.curPointIndex)&&mxLib.Util.dispatchEvent(a,"mouseout",{point:e.point,pixel:e.pixel,index:a.drawPointIndexs[a.curPointIndex]}),a.curPointIndex=n,a.map._curPtCollection=a);break}}!h&&a.map._curPtCollection==a&&(a.map.container.style.cursor=c,a.curPointIndex||0===a.curPointIndex)&&(mxLib.Util.dispatchEvent(a,"mouseout",{point:e.point,pixel:e.pixel,index:a.drawPointIndexs[a.curPointIndex]}),a.curPointIndex=null)}})};f.prototype.remove=function(){mxLib.Overlay.prototype.remove.call(this);this.map.removeEventListener("mousemove",this._mousemoveFunc);this.map.removeEventListener("click",this._clickFunc)};f.prototype.createCache=function(){this.symbol.cacheCanvas=this.cacheCanvas=document.createElement("canvas");mxLib.Util.initCanvas(this.cacheCanvas);this.symbol._drawBegin=this._drawBegin=!1;var b=this;this.symbol instanceof mxLib.Icon?this.symbol.draw(this.cacheCanvas,null,function(){b.symbol.draw(b.cacheCanvas);b.symbol._drawBegin=b._drawBegin=!0;b.draw()}):(this.symbol.draw(this.cacheCanvas),this.symbol._drawBegin=this._drawBegin=!0);for(var a in this.options.statusSymbol){var c=this.options.statusSymbol[a];c.cacheCanvas=document.createElement("canvas");mxLib.Util.initCanvas(c.cacheCanvas);c._drawBegin=!1;c instanceof mxLib.Icon?function(a){a.draw(a.cacheCanvas,null,function(){a.draw(a.cacheCanvas);a._drawBegin=!0;b.draw()})}(c):(c.draw(c.cacheCanvas),c._drawBegin=!0)}};f.prototype.draw=function(){mxLib.Overlay.prototype.draw.call(this);if(this.domElement&&this.domElement.getContext("2d")&&this.cacheCanvas&&this._drawBegin&&(this.domElement.getContext("2d").clearRect(0,0,this.domElement.width,this.domElement.height),this.map.curZoomInRange(this.options.minZoom,this.options.maxZoom))){var b=this.map.getBounds(!1),a=this.domElement.getContext("2d");this.drawPointIndexs.length=0;this.drawPixels.length=0;var c=this.options.defaultTextStyle,e;for(e in c)a[e]=c[e];for(var g=this.map.getZoom(),f=this.options.scaleZoom,h=this.options.scaleRadio,c=0;c<this.points.length;c++)if(b.containsPoint(this.points[c])){var n=this.map.pointToPixel(this.points[c]);if((!this.options.cluster||this.points[c].isShowMarker)&&0!=this.getPointVisible(c)){var l=this._getPtSymbol(c),m=l.getAnchor(),q=n.x,r=n.y,t=!1;g<f&&0!=f&&(!this.options.pointScale.noScalePtIndex||"true"!=this.options.pointScale.noScalePtIndex[c])&&(t=!0,a.save(),a.translate(q,r),e=1/Math.pow(h,f-g),a.scale(e,e),r=q=0);this.bDrawCacheCavas?a.drawImage(l.cacheCanvas,q-m.width,r-m.height):l.draw(this.domElement,new mxLib.Pixel(q-m.width,r-m.height));var w=this.options.pointsTextValue[c];if(w&&(this.options.drawTextMinZoom&&g>=this.options.drawTextMinZoom||0==this.options.drawTextMinZoom)){var l=this.options.drawTextLeftMargin||2,m=this.options.drawTextCellMargin||10,u=[],v=[],z={};$.isNumeric(w)&&(w+="");if(-1!=w.indexOf("||"))for(var x=w.split("||"),B=0;B<x.length;B++){for(var A=x[B].split("--"),D=[],C=0;C<A.length;C++){var F=A[C],G=F.indexOf("\x3c");if(0<G&&F.indexOf("\x3e")==F.length-1){var H=F.substr(0,G);D.push(H);F=F.substr(G+1,F.length-G-2);z[B+"_"+C]=F}else D.push(F)}v.push(D)}B=this.options.pointsTextStyle[c]||this.options.defaultTextStyle;for(e in B)a[e]=B[e];var F=B.textAnchor.width||0,x=B.textAnchor.height||0,E,G=q+F,H=r+x;if(A=a.background){var D=a.fillStyle,I=a.strokeStyle;if(0==v.length)E=a.measureText(w).width;else{for(B=0;B<v.length;B++)for(C=0;C<v[B].length;C++)E=a.measureText(v[B][C]).width,u[C]?u[C]<E&&(u[C]=E):u[C]=E;E=l;for(C=0;C<u.length;C++)0!=C&&(E+=m),E+=u[C]?u[C]:0}a.maxWidth&&(E=a.maxWidth);var K=0;0==v.length?C=1.2*E/w.length:(K=20,C=K*v.length);if(A.rectBounds&&(B=A.rectBounds.split(","),4==B.length)){var C=B[0],J=B[1],L=B[2],B=B[3],C=C.replace("w",E),J=J.replace("w",E),L=L.replace("w",E),B=B.replace("w",E),G=G+parseInt(eval(C)),H=H+parseInt(eval(J));E=parseInt(eval(L));C=parseInt(eval(B));0<v.length&&(K=C/v.length)}A.fillStyle&&(a.fillStyle=A.fillStyle,a.fillRect(G,H,E,C));A.strokeStyle&&(a.strokeStyle=A.strokeStyle,J=a.lineWidth,a.lineWidth=A.lineWidth||"1",a.strokeRect(G,H,E,C),a.lineWidth=J);a.fillStyle=D;a.strokeStyle=I}if(0==v.length)a.maxWidth?a.fillText(w,q+F,r+x,a.maxWidth):a.fillText(w,q+F,r+x);else for(a.textAlign="start",q+=F,q-=E/2,B=w=0;B<v.length;B++){F=l;for(C=0;C<v[B].length;C++)0!=C&&(F=m,F+=u[C-1]),D=null,z[B+"_"+C]&&(D=a.fillStyle,a.fillStyle=z[B+"_"+C]),a.maxWidth?a.fillText(v[B][C],q+F,r+x+w,a.maxWidth):a.fillText(v[B][C],q+F,r+x+w),D&&(a.fillStyle=D),A.tableLineStyle&&(a.strokeStyle=A.tableLineStyle,J=a.lineWidth,a.lineWidth="1",a.strokeRect(q+F-2,r+x+w-2,0,K),a.lineWidth=J);w+=K;A.tableLineStyle&&(a.strokeStyle=A.tableLineStyle,J=a.lineWidth,a.lineWidth="1",B!=v.length-1&&a.strokeRect(q,r+x+w-2,E,0),a.lineWidth=J)}}t&&a.restore();this.drawPointIndexs.push(c);this.drawPixels.push(n)}}if(this.options.cluster&&this.markerClusterer&&g<=this.options.maxclusterZoom&&this.options.maxclusterZoom){c=this.options.defaultClusterTextStyle||{textAnchor:new mxLib.Size(0,0),fillStyle:"black",textAlign:"center",textBaseline:"middle",font:"bold 12px serif"};for(e in c)a[e]=c[e];for(c=0;c<this.markerClusterer._clusters.length;c++)if(n=this.markerClusterer._clusters[c],e=n._markers.length,!(e<n._minClusterSize)){n=this.map.pointToPixel(n._center);b=parseInt(e);b=parseInt(b/10);b=Math.max(0,b);b=Math.min(b,(this.options.stylesLength||5)-1);if(l=this.options.statusSymbol["_cluster_symbol_"+b])m=l.getAnchor(),this.bDrawCacheCavas?a.drawImage(l.cacheCanvas,n.x-m.width,n.y-m.height):l.draw(this.domElement,new mxLib.Pixel(n.x-m.width,n.y-m.height));a.fillText(e,n.x,n.y)}}}};f.prototype.setPoints=function(b){this.points=b;this.draw()};f.prototype.setSymbol=function(b){this.symbol=b;this.createCache();this.draw()};f.prototype.refresh=function(){this.draw()};f.prototype.setStatusSymbol=function(b,a,c){a?(this.options.statusSymbol[b]=a,a.cacheCanvas=document.createElement("canvas"),mxLib.Util.initCanvas(a.cacheCanvas),a._drawBegin=!1,a instanceof mxLib.Icon?a.draw(a.cacheCanvas,null,function(){a.draw(a.cacheCanvas);a._drawBegin=!0;self.draw()}):(a.draw(a.cacheCanvas),a._drawBegin=!0)):delete this.options.statusSymbol[b];c&&this.draw()};f.prototype.setPointStatus=function(b,a,c){var e=!0;a?this.options.pointsStatus[b]!=a?this.options.pointsStatus[b]=a:e=!1:delete this.options.pointsStatus[b];c&&e&&this.draw();return c&&e};f.prototype.getPointStatus=function(b){return this.options.pointsStatus[b]};f.prototype.setPointVisible=function(b,a,c){var e=!0;a?this.options.pointsVisible[b]!=a?this.options.pointsVisible[b]=a:e=!1:delete this.options.pointsVisible[b];c&&e&&this.draw();return c&&e};f.prototype.getPointVisible=function(b){return"hidden"==this.options.pointsVisible[b]?!1:!0};f.prototype.setPointTextValue=function(b,a,c){var e=!0;a?this.options.pointsTextValue[b]!=a?this.options.pointsTextValue[b]=a:e=!1:delete this.options.pointsTextValue[b];c&&e&&this.draw()};f.prototype.getPointTextValue=function(b){return this.options.pointsTextValue[b]};f.prototype.clear=function(){this.points.length=0;this.draw()};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};f.prototype.isPointIn=function(b){return!1}})();(function(){var f=mxLib.Hotspot=function(b,a){this.position=b;a=a||{};a.text=a.text||"";this.offsets=a.offsets=a.offsets||[5,5,5,5];a.minZoom=a.minZoom||0;a.maxZoom=a.maxZoom||0;this.options=a};f.prototype.initialize=function(b){this.map=b};f.prototype.setPosition=function(b){this.position=b};f.prototype.getPosition=function(){return this.position};f.prototype.setText=function(b){this.options.text=b};f.prototype.getText=function(){return this.options.text};f.prototype.setUserData=function(b){this.options.userData=b};f.prototype.getUserData=function(){return this.options.userData}})();(function(){function f(a){var b=$("#"+a.id+" .zoomNoScale"),e=a.map.getZoom();b.each(function(b){b=Snap(this);var c=b.attr("noScaleBeginZoom");c||(c=b.attr("noscalebeginzoom"));var f=a.scaleRatio;c&&e<=c&&(f=1);(c=b.attr("transformOrigin"))||(c=b.attr("transformorigin"));c||(c="0 0");c=c.split(" ");2<=c.length&&(f=mxLib.Util.stringFormat("translate({0}, {1})  scale({2})",-c[0]*(f-1),-c[1]*(f-1),f),b.transform(f))})}var b=mxLib.VectorLayer=function(a,b,e){this.src=a;this.bounds=b;e=e||{};this.src&&""!=this.src||(this.bNewVectorLayer=!0,this.mapSvgRatio=1);1==arguments.length&&"object"==$.type(a)&&(e=a,this.bNewVectorLayer=!0,this.mapSvgRatio=1,this.bounds=e.bounds);this.options=e;this.options.minZoom=e.minZoom||0;this.options.maxZoom=e.maxZoom||0};mxLib.Lang.inherits(b,mxLib.Overlay);b.prototype.initialize=function(a){this.map=a;if(this.bNewVectorLayer){this.mapSvgRatio=(this.options.bounds||a.getBounds(!0)).width/1024;var b=document.createElementNS("http://www.w3.org/2000/svg","svg");this.id=mxLib.Util.createUniqueID("vl_new_");b.id=this.id;b.style.position="absolute";var e=$(a.container).width()+2*a.mapPaneSvgExtendPixel,g=$(this.map.container).height();0==g&&MvHost&&MvHost.height&&(g=MvHost.height);var g=g+2*a.mapPaneSvgExtendPixel,k=-a.mapPaneSvgExtendPixel,h=-a.mapPaneSvgExtendPixel;b.style.width=e+"px";b.style.height=g+"px";b.style.top=k+"px";b.style.left=h+"px";$(a.getPanes().vectorLayer).append($(b));this.embedElement=this.domElement=b;this.options&&0==this.options.pointerEvents&&$(this.domElement).css("pointer-events","none");this.setOpacity(this.options.Opacity);this.updateWidthHeight();this.updateViewBox();f(this);var n=this;a.addEventListener("resize",this.updateWidthHeightFun=function(){n.updateWidthHeight();n.updateViewBox()});!1===this.options.embedEvents&&this.setEmbedEvent(!1);return b}this.id=mxLib.Util.createUniqueID("vl_");var b=a.pointToPixel(this.bounds.getLeftTop()),e=a.pointDistToPixelDist(this.bounds.width,!0),g=a.pointDistToPixelDist(this.bounds.height,!1),e=mxLib.Util.stringFormat("\x3cdiv  id \x3d '{0}' style\x3d'position:absolute;left:{1}px;top:{2}px;width:{3}px;height:{4}px'\x3e\x3cembed src\x3d'{5}'  wmode\x3d'transparent' style\x3d'position:absolute;left:0px;top:0px;width:100%;height:100%'/\x3e\x3c/div\x3e",this.id,b.x,b.y,e,g,this.src),e=$(e);$(a.getPanes().vectorLayer).append(e);this.domElement=e[0];this.embedElement=e.children("embed")[0];this.setOpacity(this.options.Opacity);!1===this.options.embedEvents&&this.setEmbedEvent(!1);this.options&&0==this.options.pointerEvents&&$(this.domElement).css("pointer-events","none");mxLib.Overlay.prototype.setEventDispath.call(this);var l=this;this.embedElement.addEventListener&&this.embedElement.addEventListener("load",function(){l._snap=null;mxLib.Util.dispatchEvent(l,"load",{overlay:l});if(mxLib.Util.isLowerVersion()){var a=l.map.pointDistToPixelDist(l.bounds.width,!0),b=l.map.pointDistToPixelDist(l.bounds.height,!1),c=l.snap();c&&c.attr({width:a+"px",height:b+"px"})}(l.options.autoWidth||l.options.autoHeight)&&l.fitBounds(l.options.autoWidth)},!1);return e[0]};b.prototype.remove=function(){this.bNewVectorLayer&&this.updateWidthHeightFun&&map.removeEventListener("resize",this.updateWidthHeightFun);mxLib.Overlay.prototype.remove.call(this)};b.prototype.updateWidthHeight=function(){if(this.domElement){var a=$(this.map.container).width()+2*this.map.mapPaneSvgExtendPixel,b=$(this.map.container).height();0==b&&MvHost&&MvHost.height&&(b=MvHost.height);b+=2*this.map.mapPaneSvgExtendPixel;this.snap().attr({width:a,height:b});this.domElement.style.width=a+"px";this.domElement.style.height=b+"px"}};b.prototype.updateViewBox=function(){if(this.bNewVectorLayer){var a=$(this.map.container).width()+2*this.map.mapPaneSvgExtendPixel,b=$(this.map.container).height();0==b&&MvHost&&MvHost.height&&(b=MvHost.height);var b=b+2*this.map.mapPaneSvgExtendPixel,e=-this.map.mapPaneSvgExtendPixel,g=-this.map.mapPaneSvgExtendPixel,f=this.map.pixelToPoint(new mxLib.Pixel(e,g)),g=this.map.pixelToPoint(new mxLib.Pixel(e+a,g+b)),h=(this.options.bounds||this.map.getBounds(!0)).getLeftTop();this.ptMapLeftTop=h;var n,b=f.x-h.x,f=h.y-f.y,e=g.x-h.x;n=h.y-g.y;b/=this.mapSvgRatio;f/=this.mapSvgRatio;e/=this.mapSvgRatio;n/=this.mapSvgRatio;g=0+b;h=0+f;b=e-b;f=n-f;this.scaleRatio=b/a;this.snap().attr("viewBox",g+" "+h+" "+b+" "+f)}};b.prototype.svgMapPoint=function(a){var b=[],e=!1;a instanceof mxLib.Point?b.push(a):$.isArray(a)?(b=a,2<=arguments.length&&!0===arguments[1]&&(e=!0)):$.isNumeric(a)&&(px=arguments[0],py=arguments[1],b.push(new mxLib.Point(px,py)));this.ptMapLeftTop||(this.ptMapLeftTop=(this.options.bounds||this.map.getBounds(!0)).getLeftTop());var g="";1<b.length&&e&&(g="M");for(var f=0;f<b.length;f++)0!=f&&(g+=",",e&&(g+="L")),g=g+(b[f].x-this.ptMapLeftTop.x)/this.mapSvgRatio+","+(this.ptMapLeftTop.y-b[f].y)/this.mapSvgRatio;return g};b.prototype.fromMapPoint=function(a){if(!this.bNewVectorLayer)return null;var b,e;1==arguments.length&&a instanceof mxLib.Point?(b=a.x,e=a.y):2==arguments.length&&(b=arguments[0],e=arguments[1]);this.ptMapLeftTop||(this.ptMapLeftTop=(this.options.bounds||this.map.getBounds(!0)).getLeftTop());return new mxLib.Point((b-this.ptMapLeftTop.x)/this.mapSvgRatio,(this.ptMapLeftTop.y-e)/this.mapSvgRatio)};b.prototype.fromMapDist=function(a){return a/this.mapSvgRatio};b.prototype.toMapPoint=function(a){if(!this.bNewVectorLayer)return null;this.ptMapLeftTop||(this.ptMapLeftTop=(this.options.bounds||this.map.getBounds(!0)).getLeftTop());var b,e;1==arguments.length&&a instanceof mxLib.Point?(b=a.x,e=a.y):2==arguments.length&&(b=arguments[0],e=arguments[1]);return new mxLib.Point(b*this.mapSvgRatio+this.ptMapLeftTop.x,this.ptMapLeftTop.y-e*this.mapSvgRatio)};b.prototype.toMapDist=function(a){return a*this.mapSvgRatio};b.prototype.draw=function(){if(this.curZoomInRange(this.options.minZoom,this.options.maxZoom)&&this.isVisible())if(this.bNewVectorLayer)this.updateViewBox(),0<arguments.length&&!0===arguments[0]&&this.scaleRatio&&f(this);else{var a=this.map.pointToPixel(this.bounds.getLeftTop()),b=this.map.pointDistToPixelDist(this.bounds.width,!0),e=this.map.pointDistToPixelDist(this.bounds.height,!1);$(this.domElement).offset({left:a.x,top:a.y});$(this.domElement).width(b);$(this.domElement).height(e);mxLib.Util.isLowerVersion()&&(a=this.snap())&&a.attr({width:b+"px",height:e+"px"})}};b.prototype.setOpacity=function(a){a&&this.domElement&&$(this.domElement).css("opacity",a)};b.prototype.getSVGDocument=function(){return this.embedElement?this.bNewVectorLayer?this.embedElement:this.embedElement.getSVGDocument():null};b.prototype.getEmbedElement=function(){return this.embedElement};b.prototype.setEmbedEvent=function(a){this.embedElement&&$(this.embedElement).css("pointer-events",a?"":"none")};b.prototype.setPointerEvent=function(a){this.domElement&&$(this.domElement).css("pointer-events",a?"":"none")};b.prototype.getBounds=function(){return this.bounds};b.prototype.setBounds=function(a){this.bounds=a;this.draw()};b.prototype.getLeftTopPoint=function(){return this.bounds.getLeftTop()};b.prototype.setLeftTopPoint=function(a){this.bounds=new mxLib.Bounds(a.x,a.y,a.x+this.bounds.width,a.y-this.bounds.height)};b.prototype.snap=function(){if(!this.domElement)return null;if(this._snap)return this._snap;if(this.bNewVectorLayer)this._snap=Snap("#"+this.id);else{var a=null;this.getSVGDocument()&&(a=this.getSVGDocument().getElementsByTagName("svg"));a&&0<a.length&&(this._snap=Snap(a[0]))}return this._snap};b.prototype.getEventPane=function(){return this.map.getPanes().vectorLayer};b.prototype.getDragPoint=function(){return this.getLeftTopPoint()};b.prototype.setDragPoint=function(a){return this.setLeftTopPoint(a)};b.prototype.fitBounds=function(a){a?(this.options.autoHeight=!1,this.options.autoWidth=!0):(this.options.autoHeight=!0,this.options.autoWidth=!1);if(this.snap()){a=this.snap().attr("width");var b=this.snap().attr("height");a=mxLib.Util.getValueOfNoPX(a);b=mxLib.Util.getValueOfNoPX(b);if(this.options.autoWidth)var e=this.getLeftTopPoint(),g=this.bounds.height,f=a*g/b;else e=this.getLeftTopPoint(),f=this.bounds.width,g=b*f/a;this.bounds=new mxLib.Bounds(e.x,e.y,e.x+f,e.y-g);this.draw()}};b.prototype.isPointIn=function(a){return!1}})();(function(){var f=mxLib.AnimatePath=function(b,a,c){this.map=b;this.points=a;c=c||{};this.options=mxLib.Util.cloneObject(c);this.options.shape=c.shape||"M-31,-8L0,0,-31,8,-23,0Z";this.bSimpleAnimate=0<=this.options.shape.indexOf("\x3c")&&0<=this.options.shape.indexOf("\x3e")?!1:!0;this.options.scale=this.options.scale||1;this.bSimpleAnimate?(c=new Snap.Matrix,c.scale(this.options.scale,this.options.scale),this.options.shape=Snap.path.map(this.options.shape,c).toString()):1!=this.options.scale&&(this.options.shape=mxLib.Util.stringFormat("\x3cg transform\x3d'matrix({0},0,0,{1},0,0)'\x3e{2}\x3c/g\x3e",this.options.scale,this.options.scale,this.options.shape));this.options.color=this.options.color||"#11cd6e";this.options.dur=this.options.dur||"10s";this.options.minZoom=this.options.minZoom||0;this.options.maxZoom=this.options.maxZoom||0;this.vl=this.options.bounds?b.curZoomVectorLayer(this.options.minZoom,this.options.maxZoom,{bounds:this.options.bounds}):b.curZoomVectorLayer(this.options.minZoom,this.options.maxZoom);if($.isArray(a))for(b="M",c=0;c<a.length;c++){var e=this.vl.fromMapPoint(a[c]);b=b+e.x+","+e.y+" ";b=0==c?b+"L":b+""}else b=a;a=mxLib.Util.createUniqueID("ANI_G_");c=mxLib.Util.createUniqueID("ANI_P_");var e=mxLib.Util.createUniqueID("ANI_M_"),g="";this.options.zoomNoScale&&(g=' class\x3d"zoomNoScale"  transformOrigin\x3d"0 0" ',this.options.zoomBegin&&(g+=' noScaleBeginZoom\x3d"'+this.options.zoomBegin+'"'));if(void 0===this.options.rotate||null===this.options.rotate)this.options.rotate="auto";var f=""===this.options.rotate?"":' rotate\x3d "'+this.options.rotate+'"';b=this.bSimpleAnimate?mxLib.Util.stringFormat('\x3cg id\x3d"{0}"\x3e\x3cpath id\x3d"{1}" fill\x3d"{2}" d\x3d"{3}"  {4}/\x3e \r\n\t\t   \x3canimateMotion id\x3d"{5}" path\x3d"{6}" dur\x3d"{7}" begin\x3d"0s" end\x3d"indefinite" repeatCount\x3d"indefinite" {8} /\x3e \r\n\t\t\x3c/g\x3e',a,c,this.options.color,this.options.shape,g,e,b,this.options.dur,f):mxLib.Util.stringFormat('\x3cg id\x3d"{0}"\x3e\x3cg id\x3d"{1}" {2}\x3e{3}\x3c/g\x3e \r\n\t\t   \x3canimateMotion id\x3d"{4}" path\x3d"{5}" dur\x3d"{6}" begin\x3d"0s" end\x3d"indefinite" repeatCount\x3d"indefinite" {7} /\x3e \r\n\t\t\x3c/g\x3e',a,c,g,this.options.shape,e,b,this.options.dur,f);b=Snap.parse(b);this.vl.snap().add(b);this.element=document.getElementById(e);this.animateGroupId=a;this.animatePathId=c;this.animateId=e};mxLib.lang.inherits(mxLib.AnimatePath,mxLib.lang.Class,"AnimatePath");f.prototype.startAnimate=function(){this.element&&this.element.beginElement&&this.element.beginElement()};f.prototype.stopAnimate=function(){this.element&&this.element.endElement&&this.element.endElement()};f.prototype.setColor=function(b){this.bSimpleAnimate&&$("#"+this.animatePathId).attr("fill",b)};f.prototype.remove=function(){this.vl.snap().select("#"+this.animateGroupId).remove()}})();(function(f){f.fn._outerWidth=function(b){return void 0==b?this[0]==window?this.width()||document.body.clientWidth:this.outerWidth()||0:this._size("width",b)};f.fn._outerHeight=function(b){return void 0==b?this[0]==window?this.height()||document.body.clientHeight:this.outerHeight()||0:this._size("height",b)};f.fn._scrollLeft=function(b){return void 0==b?this.scrollLeft():this.each(function(){f(this).scrollLeft(b)})};f.fn._propAttr=f.fn.prop||f.fn.attr;f.fn._size=function(b,a){function c(a,b,c){if(!b.length)return!1;a=f(a)[0];b=b[0];var e=b.fcount||0;if(c)return a.fitted||(a.fitted=!0,b.fcount=e+1,f(b).addClass("panel-noscroll"),"BODY"==b.tagName&&f("html").addClass("panel-fit")),{width:f(b).width()||1,height:f(b).height()||1};a.fitted&&(a.fitted=!1,b.fcount=e-1,0==b.fcount&&(f(b).removeClass("panel-noscroll"),"BODY"==b.tagName&&f("html").removeClass("panel-fit")));return!1}function e(a,b,c,e){a=f(a);var g=b.substr(0,1).toUpperCase()+b.substr(1),q=f.parser.parseValue("min"+g,e["min"+g],c),r=f.parser.parseValue("max"+g,e["max"+g],c),t=f.parser.parseValue(b,e[b],c);c=0<=String(e[b]||"").indexOf("%")?!0:!1;isNaN(t)?(a._size(b,""),a._size("min"+g,q),a._size("max"+g,r)):(q=Math.min(Math.max(t,q||0),r||99999),c||(e[b]=q),a._size("min"+g,""),a._size("max"+g,""),a._size(b,q));return c||e.fit}function g(a,b,c){function e(){return 0<=b.toLowerCase().indexOf("width")?g.outerWidth()-g.width():g.outerHeight()-g.height()}var g=f(a);if(void 0==c){c=parseInt(a.style[b]);if(isNaN(c))return;f._boxModel&&(c+=e());return c}""===c?g.css(b,""):(f._boxModel&&(c-=e(),0>c&&(c=0)),g.css(b,c+"px"))}return"string"==typeof b?"clear"==b?this.each(function(){f(this).css({width:"",minWidth:"",maxWidth:"",height:"",minHeight:"",maxHeight:""})}):"fit"==b?this.each(function(){c(this,"BODY"==this.tagName?f("body"):f(this).parent(),!0)}):"unfit"==b?this.each(function(){c(this,f(this).parent(),!1)}):void 0==a?g(this[0],b):this.each(function(){g(this,b,a)}):this.each(function(){a=a||f(this).parent();f.extend(b,c(this,a,b.fit)||{});var g=e(this,"width",a,b),h=e(this,"height",a,b);g||h?f(this).addClass("easyui-fluid"):f(this).removeClass("easyui-fluid")})}})(jQuery);(function(f){function b(b){function g(a){var c=[];a.addClass("mx-menu");c.push(a);a.hasClass("mx-menu-content")||a.children("div").each(function(){var a=f(this).children("div");a.length&&(a.insertAfter(b),this.submenu=a,a=g(a),c=c.concat(a))});return c}function k(g){var h=mxLib.Util.parseOptions(g[0],["width","height"]);g[0].originalHeight=h.height||0;g.hasClass("mx-menu-content")?g[0].originalWidth=h.width||g._outerWidth():(g[0].originalWidth=h.width||0,g.children("div").each(function(){var a=f(this),c=f.extend({},mxLib.Util.parseOptions(this,["name","iconCls","href",{separator:"boolean"}]),{disabled:a.attr("disabled")?!0:void 0});c.separator&&a.addClass("mx-menu-sep");if(!a.hasClass("mx-menu-sep")){a[0].itemName=c.name||"";a[0].itemHref=c.href||"";var g=a.addClass("mx-menu-item").html();a.empty().append(f('\x3cdiv class\x3d"mx-menu-text"\x3e\x3c/div\x3e').html(g));c.iconCls&&f('\x3cdiv class\x3d"mx-menu-icon"\x3e\x3c/div\x3e').addClass(c.iconCls).appendTo(a);c.disabled&&l(b,a[0],!0);a[0].submenu&&f('\x3cdiv class\x3d"mx-menu-rightarrow"\x3e\x3c/div\x3e').appendTo(a);e(b,a)}}),f('\x3cdiv class\x3d"mx-menu-line"\x3e\x3c/div\x3e').prependTo(g));a(b,g);g.hide();c(b,g)}f(b).appendTo("body");f(b).addClass("mx-menu-top");f(document).unbind(".mx-menu").bind("mousedown.menu",function(a){f(a.target).closest("div.mx-menu,div.combo-p").length||f("body\x3ediv.mx-menu-top:visible").mxMenu("hide")});for(var h=g(f(b)),n=0;n<h.length;n++)k(h[n])}function a(a,b){var c=f.data(a,"menu").options,e=b.attr("style")||"";b.css({display:"block",left:-1E4,height:"auto",overflow:"hidden"});var g=b[0],k=g.originalWidth||0;k||(k=0,b.find("div.mx-menu-text").each(function(){k<f(this)._outerWidth()&&(k=f(this)._outerWidth());f(this).closest("div.mx-menu-item")._outerHeight(f(this)._outerHeight()+2)}),k+=40);var k=Math.max(k,c.minWidth),h=g.originalHeight||0;if(!h)if(h=b.outerHeight(),b.hasClass("mx-menu-top")&&c.alignTo)var l=f(c.alignTo),c=l.offset().top-f(document).scrollTop(),l=f(window)._outerHeight()+f(document).scrollTop()-l.offset().top-l._outerHeight(),h=Math.min(h,Math.max(c,l));else h>f(window)._outerHeight()?(h=f(window).height(),e+=";overflow:auto"):e+=";overflow:hidden";c=Math.max(g.originalHeight,b.outerHeight())-2;b._outerWidth(k)._outerHeight(h);b.children("div.mx-menu-line")._outerHeight(c);e+=";width:"+g.style.width+";height:"+g.style.height;b.attr("style",e)}function c(a,b){var c=f.data(a,"menu");b.unbind(".mx-menu").bind("mouseenter.mx-menu",function(){c.timer&&(clearTimeout(c.timer),c.timer=null)}).bind("mouseleave.mx-menu",function(){c.options.hideOnUnhover&&(c.timer=setTimeout(function(){g(a)},c.options.duration))})}function e(a,b){b.hasClass("mx-menu-item")&&(b.unbind(".mx-menu"),b.bind("click.mx-menu",function(){if(!f(this).hasClass("mx-menu-item-disabled")){if(!this.submenu){g(a);var b=this.itemHref;b&&(location.href=b)}b=f(a).mxMenu("getItem",this);f.data(a,"menu").options.onClick.call(a,b)}}).bind("mouseenter.menu",function(c){b.siblings().each(function(){this.submenu&&h(this.submenu);f(this).removeClass("mx-menu-active")});b.addClass("mx-menu-active");f(this).hasClass("mx-menu-item-disabled")?b.addClass("mx-menu-active-disabled"):(c=b[0].submenu)&&f(a).mxMenu("show",{menu:c,parent:b})}).bind("mouseleave.menu",function(a){b.removeClass("mx-menu-active mx-menu-active-disabled");var c=b[0].submenu;c?a.pageX>=parseInt(c.css("left"))?b.addClass("mx-menu-active"):h(c):b.removeClass("mx-menu-active")}))}function g(a){var b=f.data(a,"menu");b&&f(a).is(":visible")&&(h(f(a)),b.options.onHide.call(a));return!1}function k(a,b){function c(a,b){a+k.outerHeight()>f(window)._outerHeight()+f(document).scrollTop()&&(a=b?f(b).offset().top-k._outerHeight():f(window)._outerHeight()+f(document).scrollTop()-k.outerHeight());0>a&&(a=0);return a}var e,g;b=b||{};var k=f(b.menu||a);f(a).mxMenu("resize",k[0]);if(k.hasClass("mx-menu-top")){var h=f.data(a,"menu").options;f.extend(h,b);e=h.left;g=h.top;if(h.alignTo){var l=f(h.alignTo);e=l.offset().left;g=l.offset().top+l._outerHeight();"right"==h.align&&(e+=l.outerWidth()-k.outerWidth())}e+k.outerWidth()>f(window)._outerWidth()+f(document)._scrollLeft()&&(e=f(window)._outerWidth()+f(document).scrollLeft()-k.outerWidth()-5);0>e&&(e=0);g=c(g,h.alignTo)}else g=b.parent,e=g.offset().left+g.outerWidth()-2,e+k.outerWidth()+5>f(window)._outerWidth()+f(document).scrollLeft()&&(e=g.offset().left-k.outerWidth()+2),g=c(g.offset().top-3);k.css({left:e,top:g});k.show(0,function(){k[0].shadow||(k[0].shadow=f('\x3cdiv class\x3d"mx-menu-shadow"\x3e\x3c/div\x3e').insertAfter(k));k[0].shadow.css({display:"block",zIndex:f.fn.mxMenu.defaults.zIndex++,left:k.css("left"),top:k.css("top"),width:k.outerWidth(),height:k.outerHeight()});k.css("z-index",f.fn.mxMenu.defaults.zIndex++);k.hasClass("mx-menu-top")&&f.data(k[0],"menu").options.onShow.call(k[0])})}function h(a){function b(a){a.stop(!0,!0);a[0].shadow&&a[0].shadow.hide();a.hide()}a&&(b(a),a.find("div.mx-menu-item").each(function(){this.submenu&&h(this.submenu);f(this).removeClass("mx-menu-active")}))}function n(a,b){function c(k){k.children("div.mx-menu-item").each(function(){var k=f(a).mxMenu("getItem",this),h=g.empty().html(k.text).text();b==f.trim(h)?e=k:this.submenu&&!e&&c(this.submenu)})}var e=null,g=f("\x3cdiv\x3e\x3c/div\x3e");c(f(a));g.remove();return e}function l(a,b,c){a=f(b);a.hasClass("mx-menu-item")&&(c?(a.addClass("mx-menu-item-disabled"),b.onclick&&(b.onclick1=b.onclick,b.onclick=null)):(a.removeClass("mx-menu-item-disabled"),b.onclick1&&(b.onclick=b.onclick1,b.onclick1=null)))}function m(b,g){var k=f(b);g.parent&&(g.parent.submenu||(k=f('\x3cdiv class\x3d"mx-menu"\x3e\x3cdiv class\x3d"mx-menu-line"\x3e\x3c/div\x3e\x3c/div\x3e').appendTo("body"),k.hide(),g.parent.submenu=k,f('\x3cdiv class\x3d"mx-menu-rightarrow"\x3e\x3c/div\x3e').appendTo(g.parent)),k=g.parent.submenu);if(g.separator)var h=f('\x3cdiv class\x3d"mx-menu-sep"\x3e\x3c/div\x3e').appendTo(k);else h=f('\x3cdiv class\x3d"mx-menu-item"\x3e\x3c/div\x3e').appendTo(k),f('\x3cdiv class\x3d"mx-menu-text"\x3e\x3c/div\x3e').html(g.text).appendTo(h);g.iconCls&&f('\x3cdiv class\x3d"mx-menu-icon"\x3e\x3c/div\x3e').addClass(g.iconCls).appendTo(h);g.id&&h.attr("id",g.id);g.name&&(h[0].itemName=g.name);g.href&&(h[0].itemHref=g.href);g.onclick&&("string"==typeof g.onclick?h.attr("onclick",g.onclick):h[0].onclick=eval(g.onclick));g.handler&&(h[0].onclick=eval(g.handler));g.disabled&&l(b,h[0],!0);e(b,h);c(b,k);a(b,k)}function q(b,c){function e(a){if(a.submenu){a.submenu.children("div.mx-menu-item").each(function(){e(this)});var b=a.submenu[0].shadow;b&&b.remove();a.submenu.remove()}f(a).remove()}var g=f(c).parent();e(c);a(b,g)}function r(b,c,e){var g=f(c).parent();e?f(c).show():f(c).hide();a(b,g)}function t(a){f(a).children("div.mx-menu-item").each(function(){q(a,this)});a.shadow&&a.shadow.remove();f(a).remove()}f.fn.mxMenu=function(a,c){if("string"==typeof a)return f.fn.mxMenu.methods[a](this,c);a=a||{};return this.each(function(){var c=f.data(this,"menu");c?f.extend(c.options,a):(c=f.data(this,"menu",{options:f.extend({},f.fn.mxMenu.defaults,f.fn.mxMenu.parseOptions(this),a)}),b(this));f(this).css({left:c.options.left,top:c.options.top})})};f.fn.mxMenu.methods={options:function(a){return f.data(a[0],"menu").options},show:function(a,b){return a.each(function(){k(this,b)})},hide:function(a){return a.each(function(){g(this)})},destroy:function(a){return a.each(function(){t(this)})},setText:function(a,b){return a.each(function(){f(b.target).children("div.mx-menu-text").html(b.text)})},setIcon:function(a,b){return a.each(function(){f(b.target).children("div.mx-menu-icon").remove();b.iconCls&&f('\x3cdiv class\x3d"mx-menu-icon"\x3e\x3c/div\x3e').addClass(b.iconCls).appendTo(b.target)})},getItem:function(a,b){var c=f(b),e={target:b,id:c.attr("id"),text:f.trim(c.children("div.mx-menu-text").html()),disabled:c.hasClass("mx-menu-item-disabled"),name:b.itemName,href:b.itemHref,onclick:b.onclick},g=c.children("div.mx-menu-icon");if(g.length){for(var c=[],g=g.attr("class").split(" "),k=0;k<g.length;k++)"mx-menu-icon"!=g[k]&&c.push(g[k]);e.iconCls=c.join(" ")}return e},findItem:function(a,b){return n(a[0],b)},appendItem:function(a,b){return a.each(function(){m(this,b)})},removeItem:function(a,b){return a.each(function(){q(this,b)})},enableItem:function(a,b){return a.each(function(){l(this,b,!1)})},disableItem:function(a,b){return a.each(function(){l(this,b,!0)})},showItem:function(a,b){return a.each(function(){r(this,b,!0)})},hideItem:function(a,b){return a.each(function(){r(this,b,!1)})},resize:function(b,c){return b.each(function(){a(this,f(c))})}};f.fn.mxMenu.parseOptions=function(a){return f.extend({},mxLib.Util.parseOptions(a,[{minWidth:"number",duration:"number",hideOnUnhover:"boolean"}]))};f.fn.mxMenu.defaults={zIndex:11E4,left:0,top:0,alignTo:null,align:"left",minWidth:120,duration:100,hideOnUnhover:!0,onShow:function(){},onHide:function(){},onClick:function(a){}}})(jQuery);(function(){mxLib.MenuItem=function(b,a,c,e){this.text=b;this.icon=a;this.parent=c;this.callback=e};var f=mxLib.ContextMenu=function(b){this.menuItems=[];this.refCnt=0};f.prototype.addRef=function(){this.refCnt+=1};f.prototype.releaseRef=function(){--this.refCnt;0==this.refCnt&&this.destroy()};f.prototype.initialize=function(b){this.map=b;this.addRef();if(!this.menuDiv){this.menuDiv=b.createContextMenu();for(b=0;b<this.menuItems.length;b++)this.menuItems[b].parent||(this.appendItem(this.menuItems[b],!0),!1===this.menuItems[b].enable&&this.disableItem(this.menuItems[b].text),!1===this.menuItems[b].show&&this.hideItem(this.menuItems[b].text),!0===this.menuItems[b].check&&this.checkItem(this.menuItems[b].text));for(b=0;b<this.menuItems.length;b++)this.menuItems[b].parent&&(this.appendItem(this.menuItems[b],!0),!1===this.menuItems[b].enable&&this.disableItem(this.menuItems[b].text),!1===this.menuItems[b].show&&this.hideItem(this.menuItems[b].text),!0===this.menuItems[b].check&&this.checkItem(this.menuItems[b].text))}};f.prototype.show=function(b){this.menuDiv&&$(this.menuDiv).mxMenu("show",{left:b.x,top:b.y})};f.prototype.hide=function(){this.menuDiv&&$(this.menuDiv).mxMenu("hide")};f.prototype.destroy=function(){this.menuDiv&&($(this.menuDiv).mxMenu("destroy"),this.menuDiv=0)};f.prototype.findItem=function(b){return $(this.menuDiv).mxMenu("findItem",b)};f.prototype.setText=function(b,a){var c=this.findItem(b);$(this.menuDiv).mxMenu("setText",{target:c.target,text:a})};f.prototype.setIcon=function(b,a){if(a){var c=this.findItem(b),e=this.getItem(b);-1<e&&(this.menuItems[e].icon=a);e=mxLib.Util.createUniqueID("menuIcon");$(this.menuDiv).mxMenu("setIcon",{target:c.target,iconCls:e});$("."+e).css("background","transparent url('"+a+"') no-repeat scroll center center");$("."+e).removeClass(e)}};f.prototype.appendItem=function(b,a){a||this.menuItems.push(b);if(this.menuDiv){var c=b.parent;c?(c=this.findItem(c),$(this.menuDiv).mxMenu("appendItem",{parent:c.target,text:b.text,onclick:b.callback})):$(this.menuDiv).mxMenu("appendItem",{text:b.text,onclick:b.callback});b.icon&&this.setIcon(b.text,b.icon)}};f.prototype.getItem=function(b){for(var a=0;a<this.menuItems.length;a++)if(this.menuItems[a].text==b)return a;return-1};f.prototype.removeItem=function(b){var a=this.getItem(b);-1<a&&this.menuItems.splice(a,1);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("removeItem",b.target))};f.prototype.checkItem=function(b){var a=this.getItem(b);if(!(0>a)){this.menuItems[a].check=!0;var c=this.menuItems[a].icon;this.setIcon(b,scriptBaseDir+"mxImg/icon_check.png");this.menuItems[a].icon=c}};f.prototype.unCheckItem=function(b){var a=this.getItem(b);if(!(0>a)){this.menuItems[a].check=!1;var c=this.menuItems[a].icon;c?this.setIcon(b,c):this.setIcon(b,scriptBaseDir+"mxImg/blank.gif");this.menuItems[a].icon=c}};f.prototype.enableItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].enable=!0);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("enableItem",b.target))};f.prototype.disableItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].enable=!1);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("disableItem",b.target))};f.prototype.showItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].show=!0);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("showItem",b.target))};f.prototype.hideItem=function(b){var a=this.getItem(b);-1<a&&(this.menuItems[a].show=!1);this.menuDiv&&(b=this.findItem(b),$(this.menuDiv).mxMenu("hideItem",b.target))}})();(function(){var f=mxLib.Command=function(b,a,c){this.cmdName=b;this.parentCmd=a;this.options=c||{}};mxLib.lang.inherits(mxLib.Command,mxLib.lang.Class,"Command");f.prototype.start=function(b){this.map=b;this.result={};mxLib.Util.dispatchEvent(this,"start",{command:this})};f.prototype.end=function(b){this.map&&this.map.endCommand(this,b);this.parentCmd&&this.parentCmd.retCmd(this,this.cmdName,this.result,b);mxLib.Util.dispatchEvent(this,"end",{command:this,cancel:b})};f.prototype.retCmd=function(b,a,c,e){mxLib.Util.dispatchEvent(this,"retCmd",{command:this,name:a,retCommand:b,result:c,cancel:e})};f.prototype.leftMousedown=function(b,a){};f.prototype.leftMouseup=function(b,a){};f.prototype.mousemove=function(b,a){};f.prototype.rightMousedown=function(b,a){};f.prototype.rightMouseup=function(b,a){};f.prototype.click=function(b,a){};f.prototype.dblclick=function(b,a){};f.prototype.keydown=function(b,a){};f.prototype.keyup=function(b,a){};f.prototype.keypress=function(b,a){};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)}})();(function(){var f=mxLib.SelEntityCmd=function(b,a,c){mxLib.Command.prototype.constructor.call(this,b,a,c);this.options.showToolbar=!1===this.options.showToolbar?!1:!0;this.options.showRightMenu=!1===this.options.showRightMenu?!1:!0;this.options.multiSingel=!1===this.options.multiSingel?!1:!0};mxLib.Lang.inherits(f,mxLib.Command);f.prototype.start=function(b){mxLib.Command.prototype.start.call(this,b);this.options.tip&&mxLib.Util.toastInfo(this.options.tip,{delay:3E3});var a=this;if(this.options.showToolbar){var c=new mxLib.LinkButtonGroupControl([{text:"\u786e\u5b9a\u9009\u62e9",colorIndex:1,callback:function(){a.end(!1)}},{text:"\u53d6\u6d88\u9009\u62e9",colorIndex:2,callback:function(){a.end(!0)}}],{style:"border:1px solid #070;padding:3px",anchor:MX_ANCHOR_BOTTOM_LEFT,offset:new mxLib.Size(10,50),opacity:.7,vLayout:!0});b.addControl(c);this.buttonCtrl=c}if(this.options.showRightMenu){var c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a\u9009\u62e9",scriptBaseDir+"mxImg/ok.png","",function(c){a.options.multiSingel&&b.cancelEntitySelect();a.end(!1)});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88\u9009\u62e9",scriptBaseDir+"mxImg/cancel.png","",function(b){a.end(!0)});c.appendItem(e);b.addContextMenu(c)}this.options.singeSel=!1===this.options.singeSel?!1:!0;this.result=[];this.selEntMap={};b.setCursor("url("+(this.options.singeSel?scriptBaseDir+"mxImg/singleSel.png":scriptBaseDir+"mxImg/rectSel.png")+"),auto")};f.prototype.end=function(b){this.buttonCtrl&&(this.map.removeControl(this.buttonCtrl),this.buttonCtrl=null);this.polygon&&(this.map.removeOverlay(this.polygon),this.polygon=null);var a=this,c=$.isNumeric(this.options.clearSelTime)?this.options.clearSelTime:0;c?setTimeout(function(){a.map.cancelEntitySelect()},c):a.map.cancelEntitySelect();mxLib.Command.prototype.end.call(this,b)};f.prototype.retCmd=function(b,a,c,e){return mxLib.Command.prototype.retCmd(this,b,a,c,e)};f.prototype.leftMousedown=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);this.options.singeSel||this.endPoint||(this.points=[],this.startPoint=c,this.endPoint=this.polygon=null)};f.prototype.mousemove=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);!this.options.singeSel&&this.startPoint&&(this.polygon?(this.points[1].x=c.x,this.points[2]=c,this.points[3].y=c.y,this.polygon.setPath(this.points),c.x<this.startPoint.x?(this.polygon.setFillColor("#C0FFC0"),this.polygon.setStrokeStyle("dashed")):(this.polygon.setFillColor("#C0C0FF"),this.polygon.setStrokeStyle("solid")),this.endPoint=c):(this.points.push(this.startPoint),this.points.push(new mxLib.Point(c.x,this.startPoint.y)),this.points.push(c),this.points.push(new mxLib.Point(this.startPoint.x,c.y)),c=new mxLib.Polygon(this.points,{strokeColor:"#3399FF",fillColor:"#C0C0FF",strokeWidth:1,strokeOpacity:.9,enableClicking:!1}),this.map.addOverlay(c),this.polygon=c))};f.prototype.leftMouseup=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);this.mouseClickPoint=c;if(this.options.singeSel)c=this.map.getEntityByPoint(c.x,c.y,this.options.typeOpt,this.options.attOpt),""!=c&&(c=$.parseJSON(c),c.handle&&this.map.setEntityAttribute(c.handle,"DWG_ENT_HIGHLIGHT","true"),this.result.push(c),this.selEntMap[c.handle]=c.handle,this.options.multiSingel||this.end(!1));else{if(this.polygon){this.map.removeOverlay(this.polygon);var e=1;if(this.endPoint&&this.startPoint&&(this.endPoint.x<this.startPoint.x&&(e=2),e=this.map.getEntityByBounds(this.startPoint.x,this.startPoint.y,c.x,c.y,this.options.typeOpt,this.options.attOpt,e),""!=e)){for(var e=$.parseJSON(e),g=0;g<e.length;g++)c=e[g],this.selEntMap[c.handle]||(this.map.setEntityAttribute(c.handle,"DWG_ENT_HIGHLIGHT","true",!1),this.result.push(c),this.selEntMap[c.handle]=c.handle);this.map.update()}}else c=this.map.getEntityByPoint(c.x,c.y,this.options.typeOpt,this.options.attOpt),""!=c&&(c=$.parseJSON(c),this.selEntMap[c.handle]||(c.handle&&this.map.setEntityAttribute(c.handle,"DWG_ENT_HIGHLIGHT","true"),this.result.push(c),this.selEntMap[c.handle]=c.handle));this.endPoint=this.startPoint=this.polygon=null}};f.prototype.rightMouseup=function(b,a){this.map.showContextMenu(b)}})();(function(){var f=mxLib.DrawCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.mode=null};mxLib.Lang.inherits(f,mxLib.Command);f.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=new mxLib.DrawingTool(this,this.options.drawToolOpts);a.addControl(b);this.drawingTool=b};f.prototype.end=function(a){this.drawingTool&&(this.map.removeControl(this.drawingTool),this.drawingTool=null);this.mode=null;mxLib.Command.prototype.end.call(this,a)};f.prototype.retCmd=function(f,h,n,l){"\u753b\u70b9"==h?this.map.startCommand(new b("\u753b\u70b9",this)):"\u753b\u6298\u7ebf"==h?this.map.startCommand(new a("\u753b\u6298\u7ebf",this)):"\u753b\u591a\u8fb9\u5f62"==h?this.map.startCommand(new g("\u753b\u591a\u8fb9\u5f62",this)):"\u753b\u77e9\u5f62"==h?this.map.startCommand(new e("\u753b\u77e9\u5f62",this)):"\u753b\u5706"==h&&this.map.startCommand(new c("\u753b\u5706",this));return mxLib.Command.prototype.retCmd(this,f,h,n,l)};f.prototype.setDrawingMode=function(f){"exithander"==f?this.end(!1):"marker"==f?this.map.startCommand(new b("\u753b\u70b9",this)):"polyline"==f?this.map.startCommand(new a("\u753b\u6298\u7ebf",this)):"circle"==f?this.map.startCommand(new c("\u753b\u5706",this)):"rectangle"==f?this.map.startCommand(new e("\u753b\u77e9\u5f62",this)):"polygon"==f&&this.map.startCommand(new g("\u753b\u591a\u8fb9\u5f62",this))};f.prototype.rightMouseup=function(a,b){};f.prototype.keypress=function(a,b){27==a.charCode&&this.end(!0)};f.prototype.fireAddOverlayEvent=function(a){mxLib.Util.dispatchEvent(this,"addOverlay",{overlay:a})};f.prototype.addEventListener=function(a,b){return mxLib.Command.prototype.addEventListener.call(this,a,b)};var b=mxLib.DrawDotCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.options.drawOneDot=!0===this.options.drawOneDot?!0:!1};mxLib.Lang.inherits(b,mxLib.Command);b.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.dotStyle||1==this.options.isIcon?this.options.isIcon?(c=new mxLib.Marker(c,this.options),this.map.addOverlay(c),this.dot=c):(this.dot=c=new mxLib.Marker(c,{icon:new mxLib.Symbol(this.dotStyle,{scale:2,fillColor:"yellow",fillOpacity:.8})}),this.map.addOverlay(c)):(c=new mxLib.Marker(c),this.map.addOverlay(c),this.dot=c);this.parentCmd&&this.parentCmd.fireAddOverlayEvent(c);this.options.drawOneDot&&this.end(!1)};b.prototype.rightMouseup=function(a,b){for(var c in this.contextMenu.menuItems)this.contextMenu.menuItems.hasOwnProperty(c)&&this.contextMenu.unCheckItem(this.contextMenu.menuItems[c].text);this.contextMenu.checkItem(this.dotStyleName);this.map.showContextMenu(a)};b.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor);var b=this,c=new mxLib.ContextMenu;this.dotStyleName="\u9ed8\u8ba4\u70b9\u7b26\u53f7";var e=new mxLib.MenuItem("\u9ed8\u8ba4\u70b9\u7b26\u53f7","","",function(a){b.dotStyle=null;b.dotStyleName="\u9ed8\u8ba4\u70b9\u7b26\u53f7"});c.appendItem(e);for(var g=[{name:"\u4e94\u89d2\u661f",style:4},{name:"\u5b9a\u4f4d\u70b9\u56fe\u6807",style:9},{name:"\u98de\u673a",style:10},{name:"\u7167\u76f8\u673a",style:11},{name:"\u8b66\u544a\u7b26\u53f7",style:12},{name:"\u7b11\u8138\u5f62\u72b6",style:13},{name:"\u949f\u8868\u5f62\u72b6",style:14},{name:"- \u9000\u51fa\u7ed8\u5236\u547d\u4ee4 -",style:0}],e=function(a){return function(){0==g[a].style&&b.end(!0);b.dotStyle=g[a].style;b.dotStyleName=g[a].name}},f=0;f<g.length;f++){var r=new mxLib.MenuItem(g[f].name,"","",e(f));c.appendItem(r)}a.addContextMenu(c);this.contextMenu=c;!a._drawDotToast&&this.options.drawDotToast&&(a._drawDotToast=!0,mxLib.Util.toastInfo("\u70b9\u51fb\u53f3\u952e\u53ef\u6539\u53d8\u70b9\u7b26\u53f7",{delay:1E3,align:"left",offset:{from:"top",amount:80}}))};b.prototype.getDrawOverlay=function(){return this.dot};b.prototype.dblclick=function(a,b){this.end()};b.prototype.end=function(a){this.map.removeContextMenu(this.contextMenu);mxLib.Command.prototype.end.call(this,a)};var a=mxLib.DrawPolylineCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.points=[];this.options.strokeColor=this.options.strokeColor||"green";this.options.strokeWidth=this.options.strokeWidth||3;this.options.strokeOpacity=this.options.strokeOpacity||.9;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.options.strokeStyle||"solid"};mxLib.Lang.inherits(a,mxLib.Command);a.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.points.push(c);1==this.points.length?(this.points.push(c),c=new mxLib.Polyline(this.points,this.options),this.map.addOverlay(c),this.polyline=c):(this.points[this.points.length-1]=c,this.polyline.setPath(this.points))};a.prototype.dblclick=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.points.push(c);this.end()};a.prototype.rightMouseup=function(a,b){0<this.points.length&&this.map.showContextMenu(a)};a.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);0<this.points.length&&this.polyline.setPositionAt(this.polyline.getPath().length-1,c)};a.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=this,c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a","","",function(a){2<b.points.length&&b.points.pop();b.end()});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88","","",function(a){b.points.length=1;b.end()});c.appendItem(e);a.addContextMenu(c);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};a.prototype.getDrawOverlay=function(){return this.polyline};a.prototype.end=function(a){0<this.points.length&&(this.points.pop(),this.polyline.setPath(this.points),this.parentCmd&&this.parentCmd.fireAddOverlayEvent(this.polyline));mxLib.Command.prototype.end.call(this,a)};var c=mxLib.DrawCircleCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.options.strokeColor=this.options.strokeColor||"blue";this.options.fillColor=this.options.fillColor||"green";this.options.strokeWidth=this.options.strokeWidth||2;this.options.strokeOpacity=this.options.strokeOpacity||.2;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.strokeStyle||"solid";this.options.fillOpacity=this.fillOpacity||.65};mxLib.Lang.inherits(c,mxLib.Command);c.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=this,c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a","","",function(a){b.end()});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88","","",function(a){b.end(!0)});c.appendItem(e);a.addContextMenu(c);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};c.prototype.rightMouseup=function(a,b){this.centerPoint&&this.map.showContextMenu(a)};c.prototype.leftMousedown=function(a,b){mxLib.Util.getEventPoint(this.map,a)};c.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.centerPoint&&(this.circle?this.circle.setRadius(this.centerPoint.distanceTo(c)):(c=new mxLib.Circle(this.centerPoint,this.centerPoint.distanceTo(c),this.options),this.map.addOverlay(c),this.circle=c))};c.prototype.getDrawOverlay=function(){return this.circle};c.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.centerPoint?this.end():this.centerPoint=c};c.prototype.end=function(a){a?this.circle&&(this.map.removeOverlay(this.circle),this.centerPoint=null):this.parentCmd&&this.circle&&this.parentCmd.fireAddOverlayEvent(this.circle);mxLib.Command.prototype.end.call(this,a)};var e=mxLib.DrawRectCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.points=[];this.options.strokeColor=this.options.strokeColor||"orange";this.options.fillColor=this.options.fillColor||"#FFA0FD";this.options.strokeWidth=this.options.strokeWidth||3;this.options.strokeOpacity=this.options.strokeOpacity||.9;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.options.strokeStyle||"solid";this.options.fillOpacity=this.options.fillOpacity||.65};mxLib.Lang.inherits(e,mxLib.Command);e.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};e.prototype.leftMousedown=function(a,b){mxLib.Util.getEventPoint(this.map,a)};e.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.startPoint&&(this.polygon?(this.points[1].x=c.x,this.points[2]=c,this.points[3].y=c.y,this.polygon.setPath(this.points)):(this.points.push(this.startPoint),this.points.push(new mxLib.Point(c.x,this.startPoint.y)),this.points.push(c),this.points.push(new mxLib.Point(this.startPoint.x,c.y)),c=new mxLib.Polygon(this.points,this.options),this.map.addOverlay(c),this.polygon=c))};e.prototype.getDrawOverlay=function(){return this.polygon};e.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.startPoint?(this.parentCmd&&this.polygon&&this.parentCmd.fireAddOverlayEvent(this.polygon),this.end()):this.startPoint=c};e.prototype.end=function(a){a?this.polygon&&(this.map.removeOverlay(this.polygon),this.polygon=null):this.parentCmd&&this.polygon&&this.parentCmd.fireAddOverlayEvent(this.polygon);mxLib.Command.prototype.end.call(this,a)};var g=mxLib.DrawPolygonCommand=function(a,b,c){mxLib.Command.prototype.constructor.call(this,a,b,c);this.points=[];this.options.strokeColor=this.options.strokeColor||"red";this.options.fillColor=this.options.fillColor||"yellow";this.options.strokeWidth=this.options.strokeWidth||3;this.options.strokeOpacity=this.options.strokeOpacity||.9;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.options.strokeStyle||"solid";this.options.fillOpacity=this.options.fillOpacity||.65};mxLib.Lang.inherits(g,mxLib.Command);g.prototype.leftMouseup=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);0==this.points.length?(this.points.push(c),this.points.push(c),c=new mxLib.Polygon(this.points,this.options),this.map.addOverlay(c),this.polygon=c):(this.points[this.points.length-1]=c,this.points.push(c),this.polygon.setPath(this.points))};g.prototype.getDrawOverlay=function(){return this.polygon};g.prototype.rightMouseup=function(a,b){0<this.points.length&&this.map.showContextMenu(a)};g.prototype.mousemove=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);0<this.points.length&&this.polygon.setPositionAt(this.polygon.getPath().length-1,c)};g.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=this,c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u786e\u5b9a","","",function(a){2<b.points.length&&b.points.pop();b.end()});c.appendItem(e);e=new mxLib.MenuItem("\u53d6\u6d88","","",function(a){b.points.length=1;b.end()});c.appendItem(e);a.addContextMenu(c);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};g.prototype.dblclick=function(a,b){var c=mxLib.Util.getEventPoint(this.map,a);this.points.push(c);this.end()};g.prototype.end=function(a){0<this.points.length&&(this.points.pop(),this.polygon.setPath(this.points),this.parentCmd&&this.parentCmd.fireAddOverlayEvent(this.polygon));mxLib.Command.prototype.end.call(this,a)}})();(function(){var f=mxLib.RectZoomCmd=function(b,a,c){mxLib.Command.prototype.constructor.call(this,b,a,c)};mxLib.Lang.inherits(f,mxLib.Command);f.prototype.start=function(b){mxLib.Command.prototype.start.call(this,b);this.points=[];b.setCursor("crosshair");var a=this,c=new mxLib.ContextMenu,e=new mxLib.MenuItem("\u9000\u51fa\u547d\u4ee4","","",function(b){a.end()});c.appendItem(e);b.addContextMenu(c)};f.prototype.leftMousedown=function(b,a){mxLib.Util.getEventPoint(this.map,b)};f.prototype.mousemove=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);this.startPoint&&(this.polygon?(this.points[1].x=c.x,this.points[2]=c,this.points[3].y=c.y,this.polygon.setPath(this.points),this.endPoint=c):(this.points.push(this.startPoint),this.points.push(new mxLib.Point(c.x,this.startPoint.y)),this.points.push(c),this.points.push(new mxLib.Point(this.startPoint.x,c.y)),c=new mxLib.Polygon(this.points,{strokeColor:"#3399FF",fillColor:"#A8CAEC",strokeWidth:1,strokeOpacity:.9,enableClicking:!1}),this.map.addOverlay(c),this.polygon=c))};f.prototype.leftMouseup=function(b,a){var c=mxLib.Util.getEventPoint(this.map,b);null==this.startPoint?this.startPoint=c:(this.polygon&&this.map.removeOverlay(this.polygon),this.startPoint&&this.endPoint&&this.map.setViewport(new mxLib.Bounds(this.startPoint,this.endPoint)),this.endPoint=this.startPoint=this.polygon=null,this.points=[],this.options.runOnce&&this.end())};f.prototype.rightMouseup=function(b,a){this.map.showContextMenu(b)};f.prototype.end=function(b){this.polygon&&this.map.removeOverlay(this.polygon);mxLib.Command.prototype.end.call(this,b)}})();(function(){function f(a){var b=null;a==mxLib.PlotTypes.ATTACK_ARROW?b=new mxLib.Plot.AttackArrowDrawCmd(a):a==mxLib.PlotTypes.SQUAD_COMBAT?b=new mxLib.Plot.SquadCombatDrawCmd(a):a==mxLib.PlotTypes.TAILED_ATTACK_ARROW?b=new mxLib.Plot.TailedAttackArrowDrawCmd(a):a==mxLib.PlotTypes.TAILED_SQUAD_COMBAT?b=new mxLib.Plot.TailedSquadCombatDrawCmd(a):a==mxLib.PlotTypes.DOUBLE_ARROW?b=new mxLib.Plot.DoubleArrowDrawCmd(a):a==mxLib.PlotTypes.ELLIPSE?b=new mxLib.Plot.EllipseDrawCmd(a):a==mxLib.PlotTypes.FINE_ARROW?b=new mxLib.Plot.FineArrowDrawCmd(a):a==mxLib.PlotTypes.GATHERING_PLACE?b=new mxLib.Plot.GatheringPlaceDrawCmd(a):a==mxLib.PlotTypes.LUNE?b=new mxLib.Plot.LuneDrawCmd(a):a==mxLib.PlotTypes.SECTOR?b=new mxLib.Plot.SectorDrawCmd(a):a==mxLib.PlotTypes.STRAIGHT_ARROW?b=new mxLib.Plot.StraightArrowDrawCmd(a):a==mxLib.PlotTypes.CLOSED_CURVE?b=new mxLib.Plot.ClosedCurveDrawCmd(a):a==mxLib.PlotTypes.ARC?b=new mxLib.Plot.ArcDrawCmd(a):a==mxLib.PlotTypes.STRAIGHT_ARROW?b=new mxLib.Plot.StraightArrowDrawCmd(a):a==mxLib.PlotTypes.CURVE&&(b=new mxLib.Plot.CurveDrawCmd(a));return b}mxLib.Plot=mxLib.Plot||{};mxLib.Plot.PlotGeoUtils=PlotGeoUtils={};PlotGeoUtils.Constants={TWO_PI:2*Math.PI,HALF_PI:Math.PI/2,FITTING_COUNT:100,ZERO_TOLERANCE:1E-6};PlotGeoUtils.distance=function(a,b){return $.isArray(a)?Math.sqrt(Math.pow(a[0]-b[0],2)+Math.pow(a[1]-b[1],2)):mxLib.Util.distance(a,b)};PlotGeoUtils.wholeDistance=function(a){for(var b=0,e=0;e<a.length-1;e++)b+=PlotGeoUtils.distance(a[e],a[e+1]);return b};PlotGeoUtils.getBaseLength=function(a){return Math.pow(PlotGeoUtils.wholeDistance(a),.99)};PlotGeoUtils.pt2Arr=function(a){return[a.x,a.y]};PlotGeoUtils.mid=function(a,b){return[(a[0]+b[0])/2,(a[1]+b[1])/2]};PlotGeoUtils.getCircleCenterOfThreePoints=function(a,b,e){var g=[(a[0]+b[0])/2,(a[1]+b[1])/2],f=[(a[0]+e[0])/2,(a[1]+e[1])/2];return PlotGeoUtils.getIntersectPoint(g,[g[0]-a[1]+b[1],g[1]+a[0]-b[0]],f,[f[0]-a[1]+e[1],f[1]+a[0]-e[0]])};PlotGeoUtils.getIntersectPoint=function(a,b,e,g){if(a[1]==b[1])return g=(g[0]-e[0])/(g[1]-e[1]),b=g*(a[1]-e[1])+e[0],e=a[1],[b,e];if(e[1]==g[1])return b=(b[0]-a[0])/(b[1]-a[1]),b=b*(e[1]-a[1])+a[0],e=e[1],[b,e];b=(b[0]-a[0])/(b[1]-a[1]);g=(g[0]-e[0])/(g[1]-e[1]);e=(b*a[1]-a[0]-g*e[1]+e[0])/(b-g);b=b*e-b*a[1]+a[0];return[b,e]};PlotGeoUtils.getAzimuth=function(a,b){var e,g=Math.asin(Math.abs(b[1]-a[1])/PlotGeoUtils.distance(a,b));b[1]>=a[1]&&b[0]>=a[0]?e=g+Math.PI:b[1]>=a[1]&&b[0]<a[0]?e=PlotGeoUtils.Constants.TWO_PI-g:b[1]<a[1]&&b[0]<a[0]?e=g:b[1]<a[1]&&b[0]>=a[0]&&(e=Math.PI-g);return e};PlotGeoUtils.getAngleOfThreePoints=function(a,b,e){a=PlotGeoUtils.getAzimuth(b,a)-PlotGeoUtils.getAzimuth(b,e);return 0>a?a+PlotGeoUtils.Constants.TWO_PI:a};PlotGeoUtils.isClockWise=function(a,b,e){return(e[1]-a[1])*(b[0]-a[0])>(b[1]-a[1])*(e[0]-a[0])};PlotGeoUtils.getPointOnLine=function(a,b,e){return[b[0]+a*(e[0]-b[0]),b[1]+a*(e[1]-b[1])]};PlotGeoUtils.getCubicValue=function(a,b,e,g,f){a=Math.max(Math.min(a,1),0);var h=1-a,n=a*a,l=n*a,m=h*h,q=m*h;return[q*b[0]+3*m*a*e[0]+3*h*n*g[0]+l*f[0],q*b[1]+3*m*a*e[1]+3*h*n*g[1]+l*f[1]]};PlotGeoUtils.getThirdPoint=function(a,b,e,g,f){a=PlotGeoUtils.getAzimuth(a,b);f=f?a+e:a-e;e=g*Math.cos(f);g*=Math.sin(f);return[b[0]+e,b[1]+g]};PlotGeoUtils.getArcPoints=function(a,b,e,g){for(var f,h=[],n=g-e,n=0>n?n+PlotGeoUtils.Constants.TWO_PI:n,l=0;l<=PlotGeoUtils.Constants.FITTING_COUNT;l++)f=e+n*l/PlotGeoUtils.Constants.FITTING_COUNT,g=a[0]+b*Math.cos(f),f=a[1]+b*Math.sin(f),h.push([g,f]);return h};PlotGeoUtils.getBisectorNormals=function(a,b,e,g){var f=PlotGeoUtils.getNormal(b,e,g),h=Math.sqrt(f[0]*f[0]+f[1]*f[1]),n=f[0]/h,f=f[1]/h,l=PlotGeoUtils.distance(b,e),m=PlotGeoUtils.distance(e,g);h>PlotGeoUtils.Constants.ZERO_TOLERANCE?PlotGeoUtils.isClockWise(b,e,g)?(g=a*l,h=e[0]-g*f,l=e[1]+g*n,b=[h,l],g=a*m,h=e[0]+g*f,l=e[1]-g*n):(g=a*l,h=e[0]+g*f,l=e[1]-g*n,b=[h,l],g=a*m,h=e[0]-g*f,l=e[1]+g*n):(h=e[0]+a*(b[0]-e[0]),l=e[1]+a*(b[1]-e[1]),b=[h,l],h=e[0]+a*(g[0]-e[0]),l=e[1]+a*(g[1]-e[1]));a=[h,l];return[b,a]};PlotGeoUtils.getNormal=function(a,b,e){var g=a[0]-b[0];a=a[1]-b[1];var f=Math.sqrt(g*g+a*a),g=g/f;a/=f;f=e[0]-b[0];b=e[1]-b[1];e=Math.sqrt(f*f+b*b);return[g+f/e,a+b/e]};PlotGeoUtils.getCurvePoints=function(a,b){for(var e=[PlotGeoUtils.getLeftMostControlPoint(a,b)],g=0;g<b.length-2;g++)var f=b[g],h=b[g+1],f=PlotGeoUtils.getBisectorNormals(a,f,h,b[g+2]),e=e.concat(f);g=PlotGeoUtils.getRightMostControlPoint(a,b);e.push(g);for(var n=[],g=0;g<b.length-1;g++){f=b[g];h=b[g+1];n.push(f);for(a=0;a<PlotGeoUtils.Constants.FITTING_COUNT;a++){var l=PlotGeoUtils.getCubicValue(a/PlotGeoUtils.Constants.FITTING_COUNT,f,e[2*g],e[2*g+1],h);n.push(l)}n.push(h)}return n};PlotGeoUtils.getLeftMostControlPoint=function(a,b){var e=b[0],g=b[1],f=b[2],h=PlotGeoUtils.getBisectorNormals(0,e,g,f)[0],f=PlotGeoUtils.getNormal(e,g,f);if(Math.sqrt(f[0]*f[0]+f[1]*f[1])>PlotGeoUtils.Constants.ZERO_TOLERANCE)var f=PlotGeoUtils.mid(e,g),n=e[0]-f[0],l=e[1]-f[1],g=2/PlotGeoUtils.distance(e,g),e=-g*l,g=g*n,n=2*e*g,l=h[0]-f[0],m=h[1]-f[1],h=f[0]+(e*e-g*g)*l+n*m,f=f[1]+n*l+(g*g-e*e)*m;else h=e[0]+a*(g[0]-e[0]),f=e[1]+a*(g[1]-e[1]);return[h,f]};PlotGeoUtils.getRightMostControlPoint=function(a,b){var e=b.length,g=b[e-3],f=b[e-2],h=b[e-1],e=PlotGeoUtils.getBisectorNormals(0,g,f,h)[1],g=PlotGeoUtils.getNormal(g,f,h);if(Math.sqrt(g[0]*g[0]+g[1]*g[1])>PlotGeoUtils.Constants.ZERO_TOLERANCE)var g=PlotGeoUtils.mid(f,h),n=h[0]-g[0],l=h[1]-g[1],h=2/PlotGeoUtils.distance(f,h),f=-h*l,h=h*n,n=2*f*h,l=e[0]-g[0],m=e[1]-g[1],e=g[0]+(f*f-h*h)*l+n*m,g=g[1]+n*l+(h*h-f*f)*m;else e=h[0]+a*(f[0]-h[0]),g=h[1]+a*(f[1]-h[1]);return[e,g]};PlotGeoUtils.getBezierPoints=function(a){if(2>=a.length)return a;for(var b=[],e=a.length-1,g=0;1>=g;g+=.01){for(var f=y=0,h=0;h<=e;h++){var n=PlotGeoUtils.getBinomialFactor(e,h),l=Math.pow(g,h),m=Math.pow(1-g,e-h),f=f+n*l*m*a[h][0];y+=n*l*m*a[h][1]}b.push([f,y])}b.push(a[e]);return b};PlotGeoUtils.getBinomialFactor=function(a,b){return PlotGeoUtils.getFactorial(a)/(PlotGeoUtils.getFactorial(b)*PlotGeoUtils.getFactorial(a-b))};PlotGeoUtils.getFactorial=function(a){if(1>=a)return 1;if(2==a)return 2;if(3==a)return 6;if(4==a)return 24;if(5==a)return 120;for(var b=1,e=1;e<=a;e++)b*=e;return b};PlotGeoUtils.getQBSplinePoints=function(a){if(2>=a.length)return a;var b=[],e=a.length-2-1;b.push(a[0]);for(var g=0;g<=e;g++)for(var f=0;1>=f;f+=.05){for(var h=y=0,n=0;2>=n;n++){var l=PlotGeoUtils.getQuadricBSplineFactor(n,f),h=h+l*a[g+n][0];y+=l*a[g+n][1]}b.push([h,y])}b.push(a[a.length-1]);return b};PlotGeoUtils.getQuadricBSplineFactor=function(a,b){return 0==a?Math.pow(b-1,2)/2:1==a?(-2*Math.pow(b,2)+2*b+1)/2:2==a?Math.pow(b,2)/2:0};mxLib.PlotTypes={ARC:"arc",ELLIPSE:"ellipse",CURVE:"curve",CLOSED_CURVE:"closedcurve",LUNE:"lune",SECTOR:"sector",GATHERING_PLACE:"gatheringplace",STRAIGHT_ARROW:"straightarrow",ASSAULT_DIRECTION:"assaultdirection",ATTACK_ARROW:"attackarrow",TAILED_ATTACK_ARROW:"tailedattackarrow",SQUAD_COMBAT:"squadcombat",TAILED_SQUAD_COMBAT:"tailedsquadcombat",FINE_ARROW:"finearrow",CIRCLE:"circle",DOUBLE_ARROW:"doublearrow",POLYLINE:"polyline",FREEHAND_LINE:"freehandline",POLYGON:"polygon",FREEHAND_POLYGON:"freehandpolygon",RECTANGLE:"rectangle",MARKER:"marker",TRIANGLE:"triangle"};var b=mxLib.Plot.PolygonBaseType=function(a,b){mxLib.Polygon.prototype.constructor.call(this,a,b);this.type="";this.controlPoints=[]};mxLib.Lang.inherits(b,mxLib.Polygon);b.prototype.getDrawCmd=function(){return f(this.type)};b.prototype.setControlPoints=function(a){this.controlPoints=a?a:[];1<=this.controlPoints.length&&(a=this.getDrawCmd(),a.setPoints(this.controlPoints),this.setPath(a.resultPoints))};b.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];for(var a=this,b=0;b<this.controlPoints.length;b++){var e=new mxLib.Vertex(this.controlPoints[b],!1);this.map.addOverlay(e);this.vertexs.push(e);e.addEventListener("ondragging",function(b){return function(){0<=b&&b<a.controlPoints.length&&(a.controlPoints[b]=this.point,a.setControlPoints(a.controlPoints))}}(b))}}};b=mxLib.Plot.PolylineBaseType=function(a,b){mxLib.Polyline.prototype.constructor.call(this,a,b);this.type="";this.controlPoints=[]};mxLib.Lang.inherits(b,mxLib.Polyline);b.prototype.getDrawCmd=function(){return f(this.type)};b.prototype.setControlPoints=function(a){this.controlPoints=a?a:[];1<=this.controlPoints.length&&(a=this.getDrawCmd(),a.setPoints(this.controlPoints),this.setPath(a.resultPoints))};b.prototype.enableEditing=function(){if(!this._bEnableEditing){this.options.enableEditing=this._bEnableEditing=!0;this.vertexs=[];for(var a=this,b=0;b<this.controlPoints.length;b++){var e=new mxLib.Vertex(this.controlPoints[b],!1);this.map.addOverlay(e);this.vertexs.push(e);e.addEventListener("ondragging",function(b){return function(){0<=b&&b<a.controlPoints.length&&(a.controlPoints[b]=this.point,a.setControlPoints(a.controlPoints))}}(b))}}};b=mxLib.Plot.AttackArrow=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.ATTACK_ARROW};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.SquadCombat=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.SQUAD_COMBAT};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.TailedAttackArrow=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.TAILED_ATTACK_ARROW};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.TailedSquadCombat=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.TAILED_SQUAD_COMBAT};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.DoubleArrow=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.DOUBLE_ARROW};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.Ellipse=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.ELLIPSE};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.FineArrow=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.FINE_ARROW};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.GatheringPlace=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.GATHERING_PLACE};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.Lune=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.LUNE};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.Sector=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.SECTOR};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.ClosedCurve=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.CLOSED_CURVE};mxLib.Lang.inherits(b,mxLib.Plot.PolygonBaseType);b=mxLib.Plot.StraightArrow=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.STRAIGHT_ARROW};mxLib.Lang.inherits(b,mxLib.Plot.PolylineBaseType);b=mxLib.Plot.Arc=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.ARC};mxLib.Lang.inherits(b,mxLib.Plot.PolylineBaseType);b=mxLib.Plot.Curve=function(a,b){mxLib.Plot.PolygonBaseType.prototype.constructor.call(this,a,b);this.type=mxLib.PlotTypes.CURVE};mxLib.Lang.inherits(b,mxLib.Plot.PolylineBaseType);b=mxLib.Plot.PlotBaseCommand=function(a,b,e){mxLib.Command.prototype.constructor.call(this,a,b,e);this.points=[];this.realPoints=[];this.resultPoints=[];this.options.strokeColor=this.options.strokeColor||"red";this.options.fillColor=this.options.fillColor||"green";this.options.strokeWidth=this.options.strokeWidth||3;this.options.strokeOpacity=this.options.strokeOpacity||.9;this.options.enableClicking=!0===this.options.enableClicking?!0:!1;this.options.strokeStyle=this.options.strokeStyle||"solid";this.options.fillOpacity=this.options.fillOpacity||.25;this.setPoints(this.points);this.overlay=null};b.prototype.setPoints=function(a){this.points=a?a:[];1<=this.points.length&&this.generate()};b.prototype.getPoints=function(){for(var a=[],b=0;b<this.points.length;b++){var e=[];e[0]=this.points[b].x;e[1]=this.points[b].y;a.push(e)}return a};b.prototype.getPointCount=function(){return this.points.length};b.prototype.updatePoint=function(a,b){0<=b&&b<this.points.length&&(this.points[b]=a,this.generate())};b.prototype.updateLastPoint=function(a){this.updatePoint(a,this.points.length-1)};b.prototype.generate=function(){};b.prototype.finishDrawing=function(){};b.prototype.setCoordinates=function(a){if(1==a.length){for(var b=[],e=0;e<a[0].length;e++){var g=a[0][e],g=$.isArray(g)?new mxLib.Point(g[0],g[1]):new mxLib.Point(g.x,g.y);b.push(g)}this.overlay&&mxLib.lang.isFunction(this.overlay.setPath)?this.overlay.setPath(b):this.resultPoints=b.slice(0)}else if(0<a.length){b=[];for(e=0;e<a.length;e++)g=a[e],g=$.isArray(g)?new mxLib.Point(g[0],g[1]):new mxLib.Point(g.x,g.y),b.push(g);this.overlay&&mxLib.lang.isFunction(this.overlay.setPath)?this.overlay.setPath(b):this.resultPoints=b.slice(0)}};b.prototype.createOverlay=function(a,b){var e=null,g=this.type;g==mxLib.PlotTypes.ATTACK_ARROW?e=new mxLib.Plot.AttackArrow(a,this.options):g==mxLib.PlotTypes.SQUAD_COMBAT?e=new mxLib.Plot.SquadCombat(a,this.options):g==mxLib.PlotTypes.TAILED_ATTACK_ARROW?e=new mxLib.Plot.TailedAttackArrow(a,this.options):g==mxLib.PlotTypes.TAILED_SQUAD_COMBAT?e=new mxLib.Plot.TailedSquadCombat(a,this.options):g==mxLib.PlotTypes.DOUBLE_ARROW?e=new mxLib.Plot.DoubleArrow(a,this.options):g==mxLib.PlotTypes.ELLIPSE?e=new mxLib.Plot.Ellipse(a,this.options):g==mxLib.PlotTypes.FINE_ARROW?e=new mxLib.Plot.FineArrow(a,this.options):g==mxLib.PlotTypes.GATHERING_PLACE?e=new mxLib.Plot.GatheringPlace(a,this.options):g==mxLib.PlotTypes.LUNE?e=new mxLib.Plot.Lune(a,this.options):g==mxLib.PlotTypes.SECTOR?e=new mxLib.Plot.Sector(a,this.options):g==mxLib.PlotTypes.STRAIGHT_ARROW?e=new mxLib.Plot.StraightArrow(a,this.options):g==mxLib.PlotTypes.CLOSED_CURVE?e=new mxLib.Plot.ClosedCurve(a,this.options):g==mxLib.PlotTypes.ARC?e=new mxLib.Plot.Arc(a,this.options):g==mxLib.PlotTypes.STRAIGHT_ARROW?e=new mxLib.Plot.StraightArrow(a,this.options):g==mxLib.PlotTypes.CURVE&&(e=new mxLib.Plot.Curve(a,this.options));e||(e=this.isPolyline?new mxLib.Polyline(a,this.options):new mxLib.Polygon(a,this.options));return e};b.prototype.leftMouseup=function(a,b){var e=mxLib.Util.getEventPoint(this.map,a);0==this.realPoints.length?(this.realPoints.push(e),null==this.overlay&&(e=this.createOverlay(this.points,this.options),this.map.addOverlay(e),this.overlay=e)):PlotGeoUtils.distance(e,this.realPoints[this.realPoints.length-1])<PlotGeoUtils.Constants.ZERO_TOLERANCE||(this.realPoints.push(e),this.setPoints(this.realPoints),this.fixPointCount==this.getPointCount()&&this.end())};b.prototype.dblclick=function(a,b){this.end()};b.prototype.rightMouseup=function(a,b){0<this.realPoints.length&&this.map.showContextMenu(a)};b.prototype.mousemove=function(a,b){var e=mxLib.Util.getEventPoint(this.map,a);0<this.realPoints.length&&!(PlotGeoUtils.distance(e,this.realPoints[this.realPoints.length-1])<PlotGeoUtils.Constants.ZERO_TOLERANCE)&&(this.freehand?(this.points.push(e),this.realPoints.push(e),this.setPoints(this.points)):(e=this.realPoints.concat([e]),this.setPoints(e)))};b.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);var b=this,e=new mxLib.ContextMenu,g=new mxLib.MenuItem("\u786e\u5b9a","","",function(a){b.end(!1)});e.appendItem(g);g=new mxLib.MenuItem("\u53d6\u6d88","","",function(a){b.end(!0)});e.appendItem(g);a.addContextMenu(e);void 0===this.options.cursor?a.setCursor("crosshair"):a.setCursor(this.options.cursor)};b.prototype.getDrawOverlay=function(){return this.overlay};b.prototype.end=function(a){this.overlay&&this.parentCmd&&this.parentCmd.fireAddOverlayEvent(this.overlay);a?this.overlay&&map.removeOverlay(this.overlay):this.overlay&&$.isArray(this.overlay.controlPoints)&&(this.overlay.controlPoints=this.realPoints.slice(0));mxLib.Command.prototype.end.call(this,a)};b.prototype.keypress=function(a,b){27==a.charCode&&this.end(!0)};b.prototype.fireAddOverlayEvent=function(a){mxLib.Util.dispatchEvent(this,"addOverlay",{overlay:a})};mxLib.Lang.inherits(b,mxLib.Command);b=mxLib.Plot.AttackArrowDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.ATTACK_ARROW;this.headHeightFactor=.18;this.headWidthFactor=.3;this.neckHeightFactor=.85;this.neckWidthFactor=.15;this.headTailFactor=.8;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){if(!(2>this.getPointCount()))if(2==this.getPointCount())this.setCoordinates([this.points]);else{var a=this.getPoints(),b=a[0],e=a[1];PlotGeoUtils.isClockWise(a[0],a[1],a[2])&&(b=a[1],e=a[0]);var g=[PlotGeoUtils.mid(b,e)].concat(a.slice(2)),a=this.getArrowHeadPoints(g,b,e),f=a[0],h=a[4],n=PlotGeoUtils.distance(b,e)/PlotGeoUtils.getBaseLength(g),g=this.getArrowBodyPoints(g,f,h,n),n=g.length,b=[b].concat(g.slice(0,n/2));b.push(f);e=[e].concat(g.slice(n/2,n));e.push(h);b=PlotGeoUtils.getQBSplinePoints(b);e=PlotGeoUtils.getQBSplinePoints(e);this.setCoordinates([b.concat(a,e.reverse())])}};b.prototype.getArrowHeadPoints=function(a,b,e){var g=PlotGeoUtils.getBaseLength(a),f=g*this.headHeightFactor,h=a[a.length-1],g=PlotGeoUtils.distance(h,a[a.length-2]);b=PlotGeoUtils.distance(b,e);f>b*this.headTailFactor&&(f=b*this.headTailFactor);e=f*this.headWidthFactor;b=f*this.neckWidthFactor;f=f>g?g:f;g=f*this.neckHeightFactor;f=PlotGeoUtils.getThirdPoint(a[a.length-2],h,0,f,!0);g=PlotGeoUtils.getThirdPoint(a[a.length-2],h,0,g,!0);a=PlotGeoUtils.getThirdPoint(h,f,PlotGeoUtils.Constants.HALF_PI,e,!1);f=PlotGeoUtils.getThirdPoint(h,f,PlotGeoUtils.Constants.HALF_PI,e,!0);e=PlotGeoUtils.getThirdPoint(h,g,PlotGeoUtils.Constants.HALF_PI,b,!1);b=PlotGeoUtils.getThirdPoint(h,g,PlotGeoUtils.Constants.HALF_PI,b,!0);return[e,a,h,f,b]};b.prototype.getArrowBodyPoints=function(a,b,e,g){var f=PlotGeoUtils.wholeDistance(a);g*=PlotGeoUtils.getBaseLength(a);b=PlotGeoUtils.distance(b,e);b=(g-b)/2;e=0;for(var h=[],n=[],l=1;l<a.length-1;l++){var m=PlotGeoUtils.getAngleOfThreePoints(a[l-1],a[l],a[l+1])/2;e+=PlotGeoUtils.distance(a[l-1],a[l]);var q=(g/2-e/f*b)/Math.sin(m),r=PlotGeoUtils.getThirdPoint(a[l-1],a[l],Math.PI-m,q,!0),m=PlotGeoUtils.getThirdPoint(a[l-1],a[l],m,q,!1);h.push(r);n.push(m)}return h.concat(n)};b=mxLib.Plot.SquadCombatDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.SQUAD_COMBAT;this.headHeightFactor=.18;this.headWidthFactor=.3;this.neckHeightFactor=.85;this.neckWidthFactor=.15;this.tailWidthFactor=.1;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.AttackArrowDrawCmd);b.prototype.generate=function(){var a=this.getPointCount();if(!(2>a)){var b=this.getPoints(),e=this.getTailPoints(b),g=this.getArrowHeadPoints(b,e[0],e[1]),f=g[0],h=g[4],n=this.getArrowBodyPoints(b,f,h,this.tailWidthFactor),a=n.length,b=[e[0]].concat(n.slice(0,a/2));b.push(f);e=[e[1]].concat(n.slice(a/2,a));e.push(h);b=PlotGeoUtils.getQBSplinePoints(b);e=PlotGeoUtils.getQBSplinePoints(e);this.setCoordinates([b.concat(g,e.reverse())])}};b.prototype.getTailPoints=function(a){var b=PlotGeoUtils.getBaseLength(a)*this.tailWidthFactor,e=PlotGeoUtils.getThirdPoint(a[1],a[0],PlotGeoUtils.Constants.HALF_PI,b,!1);a=PlotGeoUtils.getThirdPoint(a[1],a[0],PlotGeoUtils.Constants.HALF_PI,b,!0);return[e,a]};b=mxLib.Plot.TailedAttackArrowDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.TAILED_ATTACK_ARROW;this.headHeightFactor=.18;this.headWidthFactor=.3;this.neckHeightFactor=.85;this.neckWidthFactor=.15;this.tailWidthFactor=.1;this.headTailFactor=.8;this.swallowTailFactor=1;this.swallowTailPnt=null;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.AttackArrowDrawCmd);b.prototype.generate=function(){var a=this.getPointCount();if(!(2>a))if(2==this.getPointCount())this.setCoordinates([this.points]);else{var b=this.getPoints(),e=b[0],g=b[1];PlotGeoUtils.isClockWise(b[0],b[1],b[2])&&(e=b[1],g=b[0]);var a=[PlotGeoUtils.mid(e,g)].concat(b.slice(2)),b=this.getArrowHeadPoints(a,e,g),f=b[0],h=b[4],n=PlotGeoUtils.distance(e,g),l=PlotGeoUtils.getBaseLength(a);this.swallowTailPnt=PlotGeoUtils.getThirdPoint(a[1],a[0],0,l*this.tailWidthFactor*this.swallowTailFactor,!0);n=this.getArrowBodyPoints(a,f,h,n/l);a=n.length;e=[e].concat(n.slice(0,a/2));e.push(f);g=[g].concat(n.slice(a/2,a));g.push(h);e=PlotGeoUtils.getQBSplinePoints(e);g=PlotGeoUtils.getQBSplinePoints(g);this.setCoordinates([e.concat(b,g.reverse(),[this.swallowTailPnt,e[0]])])}};b=mxLib.Plot.TailedSquadCombatDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.TAILED_SQUAD_COMBAT;this.headHeightFactor=.18;this.headWidthFactor=.3;this.neckHeightFactor=.85;this.neckWidthFactor=.15;this.tailWidthFactor=.1;this.swallowTailFactor=1;this.swallowTailPnt=null;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.AttackArrowDrawCmd);b.prototype.generate=function(){var a=this.getPointCount();if(!(2>a)){var b=this.getPoints(),e=this.getTailPoints(b),g=this.getArrowHeadPoints(b,e[0],e[2]),f=g[0],h=g[4],n=this.getArrowBodyPoints(b,f,h,this.tailWidthFactor),a=n.length,b=[e[0]].concat(n.slice(0,a/2));b.push(f);f=[e[2]].concat(n.slice(a/2,a));f.push(h);b=PlotGeoUtils.getQBSplinePoints(b);f=PlotGeoUtils.getQBSplinePoints(f);this.setCoordinates([b.concat(g,f.reverse(),[e[1],b[0]])])}};b.prototype.getTailPoints=function(a){var b=PlotGeoUtils.getBaseLength(a)*this.tailWidthFactor,e=PlotGeoUtils.getThirdPoint(a[1],a[0],PlotGeoUtils.Constants.HALF_PI,b,!1),g=PlotGeoUtils.getThirdPoint(a[1],a[0],PlotGeoUtils.Constants.HALF_PI,b,!0);a=PlotGeoUtils.getThirdPoint(a[1],a[0],0,b*this.swallowTailFactor,!0);return[e,a,g]};b=mxLib.Plot.DoubleArrowDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.DOUBLE_ARROW;this.headHeightFactor=.25;this.headWidthFactor=.3;this.neckHeightFactor=.85;this.neckWidthFactor=.15;this.tempPoint4=this.connPoint=null;this.fixPointCount=4;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.finishDrawing=function(){3==this.getPointCount()&&null!=this.tempPoint4&&this.points.push(this.tempPoint4);null!=this.connPoint&&this.points.push(this.connPoint)};b.prototype.generate=function(){var a=this.getPointCount();if(!(2>a))if(2==a)this.setCoordinates([this.points]);else{var b=PlotGeoUtils.pt2Arr(this.points[0]),e=PlotGeoUtils.pt2Arr(this.points[1]),g=PlotGeoUtils.pt2Arr(this.points[2]),a=this.getPointCount();this.tempPoint4=3==a?this.getTempPoint4(b,e,g):PlotGeoUtils.pt2Arr(this.points[3]);this.connPoint=3==a||4==a?PlotGeoUtils.mid(b,e):PlotGeoUtils.pt2Arr(this.points[4]);var f;PlotGeoUtils.isClockWise(b,e,g)?(a=this.getArrowPoints(b,this.connPoint,this.tempPoint4,!1),f=this.getArrowPoints(this.connPoint,e,g,!0)):(a=this.getArrowPoints(e,this.connPoint,g,!1),f=this.getArrowPoints(this.connPoint,b,this.tempPoint4,!0));var h=a.length,n=(h-5)/2,e=a.slice(0,n),b=a.slice(n,n+5),a=a.slice(n+5,h),g=f.slice(0,n),l=f.slice(n,n+5);f=f.slice(n+5,h);g=PlotGeoUtils.getBezierPoints(g);e=PlotGeoUtils.getBezierPoints(f.concat(e.slice(1)));a=PlotGeoUtils.getBezierPoints(a);b=g.concat(l,e,b,a);this.setCoordinates([b])}};b.prototype.getArrowPoints=function(a,b,e,g){var f=PlotGeoUtils.mid(a,b),h=PlotGeoUtils.distance(f,e),n=PlotGeoUtils.getThirdPoint(e,f,0,.3*h,!0),l=PlotGeoUtils.getThirdPoint(e,f,0,.5*h,!0),n=PlotGeoUtils.getThirdPoint(f,n,PlotGeoUtils.Constants.HALF_PI,h/5,g),l=PlotGeoUtils.getThirdPoint(f,l,PlotGeoUtils.Constants.HALF_PI,h/4,g),h=[f,n,l,e];e=this.getArrowHeadPoints(h,this.headHeightFactor,this.headWidthFactor,this.neckHeightFactor,this.neckWidthFactor);g=e[0];f=e[4];n=PlotGeoUtils.distance(a,b)/PlotGeoUtils.getBaseLength(h)/2;n=this.getArrowBodyPoints(h,g,f,n);l=n.length;h=n.slice(0,l/2);n=n.slice(l/2,l);h.push(g);n.push(f);h=h.reverse();h.push(b);n=n.reverse();n.push(a);return h.reverse().concat(e,n)};b.prototype.getArrowHeadPoints=function(a,b,e){var g=PlotGeoUtils.getBaseLength(a)*this.headHeightFactor,f=a[a.length-1];PlotGeoUtils.distance(b,e);e=g*this.headWidthFactor;b=g*this.neckWidthFactor;var h=g*this.neckHeightFactor,g=PlotGeoUtils.getThirdPoint(a[a.length-2],f,0,g,!0),h=PlotGeoUtils.getThirdPoint(a[a.length-2],f,0,h,!0);a=PlotGeoUtils.getThirdPoint(f,g,PlotGeoUtils.Constants.HALF_PI,e,!1);e=PlotGeoUtils.getThirdPoint(f,g,PlotGeoUtils.Constants.HALF_PI,e,!0);g=PlotGeoUtils.getThirdPoint(f,h,PlotGeoUtils.Constants.HALF_PI,b,!1);b=PlotGeoUtils.getThirdPoint(f,h,PlotGeoUtils.Constants.HALF_PI,b,!0);return[g,a,f,e,b]};b.prototype.getArrowBodyPoints=function(a,b,e,f){var k=PlotGeoUtils.wholeDistance(a);f*=PlotGeoUtils.getBaseLength(a);b=PlotGeoUtils.distance(b,e);b=(f-b)/2;e=0;for(var h=[],n=[],l=1;l<a.length-1;l++){var m=PlotGeoUtils.getAngleOfThreePoints(a[l-1],a[l],a[l+1])/2;e+=PlotGeoUtils.distance(a[l-1],a[l]);var q=(f/2-e/k*b)/Math.sin(m),r=PlotGeoUtils.getThirdPoint(a[l-1],a[l],Math.PI-m,q,!0),m=PlotGeoUtils.getThirdPoint(a[l-1],a[l],m,q,!1);h.push(r);n.push(m)}return h.concat(n)};b.prototype.getTempPoint4=function(a,b,e){b=PlotGeoUtils.mid(a,b);var f=PlotGeoUtils.distance(b,e),k=PlotGeoUtils.getAngleOfThreePoints(a,b,e);k<PlotGeoUtils.Constants.HALF_PI?(e=f*Math.sin(k),f*=Math.cos(k),a=PlotGeoUtils.getThirdPoint(a,b,PlotGeoUtils.Constants.HALF_PI,e,!1),a=PlotGeoUtils.getThirdPoint(b,a,PlotGeoUtils.Constants.HALF_PI,f,!0)):k>=PlotGeoUtils.Constants.HALF_PI&&k<Math.PI?(e=f*Math.sin(Math.PI-k),f*=Math.cos(Math.PI-k),a=PlotGeoUtils.getThirdPoint(a,b,PlotGeoUtils.Constants.HALF_PI,e,!1),a=PlotGeoUtils.getThirdPoint(b,a,PlotGeoUtils.Constants.HALF_PI,f,!1)):k>=Math.PI&&k<1.5*Math.PI?(e=f*Math.sin(k-Math.PI),f*=Math.cos(k-Math.PI),a=PlotGeoUtils.getThirdPoint(a,b,PlotGeoUtils.Constants.HALF_PI,e,!0),a=PlotGeoUtils.getThirdPoint(b,a,PlotGeoUtils.Constants.HALF_PI,f,!0)):(e=f*Math.sin(2*Math.PI-k),f*=Math.cos(2*Math.PI-k),a=PlotGeoUtils.getThirdPoint(a,b,PlotGeoUtils.Constants.HALF_PI,e,!0),a=PlotGeoUtils.getThirdPoint(b,a,PlotGeoUtils.Constants.HALF_PI,f,!1));return a};b=mxLib.Plot.EllipseDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.ELLIPSE;this.fixPointCount=2;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){if(!(2>this.getPointCount())){var a=PlotGeoUtils.pt2Arr(this.points[0]),b=PlotGeoUtils.pt2Arr(this.points[1]),e=PlotGeoUtils.mid(a,b),f=Math.abs((a[0]-b[0])/2),a=Math.abs((a[1]-b[1])/2);this.setCoordinates([this.generatePoints(e,f,a)])}};b.prototype.generatePoints=function(a,b,e){for(var f,k,h=[],n=0;n<=PlotGeoUtils.Constants.FITTING_COUNT;n++)k=2*Math.PI*n/PlotGeoUtils.Constants.FITTING_COUNT,f=a[0]+b*Math.cos(k),k=a[1]+e*Math.sin(k),h.push([f,k]);return h};b=mxLib.Plot.FineArrowDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.FINE_ARROW;this.tailWidthFactor=.15;this.neckWidthFactor=.2;this.headWidthFactor=.25;this.headAngle=Math.PI/8.5;this.neckAngle=Math.PI/13;this.fixPointCount=2;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){if(!(2>this.getPointCount())){var a=this.getPoints(),b=a[0],e=a[1],f=PlotGeoUtils.getBaseLength(a),k=f*this.tailWidthFactor,a=f*this.neckWidthFactor,h=f*this.headWidthFactor,f=PlotGeoUtils.getThirdPoint(e,b,PlotGeoUtils.Constants.HALF_PI,k,!0),k=PlotGeoUtils.getThirdPoint(e,b,PlotGeoUtils.Constants.HALF_PI,k,!1),n=PlotGeoUtils.getThirdPoint(b,e,this.headAngle,h,!1),h=PlotGeoUtils.getThirdPoint(b,e,this.headAngle,h,!0),l=PlotGeoUtils.getThirdPoint(b,e,this.neckAngle,a,!1),b=PlotGeoUtils.getThirdPoint(b,e,this.neckAngle,a,!0);this.setCoordinates([[f,l,n,e,h,b,k]])}};b=mxLib.Plot.GatheringPlaceDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.GATHERING_PLACE;this.t=.4;this.fixPointCount=3;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){var a=this.getPoints();if(!(2>a.length)){if(2==this.getPointCount())var b=PlotGeoUtils.mid(a[0],a[1]),e=PlotGeoUtils.distance(a[0],b)/.9,f=PlotGeoUtils.getThirdPoint(a[0],b,PlotGeoUtils.Constants.HALF_PI,e,!0),a=[a[0],f,a[1]];b=PlotGeoUtils.mid(a[0],a[2]);a.push(b,a[0],a[1]);b=[];for(e=0;e<a.length-2;e++)var k=a[e],h=a[e+1],f=PlotGeoUtils.getBisectorNormals(this.t,k,h,a[e+2]),b=b.concat(f);for(var e=b.length,b=[b[e-1]].concat(b.slice(0,e-1)),n=[],e=0;e<a.length-2;e++){k=a[e];h=a[e+1];n.push(k);for(var l=0;l<=PlotGeoUtils.Constants.FITTING_COUNT;l++)f=PlotGeoUtils.getCubicValue(l/PlotGeoUtils.Constants.FITTING_COUNT,k,b[2*e],b[2*e+1],h),n.push(f);n.push(h)}this.setCoordinates([n])}};b=mxLib.Plot.LuneDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.LUNE;this.fixPointCount=3;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){if(!(2>this.getPointCount())){var a=this.getPoints();if(2==this.getPointCount()){var b=PlotGeoUtils.mid(a[0],a[1]),e=PlotGeoUtils.distance(a[0],b),b=PlotGeoUtils.getThirdPoint(a[0],b,PlotGeoUtils.Constants.HALF_PI,e);a.push(b)}var e=a[0],f=a[1],k=a[2],a=PlotGeoUtils.getCircleCenterOfThreePoints(e,f,k),b=PlotGeoUtils.distance(e,a),h=PlotGeoUtils.getAzimuth(e,a),n=PlotGeoUtils.getAzimuth(f,a);PlotGeoUtils.isClockWise(e,f,k)?(e=n,f=h):(e=h,f=n);a=PlotGeoUtils.getArcPoints(a,b,e,f);a.push(a[0]);this.setCoordinates([a])}};b=mxLib.Plot.SectorDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.SECTOR;this.fixPointCount=3;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){if(!(2>this.getPointCount()))if(2==this.getPointCount())this.setCoordinates([this.points]);else{var a=this.getPoints(),b=a[0],e=a[1],f=a[2],a=PlotGeoUtils.distance(e,b),e=PlotGeoUtils.getAzimuth(e,b),f=PlotGeoUtils.getAzimuth(f,b),a=PlotGeoUtils.getArcPoints(b,a,e,f);a.push(b,a[0]);this.setCoordinates([a])}};b=mxLib.Plot.StraightArrowDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.STRAIGHT_ARROW;this.fixPointCount=2;this.maxArrowLength=3E6;this.arrowLengthScale=5;this.isPolyline=!0;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){if(!(2>this.getPointCount())){var a=this.getPoints(),b=a[0],a=a[1],e=PlotGeoUtils.distance(b,a)/this.arrowLengthScale,e=e>this.maxArrowLength?this.maxArrowLength:e,f=PlotGeoUtils.getThirdPoint(b,a,Math.PI/6,e,!1),e=PlotGeoUtils.getThirdPoint(b,a,Math.PI/6,e,!0);this.setCoordinates([b,a,f,a,e])}};b=mxLib.Plot.FreehandLineDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.FREEHAND_LINE;this.isPolyline=this.freehand=!0;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){2>this.getPointCount()||this.setCoordinates(this.points)};b=mxLib.Plot.FreehandPolygonDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.FREEHAND_POLYGON;this.freehand=!0;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){2>this.getPointCount()||this.setCoordinates([this.points])};b=mxLib.Plot.ArcDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.ARC;this.fixPointCount=3;this.isPolyline=!0;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){var a=this.getPointCount();if(!(2>a))if(2==a)this.setCoordinates(this.points);else{var a=this.getPoints(),b=a[0],e=a[1],f=a[2],a=PlotGeoUtils.getCircleCenterOfThreePoints(b,e,f),k=PlotGeoUtils.distance(b,a),h=PlotGeoUtils.getAzimuth(b,a),n=PlotGeoUtils.getAzimuth(e,a);PlotGeoUtils.isClockWise(b,e,f)?(b=n,e=h):(b=h,e=n);this.setCoordinates(PlotGeoUtils.getArcPoints(a,k,b,e))}};b=mxLib.Plot.CurveDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.CURVE;this.t=.3;this.isPolyline=!0;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){var a=this.getPointCount();2>a||(2==a?this.setCoordinates(this.points):this.setCoordinates(PlotGeoUtils.getCurvePoints(this.t,this.getPoints())))};b=mxLib.Plot.ClosedCurveDrawCmd=function(a,b,e){mxLib.Plot.PlotBaseCommand.prototype.constructor.call(this,a,b,e);this.type=mxLib.PlotTypes.CLOSED_CURVE;this.t=.3;this.setPoints(this.points)};mxLib.Lang.inherits(b,mxLib.Plot.PlotBaseCommand);b.prototype.generate=function(){var a=this.getPointCount();if(!(2>a))if(2==a)this.setCoordinates([this.points]);else{var b=this.getPoints();b.push(b[0],b[1]);for(var e=[],a=0;a<b.length-2;a++)var f=PlotGeoUtils.getBisectorNormals(this.t,b[a],b[a+1],b[a+2]),e=e.concat(f);a=e.length;e=[e[a-1]].concat(e.slice(0,a-1));f=[];for(a=0;a<b.length-2;a++){var k=b[a],h=b[a+1];f.push(k);for(var n=0;n<=PlotGeoUtils.Constants.FITTING_COUNT;n++){var l=PlotGeoUtils.getCubicValue(n/PlotGeoUtils.Constants.FITTING_COUNT,k,e[2*a],e[2*a+1],h);f.push(l)}f.push(h)}this.setCoordinates([f])}};b=mxLib.Plot.PlotSelCmd=function(a,b,e){mxLib.Command.prototype.constructor.call(this,a,b,e);this.options=e||{};this.point=this.selOverlay=null;this.options.pointSel=!0===this.options.pointSel?!0:!1};mxLib.Lang.inherits(b,mxLib.Command);b.prototype.start=function(a){mxLib.Command.prototype.start.call(this,a);a.setCursor("crosshair")};b.prototype.leftMouseup=function(a,b){var e=mxLib.Util.getEventPoint(this.map,a);if(this.options.pointSel)this.point=e,this.end();else for(var f=0;f<this.map.overlays.length;f++){var k=this.map.overlays[f];if(k&&k.isPointIn&&k.isPointIn(e)){this.selOverlay=k;this.end();break}}};b.prototype.end=function(a){mxLib.Command.prototype.end.call(this,a)};b.prototype.keypress=function(a,b){27==a.charCode&&this.end(!0)};b.prototype.dblclick=function(a,b){this.end()}})();(function(){var f=mxLib.CanvasLayer=function(b){this.entitys=[];this.frameCallbacks={};this.symbolDef={};this.canvasBounds=null;this.options=b||{};this.options.eventMaxEntitys=this.options.eventMaxEntitys||2E3;this.options.speed=!1===this.options.speed?!1:!0;this.drawEntitys={};this.showEntitys=[];this.eventEntitys={};this.entityUniqueId=1;this.layerVisible=null};mxLib.Lang.inherits(f,mxLib.Overlay);f.prototype.initialize=function(b){this.map=b;var a=document.createElement("canvas");this.id=mxLib.Util.createUniqueID("canvas_new_");a.id=this.id;a.style.position="absolute";var c=$(b.container).width()+1*b.mapPaneCanvasExtendPixel,e=$(this.map.container).height();0==e&&MvHost&&MvHost.height&&(e=MvHost.height);e+=1*b.mapPaneCanvasExtendPixel;a.style.width=c+"px";a.style.height=e+"px";a.style.top="0px";a.style.left="0px";this.canvasWidth=c;this.canvasHeight=e;mxLib.Util.initCanvas(a);b.getPanes().mapPane.appendChild(a);this.domElement=a;paper.setup(a);this._setEventDispath();var f=this;b.addEventListener("resize",this.updateWidthHeightFun=function(){f.updateWidthHeight()});paper.view.onFrame=function(a){for(var b in f.frameCallbacks)if(f.frameCallbacks[b])f.frameCallbacks[b](a)};return a};f.prototype.getEventPane=function(){return this.map.getPanes().mapPane};f.prototype.getItems=function(b,a){if(!b)return[];a=!1===a?!1:!0;var c=paper.project.activeLayer.getItems(b);if(a){for(var e=[],f=0;f<c.length;f++)e.push(c[f].entity);return e}return c};f.prototype.getItemsByRect=function(b,a,c,e,f,k,h){k=k||{};f?k.inside=new paper.Rectangle(b,a,c,e):k.overlapping=new paper.Rectangle(b,a,c,e);h=!1===h?!1:!0;b=paper.project.activeLayer.getItems(k);if(h){h=[];for(a=0;a<b.length;a++)h.push(b[a].entity);return h}return b};f.prototype.setLayerVisible=function(b,a,c){this.layerVisible=this.layerVisible||{};this.layerVisible[b]=a;c&&this.update()};f.prototype.getLayerVisible=function(b){this.layerVisible=this.layerVisible||{};return 0==this.layerVisible[b]?!1:!0};f.prototype.updateWidthHeight=function(){if(this.domElement){var b=$(this.map.container).width()+1*this.map.mapPaneCanvasExtendPixel,a=$(this.map.container).height();0==a&&MvHost&&MvHost.height&&(a=MvHost.height);a+=1*this.map.mapPaneCanvasExtendPixel;this.domElement.style.width=b+"px";this.domElement.style.height=a+"px";this.domElement.width=b;this.domElement.height=a;this.canvasWidth=b;this.canvasHeight=a;this.update()}};f.prototype.update=function(){this.clear();var b=this.map;this.canvasBounds=new mxLib.Bounds(b.pixelToPoint(new mxLib.Pixel(0,0)),b.pixelToPoint(new mxLib.Pixel(this.canvasWidth,this.canvasHeight)));var a=b.pixelDistToPointDist(1),c=0,e=[];this.showEntitys=[];for(var f=[new paper.Segment([-1,0],[0,.5522847498307936],[0,-.5522847498307936]),new paper.Segment([0,-1],[-.5522847498307936,0],[.5522847498307936,0]),new paper.Segment([1,0],[0,-.5522847498307936],[0,.5522847498307936]),new paper.Segment([0,1],[.5522847498307936,0],[-.5522847498307936,0])],k=0;k<this.entitys.length;k++){var h=this.entitys[k];h._isdraw=!1;if(this.map.curZoomInRange(h.opts.minZoom,h.opts.maxZoom)&&!(this.layerVisible&&h.opts&&h.opts.layerName&&0==this.layerVisible[h.opts.layerName])&&(h.opts&&h.opts.isAnimate||this.canvasBounds.containsBounds(h.bounds,!1))){h._isdraw=!0;var n=this.drawEntitys[h.uniqueId],l=!1;n&&(l=!0,e.push(n));if(1==h.type||4==h.type||5==h.type||6==h.type||7==h.type){var m=null;if(l){if(m=n,m.removeSegments(),h.dirty){for(var q in h.opts)"bounds"!=q&&(m[q]=h.opts[q]);h.dirty=!1}}else for(q in 1==h.type||4==h.type?m=new paper.Path:5==h.type?m=new paper.Path.Circle(b.pointToPixel(h.points),b.pointDistToPixelDist(h.radius)):6==h.type?(m=new paper.Rectangle(b.pointToPixel(h.points.x-h.radiusx,h.points.y+h.radiusy),new paper.Size(b.pointDistToPixelDist(2*h.radiusx),b.pointDistToPixelDist(2*h.radiusy))),m=new paper.Path.Ellipse(m)):7==h.type&&(m=new paper.Path.Arc(b.pointToPixel(h.ptFrom),b.pointToPixel(h.ptThrough),b.pointToPixel(h.ptTo))),this.drawEntitys[h.uniqueId]=m,m.entity=h,h._drawItem=m,h.opts)"bounds"!=q&&(m[q]=h.opts[q]);if(1==h.type||4==h.type)for(var r=0;r<h.points.length;r++)if(h.points[r].length&&$.isArray(h.points[r])){if(3==h.points[r].length){var t=b.pointToPixel(h.points[r][0]),w;h.points[r][1]instanceof mxLib.Pixel?(w=h.points[r][1],n=h.points[r][2]):(w=b.pointToPixel(h.points[r][1]),n=b.pointToPixel(h.points[r][2]),w.x-=t.x,w.y-=t.y,n.x-=t.x,n.y-=t.y);m.add(new paper.Segment(t,w,n))}}else m.add(new paper.Point(b.pointToPixel(h.points[r])));else if(5==h.type||6==h.type){if(l)for(r=b.pointToPixel(h.points),6==h.type?(t=b.pointDistToPixelDist(h.radiusx),w=b.pointDistToPixelDist(h.radiusy)):w=t=b.pointDistToPixelDist(h.radius),t=new paper.Size(t,w),w=0;4>w;w++)n=f[w],n=new paper.Segment(n._point.multiply(t).add(r),n._handleIn.multiply(t),n._handleOut.multiply(t)),m.add(n)}else 7==h.type&&l&&(m.moveTo(b.pointToPixel(h.ptFrom)),m.arcTo(b.pointToPixel(h.ptThrough),b.pointToPixel(h.ptTo)))}else if(2==h.type||3==h.type){w=null;if(2==h.type&&(w=this.symbolDef[h.symbolName],!w))return;var u=null,u=h.opts.offsetSize?b.pointToPixel(new mxLib.Point(h.points.x+h.opts.offsetSize.x,h.points.y+h.opts.offsetSize.y)):b.pointToPixel(h.points),r=new paper.Point(u),t=null;if(l){t=n;if(h.dirty){for(q in h.opts)"bounds"!=q&&(t[q]=h.opts[q]);h.dirty=!1}t.translate(new paper.Point(u.x-t.pixelPt.x,u.y-t.pixelPt.y));t.pixelPt=u.clone();w=a;paper.Numerical.isZero(t.cellRatio-w)||(t.scale(t.cellRatio/w,r),t.cellRatio=w)}else{var v=null;2==h.type?(t=new paper.SymbolItem(w.def),v=w.anchor):(t=new paper.PointText(r),t.content=h.content,v=h.opts.anchor);this.drawEntitys[h.uniqueId]=t;t.entity=h;h._drawItem=t;t.pixelPt=u.clone();t.cellRatio=a;for(q in h.opts)"bounds"!=q&&(t[q]=h.opts[q]);u=t.bounds.width;w=t.bounds.height;var z=b.pixelDistToPointDist(t.bounds.width);2==h.type&&(t.position=r);.5==v.x&&.5==v.y||t.translate(new paper.Point(m.bounds.width*(.5-v.x),m.bounds.height*(v.y-.5)));h.opts.rotateAngle&&!n&&(n=new paper.Point(0,0),v=new paper.Point(u,0),u=new paper.Point(u,w),w=new paper.Point(0,w),n=n.rotate(h.opts.rotateAngle,n),v=v.rotate(h.opts.rotateAngle,n),u=u.rotate(h.opts.rotateAngle,n),w=w.rotate(h.opts.rotateAngle,n),w=Math.max(Math.abs(u.x-n.x),Math.abs(w.x-v.x)),z=b.pixelDistToPointDist(w),t.rotate(h.opts.rotateAngle,r));w=h.bounds.width/z;t.scale(w,r);t.oldRatio=w}}this.showEntitys.push(this.drawEntitys[h.uniqueId]);if(!l&&this.options.speed){var x=this.drawEntitys[h.uniqueId];x.onMouseDown&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent=this.eventEntitys[h.uniqueId].storeEvent||{},this.eventEntitys[h.uniqueId].storeEvent.onMouseDown=x.onMouseDown);x.onMouseDrag&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent.onMouseDrag=x.onMouseDrag);x.onMouseUp&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent.onMouseUp=x.onMouseUp);x.onClick&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent.onClick=x.onClick);x.onDoubleClick&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent.onDoubleClick=x.onDoubleClick);x.onMouseMove&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent.onMouseMove=x.onMouseMove);x.onMouseEnter&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent.onMouseEnter=x.onMouseEnter);x.onMouseLeave&&(this.eventEntitys[h.uniqueId]||(this.eventEntitys[h.uniqueId]={},this.eventEntitys[h.uniqueId].storeEvent={}),this.eventEntitys[h.uniqueId].storeEvent.onMouseLeave=x.onMouseLeave)}this.eventEntitys[h.uniqueId]&&c++}}if(this.options.speed)if(c>this.options.eventMaxEntitys)for(b=0;b<this.showEntitys.length;b++){if(h=this.showEntitys[b],a=h.entity.uniqueId,this.eventEntitys[a])for(x in this.eventEntitys[a].storeEvent)h[x]=null}else for(b=0;b<this.showEntitys.length;b++)if(h=this.showEntitys[b],a=h.entity.uniqueId,this.eventEntitys[a])for(x in this.eventEntitys[a].storeEvent)h[x]=this.eventEntitys[a].storeEvent[x];paper.project.activeLayer.addChildren(e);this.draw()};f.prototype._setEventDispath=function(){var b=this;this.map.addEventListener("dragend",function(){b.update()});this.map.addEventListener("moveend",function(){b.update()});this.map.addEventListener("zoomend",function(){b.update()})};f.prototype.remove=function(){this.updateWidthHeightFun&&this.map.removeEventListener("resize",this.updateWidthHeightFun);mxLib.Overlay.prototype.remove.call(this)};f.prototype.draw=function(){mxLib.Overlay.prototype.draw.call(this);this.domElement&&this.domElement.getContext("2d")&&paper.view.draw()};f.prototype.clear=function(){paper.project.clear()};f.prototype.addFrameCallback=function(b,a){this.frameCallbacks[b]=a};f.prototype.removeFrameCallback=function(b){this.frameCallbacks[b]&&delete this.frameCallbacks[b]};f.prototype.addEventListener=function(b,a){return mxLib.lang.Class.prototype.addEventListener.call(this,b,a)};f.prototype.removeEventListener=function(b,a){mxLib.lang.Class.prototype.removeEventListener.call(this,b,a)};f.prototype.addPolyline=function(b,a){var c={};a=a||{strokeColor:"black"};c.opts=a;c.uniqueId=this.entityUniqueId++;c.bounds=a.bounds||mxLib.Util.getPointArrayBounds(b);c.points=b;c.type=1;c.opts.minZoom=a.minZoom||0;c.opts.maxZoom=a.maxZoom||0;this.entitys.push(c);return c};f.prototype.addSymbolDefinition=function(b,a,c){if(null==a)this.symbolDef[b]&&delete this.symbolDef[b];else{c=c||new mxLib.Point(.5,.5);var e=new paper.SymbolDefinition(a);this.symbolDef[b]={def:e,anchor:c,bounds:a.bounds}}};f.prototype.addSymbol=function(b,a,c){this.symbolDef[b]||console.log("symbol"+b+"is not define!!!");var e={};c=c||{};e.opts=c;e.uniqueId=this.entityUniqueId++;e.type=2;e.symbolName=b;e.points=a;e.opts.minZoom=c.minZoom||0;e.opts.maxZoom=c.maxZoom||0;if(!c.bounds&&c.geoWidth){var f=c.geoWidth,k=this.symbolDef[b].bounds.height*f/this.symbolDef[b].bounds.width;c.bounds=new mxLib.Bounds(a.x-this.symbolDef[b].anchor.x*f,a.y-this.symbolDef[b].anchor.y*k,a.x+(1-this.symbolDef[b].anchor.x)*f,a.y+(1-this.symbolDef[b].anchor.y)*k)}e.bounds=c.bounds;this.entitys.push(e);return e};f.prototype.addText=function(b,a,c){var e={};c=c||{strokeColor:"black"};e.opts=c;e.uniqueId=this.entityUniqueId++;e.type=3;e.content=a;e.points=b;e.opts.anchor=e.opts.anchor||new mxLib.Point(.5,.5);e.opts.minZoom=c.minZoom||0;e.opts.maxZoom=c.maxZoom||0;if(!c.bounds&&c.charGeoWidth){a=c.charGeoWidth*a.length;var f=1.5*c.charGeoWidth;c.bounds=new mxLib.Bounds(b.x-e.opts.anchor.x*a,b.y-e.opts.anchor.y*f,b.x+(1-e.opts.anchor.x)*a,b.y+(1-e.opts.anchor.y)*f)}e.bounds=c.bounds;this.entitys.push(e);return e};f.prototype.addPath=function(b,a){var c={};a=a||{strokeColor:"black"};c.opts=a;c.uniqueId=this.entityUniqueId++;for(var e=[],f=0;f<b.length;f++)$.isArray(b[f])?e.push(b[f][0]):e.push(b[f]);c.bounds=a.bounds||mxLib.Util.getPointArrayBounds(b);c.points=b;c.type=4;c.opts.minZoom=a.minZoom||0;c.opts.maxZoom=a.maxZoom||0;this.entitys.push(c);return c};f.prototype.addCircle=function(b,a,c){var e={};c=c||{strokeColor:"black"};e.opts=c;e.uniqueId=this.entityUniqueId++;var f=[];c.bounds||(f.push(new mxLib.Point(b.x-a,b.y-a)),f.push(new mxLib.Point(b.x+a,b.y-a)),f.push(new mxLib.Point(b.x-a,b.y+a)),f.push(new mxLib.Point(b.x+a,b.y+a)));e.bounds=c.bounds||mxLib.Util.getPointArrayBounds(f);e.points=b;e.radius=a;e.type=5;e.opts.minZoom=c.minZoom||0;e.opts.maxZoom=c.maxZoom||0;this.entitys.push(e);return e};f.prototype.addEllipse=function(b,a,c,e){var f={};e=e||{strokeColor:"black"};f.opts=e;f.uniqueId=this.entityUniqueId++;var k=[];e.bounds||(k.push(new mxLib.Point(b.x-a,b.y-c)),k.push(new mxLib.Point(b.x+a,b.y-c)),k.push(new mxLib.Point(b.x-a,b.y+c)),k.push(new mxLib.Point(b.x+a,b.y+c)));f.bounds=e.bounds||mxLib.Util.getPointArrayBounds(k);f.points=b;f.radiusx=a;f.radiusy=c;f.type=6;f.opts.minZoom=e.minZoom||0;f.opts.maxZoom=e.maxZoom||0;this.entitys.push(f);return f};f.prototype.addArc=function(b,a,c,e){var f={};e=e||{strokeColor:"black"};f.opts=e;f.uniqueId=this.entityUniqueId++;var k=[];e.bounds||(k.push(b),k.push(a),k.push(c));f.bounds=e.bounds||mxLib.Util.getPointArrayBounds(k);f.points=b;f.ptFrom=b;f.ptThrough=a;f.ptTo=c;f.type=7;f.opts.minZoom=e.minZoom||0;f.opts.maxZoom=e.maxZoom||0;this.entitys.push(f);return f};f.prototype.deleteEntity=function(b,a){var c=!1,e=!1===a?!1:!0;if("object"==typeof b)for(var f=this.entitys.length-1;0<=f;f--)b[this.entitys[f].uniqueId]&&(this.entitys.splice(f,1),c=!0);else for(f=this.entitys.length-1;0<=f;f--)if(b==this.entitys[f].uniqueId){this.entitys.splice(f,1);c=!0;break}c&&e&&this.update();return c};f.prototype.getEntity=function(b){for(var a=this.entitys.length-1;0<=a;a--)if(b==this.entitys[a].uniqueId)return this.entitys[a];return null};f.prototype.getDrawElement=function(b){for(var a=this.entitys.length-1;0<=a;a--)if(b==this.entitys[a].uniqueId)return this.entitys[a]._drawItem;return null};f.prototype.addPathAnimate=function(b,a){a=a||{};var c=this.addPolyline(b,{strokeColor:"red",strokeWidth:1,visible:!1,isAnimate:!1}),e=null,e=a.pathData?new paper.CompoundPath(a.pathData):new paper.CompoundPath({children:[new paper.Path({segments:a.segments||[[10,0],[0,2.5],[2,0],[0,-2.5]]})]});e.fillColor=a.fillColor||"green";var f=a.symbolName||"_sys_arrow";this.symbolDef[f]||this.addSymbolDefinition(f,e,a.anchor||new mxLib.Point(.5,.5));e=a;e.geoWidth=.003*(a.arrowScale||1);e.isAnimate=!0;var k=this,h=this.addSymbol(f,c.points[0],e),n=this.entityUniqueId++;this.addFrameCallback("animate"+n,function(b){if(c._isdraw){var e=c._drawItem;if(e){var f=h._drawItem;if(f){var g=16*(a.time||10);a.runOnce&&b.count>g?k.deletePathAnimate(n):(g=b.count%g*e.length/g,b=e.getPointAt(g),e=e.getTangentAt(g).angle,0>e&&(e+=360),75<e&&255>e&&a.autoReverse&&(e=180+e),f.rotate(-f.getRotation(),b),f.setPosition(b),g=a.anchor,!g||.5==g.x&&.5==g.y||f.translate(new paper.Point(f.bounds.width*(.5-g.x),f.bounds.height*(g.y-.5))),f.rotate(e,b),a.noScaleZoom&&(e=k.map.getZoom(),f.__scalezoom||(f.__scalezoom=a.noScaleZoom),e>a.noScaleZoom&f.__scalezoom!=e&&(f.scale(Math.pow(2,f.__scalezoom-a.noScaleZoom)/Math.pow(2,e-a.noScaleZoom)),f.__scalezoom=e)))}}}});this.animateElement=this.animateElement||{};f={};f.route=c.uniqueId;f.arrow=h.uniqueId;f.callbackKey="animate"+n;this.animateElement[n]=f;return n};f.prototype.deletePathAnimate=function(b){if(this.animateElement&&(b=this.animateElement[b])){var a={};a[b.route]=!0;a[b.arrow]=!0;this.deleteEntity(a);this.removeFrameCallback(b.callbackKey);this.update()}};f.prototype.isPointIn=function(b){return!1}})();(function(){function f(a,b){var e=a.toMmPoint(b.lng||b.x,b.lat||b.y);return new mxLib.Point(e.x,e.y)}var b=mxLib.Service=function(a,b){this.map=a;this.setHost(b);this.mapType=this.map.mapModel.getMapType("")};b.DRIVING_POLICY_LEAST_TIME=0;b.DRIVING_POLICY_LEAST_DISTANCE=1;b.DRIVING_POLICY_AVOID_HIGHWAYS=2;b.prototype.setHost=function(a){this.mainHost=a||"http://cloud.cmetamap.com:3008/";this.serviceHost=this.mainHost+"map?service\x3d";this.screenHost=this.mainHost+"screen?url\x3d"};b.prototype.fromMmPoint=function(a){return mxLib.isString(a)?a:this.mapType.fromMmPoint(a.x,a.y)};b.prototype.drivingRoute=function(a,b,e,f,k){var h={};e=e||{};h.method="DrivingRoute";h.start=this.fromMmPoint(a);h.end=this.fromMmPoint(b);if(e.waypoints&&$.isArray(e.waypoints)&&1<=e.waypoints.length)for(h.waypoints=[],a=0;a<e.waypoints.length;a++)h.waypoints.push(this.fromMmPoint(e.waypoints[a]));h.policy=e.policy||0;h.description=e.description||0;h.google=this.mapType.isGCJ02();var h=this.serviceHost+JSON.stringify(h),n=null,l=this;$.ajax({type:"GET",url:h,async:f?!0:!1,success:function(a){if("error"==a.status)k&&k(a);else{a.resultNums=[];a.allPoints=[];if(a.results)for(var b=0;b<a.results.length;b++){for(var c=a.results[b],e=[],h=0;h<c.length;h++){var u=c[h],u=u.split(","),u=l.mapType.toMmPoint(parseFloat(u[0]),parseFloat(u[1])),u=new mxLib.Point(u.x,u.y);e.push(u);a.allPoints.push(u)}a.resultNums.push(e)}f?f(a):n=a}},error:function(a){k&&k(a)}});return n};b.prototype.drivingRouteTaffic=function(a,b,e,g,k){var h={};e=e||{};h.method="DrivingRouteTaffic";h.start=this.fromMmPoint(a);h.end=this.fromMmPoint(b);if(e.waypoints&&$.isArray(e.waypoints)&&1<=e.waypoints.length)for(h.waypoints=[],a=0;a<e.waypoints.length;a++)h.waypoints.push(this.fromMmPoint(e.waypoints[a]));h.policy=e.policy||0;h.description=e.description||0;h.google=this.mapType.isGCJ02();var h=this.serviceHost+JSON.stringify(h),n=null,l=this;$.ajax({type:"GET",url:h,async:g?!0:!1,success:function(a){if("error"==a.status)k&&k(a);else{if(a.route)for(var b=0;b<a.route.steps.length;b++){var c=a.route.steps[b];c.start_location=f(l.mapType,c.start_location);c.end_location=f(l.mapType,c.end_location);for(var e=0;e<c.path.length;e++)c.path[e]=f(l.mapType,c.path[e]);for(var h=0;h<c.tmcs.length;h++)for(var u=c.tmcs[h],e=0;e<u.path.length;e++)u.path[e]=f(l.mapType,u.path[e])}g?g(a):n=a}},error:function(a){k&&k(a)}});return n};b.prototype.walkingRoute=function(a,b,e,f,k){var h={};e=e||{};h.method="WalkingRoute";h.start=this.fromMmPoint(a);h.end=this.fromMmPoint(b);h.google=this.mapType.isGCJ02();h.description=e.description||0;a=this.serviceHost+JSON.stringify(h);var n=null,l=this;$.ajax({type:"GET",url:a,async:f?!0:!1,success:function(a){if("error"==a.status)k&&k(a);else{a.resultNums=[];a.allPoints=[];if(a.results)for(var b=0;b<a.results.length;b++){for(var c=a.results[b],e=[],h=0;h<c.length;h++){var u=c[h],u=u.split(","),u=l.mapType.toMmPoint(parseFloat(u[0]),parseFloat(u[1])),u=new mxLib.Point(u.x,u.y);e.push(u);a.allPoints.push(u)}a.resultNums.push(e)}f?f(a):n=a}},error:function(a){k&&k(a)}});return n};b.prototype.localSearch=function(a,b,e,f,k){var h={};e=e||{};h.method="LocalSearch";h.location=this.fromMmPoint(a);h.keyword=b;e.bounds&&(h.bounds=e.bounds,h.bounds.start&&(h.bounds.start=this.fromMmPoint(h.bounds.start)),h.bounds.end&&(h.bounds.end=this.fromMmPoint(h.bounds.end)));e.center&&(h.center=this.fromMmPoint(e.center));e.radius&&(h.radius=e.radius);e.pageCapacity&&(h.pageCapacity=e.pageCapacity);h.google=this.mapType.isGCJ02();a=this.serviceHost+JSON.stringify(h);var n=null,l=this;$.ajax({type:"GET",url:a,async:f?!0:!1,success:function(a){if("error"==a.status)k&&k(a);else{for(var b=0;b<a.pois.length;b++){var c=a.pois[b],e=l.mapType.toMmPoint(c.point.lng,c.point.lat);c.point=new mxLib.Point(e.x,e.y)}f?f(a):n=a}},error:function(a){k&&k(a)}});return n};b.prototype.geocoder=function(a,b,e,f){var k={method:"Geocoder"};mxLib.isString(a)?k.location=a:k.point=this.fromMmPoint(a);k.city=b;k.google=this.mapType.isGCJ02();a=this.serviceHost+JSON.stringify(k);var h=null,n=this;$.ajax({type:"GET",url:a,async:e?!0:!1,success:function(a){if("error"==a.status)f&&f(a);else{if(a.point){var b=n.mapType.toMmPoint(a.point.lng,a.point.lat);a.point=new mxLib.Point(b.x,b.y)}e?e(a):h=a}},error:function(a){f&&f(a)}});return h};b.prototype.boundary=function(a,b,e){var f={method:"Boundary"};f.location=a;f.google=this.mapType.isGCJ02();a=this.serviceHost+JSON.stringify(f);var k=null,h=this;$.ajax({type:"GET",url:a,async:b?!0:!1,success:function(a){if("error"==a.status)e&&e(a);else{if(a.boundaries&&0<a.boundaries.length)for(var f=0;f<a.boundaries.length;f++){for(var g=[],q=a.boundaries[f].split(";"),r=0;r<q.length;r++){var t=q[r].split(","),t=h.mapType.toMmPoint(t[0],t[1]);g.push(new mxLib.Point(t.x,t.y))}a.boundaries[f]=g}b?b(a):k=a}},error:function(a){e&&e(a)}});return k};b.prototype.autocomplete=function(a,b,e,f){var k={method:"Autocomplete"};k.location=this.fromMmPoint(a);k.keyword=b;k.google=this.mapType.isGCJ02();a=this.serviceHost+JSON.stringify(k);var h=null;$.ajax({type:"GET",url:a,async:e?!0:!1,success:function(a){"error"==a.status?f&&f(a):e?e(a):h=a},error:function(a){f&&f(a)}});return h};b.prototype.weather=function(a,b,e,f){var k={method:"Weather"};k.district=a;k.forecast=b;k.google=this.mapType.isGCJ02();a=this.serviceHost+JSON.stringify(k);var h=null;$.ajax({type:"GET",url:a,async:e?!0:!1,success:function(a){"error"==a.status?f&&f(a):e?e(a):h=a},error:function(a){f&&f(a)}});return h};b.prototype.pageRender=function(a,b,e,f){var k=this.screenHost,k=k+a;b=b||{};b.type=b.type||"text";b.type&&(k+="\x26type\x3d"+b.type);b.time&&(k+="\x26time\x3d"+b.time);b.width&&(k+="\x26width\x3d"+b.width);b.height&&(k+="\x26height\x3d"+b.height);var h=null,n=this;$.ajax({type:"GET",url:k,async:e?!0:!1,success:function(a){"error"==a.status?f&&f(a):(a.pic&&(a.pic=n.mainHost+a.pic),e?e(a):h=a)},error:function(a){f&&f(a)}});return h}})();